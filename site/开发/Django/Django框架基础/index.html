
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="美少男">
      
      
        <meta name="author" content="李烨栋">
      
      
        <link rel="canonical" href="https://li-ye-dong.github.io/%E5%BC%80%E5%8F%91/Django/Django%E6%A1%86%E6%9E%B6%E5%9F%BA%E7%A1%80/">
      
      
        <link rel="prev" href="../Bootstrap/">
      
      
        <link rel="next" href="../Tailwind%20CSS/">
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.7">
    
    
      
        <title>十二，Django框架基础 - 李烨栋的博客</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.8608ea7d.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
    
    
      <link rel="stylesheet" href="../../../static/stylesheets/google_font.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="green" data-md-color-accent="green">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#十二django框架基础" class="md-skip">
          跳转至
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="页眉">
    <a href="../../.." title="李烨栋的博客" class="md-header__button md-logo" aria-label="李烨栋的博客" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            李烨栋的博客
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              十二，Django框架基础
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="green" data-md-color-accent="green"  aria-label="日间模式"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="日间模式" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="blue" data-md-color-accent="blue"  aria-label="夜间模式"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="夜间模式" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="搜索" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="查找">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="分享" aria-label="分享" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="清空当前内容" aria-label="清空当前内容" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            正在初始化搜索引擎
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/li-ye-dong/liyedong.github.io.git" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    li-ye-dong.github.io
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="标签" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
    
  
  知识库索引

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../k8s%E5%92%8C%E5%AE%B9%E5%99%A8/Helm%20%E6%97%A5%E5%B8%B8%E4%BD%BF%E7%94%A8%E4%B8%8E%E5%B0%81%E8%A3%85%E8%87%AA%E5%AE%9A%E4%B9%89%E5%BA%94%E7%94%A8%E5%8F%91%E5%B8%83%E7%AC%94%E8%AE%B0/" class="md-tabs__link">
          
  
    
  
  K8s和容器

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../%E4%B8%AD%E9%97%B4%E4%BB%B6/ELK/alertmanager/" class="md-tabs__link">
          
  
    
  
  中间件

        </a>
      </li>
    
  

    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../%E5%88%86%E4%BA%AB/1.ai%E6%95%B0%E5%AD%97%E4%BA%BA/" class="md-tabs__link">
          
  
    
  
  分享

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../%E5%AE%89%E5%85%A8/Burp%20Suite%E6%8A%93%E5%8C%85%E5%B7%A5%E5%85%B7/" class="md-tabs__link">
          
  
    
  
  安全

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/2024%E5%B9%B46%E6%9C%88%E6%80%BB%E7%BB%93/" class="md-tabs__link">
          
  
    
  
  工具使用

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../Aliphe.js%E6%A1%86%E6%9E%B6/" class="md-tabs__link">
          
  
    
  
  开发

        </a>
      </li>
    
  

    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/windows%E6%96%87%E4%BB%B6%E5%A4%8D%E5%88%B6%E5%B8%A6%E6%9D%83%E9%99%90/" class="md-tabs__link">
          
  
    
  
  操作系统

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../%E6%95%B0%E6%8D%AE%E5%BA%93%E7%AC%94%E8%AE%B0/Elasticsearch%20%E6%95%99%E7%A8%8B/" class="md-tabs__link">
          
  
    
  
  数据库笔记

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../%E6%B5%8F%E8%A7%88%E5%99%A8%E4%B9%A6%E7%AD%BE%E6%94%B6%E8%97%8F/%E5%9C%B0%E5%9D%801/" class="md-tabs__link">
          
  
    
  
  浏览器书签收藏

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../%E7%9B%91%E6%8E%A7/zabbix%E7%9B%91%E6%8E%A74.2/" class="md-tabs__link">
          
  
    
  
  监控

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../%E8%99%9A%E6%8B%9F%E5%8C%96/%E8%99%9A%E6%8B%9F%E5%8C%96/RVtools%E4%BD%BF%E7%94%A8/" class="md-tabs__link">
          
  
    
  
  虚拟化

        </a>
      </li>
    
  

    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../%E8%AE%A4%E8%AF%81%E7%9B%B8%E5%85%B3/credly%E6%9F%A5%E7%9C%8B%E5%8B%8B%E7%AB%A0/" class="md-tabs__link">
          
  
    
  
  认证相关

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="导航栏" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="李烨栋的博客" class="md-nav__button md-logo" aria-label="李烨栋的博客" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    李烨栋的博客
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/li-ye-dong/liyedong.github.io.git" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    li-ye-dong.github.io
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    知识库索引
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../../k8s%E5%92%8C%E5%AE%B9%E5%99%A8/Helm%20%E6%97%A5%E5%B8%B8%E4%BD%BF%E7%94%A8%E4%B8%8E%E5%B0%81%E8%A3%85%E8%87%AA%E5%AE%9A%E4%B9%89%E5%BA%94%E7%94%A8%E5%8F%91%E5%B8%83%E7%AC%94%E8%AE%B0/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    K8s和容器
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    
  
  
    <a href="../../../%E4%B8%AD%E9%97%B4%E4%BB%B6/ELK/alertmanager/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    中间件
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../../%E5%88%86%E4%BA%AB/1.ai%E6%95%B0%E5%AD%97%E4%BA%BA/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    分享
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../../%E5%AE%89%E5%85%A8/Burp%20Suite%E6%8A%93%E5%8C%85%E5%B7%A5%E5%85%B7/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    安全
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../../%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/2024%E5%B9%B46%E6%9C%88%E6%80%BB%E7%BB%93/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    工具使用
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
        
        
      
      
        
      
    
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" checked>
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="">
            
  
  <span class="md-ellipsis">
    开发
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            开发
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
          
          
        
      
    
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_1" checked>
        
          
          <label class="md-nav__link" for="__nav_7_1" id="__nav_7_1_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Django
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_7_1">
            <span class="md-nav__icon md-icon"></span>
            Django
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Aliphe.js%E6%A1%86%E6%9E%B6/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Aliphe.js框架
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Bootstrap/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bootstrap
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    十二，Django框架基础
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    十二，Django框架基础
    
  </span>
  

      </a>
      
        

  

<nav class="md-nav md-nav--secondary" aria-label="在这个页面">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      在这个页面
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-命令行操作" class="md-nav__link">
    <span class="md-ellipsis">
      1 命令行操作
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-主要文件介绍" class="md-nav__link">
    <span class="md-ellipsis">
      2 主要文件介绍
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-应用" class="md-nav__link">
    <span class="md-ellipsis">
      3 应用
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-命令行与pycharm创建的区别" class="md-nav__link">
    <span class="md-ellipsis">
      4 命令行与pycharm创建的区别
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-django小白必会三板斧" class="md-nav__link">
    <span class="md-ellipsis">
      5 django小白必会三板斧
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-静态文件配置" class="md-nav__link">
    <span class="md-ellipsis">
      6 静态文件配置
    </span>
  </a>
  
    <nav class="md-nav" aria-label="6 静态文件配置">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#61-static文件作用" class="md-nav__link">
    <span class="md-ellipsis">
      6.1 static文件作用
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#62-static文件配置" class="md-nav__link">
    <span class="md-ellipsis">
      6.2 static文件配置
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#63-静态文件动态解析" class="md-nav__link">
    <span class="md-ellipsis">
      6.3 静态文件动态解析
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#64-form表单提交数据及action参数" class="md-nav__link">
    <span class="md-ellipsis">
      6.4 form表单提交数据，及action参数
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#65-需要配置文件组中注释掉一行代码" class="md-nav__link">
    <span class="md-ellipsis">
      6.5 需要配置文件组中注释掉一行代码
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7-request对象方法初识" class="md-nav__link">
    <span class="md-ellipsis">
      7 request对象方法初识
    </span>
  </a>
  
    <nav class="md-nav" aria-label="7 request对象方法初识">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#71-方法" class="md-nav__link">
    <span class="md-ellipsis">
      7.1 方法
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#72-案例" class="md-nav__link">
    <span class="md-ellipsis">
      7.2 案例
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#73-requestpost结果" class="md-nav__link">
    <span class="md-ellipsis">
      7.3 request.POST结果
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#8-django链接数据库mysql" class="md-nav__link">
    <span class="md-ellipsis">
      8 django链接数据库(MySQL)
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#9-django-orm" class="md-nav__link">
    <span class="md-ellipsis">
      9 Django ORM
    </span>
  </a>
  
    <nav class="md-nav" aria-label="9 Django ORM">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#91-字段的增删改查" class="md-nav__link">
    <span class="md-ellipsis">
      9.1 字段的增删改查
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#92-数据的增删改查" class="md-nav__link">
    <span class="md-ellipsis">
      9.2 数据的增删改查
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#93-查" class="md-nav__link">
    <span class="md-ellipsis">
      9.3 查
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#94-改" class="md-nav__link">
    <span class="md-ellipsis">
      9.4 改
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#95-删除" class="md-nav__link">
    <span class="md-ellipsis">
      9.5 删除
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#96-orm创建表关系" class="md-nav__link">
    <span class="md-ellipsis">
      9.6 orm创建表关系
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#10-django-请求声明周期流程图" class="md-nav__link">
    <span class="md-ellipsis">
      10 Django 请求声明周期流程图
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#11-路由层" class="md-nav__link">
    <span class="md-ellipsis">
      11 路由层
    </span>
  </a>
  
    <nav class="md-nav" aria-label="11 路由层">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#11-1-路由匹配" class="md-nav__link">
    <span class="md-ellipsis">
      11-1 路由匹配
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#11-2-无名分组" class="md-nav__link">
    <span class="md-ellipsis">
      11-2 无名分组
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#11-3-有名分组" class="md-nav__link">
    <span class="md-ellipsis">
      11-3 有名分组
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#11-4-无名有名是否可以混用" class="md-nav__link">
    <span class="md-ellipsis">
      11-4 无名有名是否可以混用
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#11-5-反向解析" class="md-nav__link">
    <span class="md-ellipsis">
      11-5 反向解析
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#11-6-无名分组反向解析" class="md-nav__link">
    <span class="md-ellipsis">
      11-6 无名分组反向解析
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#11-7-有名分组的反向解析" class="md-nav__link">
    <span class="md-ellipsis">
      11-7 有名分组的反向解析
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#11-8-路由分发" class="md-nav__link">
    <span class="md-ellipsis">
      11-8 路由分发
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#11-9-命名空间" class="md-nav__link">
    <span class="md-ellipsis">
      11-9 命名空间
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#11-10-伪静态" class="md-nav__link">
    <span class="md-ellipsis">
      11-10 伪静态
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#12-django版本区别" class="md-nav__link">
    <span class="md-ellipsis">
      12 django版本区别
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#13-视图层" class="md-nav__link">
    <span class="md-ellipsis">
      13 视图层
    </span>
  </a>
  
    <nav class="md-nav" aria-label="13 视图层">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#13-1-三板斧" class="md-nav__link">
    <span class="md-ellipsis">
      13-1 三板斧
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#13-2-jsonresponse对象" class="md-nav__link">
    <span class="md-ellipsis">
      13-2 JsonResponse对象
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#13-3-form表单上传文件及后端如何操作" class="md-nav__link">
    <span class="md-ellipsis">
      13-3 form表单上传文件及后端如何操作
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#13-4-request对象方法" class="md-nav__link">
    <span class="md-ellipsis">
      13-4 request对象方法
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#13-5-fbv与cbv" class="md-nav__link">
    <span class="md-ellipsis">
      13-5 FBV与CBV
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#13-6-cbv源码分析" class="md-nav__link">
    <span class="md-ellipsis">
      13-6 CBV源码分析
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#14-模板层" class="md-nav__link">
    <span class="md-ellipsis">
      14 模板层
    </span>
  </a>
  
    <nav class="md-nav" aria-label="14 模板层">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#14-1-模版语法传值" class="md-nav__link">
    <span class="md-ellipsis">
      14-1 模版语法传值
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#14-2-过滤器" class="md-nav__link">
    <span class="md-ellipsis">
      14-2 过滤器
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#14-3-标签" class="md-nav__link">
    <span class="md-ellipsis">
      14-3 标签
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#14-4-自定义过滤器标签inclusion_tag" class="md-nav__link">
    <span class="md-ellipsis">
      14-4 自定义过滤器、标签、inclusion_tag
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#14-5-模板的继承" class="md-nav__link">
    <span class="md-ellipsis">
      14-5 模板的继承
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#15-模型层" class="md-nav__link">
    <span class="md-ellipsis">
      15 模型层
    </span>
  </a>
  
    <nav class="md-nav" aria-label="15 模型层">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#15-1-单表操作" class="md-nav__link">
    <span class="md-ellipsis">
      15-1 单表操作
    </span>
  </a>
  
    <nav class="md-nav" aria-label="15-1 单表操作">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#15-1-1-增" class="md-nav__link">
    <span class="md-ellipsis">
      15-1-1 增
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#15-1-2-删" class="md-nav__link">
    <span class="md-ellipsis">
      15-1-2 删
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#15-1-3-修改" class="md-nav__link">
    <span class="md-ellipsis">
      15-1-3 修改
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#15-2-必知必会13条" class="md-nav__link">
    <span class="md-ellipsis">
      15-2 必知必会13条
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#15-3-查看内部sql语句的方式" class="md-nav__link">
    <span class="md-ellipsis">
      15-3 查看内部sql语句的方式
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#15-4-测试脚本" class="md-nav__link">
    <span class="md-ellipsis">
      15-4 测试脚本
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#15-5-神奇的双下划线查询" class="md-nav__link">
    <span class="md-ellipsis">
      15-5 神奇的双下划线查询
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#15-6-案例表创建" class="md-nav__link">
    <span class="md-ellipsis">
      15-6 案例表创建
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#15-7-一对多外键增删改查" class="md-nav__link">
    <span class="md-ellipsis">
      15-7 一对多外键增删改查
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#15-8-多对多外键增删改查" class="md-nav__link">
    <span class="md-ellipsis">
      15-8 多对多外键增删改查
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#15-9-正反向的概念" class="md-nav__link">
    <span class="md-ellipsis">
      15-9 正反向的概念
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#15-10-多表查询" class="md-nav__link">
    <span class="md-ellipsis">
      15-10 多表查询
    </span>
  </a>
  
    <nav class="md-nav" aria-label="15-10 多表查询">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#10-1-子查询基于对象的跨表查询" class="md-nav__link">
    <span class="md-ellipsis">
      10-1 子查询(基于对象的跨表查询)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#10-2-联表查询基于双下划线的跨表查询" class="md-nav__link">
    <span class="md-ellipsis">
      10-2 联表查询(基于双下划线的跨表查询)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#15-11-聚合查询" class="md-nav__link">
    <span class="md-ellipsis">
      15-11 聚合查询
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#15-12-分组查询" class="md-nav__link">
    <span class="md-ellipsis">
      15-12 分组查询
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#15-13-f查询" class="md-nav__link">
    <span class="md-ellipsis">
      15-13 F查询
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#15-14-q-查询" class="md-nav__link">
    <span class="md-ellipsis">
      15-14 Q 查询
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#15-15-django中开启事务" class="md-nav__link">
    <span class="md-ellipsis">
      15-15 Django中开启事务
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#15--16-orm中常用字段及参数" class="md-nav__link">
    <span class="md-ellipsis">
      15 -16 ORM中常用字段及参数
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#15-16-数据库查询优化" class="md-nav__link">
    <span class="md-ellipsis">
      15-16 数据库查询优化
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#15-17-图书馆里系统的增删改查" class="md-nav__link">
    <span class="md-ellipsis">
      15-17 图书馆里系统的增删改查
    </span>
  </a>
  
    <nav class="md-nav" aria-label="15-17 图书馆里系统的增删改查">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#17-1-modelspy" class="md-nav__link">
    <span class="md-ellipsis">
      17-1 models.py
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#17-2-viewspy" class="md-nav__link">
    <span class="md-ellipsis">
      17-2 views.py
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#17-3-urlspy" class="md-nav__link">
    <span class="md-ellipsis">
      17-3 urls.py
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#17-4-homehtml" class="md-nav__link">
    <span class="md-ellipsis">
      17-4 home.html
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#17-5-book_listhtml" class="md-nav__link">
    <span class="md-ellipsis">
      17-5 book_list.html
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#17-6-book_addhtml" class="md-nav__link">
    <span class="md-ellipsis">
      17-6 book_add.html
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#17-7-book_delhtml" class="md-nav__link">
    <span class="md-ellipsis">
      17-7 book_del.html
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#15-18-choices参数" class="md-nav__link">
    <span class="md-ellipsis">
      15-18 choices参数
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#15-19-mtv与mvc模型" class="md-nav__link">
    <span class="md-ellipsis">
      15-19 MTV与MVC模型
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#15-20-多对多三种创建方式" class="md-nav__link">
    <span class="md-ellipsis">
      15-20 多对多三种创建方式
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#16-ajax" class="md-nav__link">
    <span class="md-ellipsis">
      16 Ajax
    </span>
  </a>
  
    <nav class="md-nav" aria-label="16 Ajax">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#16-1-小例子" class="md-nav__link">
    <span class="md-ellipsis">
      16-1 小例子
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#16-2-前后端传输数据的编码格式" class="md-nav__link">
    <span class="md-ellipsis">
      16-2 前后端传输数据的编码格式
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#16-3-ajax发送json格式" class="md-nav__link">
    <span class="md-ellipsis">
      16-3 Ajax发送JSON格式
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#16-4-ajax发送文件" class="md-nav__link">
    <span class="md-ellipsis">
      16-4 Ajax发送文件
    </span>
  </a>
  
    <nav class="md-nav" aria-label="16-4 Ajax发送文件">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#4-1-笔记上的方法" class="md-nav__link">
    <span class="md-ellipsis">
      4-1 笔记上的方法
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-2-原生js实现文件上传" class="md-nav__link">
    <span class="md-ellipsis">
      4-2 原生JS实现文件上传
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-3-jquery实现文件上传" class="md-nav__link">
    <span class="md-ellipsis">
      4-3 jQuery实现文件上传
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#16-5-显示文件上传的进度" class="md-nav__link">
    <span class="md-ellipsis">
      16-5 显示文件上传的进度
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#16-6-jquery实现loading效果" class="md-nav__link">
    <span class="md-ellipsis">
      16-6 jQuery实现loading效果
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#16-7-axios" class="md-nav__link">
    <span class="md-ellipsis">
      16-7 Axios
    </span>
  </a>
  
    <nav class="md-nav" aria-label="16-7 Axios">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#71-axios发起get请求" class="md-nav__link">
    <span class="md-ellipsis">
      7.1 axios发起GET请求
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#72-直接使用axios发起post请求" class="md-nav__link">
    <span class="md-ellipsis">
      7.2 直接使用axios发起POST请求
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#73-直接使用axios发起请求" class="md-nav__link">
    <span class="md-ellipsis">
      7,3 直接使用axios发起请求
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#16-8-django自带的序列化组件drf做铺垫" class="md-nav__link">
    <span class="md-ellipsis">
      16-8 django自带的序列化组件(drf做铺垫)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#16-9-ajax结合sweetalert" class="md-nav__link">
    <span class="md-ellipsis">
      16-9 ajax结合sweetalert
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#16-10-批量插入" class="md-nav__link">
    <span class="md-ellipsis">
      16-10 批量插入
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#16-11-分页器" class="md-nav__link">
    <span class="md-ellipsis">
      16-11 分页器
    </span>
  </a>
  
    <nav class="md-nav" aria-label="16-11 分页器">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#11-1-基础班" class="md-nav__link">
    <span class="md-ellipsis">
      11-1 基础班
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#11-2-现成的代码直接用" class="md-nav__link">
    <span class="md-ellipsis">
      11-2 现成的代码（直接用）
    </span>
  </a>
  
    <nav class="md-nav" aria-label="11-2 现成的代码（直接用）">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#utilsmypagepy" class="md-nav__link">
    <span class="md-ellipsis">
      utils.mypage.py
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#viewspy" class="md-nav__link">
    <span class="md-ellipsis">
      views.py
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ab_plhtml" class="md-nav__link">
    <span class="md-ellipsis">
      ab_pl.html
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#16-12-自定义分页器的拷贝及使用" class="md-nav__link">
    <span class="md-ellipsis">
      16-12 自定义分页器的拷贝及使用
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#17-表单的基本使用" class="md-nav__link">
    <span class="md-ellipsis">
      17 表单的基本使用
    </span>
  </a>
  
    <nav class="md-nav" aria-label="17 表单的基本使用">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#171" class="md-nav__link">
    <span class="md-ellipsis">
      17.1
    </span>
  </a>
  
    <nav class="md-nav" aria-label="17.1">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-1-target" class="md-nav__link">
    <span class="md-ellipsis">
      1-1 target
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1-2-enctype" class="md-nav__link">
    <span class="md-ellipsis">
      1-2 enctype
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#17-2-表单的同步提交及缺点" class="md-nav__link">
    <span class="md-ellipsis">
      17-2 表单的同步提交及缺点
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#17-3-通过ajax提交表单数据" class="md-nav__link">
    <span class="md-ellipsis">
      17-3 通过Ajax提交表单数据
    </span>
  </a>
  
    <nav class="md-nav" aria-label="17-3 通过Ajax提交表单数据">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-监听表单提交事件" class="md-nav__link">
    <span class="md-ellipsis">
      3.1 监听表单提交事件
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-2-阻止表单默认提交行为" class="md-nav__link">
    <span class="md-ellipsis">
      3-2 阻止表单默认提交行为
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-3-快速获取表单中的数据" class="md-nav__link">
    <span class="md-ellipsis">
      3-3 快速获取表单中的数据
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3-3 快速获取表单中的数据">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#serialize函数" class="md-nav__link">
    <span class="md-ellipsis">
      serialize()函数
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#18-forms组件" class="md-nav__link">
    <span class="md-ellipsis">
      18 forms组件
    </span>
  </a>
  
    <nav class="md-nav" aria-label="18 forms组件">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#18-1-前戏" class="md-nav__link">
    <span class="md-ellipsis">
      18-1 前戏
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#18-2-基本使用" class="md-nav__link">
    <span class="md-ellipsis">
      18-2 基本使用
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#18-3-校验数据" class="md-nav__link">
    <span class="md-ellipsis">
      18-3 校验数据
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#18-4-渲染标签" class="md-nav__link">
    <span class="md-ellipsis">
      18-4 渲染标签
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#18-5-展示提示信息" class="md-nav__link">
    <span class="md-ellipsis">
      18-5 展示提示信息
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#18-6-钩子函数hook" class="md-nav__link">
    <span class="md-ellipsis">
      18-6 钩子函数(HOOK)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#18-7-forms组件其他参数及补充知识点" class="md-nav__link">
    <span class="md-ellipsis">
      18-7 forms组件其他参数及补充知识点
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#18-8-其他类型渲染" class="md-nav__link">
    <span class="md-ellipsis">
      18-8 其他类型渲染
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#18-9-forms组件源码" class="md-nav__link">
    <span class="md-ellipsis">
      18-9 forms组件源码
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#19-cookie与session" class="md-nav__link">
    <span class="md-ellipsis">
      19 cookie与session
    </span>
  </a>
  
    <nav class="md-nav" aria-label="19 cookie与session">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#19-1-cookie与session" class="md-nav__link">
    <span class="md-ellipsis">
      19-1 cookie与session
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#19-2-django操作cookie" class="md-nav__link">
    <span class="md-ellipsis">
      19-2 Django操作cookie
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#19-3-登录装饰器" class="md-nav__link">
    <span class="md-ellipsis">
      19-3 登录装饰器
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#19-4-django操作session" class="md-nav__link">
    <span class="md-ellipsis">
      19-4 django操作session
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#19-5-cbv如何添加装饰器" class="md-nav__link">
    <span class="md-ellipsis">
      19-5 CBV如何添加装饰器
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#20-django中间件" class="md-nav__link">
    <span class="md-ellipsis">
      20 Django中间件
    </span>
  </a>
  
    <nav class="md-nav" aria-label="20 Django中间件">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#20-1-django中间件" class="md-nav__link">
    <span class="md-ellipsis">
      20-1 django中间件
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#20-2-如何自定义中间件" class="md-nav__link">
    <span class="md-ellipsis">
      20-2 如何自定义中间件
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#20-3-csrf跨站请求伪造" class="md-nav__link">
    <span class="md-ellipsis">
      20-3 csrf跨站请求伪造
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#20-4-如何符合校验" class="md-nav__link">
    <span class="md-ellipsis">
      20-4 如何符合校验
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#20-5-csrf相关装饰器" class="md-nav__link">
    <span class="md-ellipsis">
      20-5 CSRF相关装饰器
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#20-6-补充知识点" class="md-nav__link">
    <span class="md-ellipsis">
      20-6 补充知识点
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#20-7-重要思想" class="md-nav__link">
    <span class="md-ellipsis">
      20-7 重要思想
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#21-auth模块" class="md-nav__link">
    <span class="md-ellipsis">
      21 auth模块
    </span>
  </a>
  
    <nav class="md-nav" aria-label="21 auth模块">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-1-auth模块" class="md-nav__link">
    <span class="md-ellipsis">
      21-1 Auth模块
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#21-2-方法总结" class="md-nav__link">
    <span class="md-ellipsis">
      21-2 方法总结
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#21-3-如何扩展auth_user表" class="md-nav__link">
    <span class="md-ellipsis">
      21-3 如何扩展auth_user表
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#22-bbs项目" class="md-nav__link">
    <span class="md-ellipsis">
      22 bbs项目
    </span>
  </a>
  
    <nav class="md-nav" aria-label="22 bbs项目">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#22-1-表设计" class="md-nav__link">
    <span class="md-ellipsis">
      22-1 表设计
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22-2-表设计代码" class="md-nav__link">
    <span class="md-ellipsis">
      22-2 表设计代码
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22-3-注册功能" class="md-nav__link">
    <span class="md-ellipsis">
      22-3 注册功能
    </span>
  </a>
  
    <nav class="md-nav" aria-label="22-3 注册功能">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#3-1-后端代码" class="md-nav__link">
    <span class="md-ellipsis">
      3-1 后端代码
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-2-前端页面registerhtml代码" class="md-nav__link">
    <span class="md-ellipsis">
      3-2 前端页面register.html代码
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22-4-登录功能" class="md-nav__link">
    <span class="md-ellipsis">
      22-4 登录功能
    </span>
  </a>
  
    <nav class="md-nav" aria-label="22-4 登录功能">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#4-1-后端代码" class="md-nav__link">
    <span class="md-ellipsis">
      4-1 后端代码
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-2-前端login页面代码" class="md-nav__link">
    <span class="md-ellipsis">
      4-2 前端login页面代码
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#django-报错解决" class="md-nav__link">
    <span class="md-ellipsis">
      Django 报错解决
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-1-错误一" class="md-nav__link">
    <span class="md-ellipsis">
      1-1 错误一
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-2-错误二" class="md-nav__link">
    <span class="md-ellipsis">
      1-2 错误二
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Tailwind%20CSS/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tailwind CSS
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../DRF%E6%A1%86%E6%9E%B6/JWT%E8%AE%A4%E8%AF%81/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    DRF框架
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../Django%E5%9F%BA%E7%A1%80/Django%20%E8%B7%AF%E7%94%B1%E9%85%8D%E7%BD%AEURLConf/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    Django基础
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../Django%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98-luffycity/ES%E5%85%A8%E6%96%87%E6%A3%80%E7%B4%A2/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    Django项目实战 luffycity
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
          
          
        
      
    
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7_2" >
        
          
          <label class="md-nav__link" for="__nav_7_2" id="__nav_7_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Golang
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_2">
            <span class="md-nav__icon md-icon"></span>
            Golang
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Golang/GO%E8%AF%AD%E8%A8%80%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GO语言基础入门学习笔记
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Golang/Go%20%E5%BC%80%E5%8F%91%E6%8A%80%E5%B7%A7%E5%AF%B9%E7%85%A7%E8%A1%A8/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Go 开发技巧对照表
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Golang/Go%20%E8%B7%A8%E5%8C%85%E8%B0%83%E7%94%A8%20%2B%20%E9%A1%B9%E7%9B%AE%E5%B7%A5%E7%A8%8B%E5%8C%96/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Go 跨包调用 + 项目工程化
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Golang/Golang%E6%89%93%E5%8C%85/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Golang打包
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Golang/Go%E5%91%BD%E4%BB%A4%E5%B8%AE%E5%8A%A9%E6%96%87%E6%A1%A3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Go命令帮助文档
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Golang/http%E8%AF%B7%E6%B1%82%E7%AC%AC%E4%B8%89%E6%96%B9%E5%BA%93/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Http请求第三方库
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../Golang/goblog/Elasticsearch/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    Goblog
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
          
          
        
      
    
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7_3" >
        
          
          <label class="md-nav__link" for="__nav_7_3" id="__nav_7_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Python
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_3">
            <span class="md-nav__icon md-icon"></span>
            Python
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Python/Flet%E5%BA%93%20GUI%E8%B7%A8%E5%B9%B3%E5%8F%B0%E5%AD%A6%E4%B9%A0/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Flet库 GUI跨平台学习
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Python/Python%E2%80%94%E2%80%94Gooey%E5%B0%81%E8%A3%85%E5%91%BD%E4%BB%A4%E8%A1%8CGUI%E5%B7%A5%E5%85%B7/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Python——Gooey封装命令行GUI工具
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../Python/FastApi/FastAPI%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    FastApi
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../Python/Flask/Flask%20%E6%96%B9%E6%A1%88/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    Flask
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../Python/Pandas/Pandas%20DataFrame/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    Pandas
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../Python/Python%E5%8C%85%E7%AE%A1%E7%90%86%E5%99%A8/PDM/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    Python包管理器
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../Python/Python%E5%9F%BA%E7%A1%80/Python%20gui%E8%87%AA%E5%8A%A8%E5%8C%96/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    Python基础
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../Python/Python%E5%B7%A5%E7%A8%8B%E5%8C%96/Docker%E5%88%9D%E5%A7%8B%E5%8C%96/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    Python工程化
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../Python/Python%E6%89%93%E5%8C%85/Python%E6%89%93%E5%8C%85glibc%E5%85%BC%E5%AE%B9/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    Python打包
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../Python/%E7%88%AC%E8%99%AB%E5%92%8Cweb%E8%87%AA%E5%8A%A8%E5%8C%96/Base64%E7%BC%96%E7%A0%81/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    爬虫和web自动化
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
          
          
        
      
    
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7_4" >
        
          
          <label class="md-nav__link" for="__nav_7_4" id="__nav_7_4_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Rust
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_4">
            <span class="md-nav__icon md-icon"></span>
            Rust
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Rust/Cargo%E5%8C%85%E7%AE%A1%E7%90%86%E5%99%A8/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cargo包管理器
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Rust/Rust%20Slice%EF%BC%88%E5%88%87%E7%89%87%EF%BC%89%E7%B1%BB%E5%9E%8B/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Rust Slice（切片）类型
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Rust/Rust%20%E5%87%BD%E6%95%B0/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Rust 函数
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Rust/Rust%20%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Rust 基础语法
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Rust/Rust%20%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Rust 并发编程
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Rust/Rust%20%E5%BE%AA%E7%8E%AF/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Rust 循环
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Rust/Rust%20%E6%89%80%E6%9C%89%E6%9D%83/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Rust 所有权
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Rust/Rust%20%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Rust 数据类型
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Rust/Rust%20%E6%96%87%E4%BB%B6%E4%B8%8E%20IO/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Rust 文件与 IO
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Rust/Rust%20%E6%9D%A1%E4%BB%B6%E8%AF%AD%E5%8F%A5/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Rust 条件语句
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Rust/Rust%20%E6%9E%9A%E4%B8%BE%E7%B1%BB/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Rust 枚举类
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Rust/Rust%20%E6%B3%9B%E5%9E%8B%E4%B8%8E%E7%89%B9%E6%80%A7/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Rust 泛型与特性
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Rust/Rust%20%E6%B3%A8%E9%87%8A/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Rust 注释
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Rust/Rust%20%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Rust 生命周期
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Rust/Rust%20%E7%BB%84%E7%BB%87%E7%AE%A1%E7%90%86/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Rust 组织管理
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Rust/Rust%20%E7%BB%93%E6%9E%84%E4%BD%93/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Rust 结构体
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Rust/Rust%20%E8%BE%93%E5%87%BA%E5%88%B0%E5%91%BD%E4%BB%A4%E8%A1%8C/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Rust 输出到命令行
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Rust/Rust%20%E9%94%99%E8%AF%AF%E5%A4%84%E7%90%86/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Rust 错误处理
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Rust/Rust%20%E9%9B%86%E5%90%88%E4%B8%8E%E5%AD%97%E7%AC%A6%E4%B8%B2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Rust 集合与字符串
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Rust/Rust%20%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Rust 面向对象
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Rust/Rust%E5%AE%89%E8%A3%85%E5%92%8CHelloWorld/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Rust安装和HelloWorld
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
      
      
        
          
          
        
      
    
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7_5" >
        
          
          <label class="md-nav__link" for="__nav_7_5" id="__nav_7_5_label" tabindex="">
            
  
  <span class="md-ellipsis">
    前端
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_5">
            <span class="md-nav__icon md-icon"></span>
            前端
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E5%89%8D%E7%AB%AF/P1-html%2Bcss%2Bjs%2Bes6%20%281%29/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    一，二、HTML＋CSS学习笔记
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E5%89%8D%E7%AB%AF/p2-jquery%2Bajax%2Bpromise%2Bnpm%2Bgit/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    五、JQuery
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E5%89%8D%E7%AB%AF/p3-vue%2Bnodejs%2Btypescript%2Breact%2B%E5%B0%8F%E7%A8%8B%E5%BA%8F/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    十、Vue
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
          
          
        
      
    
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7_6" >
        
          
          <label class="md-nav__link" for="__nav_7_6" id="__nav_7_6_label" tabindex="">
            
  
  <span class="md-ellipsis">
    开发
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_6">
            <span class="md-nav__icon md-icon"></span>
            开发
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E5%BC%80%E5%8F%91/Git%E6%95%99%E7%A8%8B/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Git教程
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E5%BC%80%E5%8F%91/Java/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Java笔记
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E5%BC%80%E5%8F%91/Uniapp%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%88Vue2%EF%BC%89/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Uniapp学习笔记（Vue2）
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E5%BC%80%E5%8F%91/Vue3%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Vue3学习笔记
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E5%BC%80%E5%8F%91/rust%E5%AD%A6%E4%B9%A0/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    rust学习
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E5%BC%80%E5%8F%91/typescript%E5%AD%A6%E4%B9%A0/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    typescript学习
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E5%BC%80%E5%8F%91/windows%E4%BD%BF%E7%94%A8wsl%E5%BC%80%E5%8F%91/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Windows使用wsl开发
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E5%BC%80%E5%8F%91/%E5%89%8D%E7%AB%AF%E5%8C%85%E7%AE%A1%E7%90%86%E5%99%A8/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    前端包管理器
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E5%BC%80%E5%8F%91/%E6%95%B0%E6%8D%AE%E5%BA%93ORM%E7%9B%B8%E5%85%B3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    数据库ORM相关
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../%E5%BC%80%E5%8F%91/grpc/Go/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    Grpc
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../%E5%BC%80%E5%8F%91/%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86/Python%E5%AE%9E%E7%8E%B0/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    图像处理
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
      
      
        
          
          
        
      
    
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7_7" >
        
          
          <label class="md-nav__link" for="__nav_7_7" id="__nav_7_7_label" tabindex="">
            
  
  <span class="md-ellipsis">
    微信开发
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_7">
            <span class="md-nav__icon md-icon"></span>
            微信开发
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E5%BE%AE%E4%BF%A1%E5%BC%80%E5%8F%91/%E5%85%AC%E4%BC%97%E5%8F%B7/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    公众号
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E5%BE%AE%E4%BF%A1%E5%BC%80%E5%8F%91/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    内网穿透
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E5%BE%AE%E4%BF%A1%E5%BC%80%E5%8F%91/%E5%9B%9E%E8%B0%83%E6%8E%A5%E5%85%A5/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    回调接入
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E5%BE%AE%E4%BF%A1%E5%BC%80%E5%8F%91/%E6%96%87%E6%A1%A3%E5%8F%82%E8%80%83/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    文档参考
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
      
      
        
          
          
        
      
    
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7_8" >
        
          
          <label class="md-nav__link" for="__nav_7_8" id="__nav_7_8_label" tabindex="">
            
  
  <span class="md-ellipsis">
    静态网站博客
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_8">
            <span class="md-nav__icon md-icon"></span>
            静态网站博客
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E9%9D%99%E6%80%81%E7%BD%91%E7%AB%99%E5%8D%9A%E5%AE%A2/GithubPage%E6%90%AD%E5%BB%BA%E5%8D%9A%E5%AE%A2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GithubPage搭建博客
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E9%9D%99%E6%80%81%E7%BD%91%E7%AB%99%E5%8D%9A%E5%AE%A2/mkdocs%E8%AF%A6%E7%BB%86%E9%85%8D%E7%BD%AE/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mkdocs文档生成器
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E9%9D%99%E6%80%81%E7%BD%91%E7%AB%99%E5%8D%9A%E5%AE%A2/%E9%9D%99%E6%80%81%E7%AB%99%E7%82%B9%E7%94%9F%E6%88%90%E5%99%A8/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    静态站点生成器
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../../%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/windows%E6%96%87%E4%BB%B6%E5%A4%8D%E5%88%B6%E5%B8%A6%E6%9D%83%E9%99%90/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    操作系统
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../../%E6%95%B0%E6%8D%AE%E5%BA%93%E7%AC%94%E8%AE%B0/Elasticsearch%20%E6%95%99%E7%A8%8B/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    数据库笔记
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../../%E6%B5%8F%E8%A7%88%E5%99%A8%E4%B9%A6%E7%AD%BE%E6%94%B6%E8%97%8F/%E5%9C%B0%E5%9D%801/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    浏览器书签收藏
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../../%E7%9B%91%E6%8E%A7/zabbix%E7%9B%91%E6%8E%A74.2/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    监控
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    
  
  
    <a href="../../../%E8%99%9A%E6%8B%9F%E5%8C%96/%E8%99%9A%E6%8B%9F%E5%8C%96/RVtools%E4%BD%BF%E7%94%A8/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    虚拟化
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../../%E8%AE%A4%E8%AF%81%E7%9B%B8%E5%85%B3/credly%E6%9F%A5%E7%9C%8B%E5%8B%8B%E7%AB%A0/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    认证相关
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="十二django框架基础">十二，Django框架基础<a class="headerlink" href="#十二django框架基础" title="Permanent link">&para;</a></h1>
<h2 id="1-命令行操作">1 命令行操作<a class="headerlink" href="#1-命令行操作" title="Permanent link">&para;</a></h2>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-0-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-0-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-0-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-0-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-0-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-0-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-0-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-0-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-0-10">10</a></span>
<span class="normal"><a href="#__codelineno-0-11">11</a></span>
<span class="normal"><a href="#__codelineno-0-12">12</a></span>
<span class="normal"><a href="#__codelineno-0-13">13</a></span>
<span class="normal"><a href="#__codelineno-0-14">14</a></span>
<span class="normal"><a href="#__codelineno-0-15">15</a></span>
<span class="normal"><a href="#__codelineno-0-16">16</a></span>
<span class="normal"><a href="#__codelineno-0-17">17</a></span>
<span class="normal"><a href="#__codelineno-0-18">18</a></span>
<span class="normal"><a href="#__codelineno-0-19">19</a></span>
<span class="normal"><a href="#__codelineno-0-20">20</a></span>
<span class="normal"><a href="#__codelineno-0-21">21</a></span>
<span class="normal"><a href="#__codelineno-0-22">22</a></span>
<span class="normal"><a href="#__codelineno-0-23">23</a></span>
<span class="normal"><a href="#__codelineno-0-24">24</a></span>
<span class="normal"><a href="#__codelineno-0-25">25</a></span>
<span class="normal"><a href="#__codelineno-0-26">26</a></span>
<span class="normal"><a href="#__codelineno-0-27">27</a></span>
<span class="normal"><a href="#__codelineno-0-28">28</a></span>
<span class="normal"><a href="#__codelineno-0-29">29</a></span>
<span class="normal"><a href="#__codelineno-0-30">30</a></span>
<span class="normal"><a href="#__codelineno-0-31">31</a></span>
<span class="normal"><a href="#__codelineno-0-32">32</a></span>
<span class="normal"><a href="#__codelineno-0-33">33</a></span>
<span class="normal"><a href="#__codelineno-0-34">34</a></span>
<span class="normal"><a href="#__codelineno-0-35">35</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="c1">#  创建django项目</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="n">django</span><span class="o">-</span><span class="n">admin</span> <span class="n">startproject</span> <span class="n">aini</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="c1"># 启动项目</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="n">cd</span> <span class="o">/</span><span class="n">mysite</span>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="n">python3</span> <span class="n">manage</span><span class="o">.</span><span class="n">py</span> <span class="n">runserver</span>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a><span class="c1">## 创建应用</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a><span class="sd">Next, start your first app by running python manage.py startapp [app_label].</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a>    <span class="n">python</span> <span class="n">manage</span><span class="o">.</span><span class="n">py</span> <span class="n">startapp</span> <span class="n">app01</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a>    <span class="c1">## 应用名应该做到见名知意</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a>      <span class="n">user</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a>      <span class="n">order</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a>      <span class="n">web</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a>      <span class="o">...</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a>      <span class="c1">## 但是我们教学统一就用app01/02/03/04</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a>        <span class="c1">#有很多文件</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a><span class="c1"># pycharm操作</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a>    <span class="c1"># 1 new project 选择左侧第二个django即可</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a>  <span class="c1"># 2 启动</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a>          <span class="mf">1.</span><span class="n">还是用命令行启动</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a>        <span class="mf">2.</span><span class="n">点击绿色小箭头即可</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a>  <span class="c1"># 3 创建应用</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a>          <span class="mf">1.</span><span class="n">pycharm提供的终端直接输入完整命令</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a>        <span class="mf">2.</span><span class="n">pycharm</span> 
<a id="__codelineno-0-32" name="__codelineno-0-32"></a>              <span class="n">tools</span> 
<a id="__codelineno-0-33" name="__codelineno-0-33"></a>                <span class="n">run</span> <span class="n">manage</span><span class="o">.</span><span class="n">py</span> <span class="n">task提示</span><span class="p">(</span><span class="n">前期不要用</span> <span class="n">给我背完整命令</span><span class="p">)</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a> <span class="c1"># 4 修改端口号以及创建server    </span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a>        <span class="n">edit</span> <span class="n">confi</span><span class="o">....</span>
</code></pre></div></td></tr></table></div>
<h2 id="2-主要文件介绍">2 主要文件介绍<a class="headerlink" href="#2-主要文件介绍" title="Permanent link">&para;</a></h2>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-1-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-1-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-1-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-1-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-1-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-1-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-1-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-1-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-1-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-1-10">10</a></span>
<span class="normal"><a href="#__codelineno-1-11">11</a></span>
<span class="normal"><a href="#__codelineno-1-12">12</a></span>
<span class="normal"><a href="#__codelineno-1-13">13</a></span>
<span class="normal"><a href="#__codelineno-1-14">14</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1"></a><span class="o">-</span><span class="n">mysite项目文件夹</span>
<a id="__codelineno-1-2" name="__codelineno-1-2"></a>    <span class="o">--</span><span class="n">mysite文件夹</span>
<a id="__codelineno-1-3" name="__codelineno-1-3"></a>      <span class="o">---</span><span class="n">settings</span><span class="o">.</span><span class="n">py</span>       <span class="c1">## 配置文件</span>
<a id="__codelineno-1-4" name="__codelineno-1-4"></a>    <span class="o">---</span><span class="n">urls</span><span class="o">.</span><span class="n">py</span>          <span class="c1">## 路由与视图函数对应关系(路由层)</span>
<a id="__codelineno-1-5" name="__codelineno-1-5"></a>    <span class="o">---</span><span class="n">wsgi</span><span class="o">.</span><span class="n">py</span>          <span class="c1">## wsgiref模块(不考虑)</span>
<a id="__codelineno-1-6" name="__codelineno-1-6"></a>  <span class="o">--</span><span class="n">manage</span><span class="o">.</span><span class="n">py</span>               <span class="c1">## django的入口文件</span>
<a id="__codelineno-1-7" name="__codelineno-1-7"></a>  <span class="o">--</span><span class="n">db</span><span class="o">.</span><span class="n">sqlite3</span>          <span class="c1">## django自带的sqlite3数据库(小型数据库 功能不是很多还有bug)</span>
<a id="__codelineno-1-8" name="__codelineno-1-8"></a>  <span class="o">--</span><span class="n">app01文件夹</span>
<a id="__codelineno-1-9" name="__codelineno-1-9"></a>      <span class="o">---</span><span class="n">admin</span><span class="o">.</span><span class="n">py</span>           <span class="c1">## django后台管理</span>
<a id="__codelineno-1-10" name="__codelineno-1-10"></a>    <span class="o">---</span><span class="n">apps</span><span class="o">.</span><span class="n">py</span>          <span class="c1">## 注册使用</span>
<a id="__codelineno-1-11" name="__codelineno-1-11"></a>    <span class="o">---</span><span class="n">migrations文件夹</span>        <span class="c1">## 数据库迁移记录</span>
<a id="__codelineno-1-12" name="__codelineno-1-12"></a>    <span class="o">---</span><span class="n">models</span><span class="o">.</span><span class="n">py</span>        <span class="c1">## 数据库相关的 模型类(orm)</span>
<a id="__codelineno-1-13" name="__codelineno-1-13"></a>      <span class="o">---</span><span class="n">tests</span><span class="o">.</span><span class="n">py</span>           <span class="c1">## 测试文件</span>
<a id="__codelineno-1-14" name="__codelineno-1-14"></a>    <span class="o">---</span><span class="n">views</span><span class="o">.</span><span class="n">py</span>         <span class="c1">## 视图函数(视图层)</span>
</code></pre></div></td></tr></table></div>
<h2 id="3-应用">3 应用<a class="headerlink" href="#3-应用" title="Permanent link">&para;</a></h2>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Text Only</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-2-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-2-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-2-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-2-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-2-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-2-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-2-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-2-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-2-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-2-10">10</a></span>
<span class="normal"><a href="#__codelineno-2-11">11</a></span>
<span class="normal"><a href="#__codelineno-2-12">12</a></span>
<span class="normal"><a href="#__codelineno-2-13">13</a></span>
<span class="normal"><a href="#__codelineno-2-14">14</a></span>
<span class="normal"><a href="#__codelineno-2-15">15</a></span>
<span class="normal"><a href="#__codelineno-2-16">16</a></span>
<span class="normal"><a href="#__codelineno-2-17">17</a></span>
<span class="normal"><a href="#__codelineno-2-18">18</a></span>
<span class="normal"><a href="#__codelineno-2-19">19</a></span>
<span class="normal"><a href="#__codelineno-2-20">20</a></span>
<span class="normal"><a href="#__codelineno-2-21">21</a></span>
<span class="normal"><a href="#__codelineno-2-22">22</a></span>
<span class="normal"><a href="#__codelineno-2-23">23</a></span>
<span class="normal"><a href="#__codelineno-2-24">24</a></span>
<span class="normal"><a href="#__codelineno-2-25">25</a></span>
<span class="normal"><a href="#__codelineno-2-26">26</a></span>
<span class="normal"><a href="#__codelineno-2-27">27</a></span>
<span class="normal"><a href="#__codelineno-2-28">28</a></span>
<span class="normal"><a href="#__codelineno-2-29">29</a></span>
<span class="normal"><a href="#__codelineno-2-30">30</a></span>
<span class="normal"><a href="#__codelineno-2-31">31</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1"></a>&quot;&quot;&quot;
<a id="__codelineno-2-2" name="__codelineno-2-2"></a>django是一款专门用来开发app的web框架
<a id="__codelineno-2-3" name="__codelineno-2-3"></a>
<a id="__codelineno-2-4" name="__codelineno-2-4"></a>django框架就类似于是一所大学(空壳子)
<a id="__codelineno-2-5" name="__codelineno-2-5"></a>app就类似于大学里面各个学院(具体功能的app)
<a id="__codelineno-2-6" name="__codelineno-2-6"></a>    比如开发淘宝
<a id="__codelineno-2-7" name="__codelineno-2-7"></a>        订单相关
<a id="__codelineno-2-8" name="__codelineno-2-8"></a>        用户相关
<a id="__codelineno-2-9" name="__codelineno-2-9"></a>        投诉相关
<a id="__codelineno-2-10" name="__codelineno-2-10"></a>        创建不同的app对应不同的功能
<a id="__codelineno-2-11" name="__codelineno-2-11"></a>
<a id="__codelineno-2-12" name="__codelineno-2-12"></a>    选课系统
<a id="__codelineno-2-13" name="__codelineno-2-13"></a>        学生功能
<a id="__codelineno-2-14" name="__codelineno-2-14"></a>        老师功能
<a id="__codelineno-2-15" name="__codelineno-2-15"></a>
<a id="__codelineno-2-16" name="__codelineno-2-16"></a>一个app就是一个独立的功能模块
<a id="__codelineno-2-17" name="__codelineno-2-17"></a>&quot;&quot;&quot;
<a id="__codelineno-2-18" name="__codelineno-2-18"></a>## ***********************创建的应用一定要去配置文件中注册**********************
<a id="__codelineno-2-19" name="__codelineno-2-19"></a>INSTALLED_APPS = [
<a id="__codelineno-2-20" name="__codelineno-2-20"></a>    &#39;django.contrib.admin&#39;,
<a id="__codelineno-2-21" name="__codelineno-2-21"></a>    &#39;django.contrib.auth&#39;,
<a id="__codelineno-2-22" name="__codelineno-2-22"></a>    &#39;django.contrib.contenttypes&#39;,
<a id="__codelineno-2-23" name="__codelineno-2-23"></a>    &#39;django.contrib.sessions&#39;,
<a id="__codelineno-2-24" name="__codelineno-2-24"></a>    &#39;django.contrib.messages&#39;,
<a id="__codelineno-2-25" name="__codelineno-2-25"></a>    &#39;django.contrib.staticfiles&#39;,
<a id="__codelineno-2-26" name="__codelineno-2-26"></a>    &#39;app01.apps.App01Config&#39;,  # 全写
<a id="__codelineno-2-27" name="__codelineno-2-27"></a>      &#39;app01&#39;,           # 简写
<a id="__codelineno-2-28" name="__codelineno-2-28"></a>]
<a id="__codelineno-2-29" name="__codelineno-2-29"></a># 创建出来的的应用第一步先去配置文件中注册 其他的先不要给我干
<a id="__codelineno-2-30" name="__codelineno-2-30"></a>## ps:你在用pycharm创建项目的时候 pycharm可以帮你创建一个app并且自动注册
<a id="__codelineno-2-31" name="__codelineno-2-31"></a>***********************************************************************
</code></pre></div></td></tr></table></div>
<h2 id="4-命令行与pycharm创建的区别">4 命令行与pycharm创建的区别<a class="headerlink" href="#4-命令行与pycharm创建的区别" title="Permanent link">&para;</a></h2>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-3-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-3-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-3-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-3-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-3-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-3-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-3-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-3-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-3-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-3-10">10</a></span>
<span class="normal"><a href="#__codelineno-3-11">11</a></span>
<span class="normal"><a href="#__codelineno-3-12">12</a></span>
<span class="normal"><a href="#__codelineno-3-13">13</a></span>
<span class="normal"><a href="#__codelineno-3-14">14</a></span>
<span class="normal"><a href="#__codelineno-3-15">15</a></span>
<span class="normal"><a href="#__codelineno-3-16">16</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1"></a><span class="c1"># 1 命令行创建不会自动有templatew文件夹 需要你自己手动创建而pycharm会自动帮你创建并且还会自动在配置文件中配置对应的路径</span>
<a id="__codelineno-3-2" name="__codelineno-3-2"></a><span class="c1"># pycharm创建</span>
<a id="__codelineno-3-3" name="__codelineno-3-3"></a><span class="n">TEMPLATES</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-3-4" name="__codelineno-3-4"></a>    <span class="p">{</span>
<a id="__codelineno-3-5" name="__codelineno-3-5"></a>        <span class="s1">&#39;BACKEND&#39;</span><span class="p">:</span> <span class="s1">&#39;django.template.backends.django.DjangoTemplates&#39;</span><span class="p">,</span>
<a id="__codelineno-3-6" name="__codelineno-3-6"></a>        <span class="s1">&#39;DIRS&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">BASE_DIR</span><span class="p">,</span> <span class="s1">&#39;templates&#39;</span><span class="p">)]</span>
<a id="__codelineno-3-7" name="__codelineno-3-7"></a><span class="p">]</span>
<a id="__codelineno-3-8" name="__codelineno-3-8"></a><span class="c1"># 命令行创建</span>
<a id="__codelineno-3-9" name="__codelineno-3-9"></a><span class="n">TEMPLATES</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-3-10" name="__codelineno-3-10"></a>    <span class="p">{</span>
<a id="__codelineno-3-11" name="__codelineno-3-11"></a>        <span class="s1">&#39;BACKEND&#39;</span><span class="p">:</span> <span class="s1">&#39;django.template.backends.django.DjangoTemplates&#39;</span><span class="p">,</span>
<a id="__codelineno-3-12" name="__codelineno-3-12"></a>        <span class="s1">&#39;DIRS&#39;</span><span class="p">:</span> <span class="p">[],</span>
<a id="__codelineno-3-13" name="__codelineno-3-13"></a><span class="p">]</span>
<a id="__codelineno-3-14" name="__codelineno-3-14"></a><span class="s2">&quot;&quot;&quot;</span>
<a id="__codelineno-3-15" name="__codelineno-3-15"></a><span class="s2">也就意味着你在用命令创建django项目的时候不单单需要创建templates文件夹还需要去配置文件中配置路径</span>
<a id="__codelineno-3-16" name="__codelineno-3-16"></a><span class="s2">&#39;DIRS&#39;: [os.path.join(BASE_DIR, &#39;templates&#39;)]</span>
</code></pre></div></td></tr></table></div>
<h2 id="5-django小白必会三板斧">5 django小白必会三板斧<a class="headerlink" href="#5-django小白必会三板斧" title="Permanent link">&para;</a></h2>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-4-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-4-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-4-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-4-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-4-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-4-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-4-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-4-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-4-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-4-10">10</a></span>
<span class="normal"><a href="#__codelineno-4-11">11</a></span>
<span class="normal"><a href="#__codelineno-4-12">12</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-4-2" name="__codelineno-4-2"></a><span class="sd">HttpResponse</span>
<a id="__codelineno-4-3" name="__codelineno-4-3"></a><span class="sd">    返回字符串类型的数据</span>
<a id="__codelineno-4-4" name="__codelineno-4-4"></a>
<a id="__codelineno-4-5" name="__codelineno-4-5"></a><span class="sd">render</span>
<a id="__codelineno-4-6" name="__codelineno-4-6"></a><span class="sd">    返回html文件的</span>
<a id="__codelineno-4-7" name="__codelineno-4-7"></a>
<a id="__codelineno-4-8" name="__codelineno-4-8"></a><span class="sd">redirect</span>
<a id="__codelineno-4-9" name="__codelineno-4-9"></a><span class="sd">    重定向</span>
<a id="__codelineno-4-10" name="__codelineno-4-10"></a><span class="sd">      return redirect(&#39;https://www.mzitu.com/&#39;)</span>
<a id="__codelineno-4-11" name="__codelineno-4-11"></a><span class="sd">    return redirect(&#39;/home/&#39;)</span>
<a id="__codelineno-4-12" name="__codelineno-4-12"></a><span class="sd">&quot;&quot;&quot;</span> 
</code></pre></div></td></tr></table></div>
<h2 id="6-静态文件配置">6 静态文件配置<a class="headerlink" href="#6-静态文件配置" title="Permanent link">&para;</a></h2>
<h3 id="61-static文件作用">6.1 static文件作用<a class="headerlink" href="#61-static文件作用" title="Permanent link">&para;</a></h3>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-5-1">1</a></span>
<span class="normal"><a href="#__codelineno-5-2">2</a></span>
<span class="normal"><a href="#__codelineno-5-3">3</a></span>
<span class="normal"><a href="#__codelineno-5-4">4</a></span>
<span class="normal"><a href="#__codelineno-5-5">5</a></span>
<span class="normal"><a href="#__codelineno-5-6">6</a></span>
<span class="normal"><a href="#__codelineno-5-7">7</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1"></a><span class="c1">## 前段写好了的，能够直接调用使用的都称之为静态文件</span>
<a id="__codelineno-5-2" name="__codelineno-5-2"></a>    <span class="c1">## 网站写好的js文件</span>
<a id="__codelineno-5-3" name="__codelineno-5-3"></a>    <span class="c1">## 写好的css文件</span>
<a id="__codelineno-5-4" name="__codelineno-5-4"></a>    <span class="c1">## 网站用到的图片文件</span>
<a id="__codelineno-5-5" name="__codelineno-5-5"></a>    <span class="c1">## 第三方插件等等</span>
<a id="__codelineno-5-6" name="__codelineno-5-6"></a>
<a id="__codelineno-5-7" name="__codelineno-5-7"></a><span class="c1">## 需要手动创建static文件</span>
</code></pre></div></td></tr></table></div>
<h3 id="62-static文件配置">6.2 static文件配置<a class="headerlink" href="#62-static文件配置" title="Permanent link">&para;</a></h3>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-6-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-6-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-6-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-6-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-6-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-6-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-6-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-6-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-6-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-6-10">10</a></span>
<span class="normal"><a href="#__codelineno-6-11">11</a></span>
<span class="normal"><a href="#__codelineno-6-12">12</a></span>
<span class="normal"><a href="#__codelineno-6-13">13</a></span>
<span class="normal"><a href="#__codelineno-6-14">14</a></span>
<span class="normal"><a href="#__codelineno-6-15">15</a></span>
<span class="normal"><a href="#__codelineno-6-16">16</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1"></a><span class="n">STATIC_URL</span> <span class="o">=</span> <span class="s1">&#39;/ooo/&#39;</span>  <span class="c1"># 类似于访问静态文件的令牌</span>
<a id="__codelineno-6-2" name="__codelineno-6-2"></a><span class="sd">&quot;&quot;&quot;如果你想要访问静态文件 你就必须以static开头&quot;&quot;&quot;</span>
<a id="__codelineno-6-3" name="__codelineno-6-3"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-6-4" name="__codelineno-6-4"></a><span class="sd">/static/bootstrap-3.3.7-dist/js/bootstrap.min.js</span>
<a id="__codelineno-6-5" name="__codelineno-6-5"></a>
<a id="__codelineno-6-6" name="__codelineno-6-6"></a><span class="sd">/static/令牌</span>
<a id="__codelineno-6-7" name="__codelineno-6-7"></a><span class="sd">取列表里面从上往下依次查找</span>
<a id="__codelineno-6-8" name="__codelineno-6-8"></a><span class="sd">    bootstrap-3.3.7-dist/js/bootstrap.min.js</span>
<a id="__codelineno-6-9" name="__codelineno-6-9"></a><span class="sd">    都没有才会报错</span>
<a id="__codelineno-6-10" name="__codelineno-6-10"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-6-11" name="__codelineno-6-11"></a><span class="c1"># 静态文件配置（多个静态文件）</span>
<a id="__codelineno-6-12" name="__codelineno-6-12"></a><span class="n">STATICFILES_DIRS</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-6-13" name="__codelineno-6-13"></a>    <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">BASE_DIR</span><span class="p">,</span><span class="s1">&#39;static&#39;</span><span class="p">),</span>
<a id="__codelineno-6-14" name="__codelineno-6-14"></a>    <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">BASE_DIR</span><span class="p">,</span><span class="s1">&#39;static1&#39;</span><span class="p">),</span>
<a id="__codelineno-6-15" name="__codelineno-6-15"></a>    <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">BASE_DIR</span><span class="p">,</span><span class="s1">&#39;static2&#39;</span><span class="p">),</span>
<a id="__codelineno-6-16" name="__codelineno-6-16"></a><span class="p">]</span>
</code></pre></div></td></tr></table></div>
<h3 id="63-静态文件动态解析">6.3 静态文件动态解析<a class="headerlink" href="#63-静态文件动态解析" title="Permanent link">&para;</a></h3>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-7-1">1</a></span>
<span class="normal"><a href="#__codelineno-7-2">2</a></span>
<span class="normal"><a href="#__codelineno-7-3">3</a></span>
<span class="normal"><a href="#__codelineno-7-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1"></a><span class="c1"># 静态文件动态解析</span>
<a id="__codelineno-7-2" name="__codelineno-7-2"></a>    <span class="p">{</span><span class="o">%</span> <span class="n">load</span> <span class="n">static</span> <span class="o">%</span><span class="p">}</span>
<a id="__codelineno-7-3" name="__codelineno-7-3"></a>    <span class="o">&lt;</span><span class="n">link</span> <span class="n">rel</span><span class="o">=</span><span class="s2">&quot;stylesheet&quot;</span> <span class="n">href</span><span class="o">=</span><span class="s2">&quot;{</span><span class="si">% s</span><span class="s2">tatic &#39;bootstrap-3.3.7-dist/css/bootstrap.min.css&#39; %}&quot;</span><span class="o">&gt;</span>
<a id="__codelineno-7-4" name="__codelineno-7-4"></a>    <span class="o">&lt;</span><span class="n">script</span> <span class="n">src</span><span class="o">=</span><span class="s2">&quot;{</span><span class="si">% s</span><span class="s2">tatic &#39;bootstrap-3.3.7-dist/js/bootstrap.min.js&#39; %}&quot;</span><span class="o">&gt;&lt;/</span><span class="n">script</span><span class="o">&gt;</span>
</code></pre></div></td></tr></table></div>
<h3 id="64-form表单提交数据及action参数">6.4 form表单提交数据，及action参数<a class="headerlink" href="#64-form表单提交数据及action参数" title="Permanent link">&para;</a></h3>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-8-1">1</a></span>
<span class="normal"><a href="#__codelineno-8-2">2</a></span>
<span class="normal"><a href="#__codelineno-8-3">3</a></span>
<span class="normal"><a href="#__codelineno-8-4">4</a></span>
<span class="normal"><a href="#__codelineno-8-5">5</a></span>
<span class="normal"><a href="#__codelineno-8-6">6</a></span>
<span class="normal"><a href="#__codelineno-8-7">7</a></span>
<span class="normal"><a href="#__codelineno-8-8">8</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1"></a><span class="c1"># form表单默认是get请求数据</span>
<a id="__codelineno-8-2" name="__codelineno-8-2"></a>    <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">127.0.0.1</span><span class="p">:</span><span class="mi">8000</span><span class="o">/</span><span class="n">login</span><span class="o">/</span><span class="err">?</span><span class="n">username</span><span class="o">=</span><span class="n">jason</span><span class="o">&amp;</span><span class="n">password</span><span class="o">=</span><span class="mi">123</span>
<a id="__codelineno-8-3" name="__codelineno-8-3"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-8-4" name="__codelineno-8-4"></a><span class="sd">form表单action参数</span>
<a id="__codelineno-8-5" name="__codelineno-8-5"></a><span class="sd">    1.不写 默认朝当前所在的url提交数据</span>
<a id="__codelineno-8-6" name="__codelineno-8-6"></a><span class="sd">    2.全写 指名道姓</span>
<a id="__codelineno-8-7" name="__codelineno-8-7"></a><span class="sd">    3.只写后缀 /login/</span>
<a id="__codelineno-8-8" name="__codelineno-8-8"></a><span class="sd">&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
<h3 id="65-需要配置文件组中注释掉一行代码">6.5 需要配置文件组中注释掉一行代码<a class="headerlink" href="#65-需要配置文件组中注释掉一行代码" title="Permanent link">&para;</a></h3>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-9-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-9-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-9-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-9-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-9-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-9-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-9-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-9-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-9-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-9-10">10</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1"></a><span class="c1"># 在前期我们使用django提交post请求的时候 需要取配置文件中注释掉一行代码</span>
<a id="__codelineno-9-2" name="__codelineno-9-2"></a><span class="n">MIDDLEWARE</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-9-3" name="__codelineno-9-3"></a>    <span class="s1">&#39;django.middleware.security.SecurityMiddleware&#39;</span><span class="p">,</span>
<a id="__codelineno-9-4" name="__codelineno-9-4"></a>    <span class="s1">&#39;django.contrib.sessions.middleware.SessionMiddleware&#39;</span><span class="p">,</span>
<a id="__codelineno-9-5" name="__codelineno-9-5"></a>    <span class="s1">&#39;django.middleware.common.CommonMiddleware&#39;</span><span class="p">,</span>
<a id="__codelineno-9-6" name="__codelineno-9-6"></a>    <span class="c1"># &#39;django.middleware.csrf.CsrfViewMiddleware&#39;,</span>
<a id="__codelineno-9-7" name="__codelineno-9-7"></a>    <span class="s1">&#39;django.contrib.auth.middleware.AuthenticationMiddleware&#39;</span><span class="p">,</span>
<a id="__codelineno-9-8" name="__codelineno-9-8"></a>    <span class="s1">&#39;django.contrib.messages.middleware.MessageMiddleware&#39;</span><span class="p">,</span>
<a id="__codelineno-9-9" name="__codelineno-9-9"></a>    <span class="s1">&#39;django.middleware.clickjacking.XFrameOptionsMiddleware&#39;</span><span class="p">,</span>
<a id="__codelineno-9-10" name="__codelineno-9-10"></a><span class="p">]</span>
</code></pre></div></td></tr></table></div>
<h2 id="7-request对象方法初识">7 request对象方法初识<a class="headerlink" href="#7-request对象方法初识" title="Permanent link">&para;</a></h2>
<h3 id="71-方法">7.1 方法<a class="headerlink" href="#71-方法" title="Permanent link">&para;</a></h3>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-10-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-10-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-10-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-10-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-10-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-10-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-10-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-10-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-10-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-10-10">10</a></span>
<span class="normal"><a href="#__codelineno-10-11">11</a></span>
<span class="normal"><a href="#__codelineno-10-12">12</a></span>
<span class="normal"><a href="#__codelineno-10-13">13</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1"></a><span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="c1"># 返回请求方式 并且是全大写的字符串形式  &lt;class &#39;str&#39;&gt;</span>
<a id="__codelineno-10-2" name="__codelineno-10-2"></a><span class="n">request</span><span class="o">.</span><span class="n">POST</span>  <span class="c1"># 获取用户post请求提交的普通数据不包含文件</span>
<a id="__codelineno-10-3" name="__codelineno-10-3"></a>
<a id="__codelineno-10-4" name="__codelineno-10-4"></a><span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>  <span class="c1"># 只获取列表最后一个元素</span>
<a id="__codelineno-10-5" name="__codelineno-10-5"></a><span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="o">.</span><span class="n">getlist</span><span class="p">()</span>  <span class="c1"># 直接将列表取出</span>
<a id="__codelineno-10-6" name="__codelineno-10-6"></a>
<a id="__codelineno-10-7" name="__codelineno-10-7"></a><span class="n">request</span><span class="o">.</span><span class="n">GET</span>  <span class="c1"># 获取用户提交的get请求数据</span>
<a id="__codelineno-10-8" name="__codelineno-10-8"></a><span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>  <span class="c1"># 只获取列表最后一个元素</span>
<a id="__codelineno-10-9" name="__codelineno-10-9"></a><span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">getlist</span><span class="p">()</span>  <span class="c1"># 直接将列表取出</span>
<a id="__codelineno-10-10" name="__codelineno-10-10"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-10-11" name="__codelineno-10-11"></a><span class="sd">get请求携带的数据是有大小限制的 大概好像只有4KB左右</span>
<a id="__codelineno-10-12" name="__codelineno-10-12"></a><span class="sd">而post请求则没有限制</span>
<a id="__codelineno-10-13" name="__codelineno-10-13"></a><span class="sd">&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
<h3 id="72-案例">7.2 案例<a class="headerlink" href="#72-案例" title="Permanent link">&para;</a></h3>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-11-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-11-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-11-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-11-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-11-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-11-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-11-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-11-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-11-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-11-10">10</a></span>
<span class="normal"><a href="#__codelineno-11-11">11</a></span>
<span class="normal"><a href="#__codelineno-11-12">12</a></span>
<span class="normal"><a href="#__codelineno-11-13">13</a></span>
<span class="normal"><a href="#__codelineno-11-14">14</a></span>
<span class="normal"><a href="#__codelineno-11-15">15</a></span>
<span class="normal"><a href="#__codelineno-11-16">16</a></span>
<span class="normal"><a href="#__codelineno-11-17">17</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">login</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
<a id="__codelineno-11-2" name="__codelineno-11-2"></a>    <span class="c1"># 返回一个登陆界面</span>
<a id="__codelineno-11-3" name="__codelineno-11-3"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-11-4" name="__codelineno-11-4"></a><span class="sd">    get请求和post请求应该有不同的处理机制</span>
<a id="__codelineno-11-5" name="__codelineno-11-5"></a><span class="sd">    :param request: 请求相关的数据对象 里面有很多简易的方法</span>
<a id="__codelineno-11-6" name="__codelineno-11-6"></a><span class="sd">    :return:</span>
<a id="__codelineno-11-7" name="__codelineno-11-7"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-11-8" name="__codelineno-11-8"></a>    <span class="c1"># print(type(request.method))  # 返回请求方式 并且是全大写的字符串形式  &lt;class &#39;str&#39;&gt;</span>
<a id="__codelineno-11-9" name="__codelineno-11-9"></a>    <span class="c1"># if request.method == &#39;GET&#39;:</span>
<a id="__codelineno-11-10" name="__codelineno-11-10"></a>    <span class="c1">#     print(&#39;来了 老弟&#39;)</span>
<a id="__codelineno-11-11" name="__codelineno-11-11"></a>    <span class="c1">#     return render(request,&#39;login.html&#39;)</span>
<a id="__codelineno-11-12" name="__codelineno-11-12"></a>    <span class="c1"># elif request.method == &#39;POST&#39;:</span>
<a id="__codelineno-11-13" name="__codelineno-11-13"></a>    <span class="c1">#     return HttpResponse(&quot;收到了 宝贝&quot;)</span>
<a id="__codelineno-11-14" name="__codelineno-11-14"></a>
<a id="__codelineno-11-15" name="__codelineno-11-15"></a>    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;POST&#39;</span><span class="p">:</span>
<a id="__codelineno-11-16" name="__codelineno-11-16"></a>        <span class="k">return</span> <span class="n">HttpResponse</span><span class="p">(</span><span class="s2">&quot;收到了 宝贝&quot;</span><span class="p">)</span>
<a id="__codelineno-11-17" name="__codelineno-11-17"></a>    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;login.html&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<h3 id="73-requestpost结果">7.3 request.POST结果<a class="headerlink" href="#73-requestpost结果" title="Permanent link">&para;</a></h3>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-12-1">1</a></span>
<span class="normal"><a href="#__codelineno-12-2">2</a></span>
<span class="normal"><a href="#__codelineno-12-3">3</a></span>
<span class="normal"><a href="#__codelineno-12-4">4</a></span>
<span class="normal"><a href="#__codelineno-12-5">5</a></span>
<span class="normal"><a href="#__codelineno-12-6">6</a></span>
<span class="normal"><a href="#__codelineno-12-7">7</a></span>
<span class="normal"><a href="#__codelineno-12-8">8</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1"></a><span class="n">request</span><span class="o">.</span><span class="n">POST</span> <span class="c1">## 结果是一个字典   </span>
<a id="__codelineno-12-2" name="__codelineno-12-2"></a><span class="c1">## &lt;QueryDict: {&#39;username&#39;: [&#39;aini&#39;], &#39;password&#39;: [&#39;123&#39;]}</span>
<a id="__codelineno-12-3" name="__codelineno-12-3"></a><span class="c1">## 值是列表</span>
<a id="__codelineno-12-4" name="__codelineno-12-4"></a><span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;password&#39;</span><span class="p">)</span>   <span class="c1"># &#39;password&#39;</span>
<a id="__codelineno-12-5" name="__codelineno-12-5"></a><span class="c1">## 取password这个键的值列表中的最后一个值</span>
<a id="__codelineno-12-6" name="__codelineno-12-6"></a>
<a id="__codelineno-12-7" name="__codelineno-12-7"></a><span class="c1">## 如何取值列表呢</span>
<a id="__codelineno-12-8" name="__codelineno-12-8"></a><span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="o">.</span><span class="n">getlist</span><span class="p">(</span><span class="s1">&#39;password&#39;</span><span class="p">)</span>  <span class="c1">## [&#39;password&#39;]</span>
</code></pre></div></td></tr></table></div>
<h2 id="8-django链接数据库mysql">8 django链接数据库(MySQL)<a class="headerlink" href="#8-django链接数据库mysql" title="Permanent link">&para;</a></h2>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-13-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-13-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-13-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-13-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-13-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-13-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-13-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-13-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-13-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-13-10">10</a></span>
<span class="normal"><a href="#__codelineno-13-11">11</a></span>
<span class="normal"><a href="#__codelineno-13-12">12</a></span>
<span class="normal"><a href="#__codelineno-13-13">13</a></span>
<span class="normal"><a href="#__codelineno-13-14">14</a></span>
<span class="normal"><a href="#__codelineno-13-15">15</a></span>
<span class="normal"><a href="#__codelineno-13-16">16</a></span>
<span class="normal"><a href="#__codelineno-13-17">17</a></span>
<span class="normal"><a href="#__codelineno-13-18">18</a></span>
<span class="normal"><a href="#__codelineno-13-19">19</a></span>
<span class="normal"><a href="#__codelineno-13-20">20</a></span>
<span class="normal"><a href="#__codelineno-13-21">21</a></span>
<span class="normal"><a href="#__codelineno-13-22">22</a></span>
<span class="normal"><a href="#__codelineno-13-23">23</a></span>
<span class="normal"><a href="#__codelineno-13-24">24</a></span>
<span class="normal"><a href="#__codelineno-13-25">25</a></span>
<span class="normal"><a href="#__codelineno-13-26">26</a></span>
<span class="normal"><a href="#__codelineno-13-27">27</a></span>
<span class="normal"><a href="#__codelineno-13-28">28</a></span>
<span class="normal"><a href="#__codelineno-13-29">29</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1"></a><span class="c1"># 默认用的是sqkite3</span>
<a id="__codelineno-13-2" name="__codelineno-13-2"></a><span class="n">DATABASES</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-13-3" name="__codelineno-13-3"></a>    <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-13-4" name="__codelineno-13-4"></a>        <span class="s1">&#39;ENGINE&#39;</span><span class="p">:</span> <span class="s1">&#39;django.db.backends.sqlite3&#39;</span><span class="p">,</span>
<a id="__codelineno-13-5" name="__codelineno-13-5"></a>        <span class="s1">&#39;NAME&#39;</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">BASE_DIR</span><span class="p">,</span> <span class="s1">&#39;db.sqlite3&#39;</span><span class="p">),</span>
<a id="__codelineno-13-6" name="__codelineno-13-6"></a>    <span class="p">}</span>
<a id="__codelineno-13-7" name="__codelineno-13-7"></a><span class="p">}</span>
<a id="__codelineno-13-8" name="__codelineno-13-8"></a>
<a id="__codelineno-13-9" name="__codelineno-13-9"></a><span class="c1"># django链接MySQL</span>
<a id="__codelineno-13-10" name="__codelineno-13-10"></a>    <span class="mf">1.</span><span class="n">第一步配置文件中配置</span>
<a id="__codelineno-13-11" name="__codelineno-13-11"></a>      <span class="n">DATABASES</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-13-12" name="__codelineno-13-12"></a>    <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-13-13" name="__codelineno-13-13"></a>        <span class="s1">&#39;ENGINE&#39;</span><span class="p">:</span> <span class="s1">&#39;django.db.backends.mysql&#39;</span><span class="p">,</span>
<a id="__codelineno-13-14" name="__codelineno-13-14"></a>        <span class="s1">&#39;NAME&#39;</span><span class="p">:</span> <span class="s1">&#39;day60&#39;</span><span class="p">,</span>
<a id="__codelineno-13-15" name="__codelineno-13-15"></a>        <span class="s1">&#39;USER&#39;</span><span class="p">:</span><span class="s1">&#39;root&#39;</span><span class="p">,</span>
<a id="__codelineno-13-16" name="__codelineno-13-16"></a>        <span class="s1">&#39;PASSWORD&#39;</span><span class="p">:</span><span class="s1">&#39;admin123&#39;</span><span class="p">,</span>
<a id="__codelineno-13-17" name="__codelineno-13-17"></a>        <span class="s1">&#39;HOST&#39;</span><span class="p">:</span><span class="s1">&#39;127.0.0.1&#39;</span><span class="p">,</span>
<a id="__codelineno-13-18" name="__codelineno-13-18"></a>        <span class="s1">&#39;PORT&#39;</span><span class="p">:</span><span class="mi">3306</span><span class="p">,</span>
<a id="__codelineno-13-19" name="__codelineno-13-19"></a>        <span class="s1">&#39;CHARSET&#39;</span><span class="p">:</span><span class="s1">&#39;utf8&#39;</span>
<a id="__codelineno-13-20" name="__codelineno-13-20"></a>    <span class="p">}</span>
<a id="__codelineno-13-21" name="__codelineno-13-21"></a><span class="p">}</span>
<a id="__codelineno-13-22" name="__codelineno-13-22"></a>  <span class="mf">2.</span><span class="n">代码声明</span>    
<a id="__codelineno-13-23" name="__codelineno-13-23"></a>      <span class="c1">## django默认用的是mysqldb模块链接MySQL</span>
<a id="__codelineno-13-24" name="__codelineno-13-24"></a>    <span class="c1">## 但是该模块的兼容性不好 需要手动改为用pymysql链接</span>
<a id="__codelineno-13-25" name="__codelineno-13-25"></a>
<a id="__codelineno-13-26" name="__codelineno-13-26"></a>    <span class="c1">## 你需要告诉django不要用默认的mysqldb还是用pymysql</span>
<a id="__codelineno-13-27" name="__codelineno-13-27"></a>    <span class="c1"># 在项目名下的__init__或者任意的应用名下的__init__文件中书写以下代码都可以</span>
<a id="__codelineno-13-28" name="__codelineno-13-28"></a>    <span class="kn">import</span><span class="w"> </span><span class="nn">pymysql</span>
<a id="__codelineno-13-29" name="__codelineno-13-29"></a>    <span class="n">pymysql</span><span class="o">.</span><span class="n">install_as_MySQLdb</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
<h2 id="9-django-orm">9 Django ORM<a class="headerlink" href="#9-django-orm" title="Permanent link">&para;</a></h2>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-14-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-14-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-14-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-14-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-14-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-14-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-14-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-14-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-14-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-14-10">10</a></span>
<span class="normal"><a href="#__codelineno-14-11">11</a></span>
<span class="normal"><a href="#__codelineno-14-12">12</a></span>
<span class="normal"><a href="#__codelineno-14-13">13</a></span>
<span class="normal"><a href="#__codelineno-14-14">14</a></span>
<span class="normal"><a href="#__codelineno-14-15">15</a></span>
<span class="normal"><a href="#__codelineno-14-16">16</a></span>
<span class="normal"><a href="#__codelineno-14-17">17</a></span>
<span class="normal"><a href="#__codelineno-14-18">18</a></span>
<span class="normal"><a href="#__codelineno-14-19">19</a></span>
<span class="normal"><a href="#__codelineno-14-20">20</a></span>
<span class="normal"><a href="#__codelineno-14-21">21</a></span>
<span class="normal"><a href="#__codelineno-14-22">22</a></span>
<span class="normal"><a href="#__codelineno-14-23">23</a></span>
<span class="normal"><a href="#__codelineno-14-24">24</a></span>
<span class="normal"><a href="#__codelineno-14-25">25</a></span>
<span class="normal"><a href="#__codelineno-14-26">26</a></span>
<span class="normal"><a href="#__codelineno-14-27">27</a></span>
<span class="normal"><a href="#__codelineno-14-28">28</a></span>
<span class="normal"><a href="#__codelineno-14-29">29</a></span>
<span class="normal"><a href="#__codelineno-14-30">30</a></span>
<span class="normal"><a href="#__codelineno-14-31">31</a></span>
<span class="normal"><a href="#__codelineno-14-32">32</a></span>
<span class="normal"><a href="#__codelineno-14-33">33</a></span>
<span class="normal"><a href="#__codelineno-14-34">34</a></span>
<span class="normal"><a href="#__codelineno-14-35">35</a></span>
<span class="normal"><a href="#__codelineno-14-36">36</a></span>
<span class="normal"><a href="#__codelineno-14-37">37</a></span>
<span class="normal"><a href="#__codelineno-14-38">38</a></span>
<span class="normal"><a href="#__codelineno-14-39">39</a></span>
<span class="normal"><a href="#__codelineno-14-40">40</a></span>
<span class="normal"><a href="#__codelineno-14-41">41</a></span>
<span class="normal"><a href="#__codelineno-14-42">42</a></span>
<span class="normal"><a href="#__codelineno-14-43">43</a></span>
<span class="normal"><a href="#__codelineno-14-44">44</a></span>
<span class="normal"><a href="#__codelineno-14-45">45</a></span>
<span class="normal"><a href="#__codelineno-14-46">46</a></span>
<span class="normal"><a href="#__codelineno-14-47">47</a></span>
<span class="normal"><a href="#__codelineno-14-48">48</a></span>
<span class="normal"><a href="#__codelineno-14-49">49</a></span>
<span class="normal"><a href="#__codelineno-14-50">50</a></span>
<span class="normal"><a href="#__codelineno-14-51">51</a></span>
<span class="normal"><a href="#__codelineno-14-52">52</a></span>
<span class="normal"><a href="#__codelineno-14-53">53</a></span>
<span class="normal"><a href="#__codelineno-14-54">54</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-14-2" name="__codelineno-14-2"></a><span class="sd">ORM. 对象关系映射</span>
<a id="__codelineno-14-3" name="__codelineno-14-3"></a><span class="sd">作用:能够让一个不用sql语句的小白也能够通过python 面向对象的代码简单快捷的操作数据库</span>
<a id="__codelineno-14-4" name="__codelineno-14-4"></a><span class="sd">不足之处:封装程度太高 有时候sql语句的效率偏低 需要你自己写SQL语句</span>
<a id="__codelineno-14-5" name="__codelineno-14-5"></a>
<a id="__codelineno-14-6" name="__codelineno-14-6"></a><span class="sd">类                                           表</span>
<a id="__codelineno-14-7" name="__codelineno-14-7"></a>
<a id="__codelineno-14-8" name="__codelineno-14-8"></a><span class="sd">对象                                  记录</span>
<a id="__codelineno-14-9" name="__codelineno-14-9"></a>
<a id="__codelineno-14-10" name="__codelineno-14-10"></a><span class="sd">对象属性                            记录某个字段对应的值</span>
<a id="__codelineno-14-11" name="__codelineno-14-11"></a>
<a id="__codelineno-14-12" name="__codelineno-14-12"></a><span class="sd">应用下面的models.py文件</span>
<a id="__codelineno-14-13" name="__codelineno-14-13"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-14-14" name="__codelineno-14-14"></a>
<a id="__codelineno-14-15" name="__codelineno-14-15"></a><span class="c1"># 1 先去models.py中书写一个类</span>
<a id="__codelineno-14-16" name="__codelineno-14-16"></a>    <span class="k">class</span><span class="w"> </span><span class="nc">User</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
<a id="__codelineno-14-17" name="__codelineno-14-17"></a>    <span class="c1"># id int primary_key auto_increment</span>
<a id="__codelineno-14-18" name="__codelineno-14-18"></a>    <span class="nb">id</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">AutoField</span><span class="p">(</span><span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-14-19" name="__codelineno-14-19"></a>
<a id="__codelineno-14-20" name="__codelineno-14-20"></a>    <span class="c1"># username varchar(32)</span>
<a id="__codelineno-14-21" name="__codelineno-14-21"></a>    <span class="n">username</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>
<a id="__codelineno-14-22" name="__codelineno-14-22"></a>
<a id="__codelineno-14-23" name="__codelineno-14-23"></a>    <span class="c1"># password int</span>
<a id="__codelineno-14-24" name="__codelineno-14-24"></a>    <span class="n">password</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">IntegerField</span><span class="p">()</span>
<a id="__codelineno-14-25" name="__codelineno-14-25"></a>
<a id="__codelineno-14-26" name="__codelineno-14-26"></a><span class="o">*************************</span><span class="c1"># 2 数据库迁移命令*************************</span>
<a id="__codelineno-14-27" name="__codelineno-14-27"></a><span class="n">python3</span> <span class="n">manage</span><span class="o">.</span><span class="n">py</span> <span class="n">makemigrations</span> 
<a id="__codelineno-14-28" name="__codelineno-14-28"></a><span class="c1">##将操作记录记录到小本本上(migrations文件夹)</span>
<a id="__codelineno-14-29" name="__codelineno-14-29"></a>
<a id="__codelineno-14-30" name="__codelineno-14-30"></a><span class="n">python3</span> <span class="n">manage</span><span class="o">.</span><span class="n">py</span> <span class="n">migrate</span>  <span class="c1">## 将操作真正的同步到数据库中</span>
<a id="__codelineno-14-31" name="__codelineno-14-31"></a><span class="c1"># 只要你修改了models.py中跟数据库相关的代码 就必须重新执行上述的两条命令</span>
<a id="__codelineno-14-32" name="__codelineno-14-32"></a><span class="o">******************************************************************</span>
<a id="__codelineno-14-33" name="__codelineno-14-33"></a>
<a id="__codelineno-14-34" name="__codelineno-14-34"></a><span class="k">class</span><span class="w"> </span><span class="nc">User</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
<a id="__codelineno-14-35" name="__codelineno-14-35"></a>    <span class="c1"># id int primary_key auto_increment</span>
<a id="__codelineno-14-36" name="__codelineno-14-36"></a>    <span class="nb">id</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">AutoField</span><span class="p">(</span><span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">verbose_name</span><span class="o">=</span><span class="s1">&#39;主键&#39;</span><span class="p">)</span>
<a id="__codelineno-14-37" name="__codelineno-14-37"></a>    <span class="c1"># username varchar(32)</span>
<a id="__codelineno-14-38" name="__codelineno-14-38"></a>    <span class="n">username</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span><span class="n">verbose_name</span><span class="o">=</span><span class="s1">&#39;用户名&#39;</span><span class="p">)</span>
<a id="__codelineno-14-39" name="__codelineno-14-39"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-14-40" name="__codelineno-14-40"></a><span class="sd">    CharField必须要指定max_length参数 不指定会直接报错</span>
<a id="__codelineno-14-41" name="__codelineno-14-41"></a><span class="sd">    verbose_name该参数是所有字段都有的 就是用来对字段的解释</span>
<a id="__codelineno-14-42" name="__codelineno-14-42"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-14-43" name="__codelineno-14-43"></a>    <span class="c1"># password int</span>
<a id="__codelineno-14-44" name="__codelineno-14-44"></a>    <span class="n">password</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">IntegerField</span><span class="p">(</span><span class="n">verbose_name</span><span class="o">=</span><span class="s1">&#39;密码&#39;</span><span class="p">)</span>
<a id="__codelineno-14-45" name="__codelineno-14-45"></a>
<a id="__codelineno-14-46" name="__codelineno-14-46"></a>
<a id="__codelineno-14-47" name="__codelineno-14-47"></a><span class="k">class</span><span class="w"> </span><span class="nc">Author</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
<a id="__codelineno-14-48" name="__codelineno-14-48"></a>    <span class="c1"># 由于一张表中必须要有一个主键字段 并且一般情况下都叫id字段</span>
<a id="__codelineno-14-49" name="__codelineno-14-49"></a>    <span class="c1"># 所以orm当你不定义主键字段的时候 orm会自动帮你创建一个名为id主键字段</span>
<a id="__codelineno-14-50" name="__codelineno-14-50"></a>    <span class="c1"># 也就意味着 后续我们在创建模型表的时候如果主键字段名没有额外的叫法 那么主键字段可以省略不写</span>
<a id="__codelineno-14-51" name="__codelineno-14-51"></a>    <span class="c1"># username varchar(32)</span>
<a id="__codelineno-14-52" name="__codelineno-14-52"></a>    <span class="n">username</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>
<a id="__codelineno-14-53" name="__codelineno-14-53"></a>    <span class="c1"># password int</span>
<a id="__codelineno-14-54" name="__codelineno-14-54"></a>    <span class="n">password</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">IntegerField</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
<h3 id="91-字段的增删改查">9.1 字段的增删改查<a class="headerlink" href="#91-字段的增删改查" title="Permanent link">&para;</a></h3>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-15-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-15-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-15-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-15-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-15-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-15-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-15-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-15-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-15-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-15-10">10</a></span>
<span class="normal"><a href="#__codelineno-15-11">11</a></span>
<span class="normal"><a href="#__codelineno-15-12">12</a></span>
<span class="normal"><a href="#__codelineno-15-13">13</a></span>
<span class="normal"><a href="#__codelineno-15-14">14</a></span>
<span class="normal"><a href="#__codelineno-15-15">15</a></span>
<span class="normal"><a href="#__codelineno-15-16">16</a></span>
<span class="normal"><a href="#__codelineno-15-17">17</a></span>
<span class="normal"><a href="#__codelineno-15-18">18</a></span>
<span class="normal"><a href="#__codelineno-15-19">19</a></span>
<span class="normal"><a href="#__codelineno-15-20">20</a></span>
<span class="normal"><a href="#__codelineno-15-21">21</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1"></a><span class="c1"># 字段的增加</span>
<a id="__codelineno-15-2" name="__codelineno-15-2"></a>  <span class="mf">1.</span><span class="n">可以在终端内直接给出默认值</span>
<a id="__codelineno-15-3" name="__codelineno-15-3"></a>  <span class="mf">2.</span><span class="n">该字段可以为空</span>
<a id="__codelineno-15-4" name="__codelineno-15-4"></a>    <span class="n">info</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span><span class="n">verbose_name</span><span class="o">=</span><span class="s1">&#39;个人简介&#39;</span><span class="p">,</span><span class="n">null</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-15-5" name="__codelineno-15-5"></a>  <span class="mf">3.</span><span class="n">直接给字段设置默认值</span>
<a id="__codelineno-15-6" name="__codelineno-15-6"></a>    <span class="n">hobby</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span><span class="n">verbose_name</span><span class="o">=</span><span class="s1">&#39;兴趣爱好&#39;</span><span class="p">,</span><span class="n">default</span><span class="o">=</span><span class="s1">&#39;study&#39;</span><span class="p">)</span>
<a id="__codelineno-15-7" name="__codelineno-15-7"></a>
<a id="__codelineno-15-8" name="__codelineno-15-8"></a><span class="c1"># 字段的修改</span>
<a id="__codelineno-15-9" name="__codelineno-15-9"></a>    <span class="c1">## 直接修改代码然后执行数据库迁移的两条命令即可！</span>
<a id="__codelineno-15-10" name="__codelineno-15-10"></a>
<a id="__codelineno-15-11" name="__codelineno-15-11"></a><span class="c1"># 字段的删(不建议)</span>
<a id="__codelineno-15-12" name="__codelineno-15-12"></a>    <span class="c1">## 直接注释对应的字段然后执行数据库迁移的两条命令即可！</span>
<a id="__codelineno-15-13" name="__codelineno-15-13"></a>  <span class="c1">## 执行完毕之后字段对应的数据也都没有了</span>
<a id="__codelineno-15-14" name="__codelineno-15-14"></a>
<a id="__codelineno-15-15" name="__codelineno-15-15"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-15-16" name="__codelineno-15-16"></a><span class="sd">在操作models.py的时候一定要细心</span>
<a id="__codelineno-15-17" name="__codelineno-15-17"></a><span class="sd">    千万不要注释一些字段</span>
<a id="__codelineno-15-18" name="__codelineno-15-18"></a><span class="sd">    执行迁移命令之前最好先检查一下自己写的代码</span>
<a id="__codelineno-15-19" name="__codelineno-15-19"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-15-20" name="__codelineno-15-20"></a>
<a id="__codelineno-15-21" name="__codelineno-15-21"></a><span class="c1"># 个人建议:当你离开你的计算机之后一定要锁屏</span>
</code></pre></div></td></tr></table></div>
<h3 id="92-数据的增删改查">9.2 数据的增删改查<a class="headerlink" href="#92-数据的增删改查" title="Permanent link">&para;</a></h3>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-16-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-16-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-16-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-16-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-16-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-16-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-16-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-16-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-16-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-16-10">10</a></span>
<span class="normal"><a href="#__codelineno-16-11">11</a></span>
<span class="normal"><a href="#__codelineno-16-12">12</a></span>
<span class="normal"><a href="#__codelineno-16-13">13</a></span>
<span class="normal"><a href="#__codelineno-16-14">14</a></span>
<span class="normal"><a href="#__codelineno-16-15">15</a></span>
<span class="normal"><a href="#__codelineno-16-16">16</a></span>
<span class="normal"><a href="#__codelineno-16-17">17</a></span>
<span class="normal"><a href="#__codelineno-16-18">18</a></span>
<span class="normal"><a href="#__codelineno-16-19">19</a></span>
<span class="normal"><a href="#__codelineno-16-20">20</a></span>
<span class="normal"><a href="#__codelineno-16-21">21</a></span>
<span class="normal"><a href="#__codelineno-16-22">22</a></span>
<span class="normal"><a href="#__codelineno-16-23">23</a></span>
<span class="normal"><a href="#__codelineno-16-24">24</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1"></a><span class="c1"># 今天只会介绍一点点 后面会详细的介绍</span>
<a id="__codelineno-16-2" name="__codelineno-16-2"></a>
<a id="__codelineno-16-3" name="__codelineno-16-3"></a><span class="c1"># 查</span>
<a id="__codelineno-16-4" name="__codelineno-16-4"></a><span class="n">res</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">User</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="n">username</span><span class="p">)</span>
<a id="__codelineno-16-5" name="__codelineno-16-5"></a><span class="n">user_obj</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">User</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="n">username</span><span class="p">)</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
<a id="__codelineno-16-6" name="__codelineno-16-6"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-16-7" name="__codelineno-16-7"></a><span class="sd">返回值你先看成是列表套数据对象的格式</span>
<a id="__codelineno-16-8" name="__codelineno-16-8"></a><span class="sd">它也支持索引取值 切片操作 但是不支持负数索引</span>
<a id="__codelineno-16-9" name="__codelineno-16-9"></a><span class="sd">它也不推荐你使用索引的方式取值</span>
<a id="__codelineno-16-10" name="__codelineno-16-10"></a>
<a id="__codelineno-16-11" name="__codelineno-16-11"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-16-12" name="__codelineno-16-12"></a><span class="n">filter括号内可以携带多个参数</span> <span class="n">参数与参数之间默认是and关系</span>
<a id="__codelineno-16-13" name="__codelineno-16-13"></a><span class="n">你可以把filter联想成where记忆</span>
<a id="__codelineno-16-14" name="__codelineno-16-14"></a>
<a id="__codelineno-16-15" name="__codelineno-16-15"></a>
<a id="__codelineno-16-16" name="__codelineno-16-16"></a>
<a id="__codelineno-16-17" name="__codelineno-16-17"></a><span class="c1"># 增</span>
<a id="__codelineno-16-18" name="__codelineno-16-18"></a><span class="kn">from</span><span class="w"> </span><span class="nn">app01</span><span class="w"> </span><span class="kn">import</span> <span class="n">models</span>
<a id="__codelineno-16-19" name="__codelineno-16-19"></a><span class="n">res</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">User</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="n">username</span><span class="p">,</span><span class="n">password</span><span class="o">=</span><span class="n">password</span><span class="p">)</span>
<a id="__codelineno-16-20" name="__codelineno-16-20"></a><span class="c1"># 返回值就是当前被创建的对象本身</span>
<a id="__codelineno-16-21" name="__codelineno-16-21"></a>
<a id="__codelineno-16-22" name="__codelineno-16-22"></a><span class="c1"># 第二种增加</span>
<a id="__codelineno-16-23" name="__codelineno-16-23"></a><span class="n">user_obj</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">User</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="n">username</span><span class="p">,</span><span class="n">password</span><span class="o">=</span><span class="n">password</span><span class="p">)</span>
<a id="__codelineno-16-24" name="__codelineno-16-24"></a><span class="n">user_obj</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>  <span class="c1"># 保存数据</span>
</code></pre></div></td></tr></table></div>
<h3 id="93-查">9.3 查<a class="headerlink" href="#93-查" title="Permanent link">&para;</a></h3>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-17-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-17-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-17-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-17-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-17-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-17-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-17-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-17-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-17-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-17-10">10</a></span>
<span class="normal"><a href="#__codelineno-17-11">11</a></span>
<span class="normal"><a href="#__codelineno-17-12">12</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1"></a><span class="c1"># 查所有数据</span>
<a id="__codelineno-17-2" name="__codelineno-17-2"></a>
<a id="__codelineno-17-3" name="__codelineno-17-3"></a> <span class="c1"># 方式1</span>
<a id="__codelineno-17-4" name="__codelineno-17-4"></a>    <span class="n">data</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">User</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">()</span>
<a id="__codelineno-17-5" name="__codelineno-17-5"></a>    <span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<a id="__codelineno-17-6" name="__codelineno-17-6"></a>    <span class="c1"># &lt;QuerySet [&lt;User: User object&gt;, &lt;User: User object&gt;, &lt;User: User object&gt;, &lt;User: User object&gt;]&gt;</span>
<a id="__codelineno-17-7" name="__codelineno-17-7"></a> <span class="c1"># 方式2</span>
<a id="__codelineno-17-8" name="__codelineno-17-8"></a>    <span class="n">user_queryset</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">User</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
<a id="__codelineno-17-9" name="__codelineno-17-9"></a>    <span class="c1"># &lt;QuerySet [&lt;User: User object&gt;, &lt;User: User object&gt;, &lt;User: User object&gt;, &lt;User: User object&gt;]&gt;</span>
<a id="__codelineno-17-10" name="__codelineno-17-10"></a>    <span class="c1"># return render(request,&#39;userlist.html&#39;,{&#39;user_queryset&#39;:user_queryset})</span>
<a id="__codelineno-17-11" name="__codelineno-17-11"></a>    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span><span class="s1">&#39;userlist.html&#39;</span><span class="p">,</span><span class="nb">locals</span><span class="p">())</span>
<a id="__codelineno-17-12" name="__codelineno-17-12"></a><span class="c1">## locals() 函数可以把当前作用域中的变量传给前端</span>
</code></pre></div></td></tr></table></div>
<h3 id="94-改">9.4 改<a class="headerlink" href="#94-改" title="Permanent link">&para;</a></h3>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-18-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-18-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-18-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-18-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-18-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-18-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-18-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-18-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-18-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-18-10">10</a></span>
<span class="normal"><a href="#__codelineno-18-11">11</a></span>
<span class="normal"><a href="#__codelineno-18-12">12</a></span>
<span class="normal"><a href="#__codelineno-18-13">13</a></span>
<span class="normal"><a href="#__codelineno-18-14">14</a></span>
<span class="normal"><a href="#__codelineno-18-15">15</a></span>
<span class="normal"><a href="#__codelineno-18-16">16</a></span>
<span class="normal"><a href="#__codelineno-18-17">17</a></span>
<span class="normal"><a href="#__codelineno-18-18">18</a></span>
<span class="normal"><a href="#__codelineno-18-19">19</a></span>
<span class="normal"><a href="#__codelineno-18-20">20</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1"></a><span class="c1">## 根据id 修改数据库中的数据</span>
<a id="__codelineno-18-2" name="__codelineno-18-2"></a><span class="n">password</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;password&#39;</span><span class="p">)</span>
<a id="__codelineno-18-3" name="__codelineno-18-3"></a><span class="n">username</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;username&#39;</span><span class="p">)</span>
<a id="__codelineno-18-4" name="__codelineno-18-4"></a>
<a id="__codelineno-18-5" name="__codelineno-18-5"></a><span class="c1">## 方式1</span>
<a id="__codelineno-18-6" name="__codelineno-18-6"></a><span class="n">models</span><span class="o">.</span><span class="n">User</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">edit_id</span><span class="p">)</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="n">username</span><span class="p">,</span><span class="n">password</span><span class="o">=</span><span class="n">password</span><span class="p">)</span>
<a id="__codelineno-18-7" name="__codelineno-18-7"></a><span class="w"> </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-18-8" name="__codelineno-18-8"></a><span class="sd">    将filter查询出来的列表中所有的对象全部更新            批量更新操作</span>
<a id="__codelineno-18-9" name="__codelineno-18-9"></a><span class="sd">    只修改被修改的字段</span>
<a id="__codelineno-18-10" name="__codelineno-18-10"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-18-11" name="__codelineno-18-11"></a>
<a id="__codelineno-18-12" name="__codelineno-18-12"></a><span class="c1">## 方式2</span>
<a id="__codelineno-18-13" name="__codelineno-18-13"></a><span class="n">edit_obj</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">User</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">user_id</span><span class="p">)</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
<a id="__codelineno-18-14" name="__codelineno-18-14"></a><span class="n">edit_obj</span><span class="o">.</span><span class="n">username</span> <span class="o">=</span> <span class="n">username</span>
<a id="__codelineno-18-15" name="__codelineno-18-15"></a><span class="n">edit_obj</span><span class="o">.</span><span class="n">password</span> <span class="o">=</span> <span class="n">password</span>
<a id="__codelineno-18-16" name="__codelineno-18-16"></a><span class="n">edit_obj</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
<a id="__codelineno-18-17" name="__codelineno-18-17"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-18-18" name="__codelineno-18-18"></a><span class="sd">    上述方法当字段特别多的时候效率会非常的低</span>
<a id="__codelineno-18-19" name="__codelineno-18-19"></a><span class="sd">    从头到尾将数据的所有字段全部更新一边 无论该字段是否被修改</span>
<a id="__codelineno-18-20" name="__codelineno-18-20"></a><span class="sd">&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
<h3 id="95-删除">9.5 删除<a class="headerlink" href="#95-删除" title="Permanent link">&para;</a></h3>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-19-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1"></a>  <span class="n">models</span><span class="o">.</span><span class="n">User</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">delete_id</span><span class="p">)</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>  <span class="c1">## 可以批量删除</span>
</code></pre></div></td></tr></table></div>
<h3 id="96-orm创建表关系">9.6 orm创建表关系<a class="headerlink" href="#96-orm创建表关系" title="Permanent link">&para;</a></h3>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-20-1">1</a></span>
<span class="normal"><a href="#__codelineno-20-2">2</a></span>
<span class="normal"><a href="#__codelineno-20-3">3</a></span>
<span class="normal"><a href="#__codelineno-20-4">4</a></span>
<span class="normal"><a href="#__codelineno-20-5">5</a></span>
<span class="normal"><a href="#__codelineno-20-6">6</a></span>
<span class="normal"><a href="#__codelineno-20-7">7</a></span>
<span class="normal"><a href="#__codelineno-20-8">8</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1"></a><span class="sd">&#39;&#39;&#39;</span>
<a id="__codelineno-20-2" name="__codelineno-20-2"></a><span class="sd">表与表之间的关系</span>
<a id="__codelineno-20-3" name="__codelineno-20-3"></a><span class="sd">    一对多</span>
<a id="__codelineno-20-4" name="__codelineno-20-4"></a>
<a id="__codelineno-20-5" name="__codelineno-20-5"></a><span class="sd">    多对一</span>
<a id="__codelineno-20-6" name="__codelineno-20-6"></a>
<a id="__codelineno-20-7" name="__codelineno-20-7"></a><span class="sd">    一对一</span>
<a id="__codelineno-20-8" name="__codelineno-20-8"></a><span class="sd">&#39;&#39;&#39;</span>
</code></pre></div></td></tr></table></div>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-21-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-21-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-21-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-21-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-21-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-21-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-21-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-21-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-21-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-21-10">10</a></span>
<span class="normal"><a href="#__codelineno-21-11">11</a></span>
<span class="normal"><a href="#__codelineno-21-12">12</a></span>
<span class="normal"><a href="#__codelineno-21-13">13</a></span>
<span class="normal"><a href="#__codelineno-21-14">14</a></span>
<span class="normal"><a href="#__codelineno-21-15">15</a></span>
<span class="normal"><a href="#__codelineno-21-16">16</a></span>
<span class="normal"><a href="#__codelineno-21-17">17</a></span>
<span class="normal"><a href="#__codelineno-21-18">18</a></span>
<span class="normal"><a href="#__codelineno-21-19">19</a></span>
<span class="normal"><a href="#__codelineno-21-20">20</a></span>
<span class="normal"><a href="#__codelineno-21-21">21</a></span>
<span class="normal"><a href="#__codelineno-21-22">22</a></span>
<span class="normal"><a href="#__codelineno-21-23">23</a></span>
<span class="normal"><a href="#__codelineno-21-24">24</a></span>
<span class="normal"><a href="#__codelineno-21-25">25</a></span>
<span class="normal"><a href="#__codelineno-21-26">26</a></span>
<span class="normal"><a href="#__codelineno-21-27">27</a></span>
<span class="normal"><a href="#__codelineno-21-28">28</a></span>
<span class="normal"><a href="#__codelineno-21-29">29</a></span>
<span class="normal"><a href="#__codelineno-21-30">30</a></span>
<span class="normal"><a href="#__codelineno-21-31">31</a></span>
<span class="normal"><a href="#__codelineno-21-32">32</a></span>
<span class="normal"><a href="#__codelineno-21-33">33</a></span>
<span class="normal"><a href="#__codelineno-21-34">34</a></span>
<span class="normal"><a href="#__codelineno-21-35">35</a></span>
<span class="normal"><a href="#__codelineno-21-36">36</a></span>
<span class="normal"><a href="#__codelineno-21-37">37</a></span>
<span class="normal"><a href="#__codelineno-21-38">38</a></span>
<span class="normal"><a href="#__codelineno-21-39">39</a></span>
<span class="normal"><a href="#__codelineno-21-40">40</a></span>
<span class="normal"><a href="#__codelineno-21-41">41</a></span>
<span class="normal"><a href="#__codelineno-21-42">42</a></span>
<span class="normal"><a href="#__codelineno-21-43">43</a></span>
<span class="normal"><a href="#__codelineno-21-44">44</a></span>
<span class="normal"><a href="#__codelineno-21-45">45</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.db</span><span class="w"> </span><span class="kn">import</span> <span class="n">models</span>
<a id="__codelineno-21-2" name="__codelineno-21-2"></a>
<a id="__codelineno-21-3" name="__codelineno-21-3"></a><span class="c1"># Create your models here.</span>
<a id="__codelineno-21-4" name="__codelineno-21-4"></a><span class="c1"># 创建表关系 先将基表创建出来 然后再添加外键字段</span>
<a id="__codelineno-21-5" name="__codelineno-21-5"></a><span class="k">class</span><span class="w"> </span><span class="nc">Book</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
<a id="__codelineno-21-6" name="__codelineno-21-6"></a>    <span class="n">title</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>
<a id="__codelineno-21-7" name="__codelineno-21-7"></a>    <span class="n">price</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DecimalField</span><span class="p">(</span><span class="n">max_digits</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span><span class="n">decimal_places</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<a id="__codelineno-21-8" name="__codelineno-21-8"></a>    <span class="c1">## 小数总共八位，小数点后面占俩位</span>
<a id="__codelineno-21-9" name="__codelineno-21-9"></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<a id="__codelineno-21-10" name="__codelineno-21-10"></a><span class="sd">    外键关系：</span>
<a id="__codelineno-21-11" name="__codelineno-21-11"></a><span class="sd">        图书和出版社是一对多，并且书是多的一方，所以外键字段放在书表里面    </span>
<a id="__codelineno-21-12" name="__codelineno-21-12"></a><span class="sd">    &#39;&#39;&#39;</span>
<a id="__codelineno-21-13" name="__codelineno-21-13"></a>    <span class="n">publish</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="n">to</span><span class="o">=</span><span class="s1">&#39;Publish&#39;</span><span class="p">)</span>
<a id="__codelineno-21-14" name="__codelineno-21-14"></a>    <span class="c1">## 还有个to_field参数，不指定的话默认就是与出版社表的主键字段做外键关联</span>
<a id="__codelineno-21-15" name="__codelineno-21-15"></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<a id="__codelineno-21-16" name="__codelineno-21-16"></a><span class="sd">    如果字段对应的是ForeignKey，那么会自动在字段的后面加id,如publish_id;</span>
<a id="__codelineno-21-17" name="__codelineno-21-17"></a><span class="sd">    如果自作聪明的加了_id,那么orm还是会给我们加_id</span>
<a id="__codelineno-21-18" name="__codelineno-21-18"></a><span class="sd">    &#39;&#39;&#39;</span>
<a id="__codelineno-21-19" name="__codelineno-21-19"></a>
<a id="__codelineno-21-20" name="__codelineno-21-20"></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<a id="__codelineno-21-21" name="__codelineno-21-21"></a><span class="sd">        图书和出版社是一对多，并且书是多的一方，所以外键字段放在书表里面</span>
<a id="__codelineno-21-22" name="__codelineno-21-22"></a><span class="sd">        外键字段建在任意一方即可，但是推荐你建在查询频率较高的一方   </span>
<a id="__codelineno-21-23" name="__codelineno-21-23"></a><span class="sd">    &#39;&#39;&#39;</span>
<a id="__codelineno-21-24" name="__codelineno-21-24"></a>    <span class="c1"># authors是虚拟字段，主要是告诉orm 书籍表和作者表是多对多的关系，让orm自动帮你创建第三张关系表</span>
<a id="__codelineno-21-25" name="__codelineno-21-25"></a>    <span class="n">authors</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ManyToManyField</span><span class="p">(</span><span class="n">to</span><span class="o">=</span><span class="s1">&#39;Author&#39;</span><span class="p">)</span>
<a id="__codelineno-21-26" name="__codelineno-21-26"></a>
<a id="__codelineno-21-27" name="__codelineno-21-27"></a>
<a id="__codelineno-21-28" name="__codelineno-21-28"></a><span class="k">class</span><span class="w"> </span><span class="nc">Publish</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
<a id="__codelineno-21-29" name="__codelineno-21-29"></a>    <span class="n">name</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>
<a id="__codelineno-21-30" name="__codelineno-21-30"></a>    <span class="n">addr</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>
<a id="__codelineno-21-31" name="__codelineno-21-31"></a>
<a id="__codelineno-21-32" name="__codelineno-21-32"></a><span class="k">class</span><span class="w"> </span><span class="nc">Author</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
<a id="__codelineno-21-33" name="__codelineno-21-33"></a>    <span class="n">name</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>
<a id="__codelineno-21-34" name="__codelineno-21-34"></a>    <span class="n">age</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">IntegerField</span><span class="p">()</span>
<a id="__codelineno-21-35" name="__codelineno-21-35"></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<a id="__codelineno-21-36" name="__codelineno-21-36"></a><span class="sd">    作者与作者详情是一对一的关系，外键字段建在任意一方都可以，但是推荐你建立在查询频率较高的一方</span>
<a id="__codelineno-21-37" name="__codelineno-21-37"></a><span class="sd">    &#39;&#39;&#39;</span>
<a id="__codelineno-21-38" name="__codelineno-21-38"></a>    <span class="n">author_detail</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">OneToOneField</span><span class="p">(</span><span class="n">to</span><span class="o">=</span><span class="s1">&#39;AuthorDetail&#39;</span><span class="p">)</span>
<a id="__codelineno-21-39" name="__codelineno-21-39"></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<a id="__codelineno-21-40" name="__codelineno-21-40"></a><span class="sd">    自动给字段加_id后缀，所以不要自作聪明加_id后缀</span>
<a id="__codelineno-21-41" name="__codelineno-21-41"></a><span class="sd">    &#39;&#39;&#39;</span>
<a id="__codelineno-21-42" name="__codelineno-21-42"></a>
<a id="__codelineno-21-43" name="__codelineno-21-43"></a><span class="k">class</span><span class="w"> </span><span class="nc">AuthorDetail</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
<a id="__codelineno-21-44" name="__codelineno-21-44"></a>    <span class="n">phone</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">BigIntegerField</span><span class="p">()</span>
<a id="__codelineno-21-45" name="__codelineno-21-45"></a>    <span class="n">addr</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<h2 id="10-django-请求声明周期流程图">10 Django 请求声明周期流程图<a class="headerlink" href="#10-django-请求声明周期流程图" title="Permanent link">&para;</a></h2>
<p><img alt="" src="../../../images/image-20230926190459965.png" /></p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Text Only</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-22-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-22-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-22-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-22-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-22-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-22-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-22-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-22-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-22-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-22-10">10</a></span>
<span class="normal"><a href="#__codelineno-22-11">11</a></span>
<span class="normal"><a href="#__codelineno-22-12">12</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-22-1" name="__codelineno-22-1"></a># 扩展知识点
<a id="__codelineno-22-2" name="__codelineno-22-2"></a>    &quot;&quot;&quot;
<a id="__codelineno-22-3" name="__codelineno-22-3"></a>    缓存数据库
<a id="__codelineno-22-4" name="__codelineno-22-4"></a>        提前已经将你想要的数据准备好了 你来直接拿就可以
<a id="__codelineno-22-5" name="__codelineno-22-5"></a>        提高效率和响应时间
<a id="__codelineno-22-6" name="__codelineno-22-6"></a>
<a id="__codelineno-22-7" name="__codelineno-22-7"></a>    当你在修改你的数据的时候 你会发现数据并不是立刻修改完成的
<a id="__codelineno-22-8" name="__codelineno-22-8"></a>    而是需要经过一段时间才会修改
<a id="__codelineno-22-9" name="__codelineno-22-9"></a>        博客园
<a id="__codelineno-22-10" name="__codelineno-22-10"></a>
<a id="__codelineno-22-11" name="__codelineno-22-11"></a>    了解即可
<a id="__codelineno-22-12" name="__codelineno-22-12"></a>&quot;&quot;&quot;
</code></pre></div></td></tr></table></div>
<h2 id="11-路由层">11 路由层<a class="headerlink" href="#11-路由层" title="Permanent link">&para;</a></h2>
<h3 id="11-1-路由匹配">11-1 路由匹配<a class="headerlink" href="#11-1-路由匹配" title="Permanent link">&para;</a></h3>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-23-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-23-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-23-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-23-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-23-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-23-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-23-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-23-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-23-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-23-10">10</a></span>
<span class="normal"><a href="#__codelineno-23-11">11</a></span>
<span class="normal"><a href="#__codelineno-23-12">12</a></span>
<span class="normal"><a href="#__codelineno-23-13">13</a></span>
<span class="normal"><a href="#__codelineno-23-14">14</a></span>
<span class="normal"><a href="#__codelineno-23-15">15</a></span>
<span class="normal"><a href="#__codelineno-23-16">16</a></span>
<span class="normal"><a href="#__codelineno-23-17">17</a></span>
<span class="normal"><a href="#__codelineno-23-18">18</a></span>
<span class="normal"><a href="#__codelineno-23-19">19</a></span>
<span class="normal"><a href="#__codelineno-23-20">20</a></span>
<span class="normal"><a href="#__codelineno-23-21">21</a></span>
<span class="normal"><a href="#__codelineno-23-22">22</a></span>
<span class="normal"><a href="#__codelineno-23-23">23</a></span>
<span class="normal"><a href="#__codelineno-23-24">24</a></span>
<span class="normal"><a href="#__codelineno-23-25">25</a></span>
<span class="normal"><a href="#__codelineno-23-26">26</a></span>
<span class="normal"><a href="#__codelineno-23-27">27</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-23-1" name="__codelineno-23-1"></a><span class="c1"># 路由匹配</span>
<a id="__codelineno-23-2" name="__codelineno-23-2"></a><span class="n">url</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;test&#39;</span><span class="p">,</span><span class="n">views</span><span class="o">.</span><span class="n">test</span><span class="p">),</span>
<a id="__codelineno-23-3" name="__codelineno-23-3"></a><span class="n">url</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;testadd&#39;</span><span class="p">,</span><span class="n">views</span><span class="o">.</span><span class="n">testadd</span><span class="p">)</span>
<a id="__codelineno-23-4" name="__codelineno-23-4"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-23-5" name="__codelineno-23-5"></a><span class="sd">url方法第一个参数是正则表达式</span>
<a id="__codelineno-23-6" name="__codelineno-23-6"></a><span class="sd">    只要第一个参数正则表达式能够匹配到内容 那么就会立刻停止往下匹配</span>
<a id="__codelineno-23-7" name="__codelineno-23-7"></a><span class="sd">    直接执行对应的视图函数</span>
<a id="__codelineno-23-8" name="__codelineno-23-8"></a>
<a id="__codelineno-23-9" name="__codelineno-23-9"></a><span class="sd">你在输入url的时候会默认加斜杠</span>
<a id="__codelineno-23-10" name="__codelineno-23-10"></a><span class="sd">    django内部帮你做到重定向</span>
<a id="__codelineno-23-11" name="__codelineno-23-11"></a><span class="sd">        一次匹配不行</span>
<a id="__codelineno-23-12" name="__codelineno-23-12"></a><span class="sd">        url后面加斜杠再来一次</span>
<a id="__codelineno-23-13" name="__codelineno-23-13"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-23-14" name="__codelineno-23-14"></a><span class="c1"># 取消自动加斜杠</span>
<a id="__codelineno-23-15" name="__codelineno-23-15"></a><span class="n">APPEND_SLASH</span> <span class="o">=</span> <span class="kc">False</span><span class="o">/</span><span class="kc">True</span>   <span class="c1"># 默认是自动加斜杠的</span>
<a id="__codelineno-23-16" name="__codelineno-23-16"></a>
<a id="__codelineno-23-17" name="__codelineno-23-17"></a>
<a id="__codelineno-23-18" name="__codelineno-23-18"></a><span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-23-19" name="__codelineno-23-19"></a>    <span class="n">url</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^admin/&#39;</span><span class="p">,</span> <span class="n">admin</span><span class="o">.</span><span class="n">site</span><span class="o">.</span><span class="n">urls</span><span class="p">),</span>
<a id="__codelineno-23-20" name="__codelineno-23-20"></a>    <span class="c1"># 首页</span>
<a id="__codelineno-23-21" name="__codelineno-23-21"></a>    <span class="n">url</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^$&#39;</span><span class="p">,</span><span class="n">views</span><span class="o">.</span><span class="n">home</span><span class="p">),</span>
<a id="__codelineno-23-22" name="__codelineno-23-22"></a>    <span class="c1"># 路由匹配</span>
<a id="__codelineno-23-23" name="__codelineno-23-23"></a>    <span class="n">url</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^test/$&#39;</span><span class="p">,</span><span class="n">views</span><span class="o">.</span><span class="n">test</span><span class="p">),</span>
<a id="__codelineno-23-24" name="__codelineno-23-24"></a>    <span class="n">url</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^testadd/$&#39;</span><span class="p">,</span><span class="n">views</span><span class="o">.</span><span class="n">testadd</span><span class="p">),</span>
<a id="__codelineno-23-25" name="__codelineno-23-25"></a>    <span class="c1"># 尾页(了解)</span>
<a id="__codelineno-23-26" name="__codelineno-23-26"></a>    <span class="n">url</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">views</span><span class="o">.</span><span class="n">error</span><span class="p">),</span>
<a id="__codelineno-23-27" name="__codelineno-23-27"></a><span class="p">]</span>
</code></pre></div></td></tr></table></div>
<h3 id="11-2-无名分组">11-2 无名分组<a class="headerlink" href="#11-2-无名分组" title="Permanent link">&para;</a></h3>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-24-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-24-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-24-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-24-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-24-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-24-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-24-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-24-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-24-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-24-10">10</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-24-1" name="__codelineno-24-1"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-24-2" name="__codelineno-24-2"></a><span class="sd">分组:就是给某一段正则表达式用小括号扩起来</span>
<a id="__codelineno-24-3" name="__codelineno-24-3"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-24-4" name="__codelineno-24-4"></a><span class="n">url</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^test/(\d+)/&#39;</span><span class="p">,</span><span class="n">views</span><span class="o">.</span><span class="n">test</span><span class="p">)</span>
<a id="__codelineno-24-5" name="__codelineno-24-5"></a>
<a id="__codelineno-24-6" name="__codelineno-24-6"></a><span class="k">def</span><span class="w"> </span><span class="nf">test</span><span class="p">(</span><span class="n">request</span><span class="p">,</span><span class="n">xx</span><span class="p">):</span>
<a id="__codelineno-24-7" name="__codelineno-24-7"></a>    <span class="nb">print</span><span class="p">(</span><span class="n">xx</span><span class="p">)</span>
<a id="__codelineno-24-8" name="__codelineno-24-8"></a>    <span class="k">return</span> <span class="n">HttpResponse</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">)</span>
<a id="__codelineno-24-9" name="__codelineno-24-9"></a>
<a id="__codelineno-24-10" name="__codelineno-24-10"></a><span class="c1"># 无名分组就是将括号内正则表达式匹配到的内容当作位置参数传递给后面的视图函数</span>
</code></pre></div></td></tr></table></div>
<h3 id="11-3-有名分组">11-3 有名分组<a class="headerlink" href="#11-3-有名分组" title="Permanent link">&para;</a></h3>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Text Only</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-25-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-25-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-25-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-25-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-25-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-25-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-25-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-25-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-25-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-25-10">10</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-25-1" name="__codelineno-25-1"></a>&quot;&quot;&quot;
<a id="__codelineno-25-2" name="__codelineno-25-2"></a>可以给正则表达式起一个别名
<a id="__codelineno-25-3" name="__codelineno-25-3"></a>&quot;&quot;&quot;
<a id="__codelineno-25-4" name="__codelineno-25-4"></a>url(r&#39;^testadd/(?P&lt;year&gt;\d+)&#39;,views.testadd)
<a id="__codelineno-25-5" name="__codelineno-25-5"></a>
<a id="__codelineno-25-6" name="__codelineno-25-6"></a>def testadd(request,year):
<a id="__codelineno-25-7" name="__codelineno-25-7"></a>    print(year)
<a id="__codelineno-25-8" name="__codelineno-25-8"></a>    return HttpResponse(&#39;testadd&#39;)
<a id="__codelineno-25-9" name="__codelineno-25-9"></a>
<a id="__codelineno-25-10" name="__codelineno-25-10"></a># 有名分组就是将括号内正则表达式匹配到的内容当作关键字参数传递给后面的视图函数
</code></pre></div></td></tr></table></div>
<h3 id="11-4-无名有名是否可以混用">11-4 无名有名是否可以混用<a class="headerlink" href="#11-4-无名有名是否可以混用" title="Permanent link">&para;</a></h3>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-26-1">1</a></span>
<span class="normal"><a href="#__codelineno-26-2">2</a></span>
<span class="normal"><a href="#__codelineno-26-3">3</a></span>
<span class="normal"><a href="#__codelineno-26-4">4</a></span>
<span class="normal"><a href="#__codelineno-26-5">5</a></span>
<span class="normal"><a href="#__codelineno-26-6">6</a></span>
<span class="normal"><a href="#__codelineno-26-7">7</a></span>
<span class="normal"><a href="#__codelineno-26-8">8</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-26-1" name="__codelineno-26-1"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-26-2" name="__codelineno-26-2"></a><span class="sd">嘻嘻 不能混用</span>
<a id="__codelineno-26-3" name="__codelineno-26-3"></a><span class="sd">但是同一个分组可以使用N多次</span>
<a id="__codelineno-26-4" name="__codelineno-26-4"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-26-5" name="__codelineno-26-5"></a>
<a id="__codelineno-26-6" name="__codelineno-26-6"></a><span class="c1"># 单个的分组可以使用多次</span>
<a id="__codelineno-26-7" name="__codelineno-26-7"></a><span class="n">url</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^index/(\d+)/(\d+)/(\d+)/&#39;</span><span class="p">,</span><span class="n">views</span><span class="o">.</span><span class="n">index</span><span class="p">),</span>
<a id="__codelineno-26-8" name="__codelineno-26-8"></a><span class="n">url</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^index/(?P&lt;year&gt;\d+)/(?P&lt;age&gt;\d+)/(?P&lt;month&gt;\d+)/&#39;</span><span class="p">,</span><span class="n">views</span><span class="o">.</span><span class="n">index</span><span class="p">),</span>
</code></pre></div></td></tr></table></div>
<h3 id="11-5-反向解析">11-5 反向解析<a class="headerlink" href="#11-5-反向解析" title="Permanent link">&para;</a></h3>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-27-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-27-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-27-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-27-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-27-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-27-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-27-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-27-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-27-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-27-10">10</a></span>
<span class="normal"><a href="#__codelineno-27-11">11</a></span>
<span class="normal"><a href="#__codelineno-27-12">12</a></span>
<span class="normal"><a href="#__codelineno-27-13">13</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-27-1" name="__codelineno-27-1"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-27-2" name="__codelineno-27-2"></a><span class="sd">本质:通过一些方法得到一个结果 该结果可以访问到对应的url从而触发视图函数的运行</span>
<a id="__codelineno-27-3" name="__codelineno-27-3"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-27-4" name="__codelineno-27-4"></a><span class="c1"># 最简单的情况 url第一个参数里面没有正则符号</span>
<a id="__codelineno-27-5" name="__codelineno-27-5"></a>    <span class="n">url</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^index/&#39;</span><span class="p">,</span><span class="n">view</span><span class="o">.</span><span class="n">index</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;xxx&#39;</span><span class="p">)</span>
<a id="__codelineno-27-6" name="__codelineno-27-6"></a><span class="c1"># 前端</span>
<a id="__codelineno-27-7" name="__codelineno-27-7"></a>    <span class="p">{</span><span class="o">%</span> <span class="n">url</span> <span class="s1">&#39;xxx&#39;</span> <span class="o">%</span><span class="p">}</span>
<a id="__codelineno-27-8" name="__codelineno-27-8"></a><span class="c1"># 后端</span>
<a id="__codelineno-27-9" name="__codelineno-27-9"></a>    <span class="kn">from</span><span class="w"> </span><span class="nn">django.shortcuts</span><span class="w"> </span><span class="kn">import</span> <span class="n">reverse</span>
<a id="__codelineno-27-10" name="__codelineno-27-10"></a>  <span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;xxx&#39;</span><span class="p">)</span>
<a id="__codelineno-27-11" name="__codelineno-27-11"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-27-12" name="__codelineno-27-12"></a><span class="sd">别名不能出现冲突!!!</span>
<a id="__codelineno-27-13" name="__codelineno-27-13"></a><span class="sd">&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
<h3 id="11-6-无名分组反向解析">11-6 无名分组反向解析<a class="headerlink" href="#11-6-无名分组反向解析" title="Permanent link">&para;</a></h3>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-28-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-28-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-28-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-28-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-28-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-28-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-28-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-28-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-28-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-28-10">10</a></span>
<span class="normal"><a href="#__codelineno-28-11">11</a></span>
<span class="normal"><a href="#__codelineno-28-12">12</a></span>
<span class="normal"><a href="#__codelineno-28-13">13</a></span>
<span class="normal"><a href="#__codelineno-28-14">14</a></span>
<span class="normal"><a href="#__codelineno-28-15">15</a></span>
<span class="normal"><a href="#__codelineno-28-16">16</a></span>
<span class="normal"><a href="#__codelineno-28-17">17</a></span>
<span class="normal"><a href="#__codelineno-28-18">18</a></span>
<span class="normal"><a href="#__codelineno-28-19">19</a></span>
<span class="normal"><a href="#__codelineno-28-20">20</a></span>
<span class="normal"><a href="#__codelineno-28-21">21</a></span>
<span class="normal"><a href="#__codelineno-28-22">22</a></span>
<span class="normal"><a href="#__codelineno-28-23">23</a></span>
<span class="normal"><a href="#__codelineno-28-24">24</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-28-1" name="__codelineno-28-1"></a><span class="c1"># 无名分组反向解析</span>
<a id="__codelineno-28-2" name="__codelineno-28-2"></a>    <span class="n">url</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^index/(\d+)/&#39;</span><span class="p">,</span><span class="n">views</span><span class="o">.</span><span class="n">index</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;xxx&#39;</span><span class="p">)</span>
<a id="__codelineno-28-3" name="__codelineno-28-3"></a>
<a id="__codelineno-28-4" name="__codelineno-28-4"></a><span class="c1"># 前端</span>
<a id="__codelineno-28-5" name="__codelineno-28-5"></a>    <span class="p">{</span><span class="o">%</span> <span class="n">url</span> <span class="s1">&#39;xxx&#39;</span> <span class="mi">123</span> <span class="o">%</span><span class="p">}</span>
<a id="__codelineno-28-6" name="__codelineno-28-6"></a><span class="c1"># 后端</span>
<a id="__codelineno-28-7" name="__codelineno-28-7"></a>    <span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;xxx&#39;</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,))</span>
<a id="__codelineno-28-8" name="__codelineno-28-8"></a>
<a id="__codelineno-28-9" name="__codelineno-28-9"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-28-10" name="__codelineno-28-10"></a><span class="sd">这个数字写代码的时候应该放什么</span>
<a id="__codelineno-28-11" name="__codelineno-28-11"></a><span class="sd">    数字一般情况下放的是数据的主键值  数据的编辑和删除</span>
<a id="__codelineno-28-12" name="__codelineno-28-12"></a><span class="sd">    url(r&#39;^edit/(\d+)/&#39;,views.edit,name=&#39;xxx&#39;)</span>
<a id="__codelineno-28-13" name="__codelineno-28-13"></a>
<a id="__codelineno-28-14" name="__codelineno-28-14"></a><span class="sd">    def edit(request,edit_id):</span>
<a id="__codelineno-28-15" name="__codelineno-28-15"></a><span class="sd">        reverse(&#39;xxx&#39;,args=(edit_id,))</span>
<a id="__codelineno-28-16" name="__codelineno-28-16"></a>
<a id="__codelineno-28-17" name="__codelineno-28-17"></a><span class="sd">    {%for user_obj in user_queryset%}</span>
<a id="__codelineno-28-18" name="__codelineno-28-18"></a><span class="sd">        &lt;a href=&quot;{% url &#39;xxx&#39; user_obj.id %}&quot;&gt;编辑&lt;/a&gt;</span>
<a id="__codelineno-28-19" name="__codelineno-28-19"></a>
<a id="__codelineno-28-20" name="__codelineno-28-20"></a><span class="sd">    {%endfor%}</span>
<a id="__codelineno-28-21" name="__codelineno-28-21"></a>
<a id="__codelineno-28-22" name="__codelineno-28-22"></a><span class="sd">今天每个人都必须完成的作业(*******)</span>
<a id="__codelineno-28-23" name="__codelineno-28-23"></a><span class="sd">    利用无名有名 反向解析 完成数据的增删改查</span>
<a id="__codelineno-28-24" name="__codelineno-28-24"></a><span class="sd">&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
<h3 id="11-7-有名分组的反向解析">11-7 有名分组的反向解析<a class="headerlink" href="#11-7-有名分组的反向解析" title="Permanent link">&para;</a></h3>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-29-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-29-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-29-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-29-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-29-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-29-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-29-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-29-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-29-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-29-10">10</a></span>
<span class="normal"><a href="#__codelineno-29-11">11</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-29-1" name="__codelineno-29-1"></a><span class="c1"># 有名分组反向解析</span>
<a id="__codelineno-29-2" name="__codelineno-29-2"></a>   <span class="n">url</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^func/(?P&lt;year&gt;\d+)/&#39;</span><span class="p">,</span><span class="n">views</span><span class="o">.</span><span class="n">func</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;ooo&#39;</span><span class="p">)</span>
<a id="__codelineno-29-3" name="__codelineno-29-3"></a><span class="c1"># 前端</span>
<a id="__codelineno-29-4" name="__codelineno-29-4"></a>    <span class="o">&lt;</span><span class="n">a</span> <span class="n">href</span><span class="o">=</span><span class="s2">&quot;{</span><span class="si">% u</span><span class="s2">rl &#39;ooo&#39; year=123 %}&quot;</span><span class="o">&gt;</span><span class="mi">111</span><span class="o">&lt;/</span><span class="n">a</span><span class="o">&gt;</span>  <span class="n">了解</span>
<a id="__codelineno-29-5" name="__codelineno-29-5"></a>    <span class="o">&lt;</span><span class="n">a</span> <span class="n">href</span><span class="o">=</span><span class="s2">&quot;{</span><span class="si">% u</span><span class="s2">rl &#39;ooo&#39; 123 %}&quot;</span><span class="o">&gt;</span><span class="mi">222</span><span class="o">&lt;/</span><span class="n">a</span><span class="o">&gt;</span>           <span class="n">记忆</span>
<a id="__codelineno-29-6" name="__codelineno-29-6"></a>
<a id="__codelineno-29-7" name="__codelineno-29-7"></a><span class="c1"># 后端    </span>
<a id="__codelineno-29-8" name="__codelineno-29-8"></a>     <span class="c1"># 有名分组反向解析 写法1  了解</span>
<a id="__codelineno-29-9" name="__codelineno-29-9"></a>   <span class="nb">print</span><span class="p">(</span><span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;ooo&#39;</span><span class="p">,</span><span class="n">kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;year&#39;</span><span class="p">:</span><span class="mi">123</span><span class="p">}))</span>
<a id="__codelineno-29-10" name="__codelineno-29-10"></a>   <span class="c1"># 简便的写法  减少你的脑容量消耗 记跟无名一样的操作即可</span>
<a id="__codelineno-29-11" name="__codelineno-29-11"></a>   <span class="nb">print</span><span class="p">(</span><span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;ooo&#39;</span><span class="p">,</span><span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="mi">111</span><span class="p">,)))</span>
</code></pre></div></td></tr></table></div>
<h3 id="11-8-路由分发">11-8 路由分发<a class="headerlink" href="#11-8-路由分发" title="Permanent link">&para;</a></h3>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Text Only</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-30-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-30-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-30-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-30-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-30-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-30-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-30-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-30-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-30-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-30-10">10</a></span>
<span class="normal"><a href="#__codelineno-30-11">11</a></span>
<span class="normal"><a href="#__codelineno-30-12">12</a></span>
<span class="normal"><a href="#__codelineno-30-13">13</a></span>
<span class="normal"><a href="#__codelineno-30-14">14</a></span>
<span class="normal"><a href="#__codelineno-30-15">15</a></span>
<span class="normal"><a href="#__codelineno-30-16">16</a></span>
<span class="normal"><a href="#__codelineno-30-17">17</a></span>
<span class="normal"><a href="#__codelineno-30-18">18</a></span>
<span class="normal"><a href="#__codelineno-30-19">19</a></span>
<span class="normal"><a href="#__codelineno-30-20">20</a></span>
<span class="normal"><a href="#__codelineno-30-21">21</a></span>
<span class="normal"><a href="#__codelineno-30-22">22</a></span>
<span class="normal"><a href="#__codelineno-30-23">23</a></span>
<span class="normal"><a href="#__codelineno-30-24">24</a></span>
<span class="normal"><a href="#__codelineno-30-25">25</a></span>
<span class="normal"><a href="#__codelineno-30-26">26</a></span>
<span class="normal"><a href="#__codelineno-30-27">27</a></span>
<span class="normal"><a href="#__codelineno-30-28">28</a></span>
<span class="normal"><a href="#__codelineno-30-29">29</a></span>
<span class="normal"><a href="#__codelineno-30-30">30</a></span>
<span class="normal"><a href="#__codelineno-30-31">31</a></span>
<span class="normal"><a href="#__codelineno-30-32">32</a></span>
<span class="normal"><a href="#__codelineno-30-33">33</a></span>
<span class="normal"><a href="#__codelineno-30-34">34</a></span>
<span class="normal"><a href="#__codelineno-30-35">35</a></span>
<span class="normal"><a href="#__codelineno-30-36">36</a></span>
<span class="normal"><a href="#__codelineno-30-37">37</a></span>
<span class="normal"><a href="#__codelineno-30-38">38</a></span>
<span class="normal"><a href="#__codelineno-30-39">39</a></span>
<span class="normal"><a href="#__codelineno-30-40">40</a></span>
<span class="normal"><a href="#__codelineno-30-41">41</a></span>
<span class="normal"><a href="#__codelineno-30-42">42</a></span>
<span class="normal"><a href="#__codelineno-30-43">43</a></span>
<span class="normal"><a href="#__codelineno-30-44">44</a></span>
<span class="normal"><a href="#__codelineno-30-45">45</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-30-1" name="__codelineno-30-1"></a>&quot;&quot;&quot;
<a id="__codelineno-30-2" name="__codelineno-30-2"></a>django的每一个应用都可以有自己的templates文件夹 urls.py static文件夹
<a id="__codelineno-30-3" name="__codelineno-30-3"></a>正是基于上述的特点 django能够非常好的做到分组开发(每个人只写自己的app)
<a id="__codelineno-30-4" name="__codelineno-30-4"></a>作为组长 只需要将手下书写的app全部拷贝到一个新的django项目中 然后在配置文件里面注册所有的app再利用路由分发的特点将所有的app整合起来
<a id="__codelineno-30-5" name="__codelineno-30-5"></a>
<a id="__codelineno-30-6" name="__codelineno-30-6"></a>当一个django项目中的url特别多的时候 总路由urls.py代码非常冗余不好维护
<a id="__codelineno-30-7" name="__codelineno-30-7"></a>这个时候也可以利用路由分发来减轻总路由的压力
<a id="__codelineno-30-8" name="__codelineno-30-8"></a>
<a id="__codelineno-30-9" name="__codelineno-30-9"></a>利用路由分发之后 总路由不再干路由与视图函数的直接对应关系
<a id="__codelineno-30-10" name="__codelineno-30-10"></a>而是做一个分发处理
<a id="__codelineno-30-11" name="__codelineno-30-11"></a>    识别当前url是属于哪个应用下的 直接分发给对应的应用去处理
<a id="__codelineno-30-12" name="__codelineno-30-12"></a>
<a id="__codelineno-30-13" name="__codelineno-30-13"></a>&quot;&quot;&quot;
<a id="__codelineno-30-14" name="__codelineno-30-14"></a>
<a id="__codelineno-30-15" name="__codelineno-30-15"></a>
<a id="__codelineno-30-16" name="__codelineno-30-16"></a># 总路由
<a id="__codelineno-30-17" name="__codelineno-30-17"></a>from app01 import urls as app01_urls
<a id="__codelineno-30-18" name="__codelineno-30-18"></a>from app02 import urls as app02_urls
<a id="__codelineno-30-19" name="__codelineno-30-19"></a>urlpatterns = [
<a id="__codelineno-30-20" name="__codelineno-30-20"></a>    url(r&#39;^admin/&#39;, admin.site.urls),
<a id="__codelineno-30-21" name="__codelineno-30-21"></a>    # 1.路由分发
<a id="__codelineno-30-22" name="__codelineno-30-22"></a>    url(r&#39;^app01/&#39;,include(app01_urls)),  # 只要url前缀是app01开头 全部交给app01处理
<a id="__codelineno-30-23" name="__codelineno-30-23"></a>    url(r&#39;^app02/&#39;,include(app02_urls))   # 只要url前缀是app02开头 全部交给app02处理
<a id="__codelineno-30-24" name="__codelineno-30-24"></a>
<a id="__codelineno-30-25" name="__codelineno-30-25"></a>    # 2.终极写法  推荐使用
<a id="__codelineno-30-26" name="__codelineno-30-26"></a>    url(r&#39;^app01/&#39;,include(&#39;app01.urls&#39;)),
<a id="__codelineno-30-27" name="__codelineno-30-27"></a>    url(r&#39;^app02/&#39;,include(&#39;app02.urls&#39;))
<a id="__codelineno-30-28" name="__codelineno-30-28"></a>    # 注意事项:总路由里面的url千万不能加$结尾
<a id="__codelineno-30-29" name="__codelineno-30-29"></a>]
<a id="__codelineno-30-30" name="__codelineno-30-30"></a>
<a id="__codelineno-30-31" name="__codelineno-30-31"></a># 子路由
<a id="__codelineno-30-32" name="__codelineno-30-32"></a>    # app01 urls.py
<a id="__codelineno-30-33" name="__codelineno-30-33"></a>  from django.conf.urls import url
<a id="__codelineno-30-34" name="__codelineno-30-34"></a>  from app01 import views
<a id="__codelineno-30-35" name="__codelineno-30-35"></a>
<a id="__codelineno-30-36" name="__codelineno-30-36"></a>  urlpatterns = [
<a id="__codelineno-30-37" name="__codelineno-30-37"></a>      url(r&#39;^reg/&#39;,views.reg)
<a id="__codelineno-30-38" name="__codelineno-30-38"></a>  ]
<a id="__codelineno-30-39" name="__codelineno-30-39"></a>  # app02 urls.py
<a id="__codelineno-30-40" name="__codelineno-30-40"></a>  from django.conf.urls import url
<a id="__codelineno-30-41" name="__codelineno-30-41"></a>  from app02 import views
<a id="__codelineno-30-42" name="__codelineno-30-42"></a>
<a id="__codelineno-30-43" name="__codelineno-30-43"></a>  urlpatterns = [
<a id="__codelineno-30-44" name="__codelineno-30-44"></a>      url(r&#39;^reg/&#39;,views.reg)
<a id="__codelineno-30-45" name="__codelineno-30-45"></a>  ]
</code></pre></div></td></tr></table></div>
<h3 id="11-9-命名空间">11-9 命名空间<a class="headerlink" href="#11-9-命名空间" title="Permanent link">&para;</a></h3>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-31-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-31-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-31-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-31-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-31-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-31-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-31-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-31-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-31-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-31-10">10</a></span>
<span class="normal"><a href="#__codelineno-31-11">11</a></span>
<span class="normal"><a href="#__codelineno-31-12">12</a></span>
<span class="normal"><a href="#__codelineno-31-13">13</a></span>
<span class="normal"><a href="#__codelineno-31-14">14</a></span>
<span class="normal"><a href="#__codelineno-31-15">15</a></span>
<span class="normal"><a href="#__codelineno-31-16">16</a></span>
<span class="normal"><a href="#__codelineno-31-17">17</a></span>
<span class="normal"><a href="#__codelineno-31-18">18</a></span>
<span class="normal"><a href="#__codelineno-31-19">19</a></span>
<span class="normal"><a href="#__codelineno-31-20">20</a></span>
<span class="normal"><a href="#__codelineno-31-21">21</a></span>
<span class="normal"><a href="#__codelineno-31-22">22</a></span>
<span class="normal"><a href="#__codelineno-31-23">23</a></span>
<span class="normal"><a href="#__codelineno-31-24">24</a></span>
<span class="normal"><a href="#__codelineno-31-25">25</a></span>
<span class="normal"><a href="#__codelineno-31-26">26</a></span>
<span class="normal"><a href="#__codelineno-31-27">27</a></span>
<span class="normal"><a href="#__codelineno-31-28">28</a></span>
<span class="normal"><a href="#__codelineno-31-29">29</a></span>
<span class="normal"><a href="#__codelineno-31-30">30</a></span>
<span class="normal"><a href="#__codelineno-31-31">31</a></span>
<span class="normal"><a href="#__codelineno-31-32">32</a></span>
<span class="normal"><a href="#__codelineno-31-33">33</a></span>
<span class="normal"><a href="#__codelineno-31-34">34</a></span>
<span class="normal"><a href="#__codelineno-31-35">35</a></span>
<span class="normal"><a href="#__codelineno-31-36">36</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-31-1" name="__codelineno-31-1"></a><span class="c1"># 当多个应用出现了相同的别名 我们研究反向解析会不会自动识别应用前缀</span>
<a id="__codelineno-31-2" name="__codelineno-31-2"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-31-3" name="__codelineno-31-3"></a><span class="sd">正常情况下的反向解析是没有办法自动识别前缀的</span>
<a id="__codelineno-31-4" name="__codelineno-31-4"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-31-5" name="__codelineno-31-5"></a>
<a id="__codelineno-31-6" name="__codelineno-31-6"></a><span class="c1"># 名称空间</span>
<a id="__codelineno-31-7" name="__codelineno-31-7"></a>    <span class="c1"># 总路由</span>
<a id="__codelineno-31-8" name="__codelineno-31-8"></a>    <span class="n">url</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^app01/&#39;</span><span class="p">,</span><span class="n">include</span><span class="p">(</span><span class="s1">&#39;app01.urls&#39;</span><span class="p">,</span><span class="n">namespace</span><span class="o">=</span><span class="s1">&#39;app01&#39;</span><span class="p">)),</span>
<a id="__codelineno-31-9" name="__codelineno-31-9"></a>    <span class="n">url</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^app02/&#39;</span><span class="p">,</span><span class="n">include</span><span class="p">(</span><span class="s1">&#39;app02.urls&#39;</span><span class="p">,</span><span class="n">namespace</span><span class="o">=</span><span class="s1">&#39;app02&#39;</span><span class="p">))</span>
<a id="__codelineno-31-10" name="__codelineno-31-10"></a>  <span class="c1"># 解析的时候</span>
<a id="__codelineno-31-11" name="__codelineno-31-11"></a>      <span class="c1"># app01</span>
<a id="__codelineno-31-12" name="__codelineno-31-12"></a>      <span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-31-13" name="__codelineno-31-13"></a>    <span class="n">url</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^reg/&#39;</span><span class="p">,</span><span class="n">views</span><span class="o">.</span><span class="n">reg</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;reg&#39;</span><span class="p">)</span>
<a id="__codelineno-31-14" name="__codelineno-31-14"></a>        <span class="p">]</span>
<a id="__codelineno-31-15" name="__codelineno-31-15"></a>    <span class="c1"># app02</span>
<a id="__codelineno-31-16" name="__codelineno-31-16"></a>    <span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-31-17" name="__codelineno-31-17"></a>    <span class="n">url</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^reg/&#39;</span><span class="p">,</span><span class="n">views</span><span class="o">.</span><span class="n">reg</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;reg&#39;</span><span class="p">)</span>
<a id="__codelineno-31-18" name="__codelineno-31-18"></a>        <span class="p">]</span>
<a id="__codelineno-31-19" name="__codelineno-31-19"></a>    <span class="c1">## 后端反向解析</span>
<a id="__codelineno-31-20" name="__codelineno-31-20"></a>      <span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;app01:reg&#39;</span><span class="p">)</span>
<a id="__codelineno-31-21" name="__codelineno-31-21"></a>    <span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;app02:reg&#39;</span><span class="p">)</span>
<a id="__codelineno-31-22" name="__codelineno-31-22"></a>
<a id="__codelineno-31-23" name="__codelineno-31-23"></a>    <span class="c1">## 前端反向解析</span>
<a id="__codelineno-31-24" name="__codelineno-31-24"></a>    <span class="p">{</span><span class="o">%</span> <span class="n">url</span> <span class="s1">&#39;app01:reg&#39;</span> <span class="o">%</span><span class="p">}</span>
<a id="__codelineno-31-25" name="__codelineno-31-25"></a>    <span class="p">{</span><span class="o">%</span> <span class="n">url</span> <span class="s1">&#39;app02:reg&#39;</span> <span class="o">%</span><span class="p">}</span>
<a id="__codelineno-31-26" name="__codelineno-31-26"></a><span class="c1"># 其实只要保证名字不冲突 就没有必要使用名称空间</span>
<a id="__codelineno-31-27" name="__codelineno-31-27"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-31-28" name="__codelineno-31-28"></a><span class="sd">一般情况下 有多个app的时候我们在起别名的时候会加上app的前缀</span>
<a id="__codelineno-31-29" name="__codelineno-31-29"></a><span class="sd">这样的话就能够确保多个app之间名字不冲突的问题</span>
<a id="__codelineno-31-30" name="__codelineno-31-30"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-31-31" name="__codelineno-31-31"></a><span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-31-32" name="__codelineno-31-32"></a>    <span class="n">url</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^reg/&#39;</span><span class="p">,</span><span class="n">views</span><span class="o">.</span><span class="n">reg</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;app01_reg&#39;</span><span class="p">)</span>
<a id="__codelineno-31-33" name="__codelineno-31-33"></a><span class="p">]</span>
<a id="__codelineno-31-34" name="__codelineno-31-34"></a><span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-31-35" name="__codelineno-31-35"></a>    <span class="n">url</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^reg/&#39;</span><span class="p">,</span><span class="n">views</span><span class="o">.</span><span class="n">reg</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;app02_reg&#39;</span><span class="p">)</span>
<a id="__codelineno-31-36" name="__codelineno-31-36"></a><span class="p">]</span>
</code></pre></div></td></tr></table></div>
<h3 id="11-10-伪静态">11-10 伪静态<a class="headerlink" href="#11-10-伪静态" title="Permanent link">&para;</a></h3>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-32-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-32-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-32-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-32-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-32-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-32-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-32-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-32-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-32-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-32-10">10</a></span>
<span class="normal"><a href="#__codelineno-32-11">11</a></span>
<span class="normal"><a href="#__codelineno-32-12">12</a></span>
<span class="normal"><a href="#__codelineno-32-13">13</a></span>
<span class="normal"><a href="#__codelineno-32-14">14</a></span>
<span class="normal"><a href="#__codelineno-32-15">15</a></span>
<span class="normal"><a href="#__codelineno-32-16">16</a></span>
<span class="normal"><a href="#__codelineno-32-17">17</a></span>
<span class="normal"><a href="#__codelineno-32-18">18</a></span>
<span class="normal"><a href="#__codelineno-32-19">19</a></span>
<span class="normal"><a href="#__codelineno-32-20">20</a></span>
<span class="normal"><a href="#__codelineno-32-21">21</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-32-1" name="__codelineno-32-1"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-32-2" name="__codelineno-32-2"></a><span class="sd">静态网页</span>
<a id="__codelineno-32-3" name="__codelineno-32-3"></a><span class="sd">    数据是写死的 万年不变</span>
<a id="__codelineno-32-4" name="__codelineno-32-4"></a>
<a id="__codelineno-32-5" name="__codelineno-32-5"></a><span class="sd">伪静态</span>
<a id="__codelineno-32-6" name="__codelineno-32-6"></a><span class="sd">    将一个动态网页伪装成静态网页</span>
<a id="__codelineno-32-7" name="__codelineno-32-7"></a>
<a id="__codelineno-32-8" name="__codelineno-32-8"></a><span class="sd">    为什么要伪装呢？</span>
<a id="__codelineno-32-9" name="__codelineno-32-9"></a><span class="sd">        https://www.cnblogs.com/Dominic-Ji/p/9234099.html</span>
<a id="__codelineno-32-10" name="__codelineno-32-10"></a><span class="sd">        伪装的目的在于增大本网站的seo查询力度</span>
<a id="__codelineno-32-11" name="__codelineno-32-11"></a><span class="sd">        并且增加搜索引擎收藏本网上的概率</span>
<a id="__codelineno-32-12" name="__codelineno-32-12"></a>
<a id="__codelineno-32-13" name="__codelineno-32-13"></a><span class="sd">    搜索引擎本质上就是一个巨大的爬虫程序</span>
<a id="__codelineno-32-14" name="__codelineno-32-14"></a>
<a id="__codelineno-32-15" name="__codelineno-32-15"></a><span class="sd">    总结:</span>
<a id="__codelineno-32-16" name="__codelineno-32-16"></a><span class="sd">        无论你怎么优化 怎么处理</span>
<a id="__codelineno-32-17" name="__codelineno-32-17"></a><span class="sd">        始终还是干不过RMB玩家</span>
<a id="__codelineno-32-18" name="__codelineno-32-18"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-32-19" name="__codelineno-32-19"></a><span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-32-20" name="__codelineno-32-20"></a>    <span class="n">url</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^reg.html&#39;</span><span class="p">,</span><span class="n">views</span><span class="o">.</span><span class="n">reg</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;app02_reg&#39;</span><span class="p">)</span>
<a id="__codelineno-32-21" name="__codelineno-32-21"></a><span class="p">]</span>
</code></pre></div></td></tr></table></div>
<h2 id="12-django版本区别">12 django版本区别<a class="headerlink" href="#12-django版本区别" title="Permanent link">&para;</a></h2>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-33-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-33-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-33-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-33-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-33-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-33-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-33-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-33-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-33-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-33-10">10</a></span>
<span class="normal"><a href="#__codelineno-33-11">11</a></span>
<span class="normal"><a href="#__codelineno-33-12">12</a></span>
<span class="normal"><a href="#__codelineno-33-13">13</a></span>
<span class="normal"><a href="#__codelineno-33-14">14</a></span>
<span class="normal"><a href="#__codelineno-33-15">15</a></span>
<span class="normal"><a href="#__codelineno-33-16">16</a></span>
<span class="normal"><a href="#__codelineno-33-17">17</a></span>
<span class="normal"><a href="#__codelineno-33-18">18</a></span>
<span class="normal"><a href="#__codelineno-33-19">19</a></span>
<span class="normal"><a href="#__codelineno-33-20">20</a></span>
<span class="normal"><a href="#__codelineno-33-21">21</a></span>
<span class="normal"><a href="#__codelineno-33-22">22</a></span>
<span class="normal"><a href="#__codelineno-33-23">23</a></span>
<span class="normal"><a href="#__codelineno-33-24">24</a></span>
<span class="normal"><a href="#__codelineno-33-25">25</a></span>
<span class="normal"><a href="#__codelineno-33-26">26</a></span>
<span class="normal"><a href="#__codelineno-33-27">27</a></span>
<span class="normal"><a href="#__codelineno-33-28">28</a></span>
<span class="normal"><a href="#__codelineno-33-29">29</a></span>
<span class="normal"><a href="#__codelineno-33-30">30</a></span>
<span class="normal"><a href="#__codelineno-33-31">31</a></span>
<span class="normal"><a href="#__codelineno-33-32">32</a></span>
<span class="normal"><a href="#__codelineno-33-33">33</a></span>
<span class="normal"><a href="#__codelineno-33-34">34</a></span>
<span class="normal"><a href="#__codelineno-33-35">35</a></span>
<span class="normal"><a href="#__codelineno-33-36">36</a></span>
<span class="normal"><a href="#__codelineno-33-37">37</a></span>
<span class="normal"><a href="#__codelineno-33-38">38</a></span>
<span class="normal"><a href="#__codelineno-33-39">39</a></span>
<span class="normal"><a href="#__codelineno-33-40">40</a></span>
<span class="normal"><a href="#__codelineno-33-41">41</a></span>
<span class="normal"><a href="#__codelineno-33-42">42</a></span>
<span class="normal"><a href="#__codelineno-33-43">43</a></span>
<span class="normal"><a href="#__codelineno-33-44">44</a></span>
<span class="normal"><a href="#__codelineno-33-45">45</a></span>
<span class="normal"><a href="#__codelineno-33-46">46</a></span>
<span class="normal"><a href="#__codelineno-33-47">47</a></span>
<span class="normal"><a href="#__codelineno-33-48">48</a></span>
<span class="normal"><a href="#__codelineno-33-49">49</a></span>
<span class="normal"><a href="#__codelineno-33-50">50</a></span>
<span class="normal"><a href="#__codelineno-33-51">51</a></span>
<span class="normal"><a href="#__codelineno-33-52">52</a></span>
<span class="normal"><a href="#__codelineno-33-53">53</a></span>
<span class="normal"><a href="#__codelineno-33-54">54</a></span>
<span class="normal"><a href="#__codelineno-33-55">55</a></span>
<span class="normal"><a href="#__codelineno-33-56">56</a></span>
<span class="normal"><a href="#__codelineno-33-57">57</a></span>
<span class="normal"><a href="#__codelineno-33-58">58</a></span>
<span class="normal"><a href="#__codelineno-33-59">59</a></span>
<span class="normal"><a href="#__codelineno-33-60">60</a></span>
<span class="normal"><a href="#__codelineno-33-61">61</a></span>
<span class="normal"><a href="#__codelineno-33-62">62</a></span>
<span class="normal"><a href="#__codelineno-33-63">63</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-33-1" name="__codelineno-33-1"></a><span class="mf">1.</span><span class="n">django1</span><span class="o">.</span><span class="n">X路由层使用的是url方法</span>
<a id="__codelineno-33-2" name="__codelineno-33-2"></a>    <span class="n">而在django2</span><span class="o">.</span><span class="n">Xhe3</span><span class="o">.</span><span class="n">X版本中路由层使用的是path方法</span>
<a id="__codelineno-33-3" name="__codelineno-33-3"></a>    <span class="n">url</span><span class="p">()</span><span class="n">第一个参数支持正则</span>
<a id="__codelineno-33-4" name="__codelineno-33-4"></a>    <span class="n">path</span><span class="p">()</span><span class="n">第一个参数是不支持正则的</span> <span class="n">写什么就匹配什么</span>
<a id="__codelineno-33-5" name="__codelineno-33-5"></a>
<a id="__codelineno-33-6" name="__codelineno-33-6"></a>
<a id="__codelineno-33-7" name="__codelineno-33-7"></a>    <span class="n">如果你习惯使用path那么也给你提供了另外一个方法</span>
<a id="__codelineno-33-8" name="__codelineno-33-8"></a>        <span class="kn">from</span><span class="w"> </span><span class="nn">django.urls</span><span class="w"> </span><span class="kn">import</span> <span class="n">path</span><span class="p">,</span> <span class="n">re_path</span>
<a id="__codelineno-33-9" name="__codelineno-33-9"></a>        <span class="kn">from</span><span class="w"> </span><span class="nn">django.conf.urls</span><span class="w"> </span><span class="kn">import</span> <span class="n">url</span>
<a id="__codelineno-33-10" name="__codelineno-33-10"></a>
<a id="__codelineno-33-11" name="__codelineno-33-11"></a>        <span class="n">re_path</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^index/&#39;</span><span class="p">,</span><span class="n">index</span><span class="p">),</span>
<a id="__codelineno-33-12" name="__codelineno-33-12"></a>    <span class="n">url</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^login/&#39;</span><span class="p">,</span><span class="n">login</span><span class="p">)</span>
<a id="__codelineno-33-13" name="__codelineno-33-13"></a>  <span class="mf">2.</span><span class="n">X和3</span><span class="o">.</span><span class="n">X里面的re_path就等价于1</span><span class="o">.</span><span class="n">X里面的url</span>
<a id="__codelineno-33-14" name="__codelineno-33-14"></a>
<a id="__codelineno-33-15" name="__codelineno-33-15"></a>
<a id="__codelineno-33-16" name="__codelineno-33-16"></a><span class="mf">2.</span><span class="n">虽然path不支持正则</span> <span class="n">但是它的内部支持五种转换器</span>
<a id="__codelineno-33-17" name="__codelineno-33-17"></a>    <span class="n">path</span><span class="p">(</span><span class="s1">&#39;index/&lt;int:id&gt;/&#39;</span><span class="p">,</span><span class="n">index</span><span class="p">)</span>
<a id="__codelineno-33-18" name="__codelineno-33-18"></a>    <span class="c1"># 将第二个路由里面的内容先转成整型然后以关键字的形式传递给后面的视图函数</span>
<a id="__codelineno-33-19" name="__codelineno-33-19"></a>
<a id="__codelineno-33-20" name="__codelineno-33-20"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">index</span><span class="p">(</span><span class="n">request</span><span class="p">,</span><span class="nb">id</span><span class="p">):</span>
<a id="__codelineno-33-21" name="__codelineno-33-21"></a>    <span class="nb">print</span><span class="p">(</span><span class="nb">id</span><span class="p">,</span><span class="nb">type</span><span class="p">(</span><span class="nb">id</span><span class="p">))</span>
<a id="__codelineno-33-22" name="__codelineno-33-22"></a>    <span class="k">return</span> <span class="n">HttpResponse</span><span class="p">(</span><span class="s1">&#39;index&#39;</span><span class="p">)</span>
<a id="__codelineno-33-23" name="__codelineno-33-23"></a>
<a id="__codelineno-33-24" name="__codelineno-33-24"></a>
<a id="__codelineno-33-25" name="__codelineno-33-25"></a>
<a id="__codelineno-33-26" name="__codelineno-33-26"></a><span class="nb">str</span><span class="p">,</span><span class="n">匹配除了路径分隔符</span><span class="err">（</span><span class="o">/</span><span class="err">）</span><span class="n">之外的非空字符串</span><span class="err">，</span><span class="n">这是默认的形式</span>
<a id="__codelineno-33-27" name="__codelineno-33-27"></a><span class="nb">int</span><span class="p">,</span><span class="n">匹配正整数</span><span class="err">，</span><span class="n">包含0</span><span class="err">。</span>
<a id="__codelineno-33-28" name="__codelineno-33-28"></a><span class="n">slug</span><span class="p">,</span><span class="n">匹配字母</span><span class="err">、</span><span class="n">数字以及横杠</span><span class="err">、</span><span class="n">下划线组成的字符串</span><span class="err">。</span>
<a id="__codelineno-33-29" name="__codelineno-33-29"></a><span class="n">uuid</span><span class="p">,</span><span class="n">匹配格式化的uuid</span><span class="err">，</span><span class="n">如</span> <span class="mi">075194</span><span class="n">d3</span><span class="o">-</span><span class="mi">6885</span><span class="o">-</span><span class="mi">417</span><span class="n">e</span><span class="o">-</span><span class="n">a8a8</span><span class="o">-</span><span class="mi">6</span><span class="n">c931e272f00</span><span class="err">。</span>
<a id="__codelineno-33-30" name="__codelineno-33-30"></a><span class="n">path</span><span class="p">,</span><span class="n">匹配任何非空字符串</span><span class="err">，</span><span class="n">包含了路径分隔符</span><span class="err">（</span><span class="o">/</span><span class="err">）（</span><span class="n">不能用</span><span class="err">？）</span>
<a id="__codelineno-33-31" name="__codelineno-33-31"></a>
<a id="__codelineno-33-32" name="__codelineno-33-32"></a><span class="mf">3.</span><span class="n">除了有默认的五个转换器之外</span> <span class="n">还支持自定义转换器</span><span class="p">(</span><span class="n">了解</span><span class="p">)</span>
<a id="__codelineno-33-33" name="__codelineno-33-33"></a><span class="k">class</span><span class="w"> </span><span class="nc">MonthConverter</span><span class="p">:</span>
<a id="__codelineno-33-34" name="__codelineno-33-34"></a>    <span class="n">regex</span><span class="o">=</span><span class="s1">&#39;\d</span><span class="si">{2}</span><span class="s1">&#39;</span> <span class="c1"># 属性名必须为regex</span>
<a id="__codelineno-33-35" name="__codelineno-33-35"></a>
<a id="__codelineno-33-36" name="__codelineno-33-36"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">to_python</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<a id="__codelineno-33-37" name="__codelineno-33-37"></a>        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
<a id="__codelineno-33-38" name="__codelineno-33-38"></a>
<a id="__codelineno-33-39" name="__codelineno-33-39"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">to_url</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<a id="__codelineno-33-40" name="__codelineno-33-40"></a>        <span class="k">return</span> <span class="n">value</span> <span class="c1"># 匹配的regex是两个数字，返回的结果也必须是两个数字</span>
<a id="__codelineno-33-41" name="__codelineno-33-41"></a>
<a id="__codelineno-33-42" name="__codelineno-33-42"></a>
<a id="__codelineno-33-43" name="__codelineno-33-43"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.urls</span><span class="w"> </span><span class="kn">import</span> <span class="n">path</span><span class="p">,</span><span class="n">register_converter</span>
<a id="__codelineno-33-44" name="__codelineno-33-44"></a><span class="kn">from</span><span class="w"> </span><span class="nn">app01.path_converts</span><span class="w"> </span><span class="kn">import</span> <span class="n">MonthConverter</span>
<a id="__codelineno-33-45" name="__codelineno-33-45"></a>
<a id="__codelineno-33-46" name="__codelineno-33-46"></a><span class="c1"># 先注册转换器</span>
<a id="__codelineno-33-47" name="__codelineno-33-47"></a><span class="n">register_converter</span><span class="p">(</span><span class="n">MonthConverter</span><span class="p">,</span><span class="s1">&#39;mon&#39;</span><span class="p">)</span>
<a id="__codelineno-33-48" name="__codelineno-33-48"></a>
<a id="__codelineno-33-49" name="__codelineno-33-49"></a><span class="kn">from</span><span class="w"> </span><span class="nn">app01</span><span class="w"> </span><span class="kn">import</span> <span class="n">views</span>
<a id="__codelineno-33-50" name="__codelineno-33-50"></a>
<a id="__codelineno-33-51" name="__codelineno-33-51"></a>
<a id="__codelineno-33-52" name="__codelineno-33-52"></a><span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-33-53" name="__codelineno-33-53"></a>    <span class="n">path</span><span class="p">(</span><span class="s1">&#39;articles/&lt;int:year&gt;/&lt;mon:month&gt;/&lt;slug:other&gt;/&#39;</span><span class="p">,</span>   <span class="n">views</span><span class="o">.</span><span class="n">article_detail</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;aaa&#39;</span><span class="p">),</span>
<a id="__codelineno-33-54" name="__codelineno-33-54"></a>
<a id="__codelineno-33-55" name="__codelineno-33-55"></a><span class="p">]</span>
<a id="__codelineno-33-56" name="__codelineno-33-56"></a>
<a id="__codelineno-33-57" name="__codelineno-33-57"></a>
<a id="__codelineno-33-58" name="__codelineno-33-58"></a><span class="mf">4.</span><span class="n">模型层里面1</span><span class="o">.</span><span class="n">X外键默认都是级联更新删除的</span>
<a id="__codelineno-33-59" name="__codelineno-33-59"></a><span class="n">但是到了2</span><span class="o">.</span><span class="n">X和3</span><span class="o">.</span><span class="n">X中需要你自己手动配置参数</span>
<a id="__codelineno-33-60" name="__codelineno-33-60"></a>    <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="n">to</span><span class="o">=</span><span class="s1">&#39;Publish&#39;</span><span class="p">)</span>
<a id="__codelineno-33-61" name="__codelineno-33-61"></a>
<a id="__codelineno-33-62" name="__codelineno-33-62"></a><span class="n">els</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="n">to</span><span class="o">=</span><span class="s1">&#39;Publish&#39;</span><span class="p">,</span><span class="n">on_delete</span><span class="o">=</span><span class="n">models</span><span class="o">.</span><span class="n">CASCADE</span><span class="o">...</span><span class="p">)</span>
<a id="__codelineno-33-63" name="__codelineno-33-63"></a><span class="s2">&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
<h2 id="13-视图层">13 视图层<a class="headerlink" href="#13-视图层" title="Permanent link">&para;</a></h2>
<h3 id="13-1-三板斧">13-1 三板斧<a class="headerlink" href="#13-1-三板斧" title="Permanent link">&para;</a></h3>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-34-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-34-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-34-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-34-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-34-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-34-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-34-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-34-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-34-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-34-10">10</a></span>
<span class="normal"><a href="#__codelineno-34-11">11</a></span>
<span class="normal"><a href="#__codelineno-34-12">12</a></span>
<span class="normal"><a href="#__codelineno-34-13">13</a></span>
<span class="normal"><a href="#__codelineno-34-14">14</a></span>
<span class="normal"><a href="#__codelineno-34-15">15</a></span>
<span class="normal"><a href="#__codelineno-34-16">16</a></span>
<span class="normal"><a href="#__codelineno-34-17">17</a></span>
<span class="normal"><a href="#__codelineno-34-18">18</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-34-1" name="__codelineno-34-1"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-34-2" name="__codelineno-34-2"></a><span class="sd">HttpResponse</span>
<a id="__codelineno-34-3" name="__codelineno-34-3"></a><span class="sd">    返回字符串类型</span>
<a id="__codelineno-34-4" name="__codelineno-34-4"></a><span class="sd">render</span>
<a id="__codelineno-34-5" name="__codelineno-34-5"></a><span class="sd">    返回html页面 并且在返回给浏览器之前还可以给html文件传值</span>
<a id="__codelineno-34-6" name="__codelineno-34-6"></a><span class="sd">redirect</span>
<a id="__codelineno-34-7" name="__codelineno-34-7"></a><span class="sd">    重定向</span>
<a id="__codelineno-34-8" name="__codelineno-34-8"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-34-9" name="__codelineno-34-9"></a><span class="c1"># 视图函数必须要返回一个HttpResponse对象  正确   研究三者的源码即可得处结论</span>
<a id="__codelineno-34-10" name="__codelineno-34-10"></a><span class="n">The</span> <span class="n">view</span> <span class="n">app01</span><span class="o">.</span><span class="n">views</span><span class="o">.</span><span class="n">index</span> <span class="n">didn</span><span class="s1">&#39;t return an HttpResponse object. It returned None instead.</span>
<a id="__codelineno-34-11" name="__codelineno-34-11"></a>
<a id="__codelineno-34-12" name="__codelineno-34-12"></a><span class="c1"># render简单内部原理</span>
<a id="__codelineno-34-13" name="__codelineno-34-13"></a>    <span class="kn">from</span><span class="w"> </span><span class="nn">django.template</span><span class="w"> </span><span class="kn">import</span> <span class="n">Template</span><span class="p">,</span><span class="n">Context</span>
<a id="__codelineno-34-14" name="__codelineno-34-14"></a>    <span class="n">res</span> <span class="o">=</span> <span class="n">Template</span><span class="p">(</span><span class="s1">&#39;&lt;h1&gt;{{ user }}&lt;/h1&gt;&#39;</span><span class="p">)</span>
<a id="__codelineno-34-15" name="__codelineno-34-15"></a>    <span class="n">con</span> <span class="o">=</span> <span class="n">Context</span><span class="p">({</span><span class="s1">&#39;user&#39;</span><span class="p">:{</span><span class="s1">&#39;username&#39;</span><span class="p">:</span><span class="s1">&#39;jason&#39;</span><span class="p">,</span><span class="s1">&#39;password&#39;</span><span class="p">:</span><span class="mi">123</span><span class="p">}})</span>
<a id="__codelineno-34-16" name="__codelineno-34-16"></a>    <span class="n">ret</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="n">con</span><span class="p">)</span>
<a id="__codelineno-34-17" name="__codelineno-34-17"></a>    <span class="nb">print</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>
<a id="__codelineno-34-18" name="__codelineno-34-18"></a>    <span class="k">return</span> <span class="n">HttpResponse</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<h3 id="13-2-jsonresponse对象">13-2 JsonResponse对象<a class="headerlink" href="#13-2-jsonresponse对象" title="Permanent link">&para;</a></h3>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-35-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-35-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-35-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-35-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-35-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-35-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-35-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-35-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-35-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-35-10">10</a></span>
<span class="normal"><a href="#__codelineno-35-11">11</a></span>
<span class="normal"><a href="#__codelineno-35-12">12</a></span>
<span class="normal"><a href="#__codelineno-35-13">13</a></span>
<span class="normal"><a href="#__codelineno-35-14">14</a></span>
<span class="normal"><a href="#__codelineno-35-15">15</a></span>
<span class="normal"><a href="#__codelineno-35-16">16</a></span>
<span class="normal"><a href="#__codelineno-35-17">17</a></span>
<span class="normal"><a href="#__codelineno-35-18">18</a></span>
<span class="normal"><a href="#__codelineno-35-19">19</a></span>
<span class="normal"><a href="#__codelineno-35-20">20</a></span>
<span class="normal"><a href="#__codelineno-35-21">21</a></span>
<span class="normal"><a href="#__codelineno-35-22">22</a></span>
<span class="normal"><a href="#__codelineno-35-23">23</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-35-1" name="__codelineno-35-1"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-35-2" name="__codelineno-35-2"></a><span class="sd">json格式的数据有什么用？</span>
<a id="__codelineno-35-3" name="__codelineno-35-3"></a><span class="sd">    前后端数据交互需要使用到json作为过渡 实现跨语言传输数据</span>
<a id="__codelineno-35-4" name="__codelineno-35-4"></a>
<a id="__codelineno-35-5" name="__codelineno-35-5"></a><span class="sd">前端序列化</span>
<a id="__codelineno-35-6" name="__codelineno-35-6"></a><span class="sd">    JSON.stringify()                    json.dumps()</span>
<a id="__codelineno-35-7" name="__codelineno-35-7"></a><span class="sd">    JSON.parse()                            json.loads()</span>
<a id="__codelineno-35-8" name="__codelineno-35-8"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-35-9" name="__codelineno-35-9"></a><span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
<a id="__codelineno-35-10" name="__codelineno-35-10"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.http</span><span class="w"> </span><span class="kn">import</span> <span class="n">JsonResponse</span>
<a id="__codelineno-35-11" name="__codelineno-35-11"></a><span class="k">def</span><span class="w"> </span><span class="nf">ab_json</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
<a id="__codelineno-35-12" name="__codelineno-35-12"></a>    <span class="n">user_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;username&#39;</span><span class="p">:</span><span class="s1">&#39;jason好帅哦,我好喜欢!&#39;</span><span class="p">,</span><span class="s1">&#39;password&#39;</span><span class="p">:</span><span class="s1">&#39;123&#39;</span><span class="p">,</span><span class="s1">&#39;hobby&#39;</span><span class="p">:</span><span class="s1">&#39;girl&#39;</span><span class="p">}</span>
<a id="__codelineno-35-13" name="__codelineno-35-13"></a>
<a id="__codelineno-35-14" name="__codelineno-35-14"></a>    <span class="n">l</span> <span class="o">=</span> <span class="p">[</span><span class="mi">111</span><span class="p">,</span><span class="mi">222</span><span class="p">,</span><span class="mi">333</span><span class="p">,</span><span class="mi">444</span><span class="p">,</span><span class="mi">555</span><span class="p">]</span>
<a id="__codelineno-35-15" name="__codelineno-35-15"></a>    <span class="c1"># 先转成json格式字符串</span>
<a id="__codelineno-35-16" name="__codelineno-35-16"></a>    <span class="c1"># json_str = json.dumps(user_dict,ensure_ascii=False)</span>
<a id="__codelineno-35-17" name="__codelineno-35-17"></a>    <span class="c1"># 将该字符串返回</span>
<a id="__codelineno-35-18" name="__codelineno-35-18"></a>    <span class="c1"># return HttpResponse(json_str)</span>
<a id="__codelineno-35-19" name="__codelineno-35-19"></a>    <span class="c1"># 读源码掌握用法</span>
<a id="__codelineno-35-20" name="__codelineno-35-20"></a>    <span class="c1"># return JsonResponse(user_dict,json_dumps_params={&#39;ensure_ascii&#39;:False})</span>
<a id="__codelineno-35-21" name="__codelineno-35-21"></a>    <span class="c1"># In order to allow non-dict objects to be serialized set the safe parameter to False.</span>
<a id="__codelineno-35-22" name="__codelineno-35-22"></a>    <span class="c1"># return JsonResponse(l,safe=False)  </span>
<a id="__codelineno-35-23" name="__codelineno-35-23"></a>    <span class="c1"># 默认只能序列化字典 序列化其他需要加safe参数  </span>
</code></pre></div></td></tr></table></div>
<h3 id="13-3-form表单上传文件及后端如何操作">13-3 form表单上传文件及后端如何操作<a class="headerlink" href="#13-3-form表单上传文件及后端如何操作" title="Permanent link">&para;</a></h3>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-36-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-36-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-36-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-36-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-36-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-36-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-36-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-36-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-36-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-36-10">10</a></span>
<span class="normal"><a href="#__codelineno-36-11">11</a></span>
<span class="normal"><a href="#__codelineno-36-12">12</a></span>
<span class="normal"><a href="#__codelineno-36-13">13</a></span>
<span class="normal"><a href="#__codelineno-36-14">14</a></span>
<span class="normal"><a href="#__codelineno-36-15">15</a></span>
<span class="normal"><a href="#__codelineno-36-16">16</a></span>
<span class="normal"><a href="#__codelineno-36-17">17</a></span>
<span class="normal"><a href="#__codelineno-36-18">18</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-36-1" name="__codelineno-36-1"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-36-2" name="__codelineno-36-2"></a><span class="sd">form表单上传文件类型的数据</span>
<a id="__codelineno-36-3" name="__codelineno-36-3"></a><span class="sd">    1.method必须指定成post</span>
<a id="__codelineno-36-4" name="__codelineno-36-4"></a><span class="sd">    2.enctype必须换成formdata</span>
<a id="__codelineno-36-5" name="__codelineno-36-5"></a>
<a id="__codelineno-36-6" name="__codelineno-36-6"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-36-7" name="__codelineno-36-7"></a><span class="k">def</span><span class="w"> </span><span class="nf">ab_file</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
<a id="__codelineno-36-8" name="__codelineno-36-8"></a>    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;POST&#39;</span><span class="p">:</span>
<a id="__codelineno-36-9" name="__codelineno-36-9"></a>        <span class="c1"># print(request.POST)  # 只能获取普通的键值对数据 文件不行</span>
<a id="__codelineno-36-10" name="__codelineno-36-10"></a>        <span class="nb">print</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">FILES</span><span class="p">)</span>  <span class="c1"># 获取文件数据</span>
<a id="__codelineno-36-11" name="__codelineno-36-11"></a>        <span class="c1"># &lt;MultiValueDict: {&#39;file&#39;: [&lt;InMemoryUploadedFile: u=1288812541,1979816195&amp;fm=26&amp;gp=0.jpg (image/jpeg)&gt;]}&gt;</span>
<a id="__codelineno-36-12" name="__codelineno-36-12"></a>        <span class="n">file_obj</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">FILES</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;file&#39;</span><span class="p">)</span>  <span class="c1"># 文件对象</span>
<a id="__codelineno-36-13" name="__codelineno-36-13"></a>        <span class="nb">print</span><span class="p">(</span><span class="n">file_obj</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
<a id="__codelineno-36-14" name="__codelineno-36-14"></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_obj</span><span class="o">.</span><span class="n">name</span><span class="p">,</span><span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<a id="__codelineno-36-15" name="__codelineno-36-15"></a>            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">file_obj</span><span class="o">.</span><span class="n">chunks</span><span class="p">():</span>  <span class="c1"># 推荐加上chunks方法 其实跟不加是一样的都是一行行的读取</span>
<a id="__codelineno-36-16" name="__codelineno-36-16"></a>                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
<a id="__codelineno-36-17" name="__codelineno-36-17"></a>
<a id="__codelineno-36-18" name="__codelineno-36-18"></a>    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span><span class="s1">&#39;form.html&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<h3 id="13-4-request对象方法">13-4 request对象方法<a class="headerlink" href="#13-4-request对象方法" title="Permanent link">&para;</a></h3>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-37-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-37-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-37-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-37-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-37-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-37-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-37-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-37-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-37-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-37-10">10</a></span>
<span class="normal"><a href="#__codelineno-37-11">11</a></span>
<span class="normal"><a href="#__codelineno-37-12">12</a></span>
<span class="normal"><a href="#__codelineno-37-13">13</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-37-1" name="__codelineno-37-1"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-37-2" name="__codelineno-37-2"></a><span class="sd">request.method</span>
<a id="__codelineno-37-3" name="__codelineno-37-3"></a><span class="sd">request.POST</span>
<a id="__codelineno-37-4" name="__codelineno-37-4"></a><span class="sd">request.GET</span>
<a id="__codelineno-37-5" name="__codelineno-37-5"></a><span class="sd">request.FILES</span>
<a id="__codelineno-37-6" name="__codelineno-37-6"></a><span class="sd">request.body  # 原生的浏览器发过来的二进制数据  后面详细的讲</span>
<a id="__codelineno-37-7" name="__codelineno-37-7"></a><span class="sd">request.path </span>
<a id="__codelineno-37-8" name="__codelineno-37-8"></a><span class="sd">request.path_info</span>
<a id="__codelineno-37-9" name="__codelineno-37-9"></a><span class="sd">request.get_full_path()  能过获取完整的url及问号后面的参数 </span>
<a id="__codelineno-37-10" name="__codelineno-37-10"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-37-11" name="__codelineno-37-11"></a>    <span class="nb">print</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>  <span class="c1"># /app01/ab_file/</span>
<a id="__codelineno-37-12" name="__codelineno-37-12"></a>    <span class="nb">print</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">path_info</span><span class="p">)</span>  <span class="c1"># /app01/ab_file/</span>
<a id="__codelineno-37-13" name="__codelineno-37-13"></a>    <span class="nb">print</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">get_full_path</span><span class="p">())</span>  <span class="c1"># /app01/ab_file/?username=jason</span>
</code></pre></div></td></tr></table></div>
<h3 id="13-5-fbv与cbv">13-5 FBV与CBV<a class="headerlink" href="#13-5-fbv与cbv" title="Permanent link">&para;</a></h3>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-38-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-38-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-38-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-38-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-38-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-38-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-38-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-38-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-38-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-38-10">10</a></span>
<span class="normal"><a href="#__codelineno-38-11">11</a></span>
<span class="normal"><a href="#__codelineno-38-12">12</a></span>
<span class="normal"><a href="#__codelineno-38-13">13</a></span>
<span class="normal"><a href="#__codelineno-38-14">14</a></span>
<span class="normal"><a href="#__codelineno-38-15">15</a></span>
<span class="normal"><a href="#__codelineno-38-16">16</a></span>
<span class="normal"><a href="#__codelineno-38-17">17</a></span>
<span class="normal"><a href="#__codelineno-38-18">18</a></span>
<span class="normal"><a href="#__codelineno-38-19">19</a></span>
<span class="normal"><a href="#__codelineno-38-20">20</a></span>
<span class="normal"><a href="#__codelineno-38-21">21</a></span>
<span class="normal"><a href="#__codelineno-38-22">22</a></span>
<span class="normal"><a href="#__codelineno-38-23">23</a></span>
<span class="normal"><a href="#__codelineno-38-24">24</a></span>
<span class="normal"><a href="#__codelineno-38-25">25</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-38-1" name="__codelineno-38-1"></a><span class="c1"># 视图函数既可以是函数也可以是类</span>
<a id="__codelineno-38-2" name="__codelineno-38-2"></a><span class="k">def</span><span class="w"> </span><span class="nf">index</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
<a id="__codelineno-38-3" name="__codelineno-38-3"></a>  <span class="k">return</span> <span class="n">HttpResponse</span><span class="p">(</span><span class="s1">&#39;index&#39;</span><span class="p">)</span>
<a id="__codelineno-38-4" name="__codelineno-38-4"></a>
<a id="__codelineno-38-5" name="__codelineno-38-5"></a><span class="c1"># CBV</span>
<a id="__codelineno-38-6" name="__codelineno-38-6"></a>    <span class="c1"># CBV路由</span>
<a id="__codelineno-38-7" name="__codelineno-38-7"></a>    <span class="n">url</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^login/&#39;</span><span class="p">,</span><span class="n">views</span><span class="o">.</span><span class="n">MyLogin</span><span class="o">.</span><span class="n">as_view</span><span class="p">())</span>
<a id="__codelineno-38-8" name="__codelineno-38-8"></a>
<a id="__codelineno-38-9" name="__codelineno-38-9"></a>
<a id="__codelineno-38-10" name="__codelineno-38-10"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.views</span><span class="w"> </span><span class="kn">import</span> <span class="n">View</span>
<a id="__codelineno-38-11" name="__codelineno-38-11"></a><span class="k">class</span><span class="w"> </span><span class="nc">MyLogin</span><span class="p">(</span><span class="n">View</span><span class="p">):</span>
<a id="__codelineno-38-12" name="__codelineno-38-12"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">request</span><span class="p">):</span>
<a id="__codelineno-38-13" name="__codelineno-38-13"></a>        <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span><span class="s1">&#39;form.html&#39;</span><span class="p">)</span>
<a id="__codelineno-38-14" name="__codelineno-38-14"></a>
<a id="__codelineno-38-15" name="__codelineno-38-15"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">post</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">request</span><span class="p">):</span>
<a id="__codelineno-38-16" name="__codelineno-38-16"></a>        <span class="k">return</span> <span class="n">HttpResponse</span><span class="p">(</span><span class="s1">&#39;post方法&#39;</span><span class="p">)</span>
<a id="__codelineno-38-17" name="__codelineno-38-17"></a>
<a id="__codelineno-38-18" name="__codelineno-38-18"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-38-19" name="__codelineno-38-19"></a><span class="sd">FBV和CBV各有千秋</span>
<a id="__codelineno-38-20" name="__codelineno-38-20"></a><span class="sd">CBV特点</span>
<a id="__codelineno-38-21" name="__codelineno-38-21"></a><span class="sd">    能够直接根据请求方式的不同直接匹配到对应的方法执行</span>
<a id="__codelineno-38-22" name="__codelineno-38-22"></a>
<a id="__codelineno-38-23" name="__codelineno-38-23"></a><span class="sd">    内部到底是怎么实现的？</span>
<a id="__codelineno-38-24" name="__codelineno-38-24"></a><span class="sd">        CBV内部源码(******)</span>
<a id="__codelineno-38-25" name="__codelineno-38-25"></a><span class="sd">&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
<h3 id="13-6-cbv源码分析">13-6 CBV源码分析<a class="headerlink" href="#13-6-cbv源码分析" title="Permanent link">&para;</a></h3>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Text Only</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-39-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-39-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-39-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-39-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-39-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-39-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-39-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-39-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-39-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-39-10">10</a></span>
<span class="normal"><a href="#__codelineno-39-11">11</a></span>
<span class="normal"><a href="#__codelineno-39-12">12</a></span>
<span class="normal"><a href="#__codelineno-39-13">13</a></span>
<span class="normal"><a href="#__codelineno-39-14">14</a></span>
<span class="normal"><a href="#__codelineno-39-15">15</a></span>
<span class="normal"><a href="#__codelineno-39-16">16</a></span>
<span class="normal"><a href="#__codelineno-39-17">17</a></span>
<span class="normal"><a href="#__codelineno-39-18">18</a></span>
<span class="normal"><a href="#__codelineno-39-19">19</a></span>
<span class="normal"><a href="#__codelineno-39-20">20</a></span>
<span class="normal"><a href="#__codelineno-39-21">21</a></span>
<span class="normal"><a href="#__codelineno-39-22">22</a></span>
<span class="normal"><a href="#__codelineno-39-23">23</a></span>
<span class="normal"><a href="#__codelineno-39-24">24</a></span>
<span class="normal"><a href="#__codelineno-39-25">25</a></span>
<span class="normal"><a href="#__codelineno-39-26">26</a></span>
<span class="normal"><a href="#__codelineno-39-27">27</a></span>
<span class="normal"><a href="#__codelineno-39-28">28</a></span>
<span class="normal"><a href="#__codelineno-39-29">29</a></span>
<span class="normal"><a href="#__codelineno-39-30">30</a></span>
<span class="normal"><a href="#__codelineno-39-31">31</a></span>
<span class="normal"><a href="#__codelineno-39-32">32</a></span>
<span class="normal"><a href="#__codelineno-39-33">33</a></span>
<span class="normal"><a href="#__codelineno-39-34">34</a></span>
<span class="normal"><a href="#__codelineno-39-35">35</a></span>
<span class="normal"><a href="#__codelineno-39-36">36</a></span>
<span class="normal"><a href="#__codelineno-39-37">37</a></span>
<span class="normal"><a href="#__codelineno-39-38">38</a></span>
<span class="normal"><a href="#__codelineno-39-39">39</a></span>
<span class="normal"><a href="#__codelineno-39-40">40</a></span>
<span class="normal"><a href="#__codelineno-39-41">41</a></span>
<span class="normal"><a href="#__codelineno-39-42">42</a></span>
<span class="normal"><a href="#__codelineno-39-43">43</a></span>
<span class="normal"><a href="#__codelineno-39-44">44</a></span>
<span class="normal"><a href="#__codelineno-39-45">45</a></span>
<span class="normal"><a href="#__codelineno-39-46">46</a></span>
<span class="normal"><a href="#__codelineno-39-47">47</a></span>
<span class="normal"><a href="#__codelineno-39-48">48</a></span>
<span class="normal"><a href="#__codelineno-39-49">49</a></span>
<span class="normal"><a href="#__codelineno-39-50">50</a></span>
<span class="normal"><a href="#__codelineno-39-51">51</a></span>
<span class="normal"><a href="#__codelineno-39-52">52</a></span>
<span class="normal"><a href="#__codelineno-39-53">53</a></span>
<span class="normal"><a href="#__codelineno-39-54">54</a></span>
<span class="normal"><a href="#__codelineno-39-55">55</a></span>
<span class="normal"><a href="#__codelineno-39-56">56</a></span>
<span class="normal"><a href="#__codelineno-39-57">57</a></span>
<span class="normal"><a href="#__codelineno-39-58">58</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-39-1" name="__codelineno-39-1"></a># 你自己不要修改源码 出bug很难找
<a id="__codelineno-39-2" name="__codelineno-39-2"></a>
<a id="__codelineno-39-3" name="__codelineno-39-3"></a># 突破口在urls.py
<a id="__codelineno-39-4" name="__codelineno-39-4"></a>url(r&#39;^login/&#39;,views.MyLogin.as_view())
<a id="__codelineno-39-5" name="__codelineno-39-5"></a># url(r&#39;^login/&#39;,views.view)  FBV一模一样
<a id="__codelineno-39-6" name="__codelineno-39-6"></a># CBV与FBV在路由匹配上本质是一样的 都是路由 对应 函数内存地址
<a id="__codelineno-39-7" name="__codelineno-39-7"></a>&quot;&quot;&quot;
<a id="__codelineno-39-8" name="__codelineno-39-8"></a>函数名/方法名 加括号执行优先级最高
<a id="__codelineno-39-9" name="__codelineno-39-9"></a>猜测
<a id="__codelineno-39-10" name="__codelineno-39-10"></a>    as_view()
<a id="__codelineno-39-11" name="__codelineno-39-11"></a>        要么是被@staicmethod修饰的静态方法
<a id="__codelineno-39-12" name="__codelineno-39-12"></a>        要么是被@classmethod修饰的类方法  正确
<a id="__codelineno-39-13" name="__codelineno-39-13"></a>
<a id="__codelineno-39-14" name="__codelineno-39-14"></a>    @classonlymethod
<a id="__codelineno-39-15" name="__codelineno-39-15"></a>    def as_view(cls, **initkwargs):
<a id="__codelineno-39-16" name="__codelineno-39-16"></a>        pass
<a id="__codelineno-39-17" name="__codelineno-39-17"></a>&quot;&quot;&quot;
<a id="__codelineno-39-18" name="__codelineno-39-18"></a>
<a id="__codelineno-39-19" name="__codelineno-39-19"></a>    @classonlymethod
<a id="__codelineno-39-20" name="__codelineno-39-20"></a>    def as_view(cls, **initkwargs):
<a id="__codelineno-39-21" name="__codelineno-39-21"></a>        &quot;&quot;&quot;
<a id="__codelineno-39-22" name="__codelineno-39-22"></a>        cls就是我们自己写的类   MyCBV
<a id="__codelineno-39-23" name="__codelineno-39-23"></a>        Main entry point for a request-response process.
<a id="__codelineno-39-24" name="__codelineno-39-24"></a>        &quot;&quot;&quot;
<a id="__codelineno-39-25" name="__codelineno-39-25"></a>        def view(request, *args, **kwargs):
<a id="__codelineno-39-26" name="__codelineno-39-26"></a>            self = cls(**initkwargs)  # cls是我们自己写的类
<a id="__codelineno-39-27" name="__codelineno-39-27"></a>            # self = MyLogin(**initkwargs)  产生一个我们自己写的类的对象
<a id="__codelineno-39-28" name="__codelineno-39-28"></a>            return self.dispatch(request, *args, **kwargs)
<a id="__codelineno-39-29" name="__codelineno-39-29"></a>            &quot;&quot;&quot;
<a id="__codelineno-39-30" name="__codelineno-39-30"></a>            以后你们会经常需要看源码 但是在看python源码的时候 一定要时刻提醒自己面向对象属性方法查找顺序
<a id="__codelineno-39-31" name="__codelineno-39-31"></a>                先从对象自己找
<a id="__codelineno-39-32" name="__codelineno-39-32"></a>                再去产生对象的类里面找
<a id="__codelineno-39-33" name="__codelineno-39-33"></a>                之后再去父类找
<a id="__codelineno-39-34" name="__codelineno-39-34"></a>                ...
<a id="__codelineno-39-35" name="__codelineno-39-35"></a>            总结:看源码只要看到了self点一个东西 一定要问你自己当前这个self到底是谁
<a id="__codelineno-39-36" name="__codelineno-39-36"></a>            &quot;&quot;&quot;
<a id="__codelineno-39-37" name="__codelineno-39-37"></a>        return view
<a id="__codelineno-39-38" name="__codelineno-39-38"></a>
<a id="__codelineno-39-39" name="__codelineno-39-39"></a>        # CBV的精髓
<a id="__codelineno-39-40" name="__codelineno-39-40"></a>    def dispatch(self, request, *args, **kwargs):
<a id="__codelineno-39-41" name="__codelineno-39-41"></a>        # 获取当前请求的小写格式 然后比对当前请求方式是否合法
<a id="__codelineno-39-42" name="__codelineno-39-42"></a>        # get请求为例
<a id="__codelineno-39-43" name="__codelineno-39-43"></a>        # post请求
<a id="__codelineno-39-44" name="__codelineno-39-44"></a>        if request.method.lower() in self.http_method_names:
<a id="__codelineno-39-45" name="__codelineno-39-45"></a>            handler = getattr(self, request.method.lower(), self.http_method_not_allowed)
<a id="__codelineno-39-46" name="__codelineno-39-46"></a>            &quot;&quot;&quot;
<a id="__codelineno-39-47" name="__codelineno-39-47"></a>            反射:通过字符串来操作对象的属性或者方法
<a id="__codelineno-39-48" name="__codelineno-39-48"></a>                handler = getattr(自己写的类产生的对象,&#39;get&#39;,当找不到get属性或者方法的时候就会用第三个参数)
<a id="__codelineno-39-49" name="__codelineno-39-49"></a>                handler = 我们自己写的类里面的get方法
<a id="__codelineno-39-50" name="__codelineno-39-50"></a>            &quot;&quot;&quot;
<a id="__codelineno-39-51" name="__codelineno-39-51"></a>        else:
<a id="__codelineno-39-52" name="__codelineno-39-52"></a>            handler = self.http_method_not_allowed
<a id="__codelineno-39-53" name="__codelineno-39-53"></a>        return handler(request, *args, **kwargs)
<a id="__codelineno-39-54" name="__codelineno-39-54"></a>        &quot;&quot;&quot;
<a id="__codelineno-39-55" name="__codelineno-39-55"></a>        自动调用get方法
<a id="__codelineno-39-56" name="__codelineno-39-56"></a>        &quot;&quot;&quot;
<a id="__codelineno-39-57" name="__codelineno-39-57"></a>
<a id="__codelineno-39-58" name="__codelineno-39-58"></a># 要求掌握到不看源码也能够描述出CBV的内部执行流程(******)
</code></pre></div></td></tr></table></div>
<h2 id="14-模板层">14 模板层<a class="headerlink" href="#14-模板层" title="Permanent link">&para;</a></h2>
<h3 id="14-1-模版语法传值">14-1 模版语法传值<a class="headerlink" href="#14-1-模版语法传值" title="Permanent link">&para;</a></h3>
<p>{{}}:变量相关</p>
<p>{%%}:逻辑相关</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-40-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-40-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-40-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-40-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-40-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-40-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-40-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-40-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-40-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-40-10">10</a></span>
<span class="normal"><a href="#__codelineno-40-11">11</a></span>
<span class="normal"><a href="#__codelineno-40-12">12</a></span>
<span class="normal"><a href="#__codelineno-40-13">13</a></span>
<span class="normal"><a href="#__codelineno-40-14">14</a></span>
<span class="normal"><a href="#__codelineno-40-15">15</a></span>
<span class="normal"><a href="#__codelineno-40-16">16</a></span>
<span class="normal"><a href="#__codelineno-40-17">17</a></span>
<span class="normal"><a href="#__codelineno-40-18">18</a></span>
<span class="normal"><a href="#__codelineno-40-19">19</a></span>
<span class="normal"><a href="#__codelineno-40-20">20</a></span>
<span class="normal"><a href="#__codelineno-40-21">21</a></span>
<span class="normal"><a href="#__codelineno-40-22">22</a></span>
<span class="normal"><a href="#__codelineno-40-23">23</a></span>
<span class="normal"><a href="#__codelineno-40-24">24</a></span>
<span class="normal"><a href="#__codelineno-40-25">25</a></span>
<span class="normal"><a href="#__codelineno-40-26">26</a></span>
<span class="normal"><a href="#__codelineno-40-27">27</a></span>
<span class="normal"><a href="#__codelineno-40-28">28</a></span>
<span class="normal"><a href="#__codelineno-40-29">29</a></span>
<span class="normal"><a href="#__codelineno-40-30">30</a></span>
<span class="normal"><a href="#__codelineno-40-31">31</a></span>
<span class="normal"><a href="#__codelineno-40-32">32</a></span>
<span class="normal"><a href="#__codelineno-40-33">33</a></span>
<span class="normal"><a href="#__codelineno-40-34">34</a></span>
<span class="normal"><a href="#__codelineno-40-35">35</a></span>
<span class="normal"><a href="#__codelineno-40-36">36</a></span>
<span class="normal"><a href="#__codelineno-40-37">37</a></span>
<span class="normal"><a href="#__codelineno-40-38">38</a></span>
<span class="normal"><a href="#__codelineno-40-39">39</a></span>
<span class="normal"><a href="#__codelineno-40-40">40</a></span>
<span class="normal"><a href="#__codelineno-40-41">41</a></span>
<span class="normal"><a href="#__codelineno-40-42">42</a></span>
<span class="normal"><a href="#__codelineno-40-43">43</a></span>
<span class="normal"><a href="#__codelineno-40-44">44</a></span>
<span class="normal"><a href="#__codelineno-40-45">45</a></span>
<span class="normal"><a href="#__codelineno-40-46">46</a></span>
<span class="normal"><a href="#__codelineno-40-47">47</a></span>
<span class="normal"><a href="#__codelineno-40-48">48</a></span>
<span class="normal"><a href="#__codelineno-40-49">49</a></span>
<span class="normal"><a href="#__codelineno-40-50">50</a></span>
<span class="normal"><a href="#__codelineno-40-51">51</a></span>
<span class="normal"><a href="#__codelineno-40-52">52</a></span>
<span class="normal"><a href="#__codelineno-40-53">53</a></span>
<span class="normal"><a href="#__codelineno-40-54">54</a></span>
<span class="normal"><a href="#__codelineno-40-55">55</a></span>
<span class="normal"><a href="#__codelineno-40-56">56</a></span>
<span class="normal"><a href="#__codelineno-40-57">57</a></span>
<span class="normal"><a href="#__codelineno-40-58">58</a></span>
<span class="normal"><a href="#__codelineno-40-59">59</a></span>
<span class="normal"><a href="#__codelineno-40-60">60</a></span>
<span class="normal"><a href="#__codelineno-40-61">61</a></span>
<span class="normal"><a href="#__codelineno-40-62">62</a></span>
<span class="normal"><a href="#__codelineno-40-63">63</a></span>
<span class="normal"><a href="#__codelineno-40-64">64</a></span>
<span class="normal"><a href="#__codelineno-40-65">65</a></span>
<span class="normal"><a href="#__codelineno-40-66">66</a></span>
<span class="normal"><a href="#__codelineno-40-67">67</a></span>
<span class="normal"><a href="#__codelineno-40-68">68</a></span>
<span class="normal"><a href="#__codelineno-40-69">69</a></span>
<span class="normal"><a href="#__codelineno-40-70">70</a></span>
<span class="normal"><a href="#__codelineno-40-71">71</a></span>
<span class="normal"><a href="#__codelineno-40-72">72</a></span>
<span class="normal"><a href="#__codelineno-40-73">73</a></span>
<span class="normal"><a href="#__codelineno-40-74">74</a></span>
<span class="normal"><a href="#__codelineno-40-75">75</a></span>
<span class="normal"><a href="#__codelineno-40-76">76</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-40-1" name="__codelineno-40-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">index</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
<a id="__codelineno-40-2" name="__codelineno-40-2"></a>    <span class="c1"># 模版语法可以传递的后端python数据类型</span>
<a id="__codelineno-40-3" name="__codelineno-40-3"></a>    <span class="n">n</span> <span class="o">=</span> <span class="mi">123</span>
<a id="__codelineno-40-4" name="__codelineno-40-4"></a>    <span class="n">f</span> <span class="o">=</span> <span class="mf">11.11</span>
<a id="__codelineno-40-5" name="__codelineno-40-5"></a>    <span class="n">s</span> <span class="o">=</span> <span class="s1">&#39;我也想奔现&#39;</span>
<a id="__codelineno-40-6" name="__codelineno-40-6"></a>    <span class="n">b</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-40-7" name="__codelineno-40-7"></a>    <span class="n">l</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;小红&#39;</span><span class="p">,</span><span class="s1">&#39;姗姗&#39;</span><span class="p">,</span><span class="s1">&#39;花花&#39;</span><span class="p">,</span><span class="s1">&#39;茹茹&#39;</span><span class="p">]</span>
<a id="__codelineno-40-8" name="__codelineno-40-8"></a>    <span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="mi">111</span><span class="p">,</span><span class="mi">222</span><span class="p">,</span><span class="mi">333</span><span class="p">,</span><span class="mi">444</span><span class="p">)</span>
<a id="__codelineno-40-9" name="__codelineno-40-9"></a>    <span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;username&#39;</span><span class="p">:</span><span class="s1">&#39;jason&#39;</span><span class="p">,</span><span class="s1">&#39;age&#39;</span><span class="p">:</span><span class="mi">18</span><span class="p">,</span><span class="s1">&#39;info&#39;</span><span class="p">:</span><span class="s1">&#39;这个人有点意思&#39;</span><span class="p">}</span>
<a id="__codelineno-40-10" name="__codelineno-40-10"></a>    <span class="n">se</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;晶晶&#39;</span><span class="p">,</span><span class="s1">&#39;洋洋&#39;</span><span class="p">,</span><span class="s1">&#39;嘤嘤&#39;</span><span class="p">}</span>
<a id="__codelineno-40-11" name="__codelineno-40-11"></a>
<a id="__codelineno-40-12" name="__codelineno-40-12"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">func</span><span class="p">():</span>
<a id="__codelineno-40-13" name="__codelineno-40-13"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;我被执行了&#39;</span><span class="p">)</span>
<a id="__codelineno-40-14" name="__codelineno-40-14"></a>        <span class="k">return</span> <span class="s1">&#39;你的另一半在等你&#39;</span>
<a id="__codelineno-40-15" name="__codelineno-40-15"></a>
<a id="__codelineno-40-16" name="__codelineno-40-16"></a>    <span class="k">class</span><span class="w"> </span><span class="nc">MyClass</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<a id="__codelineno-40-17" name="__codelineno-40-17"></a>        <span class="k">def</span><span class="w"> </span><span class="nf">get_self</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-40-18" name="__codelineno-40-18"></a>            <span class="k">return</span> <span class="s1">&#39;self&#39;</span>
<a id="__codelineno-40-19" name="__codelineno-40-19"></a>
<a id="__codelineno-40-20" name="__codelineno-40-20"></a>        <span class="nd">@staticmethod</span>
<a id="__codelineno-40-21" name="__codelineno-40-21"></a>        <span class="k">def</span><span class="w"> </span><span class="nf">get_func</span><span class="p">():</span>
<a id="__codelineno-40-22" name="__codelineno-40-22"></a>            <span class="k">return</span> <span class="s1">&#39;func&#39;</span>
<a id="__codelineno-40-23" name="__codelineno-40-23"></a>
<a id="__codelineno-40-24" name="__codelineno-40-24"></a>        <span class="nd">@classmethod</span>
<a id="__codelineno-40-25" name="__codelineno-40-25"></a>        <span class="k">def</span><span class="w"> </span><span class="nf">get_class</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
<a id="__codelineno-40-26" name="__codelineno-40-26"></a>            <span class="k">return</span> <span class="s1">&#39;cls&#39;</span>
<a id="__codelineno-40-27" name="__codelineno-40-27"></a>
<a id="__codelineno-40-28" name="__codelineno-40-28"></a>        <span class="c1"># 对象被展示到html页面上 就类似于执行了打印操作也会触发__str__方法</span>
<a id="__codelineno-40-29" name="__codelineno-40-29"></a>        <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-40-30" name="__codelineno-40-30"></a>            <span class="k">return</span> <span class="s1">&#39;到底会不会？&#39;</span>  
<a id="__codelineno-40-31" name="__codelineno-40-31"></a>
<a id="__codelineno-40-32" name="__codelineno-40-32"></a>    <span class="n">obj</span> <span class="o">=</span> <span class="n">MyClass</span><span class="p">()</span>
<a id="__codelineno-40-33" name="__codelineno-40-33"></a>
<a id="__codelineno-40-34" name="__codelineno-40-34"></a>    <span class="c1"># return render(request,&#39;index.html&#39;,{})  # 一个个传</span>
<a id="__codelineno-40-35" name="__codelineno-40-35"></a>    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span><span class="s1">&#39;index.html&#39;</span><span class="p">,</span><span class="nb">locals</span><span class="p">())</span>
<a id="__codelineno-40-36" name="__codelineno-40-36"></a>
<a id="__codelineno-40-37" name="__codelineno-40-37"></a>
<a id="__codelineno-40-38" name="__codelineno-40-38"></a><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="p">{{</span> <span class="n">n</span> <span class="p">}}</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
<a id="__codelineno-40-39" name="__codelineno-40-39"></a>
<a id="__codelineno-40-40" name="__codelineno-40-40"></a><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="p">{{</span> <span class="n">f</span> <span class="p">}}</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
<a id="__codelineno-40-41" name="__codelineno-40-41"></a>
<a id="__codelineno-40-42" name="__codelineno-40-42"></a><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="p">{{</span> <span class="n">s</span> <span class="p">}}</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
<a id="__codelineno-40-43" name="__codelineno-40-43"></a>
<a id="__codelineno-40-44" name="__codelineno-40-44"></a><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="p">{{</span> <span class="n">b</span> <span class="p">}}</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
<a id="__codelineno-40-45" name="__codelineno-40-45"></a>
<a id="__codelineno-40-46" name="__codelineno-40-46"></a><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="p">{{</span> <span class="n">l</span> <span class="p">}}</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
<a id="__codelineno-40-47" name="__codelineno-40-47"></a>
<a id="__codelineno-40-48" name="__codelineno-40-48"></a><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="p">{{</span> <span class="n">d</span> <span class="p">}}</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
<a id="__codelineno-40-49" name="__codelineno-40-49"></a>
<a id="__codelineno-40-50" name="__codelineno-40-50"></a><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="p">{{</span> <span class="n">t</span> <span class="p">}}</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
<a id="__codelineno-40-51" name="__codelineno-40-51"></a>
<a id="__codelineno-40-52" name="__codelineno-40-52"></a><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="p">{{</span> <span class="n">se</span> <span class="p">}}</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
<a id="__codelineno-40-53" name="__codelineno-40-53"></a>
<a id="__codelineno-40-54" name="__codelineno-40-54"></a><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="n">传递函数名会自动加括号调用</span> <span class="n">但是模版语法不支持给函数传额外的参数</span><span class="p">:{{</span> <span class="n">func</span> <span class="p">}}</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
<a id="__codelineno-40-55" name="__codelineno-40-55"></a>
<a id="__codelineno-40-56" name="__codelineno-40-56"></a><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="n">传类名的时候也会自动加括号调用</span><span class="p">(</span><span class="n">实例化</span><span class="p">){{</span> <span class="n">MyClass</span> <span class="p">}}</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
<a id="__codelineno-40-57" name="__codelineno-40-57"></a>
<a id="__codelineno-40-58" name="__codelineno-40-58"></a><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="n">内部能够自动判断出当前的变量名是否可以加括号调用</span> <span class="n">如果可以就会自动执行</span>  <span class="n">针对的是函数名和类名</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
<a id="__codelineno-40-59" name="__codelineno-40-59"></a>
<a id="__codelineno-40-60" name="__codelineno-40-60"></a><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="p">{{</span> <span class="n">obj</span> <span class="p">}}</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
<a id="__codelineno-40-61" name="__codelineno-40-61"></a>
<a id="__codelineno-40-62" name="__codelineno-40-62"></a><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="p">{{</span> <span class="n">obj</span><span class="o">.</span><span class="n">get_self</span> <span class="p">}}</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
<a id="__codelineno-40-63" name="__codelineno-40-63"></a>
<a id="__codelineno-40-64" name="__codelineno-40-64"></a><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="p">{{</span> <span class="n">obj</span><span class="o">.</span><span class="n">get_func</span> <span class="p">}}</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
<a id="__codelineno-40-65" name="__codelineno-40-65"></a>
<a id="__codelineno-40-66" name="__codelineno-40-66"></a><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="p">{{</span> <span class="n">obj</span><span class="o">.</span><span class="n">get_class</span> <span class="p">}}</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
<a id="__codelineno-40-67" name="__codelineno-40-67"></a>
<a id="__codelineno-40-68" name="__codelineno-40-68"></a>
<a id="__codelineno-40-69" name="__codelineno-40-69"></a><span class="c1"># django模版语法的取值 是固定的格式 只能采用“句点符” .</span>
<a id="__codelineno-40-70" name="__codelineno-40-70"></a><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="p">{{</span> <span class="n">d</span><span class="o">.</span><span class="n">username</span> <span class="p">}}</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
<a id="__codelineno-40-71" name="__codelineno-40-71"></a>
<a id="__codelineno-40-72" name="__codelineno-40-72"></a><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="p">{{</span> <span class="n">l</span><span class="mf">.0</span> <span class="p">}}</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
<a id="__codelineno-40-73" name="__codelineno-40-73"></a>
<a id="__codelineno-40-74" name="__codelineno-40-74"></a><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="p">{{</span> <span class="n">d</span><span class="o">.</span><span class="n">hobby</span><span class="mf">.3</span><span class="o">.</span><span class="n">info</span> <span class="p">}}</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
<a id="__codelineno-40-75" name="__codelineno-40-75"></a>
<a id="__codelineno-40-76" name="__codelineno-40-76"></a><span class="c1"># 即可以点键也可以点索引 还可以两者混</span>
</code></pre></div></td></tr></table></div>
<h3 id="14-2-过滤器">14-2 过滤器<a class="headerlink" href="#14-2-过滤器" title="Permanent link">&para;</a></h3>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-41-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-41-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-41-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-41-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-41-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-41-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-41-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-41-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-41-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-41-10">10</a></span>
<span class="normal"><a href="#__codelineno-41-11">11</a></span>
<span class="normal"><a href="#__codelineno-41-12">12</a></span>
<span class="normal"><a href="#__codelineno-41-13">13</a></span>
<span class="normal"><a href="#__codelineno-41-14">14</a></span>
<span class="normal"><a href="#__codelineno-41-15">15</a></span>
<span class="normal"><a href="#__codelineno-41-16">16</a></span>
<span class="normal"><a href="#__codelineno-41-17">17</a></span>
<span class="normal"><a href="#__codelineno-41-18">18</a></span>
<span class="normal"><a href="#__codelineno-41-19">19</a></span>
<span class="normal"><a href="#__codelineno-41-20">20</a></span>
<span class="normal"><a href="#__codelineno-41-21">21</a></span>
<span class="normal"><a href="#__codelineno-41-22">22</a></span>
<span class="normal"><a href="#__codelineno-41-23">23</a></span>
<span class="normal"><a href="#__codelineno-41-24">24</a></span>
<span class="normal"><a href="#__codelineno-41-25">25</a></span>
<span class="normal"><a href="#__codelineno-41-26">26</a></span>
<span class="normal"><a href="#__codelineno-41-27">27</a></span>
<span class="normal"><a href="#__codelineno-41-28">28</a></span>
<span class="normal"><a href="#__codelineno-41-29">29</a></span>
<span class="normal"><a href="#__codelineno-41-30">30</a></span>
<span class="normal"><a href="#__codelineno-41-31">31</a></span>
<span class="normal"><a href="#__codelineno-41-32">32</a></span>
<span class="normal"><a href="#__codelineno-41-33">33</a></span>
<span class="normal"><a href="#__codelineno-41-34">34</a></span>
<span class="normal"><a href="#__codelineno-41-35">35</a></span>
<span class="normal"><a href="#__codelineno-41-36">36</a></span>
<span class="normal"><a href="#__codelineno-41-37">37</a></span>
<span class="normal"><a href="#__codelineno-41-38">38</a></span>
<span class="normal"><a href="#__codelineno-41-39">39</a></span>
<span class="normal"><a href="#__codelineno-41-40">40</a></span>
<span class="normal"><a href="#__codelineno-41-41">41</a></span>
<span class="normal"><a href="#__codelineno-41-42">42</a></span>
<span class="normal"><a href="#__codelineno-41-43">43</a></span>
<span class="normal"><a href="#__codelineno-41-44">44</a></span>
<span class="normal"><a href="#__codelineno-41-45">45</a></span>
<span class="normal"><a href="#__codelineno-41-46">46</a></span>
<span class="normal"><a href="#__codelineno-41-47">47</a></span>
<span class="normal"><a href="#__codelineno-41-48">48</a></span>
<span class="normal"><a href="#__codelineno-41-49">49</a></span>
<span class="normal"><a href="#__codelineno-41-50">50</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-41-1" name="__codelineno-41-1"></a><span class="c1"># 过滤器就类似于是模版语法内置的 内置方法</span>
<a id="__codelineno-41-2" name="__codelineno-41-2"></a><span class="c1"># django内置有60多个过滤器 我们不需要学这么多 了解10个左右就差不多了 后面碰到了再去记忆</span>
<a id="__codelineno-41-3" name="__codelineno-41-3"></a>
<a id="__codelineno-41-4" name="__codelineno-41-4"></a>
<a id="__codelineno-41-5" name="__codelineno-41-5"></a>
<a id="__codelineno-41-6" name="__codelineno-41-6"></a><span class="c1"># 基本语法</span>
<a id="__codelineno-41-7" name="__codelineno-41-7"></a><span class="p">{{</span><span class="n">数据</span><span class="o">|</span><span class="n">过滤器</span><span class="p">:</span><span class="n">参数</span><span class="p">}}</span>
<a id="__codelineno-41-8" name="__codelineno-41-8"></a>
<a id="__codelineno-41-9" name="__codelineno-41-9"></a><span class="c1"># 转义</span>
<a id="__codelineno-41-10" name="__codelineno-41-10"></a><span class="c1"># 前端</span>
<a id="__codelineno-41-11" name="__codelineno-41-11"></a>    <span class="o">|</span><span class="n">safe</span>
<a id="__codelineno-41-12" name="__codelineno-41-12"></a><span class="c1"># 后端</span>
<a id="__codelineno-41-13" name="__codelineno-41-13"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.utils.safestring</span><span class="w"> </span><span class="kn">import</span> <span class="n">mark_safe</span>
<a id="__codelineno-41-14" name="__codelineno-41-14"></a> <span class="n">res</span> <span class="o">=</span> <span class="n">mark_safe</span><span class="p">(</span><span class="s1">&#39;&lt;h1&gt;新新&lt;/h1&gt;&#39;</span><span class="p">)</span>
<a id="__codelineno-41-15" name="__codelineno-41-15"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-41-16" name="__codelineno-41-16"></a><span class="sd">以后你在全栈项目的时候 前端代码不一定非要在前端页面书写</span>
<a id="__codelineno-41-17" name="__codelineno-41-17"></a><span class="sd">也可以现在先在后端写好 然后传递给前端页面</span>
<a id="__codelineno-41-18" name="__codelineno-41-18"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-41-19" name="__codelineno-41-19"></a>
<a id="__codelineno-41-20" name="__codelineno-41-20"></a>
<a id="__codelineno-41-21" name="__codelineno-41-21"></a><span class="o">&lt;</span><span class="n">h1</span><span class="o">&gt;</span><span class="n">过滤器</span><span class="o">&lt;/</span><span class="n">h1</span><span class="o">&gt;</span>
<a id="__codelineno-41-22" name="__codelineno-41-22"></a>
<a id="__codelineno-41-23" name="__codelineno-41-23"></a><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="n">统计长度</span><span class="p">:{{</span> <span class="n">s</span><span class="o">|</span><span class="n">length</span> <span class="p">}}</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
<a id="__codelineno-41-24" name="__codelineno-41-24"></a>
<a id="__codelineno-41-25" name="__codelineno-41-25"></a><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="n">默认值</span><span class="p">(</span><span class="n">第一个参数布尔值是True就展示第一个参数的值否在展示冒号后面的值</span><span class="p">):{{</span> <span class="n">b</span><span class="o">|</span><span class="n">default</span><span class="p">:</span><span class="s1">&#39;啥也不是&#39;</span> <span class="p">}}</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
<a id="__codelineno-41-26" name="__codelineno-41-26"></a>
<a id="__codelineno-41-27" name="__codelineno-41-27"></a><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="n">文件大小</span><span class="p">:{{</span> <span class="n">file_size</span><span class="o">|</span><span class="n">filesizeformat</span> <span class="p">}}</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
<a id="__codelineno-41-28" name="__codelineno-41-28"></a>
<a id="__codelineno-41-29" name="__codelineno-41-29"></a><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="n">日期格式化</span><span class="p">:{{</span> <span class="n">current_time</span><span class="o">|</span><span class="n">date</span><span class="p">:</span><span class="s1">&#39;Y-m-d H:i:s&#39;</span> <span class="p">}}</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
<a id="__codelineno-41-30" name="__codelineno-41-30"></a>
<a id="__codelineno-41-31" name="__codelineno-41-31"></a><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="n">切片操作</span><span class="p">(</span><span class="n">支持步长</span><span class="p">):{{</span> <span class="n">l</span><span class="o">|</span><span class="nb">slice</span><span class="p">:</span><span class="s1">&#39;0:4:2&#39;</span> <span class="p">}}</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
<a id="__codelineno-41-32" name="__codelineno-41-32"></a>
<a id="__codelineno-41-33" name="__codelineno-41-33"></a><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="n">切取字符</span><span class="p">(</span><span class="n">包含三个点</span><span class="p">):{{</span> <span class="n">info</span><span class="o">|</span><span class="n">truncatechars</span><span class="p">:</span><span class="mi">9</span> <span class="p">}}</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
<a id="__codelineno-41-34" name="__codelineno-41-34"></a>
<a id="__codelineno-41-35" name="__codelineno-41-35"></a><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="n">切取单词</span><span class="p">(</span><span class="n">不包含三个点</span> <span class="n">按照空格切</span><span class="p">):{{</span> <span class="n">egl</span><span class="o">|</span><span class="n">truncatewords</span><span class="p">:</span><span class="mi">9</span> <span class="p">}}</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
<a id="__codelineno-41-36" name="__codelineno-41-36"></a>
<a id="__codelineno-41-37" name="__codelineno-41-37"></a><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="n">切取单词</span><span class="p">(</span><span class="n">不包含三个点</span> <span class="n">按照空格切</span><span class="p">):{{</span> <span class="n">info</span><span class="o">|</span><span class="n">truncatewords</span><span class="p">:</span><span class="mi">9</span> <span class="p">}}</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
<a id="__codelineno-41-38" name="__codelineno-41-38"></a>
<a id="__codelineno-41-39" name="__codelineno-41-39"></a><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="n">移除特定的字符</span><span class="p">:{{</span> <span class="n">msg</span><span class="o">|</span><span class="n">cut</span><span class="p">:</span><span class="s1">&#39; &#39;</span> <span class="p">}}</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
<a id="__codelineno-41-40" name="__codelineno-41-40"></a>
<a id="__codelineno-41-41" name="__codelineno-41-41"></a><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="n">拼接操作</span><span class="p">:{{</span> <span class="n">l</span><span class="o">|</span><span class="n">join</span><span class="p">:</span><span class="s1">&#39;$&#39;</span> <span class="p">}}</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
<a id="__codelineno-41-42" name="__codelineno-41-42"></a>
<a id="__codelineno-41-43" name="__codelineno-41-43"></a><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="n">拼接操作</span><span class="p">(</span><span class="n">加法</span><span class="p">):{{</span> <span class="n">n</span><span class="o">|</span><span class="n">add</span><span class="p">:</span><span class="mi">10</span> <span class="p">}}</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
<a id="__codelineno-41-44" name="__codelineno-41-44"></a>
<a id="__codelineno-41-45" name="__codelineno-41-45"></a><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="n">拼接操作</span><span class="p">(</span><span class="n">加法</span><span class="p">):{{</span> <span class="n">s</span><span class="o">|</span><span class="n">add</span><span class="p">:</span><span class="n">msg</span> <span class="p">}}</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
<a id="__codelineno-41-46" name="__codelineno-41-46"></a>
<a id="__codelineno-41-47" name="__codelineno-41-47"></a><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="n">取消转义</span><span class="p">:{{</span> <span class="n">hhh</span><span class="o">|</span><span class="n">safe</span> <span class="p">}}</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>  <span class="c1">## 取消对html标签的转义</span>
<a id="__codelineno-41-48" name="__codelineno-41-48"></a><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="n">转义</span><span class="p">:{{</span> <span class="n">sss</span><span class="o">|</span><span class="n">safe</span> <span class="p">}}</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
<a id="__codelineno-41-49" name="__codelineno-41-49"></a>
<a id="__codelineno-41-50" name="__codelineno-41-50"></a><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="n">转义</span><span class="p">:{{</span> <span class="n">res</span> <span class="p">}}</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</code></pre></div></td></tr></table></div>
<h3 id="14-3-标签">14-3 标签<a class="headerlink" href="#14-3-标签" title="Permanent link">&para;</a></h3>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-42-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-42-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-42-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-42-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-42-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-42-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-42-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-42-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-42-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-42-10">10</a></span>
<span class="normal"><a href="#__codelineno-42-11">11</a></span>
<span class="normal"><a href="#__codelineno-42-12">12</a></span>
<span class="normal"><a href="#__codelineno-42-13">13</a></span>
<span class="normal"><a href="#__codelineno-42-14">14</a></span>
<span class="normal"><a href="#__codelineno-42-15">15</a></span>
<span class="normal"><a href="#__codelineno-42-16">16</a></span>
<span class="normal"><a href="#__codelineno-42-17">17</a></span>
<span class="normal"><a href="#__codelineno-42-18">18</a></span>
<span class="normal"><a href="#__codelineno-42-19">19</a></span>
<span class="normal"><a href="#__codelineno-42-20">20</a></span>
<span class="normal"><a href="#__codelineno-42-21">21</a></span>
<span class="normal"><a href="#__codelineno-42-22">22</a></span>
<span class="normal"><a href="#__codelineno-42-23">23</a></span>
<span class="normal"><a href="#__codelineno-42-24">24</a></span>
<span class="normal"><a href="#__codelineno-42-25">25</a></span>
<span class="normal"><a href="#__codelineno-42-26">26</a></span>
<span class="normal"><a href="#__codelineno-42-27">27</a></span>
<span class="normal"><a href="#__codelineno-42-28">28</a></span>
<span class="normal"><a href="#__codelineno-42-29">29</a></span>
<span class="normal"><a href="#__codelineno-42-30">30</a></span>
<span class="normal"><a href="#__codelineno-42-31">31</a></span>
<span class="normal"><a href="#__codelineno-42-32">32</a></span>
<span class="normal"><a href="#__codelineno-42-33">33</a></span>
<span class="normal"><a href="#__codelineno-42-34">34</a></span>
<span class="normal"><a href="#__codelineno-42-35">35</a></span>
<span class="normal"><a href="#__codelineno-42-36">36</a></span>
<span class="normal"><a href="#__codelineno-42-37">37</a></span>
<span class="normal"><a href="#__codelineno-42-38">38</a></span>
<span class="normal"><a href="#__codelineno-42-39">39</a></span>
<span class="normal"><a href="#__codelineno-42-40">40</a></span>
<span class="normal"><a href="#__codelineno-42-41">41</a></span>
<span class="normal"><a href="#__codelineno-42-42">42</a></span>
<span class="normal"><a href="#__codelineno-42-43">43</a></span>
<span class="normal"><a href="#__codelineno-42-44">44</a></span>
<span class="normal"><a href="#__codelineno-42-45">45</a></span>
<span class="normal"><a href="#__codelineno-42-46">46</a></span>
<span class="normal"><a href="#__codelineno-42-47">47</a></span>
<span class="normal"><a href="#__codelineno-42-48">48</a></span>
<span class="normal"><a href="#__codelineno-42-49">49</a></span>
<span class="normal"><a href="#__codelineno-42-50">50</a></span>
<span class="normal"><a href="#__codelineno-42-51">51</a></span>
<span class="normal"><a href="#__codelineno-42-52">52</a></span>
<span class="normal"><a href="#__codelineno-42-53">53</a></span>
<span class="normal"><a href="#__codelineno-42-54">54</a></span>
<span class="normal"><a href="#__codelineno-42-55">55</a></span>
<span class="normal"><a href="#__codelineno-42-56">56</a></span>
<span class="normal"><a href="#__codelineno-42-57">57</a></span>
<span class="normal"><a href="#__codelineno-42-58">58</a></span>
<span class="normal"><a href="#__codelineno-42-59">59</a></span>
<span class="normal"><a href="#__codelineno-42-60">60</a></span>
<span class="normal"><a href="#__codelineno-42-61">61</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-42-1" name="__codelineno-42-1"></a><span class="c1"># for循环</span>
<a id="__codelineno-42-2" name="__codelineno-42-2"></a>    <span class="p">{</span><span class="o">%</span> <span class="k">for</span> <span class="n">foo</span> <span class="ow">in</span> <span class="n">l</span> <span class="o">%</span><span class="p">}</span>
<a id="__codelineno-42-3" name="__codelineno-42-3"></a>    <span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="p">{{</span> <span class="n">forloop</span> <span class="p">}}</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
<a id="__codelineno-42-4" name="__codelineno-42-4"></a>
<a id="__codelineno-42-5" name="__codelineno-42-5"></a>    <span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="p">{{</span> <span class="n">foo</span> <span class="p">}}</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>  <span class="n">一个个元素</span>
<a id="__codelineno-42-6" name="__codelineno-42-6"></a>    <span class="p">{</span><span class="o">%</span> <span class="n">endfor</span> <span class="o">%</span><span class="p">}</span>
<a id="__codelineno-42-7" name="__codelineno-42-7"></a>  <span class="p">{</span><span class="s1">&#39;parentloop&#39;</span><span class="p">:</span> <span class="p">{},</span> <span class="s1">&#39;counter0&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;counter&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;revcounter&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;revcounter0&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;first&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;last&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}</span>
<a id="__codelineno-42-8" name="__codelineno-42-8"></a>
<a id="__codelineno-42-9" name="__codelineno-42-9"></a><span class="c1"># if判断</span>
<a id="__codelineno-42-10" name="__codelineno-42-10"></a><span class="p">{</span><span class="o">%</span> <span class="k">if</span> <span class="n">b</span> <span class="o">%</span><span class="p">}</span>
<a id="__codelineno-42-11" name="__codelineno-42-11"></a>    <span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="n">baby</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
<a id="__codelineno-42-12" name="__codelineno-42-12"></a>
<a id="__codelineno-42-13" name="__codelineno-42-13"></a><span class="p">{</span><span class="o">%</span> <span class="k">elif</span> <span class="n">s</span><span class="o">%</span><span class="p">}</span>
<a id="__codelineno-42-14" name="__codelineno-42-14"></a>    <span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="n">都来把</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
<a id="__codelineno-42-15" name="__codelineno-42-15"></a>
<a id="__codelineno-42-16" name="__codelineno-42-16"></a><span class="p">{</span><span class="o">%</span> <span class="k">else</span> <span class="o">%</span><span class="p">}</span>
<a id="__codelineno-42-17" name="__codelineno-42-17"></a>    <span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="n">老baby</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
<a id="__codelineno-42-18" name="__codelineno-42-18"></a>
<a id="__codelineno-42-19" name="__codelineno-42-19"></a><span class="p">{</span><span class="o">%</span> <span class="n">endif</span> <span class="o">%</span><span class="p">}</span>
<a id="__codelineno-42-20" name="__codelineno-42-20"></a>
<a id="__codelineno-42-21" name="__codelineno-42-21"></a>
<a id="__codelineno-42-22" name="__codelineno-42-22"></a><span class="c1"># for与if混合使用</span>
<a id="__codelineno-42-23" name="__codelineno-42-23"></a><span class="p">{</span><span class="o">%</span> <span class="k">for</span> <span class="n">foo</span> <span class="ow">in</span> <span class="n">lll</span> <span class="o">%</span><span class="p">}</span>
<a id="__codelineno-42-24" name="__codelineno-42-24"></a>    <span class="p">{</span><span class="o">%</span> <span class="k">if</span> <span class="n">forloop</span><span class="o">.</span><span class="n">first</span> <span class="o">%</span><span class="p">}</span>
<a id="__codelineno-42-25" name="__codelineno-42-25"></a>        <span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="n">这是我的第一次</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
<a id="__codelineno-42-26" name="__codelineno-42-26"></a>
<a id="__codelineno-42-27" name="__codelineno-42-27"></a>    <span class="p">{</span><span class="o">%</span> <span class="k">elif</span> <span class="n">forloop</span><span class="o">.</span><span class="n">last</span> <span class="o">%</span><span class="p">}</span>
<a id="__codelineno-42-28" name="__codelineno-42-28"></a>        <span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="n">这是最后一次啊</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
<a id="__codelineno-42-29" name="__codelineno-42-29"></a>
<a id="__codelineno-42-30" name="__codelineno-42-30"></a>    <span class="p">{</span><span class="o">%</span> <span class="k">else</span> <span class="o">%</span><span class="p">}</span>
<a id="__codelineno-42-31" name="__codelineno-42-31"></a>        <span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="p">{{</span> <span class="n">foo</span> <span class="p">}}</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
<a id="__codelineno-42-32" name="__codelineno-42-32"></a>
<a id="__codelineno-42-33" name="__codelineno-42-33"></a>    <span class="p">{</span><span class="o">%</span> <span class="n">endif</span> <span class="o">%</span><span class="p">}</span>
<a id="__codelineno-42-34" name="__codelineno-42-34"></a>    <span class="p">{</span><span class="o">%</span> <span class="n">empty</span> <span class="o">%</span><span class="p">}</span>
<a id="__codelineno-42-35" name="__codelineno-42-35"></a>        <span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="n">for循环的可迭代对象内部没有元素</span> <span class="n">根本没法循环</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
<a id="__codelineno-42-36" name="__codelineno-42-36"></a>
<a id="__codelineno-42-37" name="__codelineno-42-37"></a><span class="p">{</span><span class="o">%</span> <span class="n">endfor</span> <span class="o">%</span><span class="p">}</span>
<a id="__codelineno-42-38" name="__codelineno-42-38"></a><span class="n">s</span>
<a id="__codelineno-42-39" name="__codelineno-42-39"></a><span class="c1"># 处理字典其他方法</span>
<a id="__codelineno-42-40" name="__codelineno-42-40"></a><span class="p">{</span><span class="o">%</span> <span class="k">for</span> <span class="n">foo</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">keys</span> <span class="o">%</span><span class="p">}</span>
<a id="__codelineno-42-41" name="__codelineno-42-41"></a>    <span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="p">{{</span> <span class="n">foo</span> <span class="p">}}</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
<a id="__codelineno-42-42" name="__codelineno-42-42"></a>
<a id="__codelineno-42-43" name="__codelineno-42-43"></a><span class="p">{</span><span class="o">%</span> <span class="n">endfor</span> <span class="o">%</span><span class="p">}</span>
<a id="__codelineno-42-44" name="__codelineno-42-44"></a><span class="p">{</span><span class="o">%</span> <span class="k">for</span> <span class="n">foo</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">values</span> <span class="o">%</span><span class="p">}</span>
<a id="__codelineno-42-45" name="__codelineno-42-45"></a>    <span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="p">{{</span> <span class="n">foo</span> <span class="p">}}</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
<a id="__codelineno-42-46" name="__codelineno-42-46"></a>
<a id="__codelineno-42-47" name="__codelineno-42-47"></a><span class="p">{</span><span class="o">%</span> <span class="n">endfor</span> <span class="o">%</span><span class="p">}</span>
<a id="__codelineno-42-48" name="__codelineno-42-48"></a><span class="p">{</span><span class="o">%</span> <span class="k">for</span> <span class="n">foo</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">items</span> <span class="o">%</span><span class="p">}</span>
<a id="__codelineno-42-49" name="__codelineno-42-49"></a>    <span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="p">{{</span> <span class="n">foo</span> <span class="p">}}</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
<a id="__codelineno-42-50" name="__codelineno-42-50"></a>
<a id="__codelineno-42-51" name="__codelineno-42-51"></a><span class="p">{</span><span class="o">%</span> <span class="n">endfor</span> <span class="o">%</span><span class="p">}</span>
<a id="__codelineno-42-52" name="__codelineno-42-52"></a>
<a id="__codelineno-42-53" name="__codelineno-42-53"></a>
<a id="__codelineno-42-54" name="__codelineno-42-54"></a><span class="c1"># with起别名</span>
<a id="__codelineno-42-55" name="__codelineno-42-55"></a><span class="p">{</span><span class="o">%</span> <span class="k">with</span> <span class="n">d</span><span class="o">.</span><span class="n">hobby</span><span class="mf">.3</span><span class="o">.</span><span class="n">info</span> <span class="k">as</span> <span class="n">nb</span>  <span class="o">%</span><span class="p">}</span>
<a id="__codelineno-42-56" name="__codelineno-42-56"></a>    <span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="p">{{</span> <span class="n">nb</span> <span class="p">}}</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
<a id="__codelineno-42-57" name="__codelineno-42-57"></a>
<a id="__codelineno-42-58" name="__codelineno-42-58"></a>    <span class="n">在with语法内就可以通过as后面的别名快速的使用到前面非常复杂获取数据的方式</span>
<a id="__codelineno-42-59" name="__codelineno-42-59"></a>    <span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="p">{{</span> <span class="n">d</span><span class="o">.</span><span class="n">hobby</span><span class="mf">.3</span><span class="o">.</span><span class="n">info</span> <span class="p">}}</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
<a id="__codelineno-42-60" name="__codelineno-42-60"></a>
<a id="__codelineno-42-61" name="__codelineno-42-61"></a><span class="p">{</span><span class="o">%</span> <span class="n">endwith</span> <span class="o">%</span><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<h3 id="14-4-自定义过滤器标签inclusion_tag">14-4 自定义过滤器、标签、inclusion_tag<a class="headerlink" href="#14-4-自定义过滤器标签inclusion_tag" title="Permanent link">&para;</a></h3>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-43-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-43-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-43-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-43-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-43-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-43-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-43-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-43-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-43-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-43-10">10</a></span>
<span class="normal"><a href="#__codelineno-43-11">11</a></span>
<span class="normal"><a href="#__codelineno-43-12">12</a></span>
<span class="normal"><a href="#__codelineno-43-13">13</a></span>
<span class="normal"><a href="#__codelineno-43-14">14</a></span>
<span class="normal"><a href="#__codelineno-43-15">15</a></span>
<span class="normal"><a href="#__codelineno-43-16">16</a></span>
<span class="normal"><a href="#__codelineno-43-17">17</a></span>
<span class="normal"><a href="#__codelineno-43-18">18</a></span>
<span class="normal"><a href="#__codelineno-43-19">19</a></span>
<span class="normal"><a href="#__codelineno-43-20">20</a></span>
<span class="normal"><a href="#__codelineno-43-21">21</a></span>
<span class="normal"><a href="#__codelineno-43-22">22</a></span>
<span class="normal"><a href="#__codelineno-43-23">23</a></span>
<span class="normal"><a href="#__codelineno-43-24">24</a></span>
<span class="normal"><a href="#__codelineno-43-25">25</a></span>
<span class="normal"><a href="#__codelineno-43-26">26</a></span>
<span class="normal"><a href="#__codelineno-43-27">27</a></span>
<span class="normal"><a href="#__codelineno-43-28">28</a></span>
<span class="normal"><a href="#__codelineno-43-29">29</a></span>
<span class="normal"><a href="#__codelineno-43-30">30</a></span>
<span class="normal"><a href="#__codelineno-43-31">31</a></span>
<span class="normal"><a href="#__codelineno-43-32">32</a></span>
<span class="normal"><a href="#__codelineno-43-33">33</a></span>
<span class="normal"><a href="#__codelineno-43-34">34</a></span>
<span class="normal"><a href="#__codelineno-43-35">35</a></span>
<span class="normal"><a href="#__codelineno-43-36">36</a></span>
<span class="normal"><a href="#__codelineno-43-37">37</a></span>
<span class="normal"><a href="#__codelineno-43-38">38</a></span>
<span class="normal"><a href="#__codelineno-43-39">39</a></span>
<span class="normal"><a href="#__codelineno-43-40">40</a></span>
<span class="normal"><a href="#__codelineno-43-41">41</a></span>
<span class="normal"><a href="#__codelineno-43-42">42</a></span>
<span class="normal"><a href="#__codelineno-43-43">43</a></span>
<span class="normal"><a href="#__codelineno-43-44">44</a></span>
<span class="normal"><a href="#__codelineno-43-45">45</a></span>
<span class="normal"><a href="#__codelineno-43-46">46</a></span>
<span class="normal"><a href="#__codelineno-43-47">47</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-43-1" name="__codelineno-43-1"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-43-2" name="__codelineno-43-2"></a><span class="sd">先三步走</span>
<a id="__codelineno-43-3" name="__codelineno-43-3"></a><span class="sd">    1.在应用下创建一个名字”必须“叫templatetags文件夹</span>
<a id="__codelineno-43-4" name="__codelineno-43-4"></a><span class="sd">    2.在该文件夹内创建“任意”名称的py文件 eg:mytag.py</span>
<a id="__codelineno-43-5" name="__codelineno-43-5"></a><span class="sd">    3.在该py文件内&quot;必须&quot;先书写下面两句话(单词一个都不能错)</span>
<a id="__codelineno-43-6" name="__codelineno-43-6"></a><span class="sd">        from django import template</span>
<a id="__codelineno-43-7" name="__codelineno-43-7"></a>
<a id="__codelineno-43-8" name="__codelineno-43-8"></a><span class="sd">        register = template.Library()</span>
<a id="__codelineno-43-9" name="__codelineno-43-9"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-43-10" name="__codelineno-43-10"></a>
<a id="__codelineno-43-11" name="__codelineno-43-11"></a><span class="c1"># 自定义过滤器</span>
<a id="__codelineno-43-12" name="__codelineno-43-12"></a><span class="nd">@register</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;baby&#39;</span><span class="p">)</span>
<a id="__codelineno-43-13" name="__codelineno-43-13"></a><span class="k">def</span><span class="w"> </span><span class="nf">my_sum</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="p">):</span>
<a id="__codelineno-43-14" name="__codelineno-43-14"></a>    <span class="k">return</span> <span class="n">v1</span> <span class="o">+</span> <span class="n">v2</span>
<a id="__codelineno-43-15" name="__codelineno-43-15"></a><span class="c1"># 使用</span>
<a id="__codelineno-43-16" name="__codelineno-43-16"></a><span class="p">{</span><span class="o">%</span> <span class="n">load</span> <span class="n">mytag</span> <span class="o">%</span><span class="p">}</span>
<a id="__codelineno-43-17" name="__codelineno-43-17"></a><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="p">{{</span> <span class="n">n</span><span class="o">|</span><span class="n">baby</span><span class="p">:</span><span class="mi">666</span> <span class="p">}}</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
<a id="__codelineno-43-18" name="__codelineno-43-18"></a>
<a id="__codelineno-43-19" name="__codelineno-43-19"></a>
<a id="__codelineno-43-20" name="__codelineno-43-20"></a><span class="c1"># 自定义标签(参数可以有多个)            类似于自定义函数</span>
<a id="__codelineno-43-21" name="__codelineno-43-21"></a><span class="nd">@register</span><span class="o">.</span><span class="n">simple_tag</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;plus&#39;</span><span class="p">)</span>
<a id="__codelineno-43-22" name="__codelineno-43-22"></a><span class="k">def</span><span class="w"> </span><span class="nf">index</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">d</span><span class="p">):</span>
<a id="__codelineno-43-23" name="__codelineno-43-23"></a>    <span class="k">return</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">-</span><span class="si">%s</span><span class="s1">-</span><span class="si">%s</span><span class="s1">-</span><span class="si">%s</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">d</span><span class="p">)</span>
<a id="__codelineno-43-24" name="__codelineno-43-24"></a><span class="c1"># 使用</span>
<a id="__codelineno-43-25" name="__codelineno-43-25"></a><span class="n">标签多个参数彼此之间空格隔开</span>
<a id="__codelineno-43-26" name="__codelineno-43-26"></a><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="p">{</span><span class="o">%</span> <span class="n">plus</span> <span class="s1">&#39;jason&#39;</span> <span class="mi">123</span> <span class="mi">123</span> <span class="mi">123</span> <span class="o">%</span><span class="p">}</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
<a id="__codelineno-43-27" name="__codelineno-43-27"></a>
<a id="__codelineno-43-28" name="__codelineno-43-28"></a>
<a id="__codelineno-43-29" name="__codelineno-43-29"></a><span class="c1"># 自定义inclusion_tag</span>
<a id="__codelineno-43-30" name="__codelineno-43-30"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-43-31" name="__codelineno-43-31"></a><span class="sd">内部原理</span>
<a id="__codelineno-43-32" name="__codelineno-43-32"></a><span class="sd">    先定义一个方法 </span>
<a id="__codelineno-43-33" name="__codelineno-43-33"></a><span class="sd">    在页面上调用该方法 并且可以传值</span>
<a id="__codelineno-43-34" name="__codelineno-43-34"></a><span class="sd">    该方法会生成一些数据然后传递给一个html页面</span>
<a id="__codelineno-43-35" name="__codelineno-43-35"></a><span class="sd">    之后将渲染好的结果放到调用的位置</span>
<a id="__codelineno-43-36" name="__codelineno-43-36"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-43-37" name="__codelineno-43-37"></a><span class="nd">@register</span><span class="o">.</span><span class="n">inclusion_tag</span><span class="p">(</span><span class="s1">&#39;left_menu.html&#39;</span><span class="p">)</span>
<a id="__codelineno-43-38" name="__codelineno-43-38"></a><span class="k">def</span><span class="w"> </span><span class="nf">left</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
<a id="__codelineno-43-39" name="__codelineno-43-39"></a>    <span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;第</span><span class="si">{}</span><span class="s1">项&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)]</span>
<a id="__codelineno-43-40" name="__codelineno-43-40"></a>    <span class="c1"># 第一种</span>
<a id="__codelineno-43-41" name="__codelineno-43-41"></a>    <span class="c1"># return {&#39;data&#39;:data}  # 将data传递给left_menu.html</span>
<a id="__codelineno-43-42" name="__codelineno-43-42"></a>    <span class="c1"># 第二种</span>
<a id="__codelineno-43-43" name="__codelineno-43-43"></a>    <span class="k">return</span> <span class="nb">locals</span><span class="p">()</span>  <span class="c1"># 将data传递给left_menu.html</span>
<a id="__codelineno-43-44" name="__codelineno-43-44"></a>
<a id="__codelineno-43-45" name="__codelineno-43-45"></a><span class="p">{</span><span class="o">%</span> <span class="n">left</span> <span class="mi">5</span> <span class="o">%</span><span class="p">}</span>
<a id="__codelineno-43-46" name="__codelineno-43-46"></a><span class="c1"># 总结:当html页面某一个地方的页面需要传参数才能够动态的渲染出来，并且在多个页面上都需要使用到该局部 那么就考虑将该局部页面做成inclusion_tag形式</span>
<a id="__codelineno-43-47" name="__codelineno-43-47"></a><span class="p">(</span><span class="n">在讲bbs的时候会使用到</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<h3 id="14-5-模板的继承">14-5 模板的继承<a class="headerlink" href="#14-5-模板的继承" title="Permanent link">&para;</a></h3>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Text Only</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-44-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-44-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-44-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-44-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-44-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-44-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-44-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-44-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-44-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-44-10">10</a></span>
<span class="normal"><a href="#__codelineno-44-11">11</a></span>
<span class="normal"><a href="#__codelineno-44-12">12</a></span>
<span class="normal"><a href="#__codelineno-44-13">13</a></span>
<span class="normal"><a href="#__codelineno-44-14">14</a></span>
<span class="normal"><a href="#__codelineno-44-15">15</a></span>
<span class="normal"><a href="#__codelineno-44-16">16</a></span>
<span class="normal"><a href="#__codelineno-44-17">17</a></span>
<span class="normal"><a href="#__codelineno-44-18">18</a></span>
<span class="normal"><a href="#__codelineno-44-19">19</a></span>
<span class="normal"><a href="#__codelineno-44-20">20</a></span>
<span class="normal"><a href="#__codelineno-44-21">21</a></span>
<span class="normal"><a href="#__codelineno-44-22">22</a></span>
<span class="normal"><a href="#__codelineno-44-23">23</a></span>
<span class="normal"><a href="#__codelineno-44-24">24</a></span>
<span class="normal"><a href="#__codelineno-44-25">25</a></span>
<span class="normal"><a href="#__codelineno-44-26">26</a></span>
<span class="normal"><a href="#__codelineno-44-27">27</a></span>
<span class="normal"><a href="#__codelineno-44-28">28</a></span>
<span class="normal"><a href="#__codelineno-44-29">29</a></span>
<span class="normal"><a href="#__codelineno-44-30">30</a></span>
<span class="normal"><a href="#__codelineno-44-31">31</a></span>
<span class="normal"><a href="#__codelineno-44-32">32</a></span>
<span class="normal"><a href="#__codelineno-44-33">33</a></span>
<span class="normal"><a href="#__codelineno-44-34">34</a></span>
<span class="normal"><a href="#__codelineno-44-35">35</a></span>
<span class="normal"><a href="#__codelineno-44-36">36</a></span>
<span class="normal"><a href="#__codelineno-44-37">37</a></span>
<span class="normal"><a href="#__codelineno-44-38">38</a></span>
<span class="normal"><a href="#__codelineno-44-39">39</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-44-1" name="__codelineno-44-1"></a>&quot;&quot;&quot;
<a id="__codelineno-44-2" name="__codelineno-44-2"></a>你们有没有见过一些网站
<a id="__codelineno-44-3" name="__codelineno-44-3"></a>    这些网站页面整体都大差不差 只是某一些局部在做变化   
<a id="__codelineno-44-4" name="__codelineno-44-4"></a>&quot;&quot;&quot;
<a id="__codelineno-44-5" name="__codelineno-44-5"></a># 模版的继承 你自己先选好一个你要想继承的模版页面
<a id="__codelineno-44-6" name="__codelineno-44-6"></a>{% extends &#39;home.html&#39; %}
<a id="__codelineno-44-7" name="__codelineno-44-7"></a>
<a id="__codelineno-44-8" name="__codelineno-44-8"></a># 继承了之后子页面跟模版页面长的是一模一样的 你需要在模版页面上提前划定可以被修改的区域
<a id="__codelineno-44-9" name="__codelineno-44-9"></a>{% block content %}
<a id="__codelineno-44-10" name="__codelineno-44-10"></a>    模版内容
<a id="__codelineno-44-11" name="__codelineno-44-11"></a>{% endblock %}
<a id="__codelineno-44-12" name="__codelineno-44-12"></a>
<a id="__codelineno-44-13" name="__codelineno-44-13"></a># 子页面就可以声明想要修改哪块划定了的区域
<a id="__codelineno-44-14" name="__codelineno-44-14"></a>{% block content %}
<a id="__codelineno-44-15" name="__codelineno-44-15"></a>    子页面内容   
<a id="__codelineno-44-16" name="__codelineno-44-16"></a>{% endblock %}
<a id="__codelineno-44-17" name="__codelineno-44-17"></a>
<a id="__codelineno-44-18" name="__codelineno-44-18"></a>
<a id="__codelineno-44-19" name="__codelineno-44-19"></a># 一般情况下模版页面上应该至少有三块可以被修改的区域
<a id="__codelineno-44-20" name="__codelineno-44-20"></a>    1.css区域
<a id="__codelineno-44-21" name="__codelineno-44-21"></a>  2.html区域
<a id="__codelineno-44-22" name="__codelineno-44-22"></a>  3.js区域
<a id="__codelineno-44-23" name="__codelineno-44-23"></a>  {% block css %}
<a id="__codelineno-44-24" name="__codelineno-44-24"></a>
<a id="__codelineno-44-25" name="__codelineno-44-25"></a>  {% endblock %}
<a id="__codelineno-44-26" name="__codelineno-44-26"></a>
<a id="__codelineno-44-27" name="__codelineno-44-27"></a>  {% block content %}
<a id="__codelineno-44-28" name="__codelineno-44-28"></a>
<a id="__codelineno-44-29" name="__codelineno-44-29"></a>  {% endblock %}
<a id="__codelineno-44-30" name="__codelineno-44-30"></a>
<a id="__codelineno-44-31" name="__codelineno-44-31"></a>  {% block js %}
<a id="__codelineno-44-32" name="__codelineno-44-32"></a>
<a id="__codelineno-44-33" name="__codelineno-44-33"></a>  {% endblock %}
<a id="__codelineno-44-34" name="__codelineno-44-34"></a>  # 每一个子页面就都可以有自己独有的css代码 html代码 js代码
<a id="__codelineno-44-35" name="__codelineno-44-35"></a>
<a id="__codelineno-44-36" name="__codelineno-44-36"></a>&quot;&quot;&quot;
<a id="__codelineno-44-37" name="__codelineno-44-37"></a>一般情况下 模版的页面上划定的区域越多 那么该模版的扩展性就越高
<a id="__codelineno-44-38" name="__codelineno-44-38"></a>但是如果太多 那还不如自己直接写
<a id="__codelineno-44-39" name="__codelineno-44-39"></a>&quot;&quot;&quot;
</code></pre></div></td></tr></table></div>
<p>模版的导入</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Text Only</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-45-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-45-1" name="__codelineno-45-1"></a>{% include &#39;模版文件名&#39; %}
</code></pre></div></td></tr></table></div>
<h2 id="15-模型层">15 模型层<a class="headerlink" href="#15-模型层" title="Permanent link">&para;</a></h2>
<h3 id="15-1-单表操作">15-1 单表操作<a class="headerlink" href="#15-1-单表操作" title="Permanent link">&para;</a></h3>
<h4 id="15-1-1-增">15-1-1 增<a class="headerlink" href="#15-1-1-增" title="Permanent link">&para;</a></h4>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-46-1">1</a></span>
<span class="normal"><a href="#__codelineno-46-2">2</a></span>
<span class="normal"><a href="#__codelineno-46-3">3</a></span>
<span class="normal"><a href="#__codelineno-46-4">4</a></span>
<span class="normal"><a href="#__codelineno-46-5">5</a></span>
<span class="normal"><a href="#__codelineno-46-6">6</a></span>
<span class="normal"><a href="#__codelineno-46-7">7</a></span>
<span class="normal"><a href="#__codelineno-46-8">8</a></span>
<span class="normal"><a href="#__codelineno-46-9">9</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-46-1" name="__codelineno-46-1"></a><span class="c1"># django自带的sqlite3数据库对日期格式不是很敏感 处理的时候容易出错</span>
<a id="__codelineno-46-2" name="__codelineno-46-2"></a><span class="c1"># 增</span>
<a id="__codelineno-46-3" name="__codelineno-46-3"></a>    <span class="n">res</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">User</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;jason&#39;</span><span class="p">,</span><span class="n">age</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span><span class="n">register_time</span><span class="o">=</span><span class="s1">&#39;2002-1-21&#39;</span><span class="p">)</span>
<a id="__codelineno-46-4" name="__codelineno-46-4"></a>    <span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
<a id="__codelineno-46-5" name="__codelineno-46-5"></a>
<a id="__codelineno-46-6" name="__codelineno-46-6"></a>    <span class="kn">import</span><span class="w"> </span><span class="nn">datetime</span>
<a id="__codelineno-46-7" name="__codelineno-46-7"></a>    <span class="n">ctime</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
<a id="__codelineno-46-8" name="__codelineno-46-8"></a>    <span class="n">user_obj</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">User</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;egon&#39;</span><span class="p">,</span><span class="n">age</span><span class="o">=</span><span class="mi">84</span><span class="p">,</span><span class="n">register_time</span><span class="o">=</span><span class="n">ctime</span><span class="p">)</span>
<a id="__codelineno-46-9" name="__codelineno-46-9"></a>    <span class="n">user_obj</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
<h4 id="15-1-2-删">15-1-2 删<a class="headerlink" href="#15-1-2-删" title="Permanent link">&para;</a></h4>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Text Only</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-47-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-47-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-47-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-47-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-47-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-47-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-47-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-47-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-47-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-47-10">10</a></span>
<span class="normal"><a href="#__codelineno-47-11">11</a></span>
<span class="normal"><a href="#__codelineno-47-12">12</a></span>
<span class="normal"><a href="#__codelineno-47-13">13</a></span>
<span class="normal"><a href="#__codelineno-47-14">14</a></span>
<span class="normal"><a href="#__codelineno-47-15">15</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-47-1" name="__codelineno-47-1"></a># 删
<a id="__codelineno-47-2" name="__codelineno-47-2"></a>    res = models.User.objects.filter(pk=2).delete()
<a id="__codelineno-47-3" name="__codelineno-47-3"></a>    print(res)
<a id="__codelineno-47-4" name="__codelineno-47-4"></a>    &quot;&quot;&quot;
<a id="__codelineno-47-5" name="__codelineno-47-5"></a>    pk会自动查找到当前表的主键字段 指代的就是当前表的主键字段
<a id="__codelineno-47-6" name="__codelineno-47-6"></a>    用了pk之后 你就不需要指代当前表的主键字段到底叫什么了
<a id="__codelineno-47-7" name="__codelineno-47-7"></a>        uid
<a id="__codelineno-47-8" name="__codelineno-47-8"></a>        pid
<a id="__codelineno-47-9" name="__codelineno-47-9"></a>        sid
<a id="__codelineno-47-10" name="__codelineno-47-10"></a>        ...
<a id="__codelineno-47-11" name="__codelineno-47-11"></a>    &quot;&quot;&quot;
<a id="__codelineno-47-12" name="__codelineno-47-12"></a>    ## 先拿到当前用户对象
<a id="__codelineno-47-13" name="__codelineno-47-13"></a>    user_obj = models.User.objects.filter(pk=1).first()
<a id="__codelineno-47-14" name="__codelineno-47-14"></a>    ## 再对这个用户对象进行删除
<a id="__codelineno-47-15" name="__codelineno-47-15"></a>    user_obj.delete()
</code></pre></div></td></tr></table></div>
<h4 id="15-1-3-修改">15-1-3 修改<a class="headerlink" href="#15-1-3-修改" title="Permanent link">&para;</a></h4>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Text Only</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-48-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-48-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-48-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-48-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-48-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-48-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-48-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-48-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-48-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-48-10">10</a></span>
<span class="normal"><a href="#__codelineno-48-11">11</a></span>
<span class="normal"><a href="#__codelineno-48-12">12</a></span>
<span class="normal"><a href="#__codelineno-48-13">13</a></span>
<span class="normal"><a href="#__codelineno-48-14">14</a></span>
<span class="normal"><a href="#__codelineno-48-15">15</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-48-1" name="__codelineno-48-1"></a># 修改
<a id="__codelineno-48-2" name="__codelineno-48-2"></a>    models.User.objects.filter(pk=4).update(name=&#39;egonDSB&#39;)
<a id="__codelineno-48-3" name="__codelineno-48-3"></a>
<a id="__codelineno-48-4" name="__codelineno-48-4"></a>    ## 直接拿到当前数据对象，但是该方法不推荐使用，如果数据不存在则直接报错
<a id="__codelineno-48-5" name="__codelineno-48-5"></a>    user_obj = models.User.objects.get(pk=4)
<a id="__codelineno-48-6" name="__codelineno-48-6"></a>    user_obj = models.User.objects.filter(pk=6)
<a id="__codelineno-48-7" name="__codelineno-48-7"></a>    &quot;&quot;&quot;
<a id="__codelineno-48-8" name="__codelineno-48-8"></a>    get方法返回的直接就是当前数据对象
<a id="__codelineno-48-9" name="__codelineno-48-9"></a>    但是该方法不推荐使用
<a id="__codelineno-48-10" name="__codelineno-48-10"></a>        一旦数据不存在该方法会直接报错
<a id="__codelineno-48-11" name="__codelineno-48-11"></a>        而filter则不会
<a id="__codelineno-48-12" name="__codelineno-48-12"></a>            所以我们还是用filter
<a id="__codelineno-48-13" name="__codelineno-48-13"></a>    &quot;&quot;&quot;
<a id="__codelineno-48-14" name="__codelineno-48-14"></a>    user_obj.name = &#39;egonPPP&#39;
<a id="__codelineno-48-15" name="__codelineno-48-15"></a>    user_obj.save()
</code></pre></div></td></tr></table></div>
<h3 id="15-2-必知必会13条">15-2 必知必会13条<a class="headerlink" href="#15-2-必知必会13条" title="Permanent link">&para;</a></h3>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-49-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-49-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-49-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-49-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-49-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-49-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-49-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-49-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-49-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-49-10">10</a></span>
<span class="normal"><a href="#__codelineno-49-11">11</a></span>
<span class="normal"><a href="#__codelineno-49-12">12</a></span>
<span class="normal"><a href="#__codelineno-49-13">13</a></span>
<span class="normal"><a href="#__codelineno-49-14">14</a></span>
<span class="normal"><a href="#__codelineno-49-15">15</a></span>
<span class="normal"><a href="#__codelineno-49-16">16</a></span>
<span class="normal"><a href="#__codelineno-49-17">17</a></span>
<span class="normal"><a href="#__codelineno-49-18">18</a></span>
<span class="normal"><a href="#__codelineno-49-19">19</a></span>
<span class="normal"><a href="#__codelineno-49-20">20</a></span>
<span class="normal"><a href="#__codelineno-49-21">21</a></span>
<span class="normal"><a href="#__codelineno-49-22">22</a></span>
<span class="normal"><a href="#__codelineno-49-23">23</a></span>
<span class="normal"><a href="#__codelineno-49-24">24</a></span>
<span class="normal"><a href="#__codelineno-49-25">25</a></span>
<span class="normal"><a href="#__codelineno-49-26">26</a></span>
<span class="normal"><a href="#__codelineno-49-27">27</a></span>
<span class="normal"><a href="#__codelineno-49-28">28</a></span>
<span class="normal"><a href="#__codelineno-49-29">29</a></span>
<span class="normal"><a href="#__codelineno-49-30">30</a></span>
<span class="normal"><a href="#__codelineno-49-31">31</a></span>
<span class="normal"><a href="#__codelineno-49-32">32</a></span>
<span class="normal"><a href="#__codelineno-49-33">33</a></span>
<span class="normal"><a href="#__codelineno-49-34">34</a></span>
<span class="normal"><a href="#__codelineno-49-35">35</a></span>
<span class="normal"><a href="#__codelineno-49-36">36</a></span>
<span class="normal"><a href="#__codelineno-49-37">37</a></span>
<span class="normal"><a href="#__codelineno-49-38">38</a></span>
<span class="normal"><a href="#__codelineno-49-39">39</a></span>
<span class="normal"><a href="#__codelineno-49-40">40</a></span>
<span class="normal"><a href="#__codelineno-49-41">41</a></span>
<span class="normal"><a href="#__codelineno-49-42">42</a></span>
<span class="normal"><a href="#__codelineno-49-43">43</a></span>
<span class="normal"><a href="#__codelineno-49-44">44</a></span>
<span class="normal"><a href="#__codelineno-49-45">45</a></span>
<span class="normal"><a href="#__codelineno-49-46">46</a></span>
<span class="normal"><a href="#__codelineno-49-47">47</a></span>
<span class="normal"><a href="#__codelineno-49-48">48</a></span>
<span class="normal"><a href="#__codelineno-49-49">49</a></span>
<span class="normal"><a href="#__codelineno-49-50">50</a></span>
<span class="normal"><a href="#__codelineno-49-51">51</a></span>
<span class="normal"><a href="#__codelineno-49-52">52</a></span>
<span class="normal"><a href="#__codelineno-49-53">53</a></span>
<span class="normal"><a href="#__codelineno-49-54">54</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-49-1" name="__codelineno-49-1"></a><span class="c1"># 必知必会13条</span>
<a id="__codelineno-49-2" name="__codelineno-49-2"></a>    <span class="mf">1.</span><span class="n">all</span><span class="p">()</span>  <span class="c1">## 查询所有数据</span>
<a id="__codelineno-49-3" name="__codelineno-49-3"></a>
<a id="__codelineno-49-4" name="__codelineno-49-4"></a>    <span class="mf">2.</span><span class="n">filter</span><span class="p">()</span>     <span class="c1">## 带有过滤条件的查询</span>
<a id="__codelineno-49-5" name="__codelineno-49-5"></a>    <span class="mf">3.</span><span class="n">get</span><span class="p">()</span>        <span class="c1">## 直接拿数据对象 但是条件不存在直接报错</span>
<a id="__codelineno-49-6" name="__codelineno-49-6"></a>    <span class="mf">4.</span><span class="n">first</span><span class="p">()</span>      <span class="c1">## 拿queryset里面第一个元素</span>
<a id="__codelineno-49-7" name="__codelineno-49-7"></a>        <span class="n">res</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">User</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">()</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
<a id="__codelineno-49-8" name="__codelineno-49-8"></a>        <span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
<a id="__codelineno-49-9" name="__codelineno-49-9"></a>
<a id="__codelineno-49-10" name="__codelineno-49-10"></a>    <span class="mf">5.</span><span class="n">last</span><span class="p">()</span>
<a id="__codelineno-49-11" name="__codelineno-49-11"></a>        <span class="n">res</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">User</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">()</span><span class="o">.</span><span class="n">last</span><span class="p">()</span>
<a id="__codelineno-49-12" name="__codelineno-49-12"></a>        <span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
<a id="__codelineno-49-13" name="__codelineno-49-13"></a>
<a id="__codelineno-49-14" name="__codelineno-49-14"></a>    <span class="mf">6.</span><span class="n">values</span><span class="p">()</span>  <span class="c1">## 可以指定获取的数据字段  select name,age from ...     列表套字典</span>
<a id="__codelineno-49-15" name="__codelineno-49-15"></a>        <span class="n">res</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">User</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">values</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span><span class="s1">&#39;age&#39;</span><span class="p">)</span>  
<a id="__codelineno-49-16" name="__codelineno-49-16"></a>        <span class="c1"># &lt;QuerySet [{&#39;name&#39;: &#39;jason&#39;, &#39;age&#39;: 18}, {&#39;name&#39;: &#39;egonPPP&#39;, &#39;age&#39;: 84}]&gt;</span>
<a id="__codelineno-49-17" name="__codelineno-49-17"></a>        <span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
<a id="__codelineno-49-18" name="__codelineno-49-18"></a>
<a id="__codelineno-49-19" name="__codelineno-49-19"></a>    <span class="mf">7.</span><span class="n">values_list</span><span class="p">()</span>  <span class="c1">## 列表套元祖</span>
<a id="__codelineno-49-20" name="__codelineno-49-20"></a>        <span class="n">res</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">User</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">values_list</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span><span class="s1">&#39;age&#39;</span><span class="p">)</span>  
<a id="__codelineno-49-21" name="__codelineno-49-21"></a>        <span class="c1"># &lt;QuerySet [(&#39;jason&#39;, 18), (&#39;egonPPP&#39;, 84)]&gt;</span>
<a id="__codelineno-49-22" name="__codelineno-49-22"></a>        <span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
<a id="__codelineno-49-23" name="__codelineno-49-23"></a><span class="w">     </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-49-24" name="__codelineno-49-24"></a><span class="sd">     查看内部封装的sql语句</span>
<a id="__codelineno-49-25" name="__codelineno-49-25"></a><span class="sd">     上述查看sql语句的方式  只能用于queryset对象</span>
<a id="__codelineno-49-26" name="__codelineno-49-26"></a><span class="sd">     只有queryset对象才能够点击query查看内部的sql语句</span>
<a id="__codelineno-49-27" name="__codelineno-49-27"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-49-28" name="__codelineno-49-28"></a>    <span class="mf">8.</span><span class="n">distinct</span><span class="p">()</span>  <span class="c1">## 去重</span>
<a id="__codelineno-49-29" name="__codelineno-49-29"></a>        <span class="n">res</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">User</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">values</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span><span class="s1">&#39;age&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">distinct</span><span class="p">()</span>
<a id="__codelineno-49-30" name="__codelineno-49-30"></a>        <span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
<a id="__codelineno-49-31" name="__codelineno-49-31"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-49-32" name="__codelineno-49-32"></a><span class="sd">    去重一定要是一模一样的数据</span>
<a id="__codelineno-49-33" name="__codelineno-49-33"></a><span class="sd">    如果带有主键那么肯定不一样 你在往后的查询中一定不要忽略主键</span>
<a id="__codelineno-49-34" name="__codelineno-49-34"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-49-35" name="__codelineno-49-35"></a>    <span class="mf">9.</span><span class="n">order_by</span><span class="p">()</span>
<a id="__codelineno-49-36" name="__codelineno-49-36"></a>        <span class="n">res</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">User</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="s1">&#39;age&#39;</span><span class="p">)</span>  <span class="c1"># 默认升序</span>
<a id="__codelineno-49-37" name="__codelineno-49-37"></a>        <span class="n">res</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">User</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="s1">&#39;-age&#39;</span><span class="p">)</span>  <span class="c1"># 降序</span>
<a id="__codelineno-49-38" name="__codelineno-49-38"></a>          <span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
<a id="__codelineno-49-39" name="__codelineno-49-39"></a>    <span class="mf">10.</span><span class="n">reverse</span><span class="p">()</span>  <span class="c1">## 反转的前提是 数据已经排过序了  order_by()</span>
<a id="__codelineno-49-40" name="__codelineno-49-40"></a>        <span class="n">res</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">User</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
<a id="__codelineno-49-41" name="__codelineno-49-41"></a>        <span class="n">res1</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">User</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="s1">&#39;age&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
<a id="__codelineno-49-42" name="__codelineno-49-42"></a>        <span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="p">,</span><span class="n">res1</span><span class="p">)</span>
<a id="__codelineno-49-43" name="__codelineno-49-43"></a>
<a id="__codelineno-49-44" name="__codelineno-49-44"></a>    <span class="mf">11.</span><span class="n">count</span><span class="p">()</span>  <span class="c1">## 统计当前数据的个数</span>
<a id="__codelineno-49-45" name="__codelineno-49-45"></a>        <span class="n">res</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">User</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
<a id="__codelineno-49-46" name="__codelineno-49-46"></a>        <span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
<a id="__codelineno-49-47" name="__codelineno-49-47"></a>
<a id="__codelineno-49-48" name="__codelineno-49-48"></a>    <span class="n">exclude</span><span class="p">()</span>  <span class="c1">## 排除在外</span>
<a id="__codelineno-49-49" name="__codelineno-49-49"></a>        <span class="n">res</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">User</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">exclude</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;jason&#39;</span><span class="p">)</span>
<a id="__codelineno-49-50" name="__codelineno-49-50"></a>        <span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
<a id="__codelineno-49-51" name="__codelineno-49-51"></a>
<a id="__codelineno-49-52" name="__codelineno-49-52"></a>    <span class="mf">13.</span><span class="n">exists</span><span class="p">()</span>  <span class="c1">## 基本用不到因为数据本身就自带布尔值  返回的是布尔值</span>
<a id="__codelineno-49-53" name="__codelineno-49-53"></a>        <span class="n">res</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">User</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span>
<a id="__codelineno-49-54" name="__codelineno-49-54"></a>        <span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<h3 id="15-3-查看内部sql语句的方式">15-3 查看内部sql语句的方式<a class="headerlink" href="#15-3-查看内部sql语句的方式" title="Permanent link">&para;</a></h3>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-50-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-50-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-50-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-50-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-50-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-50-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-50-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-50-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-50-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-50-10">10</a></span>
<span class="normal"><a href="#__codelineno-50-11">11</a></span>
<span class="normal"><a href="#__codelineno-50-12">12</a></span>
<span class="normal"><a href="#__codelineno-50-13">13</a></span>
<span class="normal"><a href="#__codelineno-50-14">14</a></span>
<span class="normal"><a href="#__codelineno-50-15">15</a></span>
<span class="normal"><a href="#__codelineno-50-16">16</a></span>
<span class="normal"><a href="#__codelineno-50-17">17</a></span>
<span class="normal"><a href="#__codelineno-50-18">18</a></span>
<span class="normal"><a href="#__codelineno-50-19">19</a></span>
<span class="normal"><a href="#__codelineno-50-20">20</a></span>
<span class="normal"><a href="#__codelineno-50-21">21</a></span>
<span class="normal"><a href="#__codelineno-50-22">22</a></span>
<span class="normal"><a href="#__codelineno-50-23">23</a></span>
<span class="normal"><a href="#__codelineno-50-24">24</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-50-1" name="__codelineno-50-1"></a><span class="c1"># 方式1</span>
<a id="__codelineno-50-2" name="__codelineno-50-2"></a><span class="n">res</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">User</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">values_list</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span><span class="s1">&#39;age&#39;</span><span class="p">)</span>  <span class="c1"># &lt;QuerySet [(&#39;jason&#39;, 18), (&#39;egonPPP&#39;, 84)]&gt;</span>
<a id="__codelineno-50-3" name="__codelineno-50-3"></a><span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">query</span><span class="p">)</span>
<a id="__codelineno-50-4" name="__codelineno-50-4"></a><span class="n">queryset对象才能够点击query查看内部的sql语句</span>
<a id="__codelineno-50-5" name="__codelineno-50-5"></a>
<a id="__codelineno-50-6" name="__codelineno-50-6"></a><span class="c1"># 方式2:所有的sql语句都能查看</span>
<a id="__codelineno-50-7" name="__codelineno-50-7"></a><span class="c1"># 去配置文件中配置一下即可</span>
<a id="__codelineno-50-8" name="__codelineno-50-8"></a><span class="n">LOGGING</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-50-9" name="__codelineno-50-9"></a>    <span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
<a id="__codelineno-50-10" name="__codelineno-50-10"></a>    <span class="s1">&#39;disable_existing_loggers&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-50-11" name="__codelineno-50-11"></a>    <span class="s1">&#39;handlers&#39;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-50-12" name="__codelineno-50-12"></a>        <span class="s1">&#39;console&#39;</span><span class="p">:{</span>
<a id="__codelineno-50-13" name="__codelineno-50-13"></a>            <span class="s1">&#39;level&#39;</span><span class="p">:</span><span class="s1">&#39;DEBUG&#39;</span><span class="p">,</span>
<a id="__codelineno-50-14" name="__codelineno-50-14"></a>            <span class="s1">&#39;class&#39;</span><span class="p">:</span><span class="s1">&#39;logging.StreamHandler&#39;</span><span class="p">,</span>
<a id="__codelineno-50-15" name="__codelineno-50-15"></a>        <span class="p">},</span>
<a id="__codelineno-50-16" name="__codelineno-50-16"></a>    <span class="p">},</span>
<a id="__codelineno-50-17" name="__codelineno-50-17"></a>    <span class="s1">&#39;loggers&#39;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-50-18" name="__codelineno-50-18"></a>        <span class="s1">&#39;django.db.backends&#39;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-50-19" name="__codelineno-50-19"></a>            <span class="s1">&#39;handlers&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;console&#39;</span><span class="p">],</span>
<a id="__codelineno-50-20" name="__codelineno-50-20"></a>            <span class="s1">&#39;propagate&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-50-21" name="__codelineno-50-21"></a>            <span class="s1">&#39;level&#39;</span><span class="p">:</span><span class="s1">&#39;DEBUG&#39;</span><span class="p">,</span>
<a id="__codelineno-50-22" name="__codelineno-50-22"></a>        <span class="p">},</span>
<a id="__codelineno-50-23" name="__codelineno-50-23"></a>    <span class="p">}</span>
<a id="__codelineno-50-24" name="__codelineno-50-24"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<h3 id="15-4-测试脚本">15-4 测试脚本<a class="headerlink" href="#15-4-测试脚本" title="Permanent link">&para;</a></h3>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-51-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-51-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-51-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-51-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-51-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-51-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-51-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-51-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-51-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-51-10">10</a></span>
<span class="normal"><a href="#__codelineno-51-11">11</a></span>
<span class="normal"><a href="#__codelineno-51-12">12</a></span>
<span class="normal"><a href="#__codelineno-51-13">13</a></span>
<span class="normal"><a href="#__codelineno-51-14">14</a></span>
<span class="normal"><a href="#__codelineno-51-15">15</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-51-1" name="__codelineno-51-1"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-51-2" name="__codelineno-51-2"></a><span class="sd">当你只是想测试django中的某一个py文件内容 那么你可以不用书写前后端交互的形式</span>
<a id="__codelineno-51-3" name="__codelineno-51-3"></a><span class="sd">而是直接写一个测试脚本即可</span>
<a id="__codelineno-51-4" name="__codelineno-51-4"></a>
<a id="__codelineno-51-5" name="__codelineno-51-5"></a><span class="sd">脚本代码无论是写在应用下的tests.py还是自己单独开设py文件都可以</span>
<a id="__codelineno-51-6" name="__codelineno-51-6"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-51-7" name="__codelineno-51-7"></a><span class="c1"># 测试环境的准备 去manage.py中拷贝前四行代码 然后自己写两行</span>
<a id="__codelineno-51-8" name="__codelineno-51-8"></a><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<a id="__codelineno-51-9" name="__codelineno-51-9"></a><span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
<a id="__codelineno-51-10" name="__codelineno-51-10"></a>
<a id="__codelineno-51-11" name="__codelineno-51-11"></a><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
<a id="__codelineno-51-12" name="__codelineno-51-12"></a>    <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s2">&quot;DJANGO_SETTINGS_MODULE&quot;</span><span class="p">,</span> <span class="s2">&quot;day64.settings&quot;</span><span class="p">)</span>
<a id="__codelineno-51-13" name="__codelineno-51-13"></a>    <span class="kn">import</span><span class="w"> </span><span class="nn">django</span>
<a id="__codelineno-51-14" name="__codelineno-51-14"></a>    <span class="n">django</span><span class="o">.</span><span class="n">setup</span><span class="p">()</span>
<a id="__codelineno-51-15" name="__codelineno-51-15"></a>    <span class="c1"># 在这个代码块的下面就可以测试django里面的单个py文件了</span>
</code></pre></div></td></tr></table></div>
<h3 id="15-5-神奇的双下划线查询">15-5 神奇的双下划线查询<a class="headerlink" href="#15-5-神奇的双下划线查询" title="Permanent link">&para;</a></h3>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-52-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-52-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-52-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-52-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-52-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-52-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-52-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-52-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-52-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-52-10">10</a></span>
<span class="normal"><a href="#__codelineno-52-11">11</a></span>
<span class="normal"><a href="#__codelineno-52-12">12</a></span>
<span class="normal"><a href="#__codelineno-52-13">13</a></span>
<span class="normal"><a href="#__codelineno-52-14">14</a></span>
<span class="normal"><a href="#__codelineno-52-15">15</a></span>
<span class="normal"><a href="#__codelineno-52-16">16</a></span>
<span class="normal"><a href="#__codelineno-52-17">17</a></span>
<span class="normal"><a href="#__codelineno-52-18">18</a></span>
<span class="normal"><a href="#__codelineno-52-19">19</a></span>
<span class="normal"><a href="#__codelineno-52-20">20</a></span>
<span class="normal"><a href="#__codelineno-52-21">21</a></span>
<span class="normal"><a href="#__codelineno-52-22">22</a></span>
<span class="normal"><a href="#__codelineno-52-23">23</a></span>
<span class="normal"><a href="#__codelineno-52-24">24</a></span>
<span class="normal"><a href="#__codelineno-52-25">25</a></span>
<span class="normal"><a href="#__codelineno-52-26">26</a></span>
<span class="normal"><a href="#__codelineno-52-27">27</a></span>
<span class="normal"><a href="#__codelineno-52-28">28</a></span>
<span class="normal"><a href="#__codelineno-52-29">29</a></span>
<span class="normal"><a href="#__codelineno-52-30">30</a></span>
<span class="normal"><a href="#__codelineno-52-31">31</a></span>
<span class="normal"><a href="#__codelineno-52-32">32</a></span>
<span class="normal"><a href="#__codelineno-52-33">33</a></span>
<span class="normal"><a href="#__codelineno-52-34">34</a></span>
<span class="normal"><a href="#__codelineno-52-35">35</a></span>
<span class="normal"><a href="#__codelineno-52-36">36</a></span>
<span class="normal"><a href="#__codelineno-52-37">37</a></span>
<span class="normal"><a href="#__codelineno-52-38">38</a></span>
<span class="normal"><a href="#__codelineno-52-39">39</a></span>
<span class="normal"><a href="#__codelineno-52-40">40</a></span>
<span class="normal"><a href="#__codelineno-52-41">41</a></span>
<span class="normal"><a href="#__codelineno-52-42">42</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-52-1" name="__codelineno-52-1"></a><span class="c1">## 神奇的双下划线查询</span>
<a id="__codelineno-52-2" name="__codelineno-52-2"></a>    <span class="c1"># 年龄大于35岁的数据</span>
<a id="__codelineno-52-3" name="__codelineno-52-3"></a>        <span class="n">res</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">User</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">age__gt</span><span class="o">=</span><span class="mi">35</span><span class="p">)</span>
<a id="__codelineno-52-4" name="__codelineno-52-4"></a>        <span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
<a id="__codelineno-52-5" name="__codelineno-52-5"></a>    <span class="c1"># 年龄小于35岁的数据</span>
<a id="__codelineno-52-6" name="__codelineno-52-6"></a>        <span class="n">res</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">User</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">age__lt</span><span class="o">=</span><span class="mi">35</span><span class="p">)</span>
<a id="__codelineno-52-7" name="__codelineno-52-7"></a>        <span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
<a id="__codelineno-52-8" name="__codelineno-52-8"></a>
<a id="__codelineno-52-9" name="__codelineno-52-9"></a>    <span class="c1">## 大于等于 小于等于</span>
<a id="__codelineno-52-10" name="__codelineno-52-10"></a>        <span class="n">res</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">User</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">age__gte</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>
<a id="__codelineno-52-11" name="__codelineno-52-11"></a>        <span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
<a id="__codelineno-52-12" name="__codelineno-52-12"></a>        <span class="n">res</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">User</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">age__lte</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>
<a id="__codelineno-52-13" name="__codelineno-52-13"></a>        <span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
<a id="__codelineno-52-14" name="__codelineno-52-14"></a>
<a id="__codelineno-52-15" name="__codelineno-52-15"></a>    <span class="c1">## 年龄是18 或者 32 或者40</span>
<a id="__codelineno-52-16" name="__codelineno-52-16"></a>        <span class="n">res</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">User</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">age__in</span><span class="o">=</span><span class="p">[</span><span class="mi">18</span><span class="p">,</span><span class="mi">32</span><span class="p">,</span><span class="mi">40</span><span class="p">])</span>
<a id="__codelineno-52-17" name="__codelineno-52-17"></a>        <span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
<a id="__codelineno-52-18" name="__codelineno-52-18"></a>
<a id="__codelineno-52-19" name="__codelineno-52-19"></a>    <span class="c1">## 年龄在18到40岁之间的  首尾都要</span>
<a id="__codelineno-52-20" name="__codelineno-52-20"></a>        <span class="n">res</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">User</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">age__range</span><span class="o">=</span><span class="p">[</span><span class="mi">18</span><span class="p">,</span><span class="mi">40</span><span class="p">])</span>
<a id="__codelineno-52-21" name="__codelineno-52-21"></a>        <span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
<a id="__codelineno-52-22" name="__codelineno-52-22"></a>
<a id="__codelineno-52-23" name="__codelineno-52-23"></a>    <span class="c1">## 查询出名字里面含有s的数据  模糊查询</span>
<a id="__codelineno-52-24" name="__codelineno-52-24"></a>        <span class="n">res</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">User</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">name__contains</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">)</span>
<a id="__codelineno-52-25" name="__codelineno-52-25"></a>        <span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
<a id="__codelineno-52-26" name="__codelineno-52-26"></a>
<a id="__codelineno-52-27" name="__codelineno-52-27"></a>    <span class="c1">## 是否区分大小写  查询出名字里面含有p的数据  区分大小写</span>
<a id="__codelineno-52-28" name="__codelineno-52-28"></a>        <span class="n">res</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">User</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">name__contains</span><span class="o">=</span><span class="s1">&#39;p&#39;</span><span class="p">)</span>
<a id="__codelineno-52-29" name="__codelineno-52-29"></a>        <span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
<a id="__codelineno-52-30" name="__codelineno-52-30"></a>
<a id="__codelineno-52-31" name="__codelineno-52-31"></a>    <span class="c1">## 忽略大小写</span>
<a id="__codelineno-52-32" name="__codelineno-52-32"></a>        <span class="n">res</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">User</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">name__icontains</span><span class="o">=</span><span class="s1">&#39;p&#39;</span><span class="p">)</span>
<a id="__codelineno-52-33" name="__codelineno-52-33"></a>        <span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
<a id="__codelineno-52-34" name="__codelineno-52-34"></a>
<a id="__codelineno-52-35" name="__codelineno-52-35"></a>    <span class="c1">## 以..开头 以...结尾</span>
<a id="__codelineno-52-36" name="__codelineno-52-36"></a>        <span class="n">res</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">User</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">name__startswith</span><span class="o">=</span><span class="s1">&#39;j&#39;</span><span class="p">)</span>
<a id="__codelineno-52-37" name="__codelineno-52-37"></a>        <span class="n">res1</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">User</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">name__endswith</span><span class="o">=</span><span class="s1">&#39;j&#39;</span><span class="p">)</span>
<a id="__codelineno-52-38" name="__codelineno-52-38"></a>        <span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="p">,</span><span class="n">res1</span><span class="p">)</span>
<a id="__codelineno-52-39" name="__codelineno-52-39"></a>
<a id="__codelineno-52-40" name="__codelineno-52-40"></a>    <span class="c1">## 查询出注册时间是 2020 1月</span>
<a id="__codelineno-52-41" name="__codelineno-52-41"></a>        <span class="n">res</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">User</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">register_time__month</span><span class="o">=</span><span class="s1">&#39;1&#39;</span><span class="p">)</span>
<a id="__codelineno-52-42" name="__codelineno-52-42"></a>        <span class="n">res</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">User</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">register_time__year</span><span class="o">=</span><span class="s1">&#39;2020&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<h3 id="15-6-案例表创建">15-6 案例表创建<a class="headerlink" href="#15-6-案例表创建" title="Permanent link">&para;</a></h3>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-53-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-53-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-53-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-53-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-53-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-53-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-53-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-53-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-53-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-53-10">10</a></span>
<span class="normal"><a href="#__codelineno-53-11">11</a></span>
<span class="normal"><a href="#__codelineno-53-12">12</a></span>
<span class="normal"><a href="#__codelineno-53-13">13</a></span>
<span class="normal"><a href="#__codelineno-53-14">14</a></span>
<span class="normal"><a href="#__codelineno-53-15">15</a></span>
<span class="normal"><a href="#__codelineno-53-16">16</a></span>
<span class="normal"><a href="#__codelineno-53-17">17</a></span>
<span class="normal"><a href="#__codelineno-53-18">18</a></span>
<span class="normal"><a href="#__codelineno-53-19">19</a></span>
<span class="normal"><a href="#__codelineno-53-20">20</a></span>
<span class="normal"><a href="#__codelineno-53-21">21</a></span>
<span class="normal"><a href="#__codelineno-53-22">22</a></span>
<span class="normal"><a href="#__codelineno-53-23">23</a></span>
<span class="normal"><a href="#__codelineno-53-24">24</a></span>
<span class="normal"><a href="#__codelineno-53-25">25</a></span>
<span class="normal"><a href="#__codelineno-53-26">26</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-53-1" name="__codelineno-53-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">Book</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
<a id="__codelineno-53-2" name="__codelineno-53-2"></a>    <span class="n">title</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>
<a id="__codelineno-53-3" name="__codelineno-53-3"></a>    <span class="n">price</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DecimalField</span><span class="p">(</span><span class="n">max_digits</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span><span class="n">decimal_places</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<a id="__codelineno-53-4" name="__codelineno-53-4"></a>    <span class="n">publish_date</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DateField</span><span class="p">(</span><span class="n">auto_now_add</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-53-5" name="__codelineno-53-5"></a>
<a id="__codelineno-53-6" name="__codelineno-53-6"></a>    <span class="c1">## 一对多</span>
<a id="__codelineno-53-7" name="__codelineno-53-7"></a>    <span class="n">publish</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="n">to</span><span class="o">=</span><span class="s1">&#39;Publish&#39;</span><span class="p">)</span>
<a id="__codelineno-53-8" name="__codelineno-53-8"></a>    <span class="c1">## 多对多</span>
<a id="__codelineno-53-9" name="__codelineno-53-9"></a>    <span class="n">authors</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ManyToManyField</span><span class="p">(</span><span class="n">to</span><span class="o">=</span><span class="s1">&#39;Author&#39;</span><span class="p">)</span>
<a id="__codelineno-53-10" name="__codelineno-53-10"></a>
<a id="__codelineno-53-11" name="__codelineno-53-11"></a>
<a id="__codelineno-53-12" name="__codelineno-53-12"></a><span class="k">class</span><span class="w"> </span><span class="nc">Publish</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
<a id="__codelineno-53-13" name="__codelineno-53-13"></a>    <span class="n">name</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>
<a id="__codelineno-53-14" name="__codelineno-53-14"></a>    <span class="n">addr</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">64</span><span class="p">)</span>
<a id="__codelineno-53-15" name="__codelineno-53-15"></a>    <span class="n">email</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">EmailField</span><span class="p">()</span> <span class="c1">## 本质是varchar</span>
<a id="__codelineno-53-16" name="__codelineno-53-16"></a>
<a id="__codelineno-53-17" name="__codelineno-53-17"></a><span class="k">class</span><span class="w"> </span><span class="nc">Author</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
<a id="__codelineno-53-18" name="__codelineno-53-18"></a>    <span class="n">name</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>
<a id="__codelineno-53-19" name="__codelineno-53-19"></a>    <span class="n">age</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">IntegerField</span><span class="p">()</span>
<a id="__codelineno-53-20" name="__codelineno-53-20"></a>
<a id="__codelineno-53-21" name="__codelineno-53-21"></a>    <span class="c1">## 一对一</span>
<a id="__codelineno-53-22" name="__codelineno-53-22"></a>    <span class="n">author_detail</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">OneToOneField</span><span class="p">(</span><span class="n">to</span><span class="o">=</span><span class="s1">&#39;AuthorDetail&#39;</span><span class="p">)</span>
<a id="__codelineno-53-23" name="__codelineno-53-23"></a>
<a id="__codelineno-53-24" name="__codelineno-53-24"></a><span class="k">class</span><span class="w"> </span><span class="nc">AuthorDetail</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
<a id="__codelineno-53-25" name="__codelineno-53-25"></a>    <span class="n">phone</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">BigIntegerField</span><span class="p">()</span>
<a id="__codelineno-53-26" name="__codelineno-53-26"></a>    <span class="n">addr</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">64</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<h3 id="15-7-一对多外键增删改查">15-7 一对多外键增删改查<a class="headerlink" href="#15-7-一对多外键增删改查" title="Permanent link">&para;</a></h3>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-54-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-54-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-54-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-54-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-54-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-54-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-54-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-54-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-54-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-54-10">10</a></span>
<span class="normal"><a href="#__codelineno-54-11">11</a></span>
<span class="normal"><a href="#__codelineno-54-12">12</a></span>
<span class="normal"><a href="#__codelineno-54-13">13</a></span>
<span class="normal"><a href="#__codelineno-54-14">14</a></span>
<span class="normal"><a href="#__codelineno-54-15">15</a></span>
<span class="normal"><a href="#__codelineno-54-16">16</a></span>
<span class="normal"><a href="#__codelineno-54-17">17</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-54-1" name="__codelineno-54-1"></a><span class="c1">## 一对多外键增删改查</span>
<a id="__codelineno-54-2" name="__codelineno-54-2"></a>    <span class="c1">## 增</span>
<a id="__codelineno-54-3" name="__codelineno-54-3"></a>    <span class="c1">## 1  直接写实际字段 id</span>
<a id="__codelineno-54-4" name="__codelineno-54-4"></a>        <span class="n">models</span><span class="o">.</span><span class="n">Book</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;论语&#39;</span><span class="p">,</span><span class="n">price</span><span class="o">=</span><span class="mf">899.23</span><span class="p">,</span><span class="n">publish_id</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-54-5" name="__codelineno-54-5"></a>        <span class="n">models</span><span class="o">.</span><span class="n">Book</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;聊斋&#39;</span><span class="p">,</span><span class="n">price</span><span class="o">=</span><span class="mf">444.23</span><span class="p">,</span><span class="n">publish_id</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<a id="__codelineno-54-6" name="__codelineno-54-6"></a>        <span class="n">models</span><span class="o">.</span><span class="n">Book</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;老子&#39;</span><span class="p">,</span><span class="n">price</span><span class="o">=</span><span class="mf">333.66</span><span class="p">,</span><span class="n">publish_id</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-54-7" name="__codelineno-54-7"></a>    <span class="c1">## 2  虚拟字段 对象</span>
<a id="__codelineno-54-8" name="__codelineno-54-8"></a>        <span class="n">publish_obj</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Publish</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
<a id="__codelineno-54-9" name="__codelineno-54-9"></a>        <span class="n">models</span><span class="o">.</span><span class="n">Book</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;红楼梦&#39;</span><span class="p">,</span><span class="n">price</span><span class="o">=</span><span class="mf">666.23</span><span class="p">,</span><span class="n">publish</span><span class="o">=</span><span class="n">publish_obj</span><span class="p">)</span>
<a id="__codelineno-54-10" name="__codelineno-54-10"></a>
<a id="__codelineno-54-11" name="__codelineno-54-11"></a>    <span class="c1">## 删</span>
<a id="__codelineno-54-12" name="__codelineno-54-12"></a>        <span class="n">models</span><span class="o">.</span><span class="n">Publish</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>  <span class="c1"># 级联删除</span>
<a id="__codelineno-54-13" name="__codelineno-54-13"></a>
<a id="__codelineno-54-14" name="__codelineno-54-14"></a>    <span class="c1">## 修改</span>
<a id="__codelineno-54-15" name="__codelineno-54-15"></a>        <span class="n">models</span><span class="o">.</span><span class="n">Book</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">publish_id</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<a id="__codelineno-54-16" name="__codelineno-54-16"></a>        <span class="n">publish_obj</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Publish</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
<a id="__codelineno-54-17" name="__codelineno-54-17"></a>        <span class="n">models</span><span class="o">.</span><span class="n">Book</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">publish</span><span class="o">=</span><span class="n">publish_obj</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<h3 id="15-8-多对多外键增删改查">15-8 多对多外键增删改查<a class="headerlink" href="#15-8-多对多外键增删改查" title="Permanent link">&para;</a></h3>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-55-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-55-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-55-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-55-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-55-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-55-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-55-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-55-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-55-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-55-10">10</a></span>
<span class="normal"><a href="#__codelineno-55-11">11</a></span>
<span class="normal"><a href="#__codelineno-55-12">12</a></span>
<span class="normal"><a href="#__codelineno-55-13">13</a></span>
<span class="normal"><a href="#__codelineno-55-14">14</a></span>
<span class="normal"><a href="#__codelineno-55-15">15</a></span>
<span class="normal"><a href="#__codelineno-55-16">16</a></span>
<span class="normal"><a href="#__codelineno-55-17">17</a></span>
<span class="normal"><a href="#__codelineno-55-18">18</a></span>
<span class="normal"><a href="#__codelineno-55-19">19</a></span>
<span class="normal"><a href="#__codelineno-55-20">20</a></span>
<span class="normal"><a href="#__codelineno-55-21">21</a></span>
<span class="normal"><a href="#__codelineno-55-22">22</a></span>
<span class="normal"><a href="#__codelineno-55-23">23</a></span>
<span class="normal"><a href="#__codelineno-55-24">24</a></span>
<span class="normal"><a href="#__codelineno-55-25">25</a></span>
<span class="normal"><a href="#__codelineno-55-26">26</a></span>
<span class="normal"><a href="#__codelineno-55-27">27</a></span>
<span class="normal"><a href="#__codelineno-55-28">28</a></span>
<span class="normal"><a href="#__codelineno-55-29">29</a></span>
<span class="normal"><a href="#__codelineno-55-30">30</a></span>
<span class="normal"><a href="#__codelineno-55-31">31</a></span>
<span class="normal"><a href="#__codelineno-55-32">32</a></span>
<span class="normal"><a href="#__codelineno-55-33">33</a></span>
<span class="normal"><a href="#__codelineno-55-34">34</a></span>
<span class="normal"><a href="#__codelineno-55-35">35</a></span>
<span class="normal"><a href="#__codelineno-55-36">36</a></span>
<span class="normal"><a href="#__codelineno-55-37">37</a></span>
<span class="normal"><a href="#__codelineno-55-38">38</a></span>
<span class="normal"><a href="#__codelineno-55-39">39</a></span>
<span class="normal"><a href="#__codelineno-55-40">40</a></span>
<span class="normal"><a href="#__codelineno-55-41">41</a></span>
<span class="normal"><a href="#__codelineno-55-42">42</a></span>
<span class="normal"><a href="#__codelineno-55-43">43</a></span>
<span class="normal"><a href="#__codelineno-55-44">44</a></span>
<span class="normal"><a href="#__codelineno-55-45">45</a></span>
<span class="normal"><a href="#__codelineno-55-46">46</a></span>
<span class="normal"><a href="#__codelineno-55-47">47</a></span>
<span class="normal"><a href="#__codelineno-55-48">48</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-55-1" name="__codelineno-55-1"></a><span class="c1"># 如何给书籍添加作者？</span>
<a id="__codelineno-55-2" name="__codelineno-55-2"></a>    <span class="n">book_obj</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Book</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
<a id="__codelineno-55-3" name="__codelineno-55-3"></a>    <span class="nb">print</span><span class="p">(</span><span class="n">book_obj</span><span class="o">.</span><span class="n">authors</span><span class="p">)</span>  <span class="c1"># 就类似于你已经到了第三张关系表了</span>
<a id="__codelineno-55-4" name="__codelineno-55-4"></a>
<a id="__codelineno-55-5" name="__codelineno-55-5"></a>    <span class="n">book_obj</span><span class="o">.</span><span class="n">authors</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># 书籍id为1的书籍绑定一个主键为1 的作者</span>
<a id="__codelineno-55-6" name="__codelineno-55-6"></a>    <span class="n">book_obj</span><span class="o">.</span><span class="n">authors</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-55-7" name="__codelineno-55-7"></a>
<a id="__codelineno-55-8" name="__codelineno-55-8"></a>    <span class="n">author_obj</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Author</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
<a id="__codelineno-55-9" name="__codelineno-55-9"></a>    <span class="n">author_obj1</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Author</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
<a id="__codelineno-55-10" name="__codelineno-55-10"></a>    <span class="n">author_obj2</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Author</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
<a id="__codelineno-55-11" name="__codelineno-55-11"></a>    <span class="n">book_obj</span><span class="o">.</span><span class="n">authors</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">author_obj</span><span class="p">)</span>
<a id="__codelineno-55-12" name="__codelineno-55-12"></a>    <span class="n">book_obj</span><span class="o">.</span><span class="n">authors</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">author_obj1</span><span class="p">,</span><span class="n">author_obj2</span><span class="p">)</span>
<a id="__codelineno-55-13" name="__codelineno-55-13"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-55-14" name="__codelineno-55-14"></a><span class="sd">add给第三张关系表添加数据</span>
<a id="__codelineno-55-15" name="__codelineno-55-15"></a><span class="sd">    括号内既可以传数字也可以传对象 并且都支持多个</span>
<a id="__codelineno-55-16" name="__codelineno-55-16"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-55-17" name="__codelineno-55-17"></a>
<a id="__codelineno-55-18" name="__codelineno-55-18"></a><span class="c1"># 删</span>
<a id="__codelineno-55-19" name="__codelineno-55-19"></a>    <span class="n">book_obj</span><span class="o">.</span><span class="n">authors</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a id="__codelineno-55-20" name="__codelineno-55-20"></a>    <span class="n">book_obj</span><span class="o">.</span><span class="n">authors</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-55-21" name="__codelineno-55-21"></a>
<a id="__codelineno-55-22" name="__codelineno-55-22"></a>    <span class="n">author_obj</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Author</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
<a id="__codelineno-55-23" name="__codelineno-55-23"></a>    <span class="n">author_obj1</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Author</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
<a id="__codelineno-55-24" name="__codelineno-55-24"></a>    <span class="n">book_obj</span><span class="o">.</span><span class="n">authors</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">author_obj</span><span class="p">,</span><span class="n">author_obj1</span><span class="p">)</span>
<a id="__codelineno-55-25" name="__codelineno-55-25"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-55-26" name="__codelineno-55-26"></a><span class="sd">    remove</span>
<a id="__codelineno-55-27" name="__codelineno-55-27"></a><span class="sd">        括号内既可以传数字也可以传对象 并且都支持多个</span>
<a id="__codelineno-55-28" name="__codelineno-55-28"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-55-29" name="__codelineno-55-29"></a>
<a id="__codelineno-55-30" name="__codelineno-55-30"></a><span class="c1">## 修改</span>
<a id="__codelineno-55-31" name="__codelineno-55-31"></a>    <span class="n">book_obj</span><span class="o">.</span><span class="n">authors</span><span class="o">.</span><span class="n">set</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>  <span class="c1"># 括号内必须给一个可迭代对象</span>
<a id="__codelineno-55-32" name="__codelineno-55-32"></a>    <span class="n">book_obj</span><span class="o">.</span><span class="n">authors</span><span class="o">.</span><span class="n">set</span><span class="p">([</span><span class="mi">3</span><span class="p">])</span>  <span class="c1"># 括号内必须给一个可迭代对象</span>
<a id="__codelineno-55-33" name="__codelineno-55-33"></a>
<a id="__codelineno-55-34" name="__codelineno-55-34"></a>    <span class="n">author_obj</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Author</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
<a id="__codelineno-55-35" name="__codelineno-55-35"></a>    <span class="n">author_obj1</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Author</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
<a id="__codelineno-55-36" name="__codelineno-55-36"></a>    <span class="n">book_obj</span><span class="o">.</span><span class="n">authors</span><span class="o">.</span><span class="n">set</span><span class="p">([</span><span class="n">author_obj</span><span class="p">,</span><span class="n">author_obj1</span><span class="p">])</span>  <span class="c1"># 括号内必须给一个可迭代对象</span>
<a id="__codelineno-55-37" name="__codelineno-55-37"></a>
<a id="__codelineno-55-38" name="__codelineno-55-38"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-55-39" name="__codelineno-55-39"></a><span class="sd">    set</span>
<a id="__codelineno-55-40" name="__codelineno-55-40"></a><span class="sd">        括号内必须传一个可迭代对象，该对象内既可以数字也可以对象 并且都支持多个</span>
<a id="__codelineno-55-41" name="__codelineno-55-41"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-55-42" name="__codelineno-55-42"></a>
<a id="__codelineno-55-43" name="__codelineno-55-43"></a><span class="c1">## 清空</span>
<a id="__codelineno-55-44" name="__codelineno-55-44"></a><span class="c1">## 在第三张关系表中清空某个书籍与作者的绑定关系</span>
<a id="__codelineno-55-45" name="__codelineno-55-45"></a>    <span class="n">book_obj</span><span class="o">.</span><span class="n">authors</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
<a id="__codelineno-55-46" name="__codelineno-55-46"></a>    <span class="s2">&quot;&quot;&quot;</span>
<a id="__codelineno-55-47" name="__codelineno-55-47"></a><span class="s2">    clear</span>
<a id="__codelineno-55-48" name="__codelineno-55-48"></a><span class="s2">        括号内不要加任何参数</span>
</code></pre></div></td></tr></table></div>
<h3 id="15-9-正反向的概念">15-9 正反向的概念<a class="headerlink" href="#15-9-正反向的概念" title="Permanent link">&para;</a></h3>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-56-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-56-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-56-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-56-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-56-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-56-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-56-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-56-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-56-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-56-10">10</a></span>
<span class="normal"><a href="#__codelineno-56-11">11</a></span>
<span class="normal"><a href="#__codelineno-56-12">12</a></span>
<span class="normal"><a href="#__codelineno-56-13">13</a></span>
<span class="normal"><a href="#__codelineno-56-14">14</a></span>
<span class="normal"><a href="#__codelineno-56-15">15</a></span>
<span class="normal"><a href="#__codelineno-56-16">16</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-56-1" name="__codelineno-56-1"></a><span class="c1"># 正向</span>
<a id="__codelineno-56-2" name="__codelineno-56-2"></a><span class="c1"># 反向</span>
<a id="__codelineno-56-3" name="__codelineno-56-3"></a>    <span class="n">外键字段在我手上那么</span><span class="err">，</span><span class="n">我查你就是正向</span>
<a id="__codelineno-56-4" name="__codelineno-56-4"></a>  <span class="n">外键字段如果不在手上</span><span class="err">，</span><span class="n">我查你就是反向</span>
<a id="__codelineno-56-5" name="__codelineno-56-5"></a>
<a id="__codelineno-56-6" name="__codelineno-56-6"></a>  <span class="n">book</span> <span class="o">&gt;&gt;&gt;</span><span class="n">外键字段在书那儿</span><span class="p">(</span><span class="n">正向</span><span class="p">)</span><span class="o">&gt;&gt;&gt;</span> <span class="n">publish</span>
<a id="__codelineno-56-7" name="__codelineno-56-7"></a>  <span class="n">publish</span>   <span class="o">&gt;&gt;&gt;</span><span class="n">外键字段在书那儿</span><span class="p">(</span><span class="n">反向</span><span class="p">)</span><span class="o">&gt;&gt;&gt;</span><span class="n">book</span>
<a id="__codelineno-56-8" name="__codelineno-56-8"></a>
<a id="__codelineno-56-9" name="__codelineno-56-9"></a>  <span class="n">一对一和多对多正反向的判断也是如此</span>
<a id="__codelineno-56-10" name="__codelineno-56-10"></a>
<a id="__codelineno-56-11" name="__codelineno-56-11"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-56-12" name="__codelineno-56-12"></a><span class="sd">正向查询按字段</span>
<a id="__codelineno-56-13" name="__codelineno-56-13"></a><span class="sd">反向查询按表名小写</span>
<a id="__codelineno-56-14" name="__codelineno-56-14"></a><span class="sd">                _set</span>
<a id="__codelineno-56-15" name="__codelineno-56-15"></a><span class="sd">                ...</span>
<a id="__codelineno-56-16" name="__codelineno-56-16"></a><span class="sd">&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
<h3 id="15-10-多表查询">15-10 多表查询<a class="headerlink" href="#15-10-多表查询" title="Permanent link">&para;</a></h3>
<h4 id="10-1-子查询基于对象的跨表查询">10-1 子查询(基于对象的跨表查询)<a class="headerlink" href="#10-1-子查询基于对象的跨表查询" title="Permanent link">&para;</a></h4>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-57-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-57-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-57-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-57-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-57-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-57-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-57-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-57-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-57-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-57-10">10</a></span>
<span class="normal"><a href="#__codelineno-57-11">11</a></span>
<span class="normal"><a href="#__codelineno-57-12">12</a></span>
<span class="normal"><a href="#__codelineno-57-13">13</a></span>
<span class="normal"><a href="#__codelineno-57-14">14</a></span>
<span class="normal"><a href="#__codelineno-57-15">15</a></span>
<span class="normal"><a href="#__codelineno-57-16">16</a></span>
<span class="normal"><a href="#__codelineno-57-17">17</a></span>
<span class="normal"><a href="#__codelineno-57-18">18</a></span>
<span class="normal"><a href="#__codelineno-57-19">19</a></span>
<span class="normal"><a href="#__codelineno-57-20">20</a></span>
<span class="normal"><a href="#__codelineno-57-21">21</a></span>
<span class="normal"><a href="#__codelineno-57-22">22</a></span>
<span class="normal"><a href="#__codelineno-57-23">23</a></span>
<span class="normal"><a href="#__codelineno-57-24">24</a></span>
<span class="normal"><a href="#__codelineno-57-25">25</a></span>
<span class="normal"><a href="#__codelineno-57-26">26</a></span>
<span class="normal"><a href="#__codelineno-57-27">27</a></span>
<span class="normal"><a href="#__codelineno-57-28">28</a></span>
<span class="normal"><a href="#__codelineno-57-29">29</a></span>
<span class="normal"><a href="#__codelineno-57-30">30</a></span>
<span class="normal"><a href="#__codelineno-57-31">31</a></span>
<span class="normal"><a href="#__codelineno-57-32">32</a></span>
<span class="normal"><a href="#__codelineno-57-33">33</a></span>
<span class="normal"><a href="#__codelineno-57-34">34</a></span>
<span class="normal"><a href="#__codelineno-57-35">35</a></span>
<span class="normal"><a href="#__codelineno-57-36">36</a></span>
<span class="normal"><a href="#__codelineno-57-37">37</a></span>
<span class="normal"><a href="#__codelineno-57-38">38</a></span>
<span class="normal"><a href="#__codelineno-57-39">39</a></span>
<span class="normal"><a href="#__codelineno-57-40">40</a></span>
<span class="normal"><a href="#__codelineno-57-41">41</a></span>
<span class="normal"><a href="#__codelineno-57-42">42</a></span>
<span class="normal"><a href="#__codelineno-57-43">43</a></span>
<span class="normal"><a href="#__codelineno-57-44">44</a></span>
<span class="normal"><a href="#__codelineno-57-45">45</a></span>
<span class="normal"><a href="#__codelineno-57-46">46</a></span>
<span class="normal"><a href="#__codelineno-57-47">47</a></span>
<span class="normal"><a href="#__codelineno-57-48">48</a></span>
<span class="normal"><a href="#__codelineno-57-49">49</a></span>
<span class="normal"><a href="#__codelineno-57-50">50</a></span>
<span class="normal"><a href="#__codelineno-57-51">51</a></span>
<span class="normal"><a href="#__codelineno-57-52">52</a></span>
<span class="normal"><a href="#__codelineno-57-53">53</a></span>
<span class="normal"><a href="#__codelineno-57-54">54</a></span>
<span class="normal"><a href="#__codelineno-57-55">55</a></span>
<span class="normal"><a href="#__codelineno-57-56">56</a></span>
<span class="normal"><a href="#__codelineno-57-57">57</a></span>
<span class="normal"><a href="#__codelineno-57-58">58</a></span>
<span class="normal"><a href="#__codelineno-57-59">59</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-57-1" name="__codelineno-57-1"></a><span class="mf">1.</span><span class="n">查询书籍主键为1的出版社</span>
<a id="__codelineno-57-2" name="__codelineno-57-2"></a><span class="n">book_obj</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Book</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
<a id="__codelineno-57-3" name="__codelineno-57-3"></a><span class="c1">## 书查出版社 正向</span>
<a id="__codelineno-57-4" name="__codelineno-57-4"></a><span class="n">res</span> <span class="o">=</span> <span class="n">book_obj</span><span class="o">.</span><span class="n">publish</span>
<a id="__codelineno-57-5" name="__codelineno-57-5"></a><span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
<a id="__codelineno-57-6" name="__codelineno-57-6"></a><span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
<a id="__codelineno-57-7" name="__codelineno-57-7"></a><span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">addr</span><span class="p">)</span>
<a id="__codelineno-57-8" name="__codelineno-57-8"></a>
<a id="__codelineno-57-9" name="__codelineno-57-9"></a><span class="mf">2.</span><span class="n">查询书籍主键为2的作者</span>
<a id="__codelineno-57-10" name="__codelineno-57-10"></a><span class="n">book_obj</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Book</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
<a id="__codelineno-57-11" name="__codelineno-57-11"></a><span class="c1"># # 书查作者 正向</span>
<a id="__codelineno-57-12" name="__codelineno-57-12"></a><span class="n">res</span> <span class="o">=</span> <span class="n">book_obj</span><span class="o">.</span><span class="n">authors</span>  <span class="c1"># app01.Author.None</span>
<a id="__codelineno-57-13" name="__codelineno-57-13"></a><span class="n">res</span> <span class="o">=</span> <span class="n">book_obj</span><span class="o">.</span><span class="n">authors</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>  
<a id="__codelineno-57-14" name="__codelineno-57-14"></a><span class="c1"># &lt;QuerySet [&lt;Author: Author object&gt;, &lt;Author: Author object&gt;]&gt;</span>
<a id="__codelineno-57-15" name="__codelineno-57-15"></a><span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
<a id="__codelineno-57-16" name="__codelineno-57-16"></a>
<a id="__codelineno-57-17" name="__codelineno-57-17"></a><span class="mf">3.</span><span class="n">查询作者jason的电话号码</span>
<a id="__codelineno-57-18" name="__codelineno-57-18"></a><span class="n">author_obj</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Author</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;jason&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
<a id="__codelineno-57-19" name="__codelineno-57-19"></a><span class="n">res</span> <span class="o">=</span> <span class="n">author_obj</span><span class="o">.</span><span class="n">author_detail</span>
<a id="__codelineno-57-20" name="__codelineno-57-20"></a><span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
<a id="__codelineno-57-21" name="__codelineno-57-21"></a><span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">phone</span><span class="p">)</span>
<a id="__codelineno-57-22" name="__codelineno-57-22"></a><span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">addr</span><span class="p">)</span>
<a id="__codelineno-57-23" name="__codelineno-57-23"></a>
<a id="__codelineno-57-24" name="__codelineno-57-24"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-57-25" name="__codelineno-57-25"></a><span class="sd">在书写orm语句的时候跟写sql语句一样的</span>
<a id="__codelineno-57-26" name="__codelineno-57-26"></a><span class="sd">不要企图一次性将orm语句写完 如果比较复杂 就写一点看一点</span>
<a id="__codelineno-57-27" name="__codelineno-57-27"></a>
<a id="__codelineno-57-28" name="__codelineno-57-28"></a><span class="sd">正向什么时候需要加.all()</span>
<a id="__codelineno-57-29" name="__codelineno-57-29"></a><span class="sd">    当你的结果可能有多个的时候就需要加.all()</span>
<a id="__codelineno-57-30" name="__codelineno-57-30"></a><span class="sd">    如果是一个则直接拿到数据对象</span>
<a id="__codelineno-57-31" name="__codelineno-57-31"></a><span class="sd">        book_obj.publish</span>
<a id="__codelineno-57-32" name="__codelineno-57-32"></a><span class="sd">        book_obj.authors.all()</span>
<a id="__codelineno-57-33" name="__codelineno-57-33"></a><span class="sd">        author_obj.author_detail</span>
<a id="__codelineno-57-34" name="__codelineno-57-34"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-57-35" name="__codelineno-57-35"></a><span class="mf">4.</span><span class="n">查询出版社是东方出版社出版的书</span>
<a id="__codelineno-57-36" name="__codelineno-57-36"></a><span class="n">publish_obj</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Publish</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;东方出版社&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
<a id="__codelineno-57-37" name="__codelineno-57-37"></a><span class="n">出版社查书</span>  <span class="n">反向</span>
<a id="__codelineno-57-38" name="__codelineno-57-38"></a><span class="n">res</span> <span class="o">=</span> <span class="n">publish_obj</span><span class="o">.</span><span class="n">book_set</span>  <span class="c1"># app01.Book.None</span>
<a id="__codelineno-57-39" name="__codelineno-57-39"></a><span class="n">res</span> <span class="o">=</span> <span class="n">publish_obj</span><span class="o">.</span><span class="n">book_set</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
<a id="__codelineno-57-40" name="__codelineno-57-40"></a><span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
<a id="__codelineno-57-41" name="__codelineno-57-41"></a>
<a id="__codelineno-57-42" name="__codelineno-57-42"></a><span class="mf">5.</span><span class="n">查询作者是jason写过的书</span>
<a id="__codelineno-57-43" name="__codelineno-57-43"></a><span class="n">author_obj</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Author</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;jason&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
<a id="__codelineno-57-44" name="__codelineno-57-44"></a><span class="c1"># 作者查书      反向</span>
<a id="__codelineno-57-45" name="__codelineno-57-45"></a><span class="n">res</span> <span class="o">=</span> <span class="n">author_obj</span><span class="o">.</span><span class="n">book_set</span>  <span class="c1"># app01.Book.None</span>
<a id="__codelineno-57-46" name="__codelineno-57-46"></a><span class="n">res</span> <span class="o">=</span> <span class="n">author_obj</span><span class="o">.</span><span class="n">book_set</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
<a id="__codelineno-57-47" name="__codelineno-57-47"></a><span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
<a id="__codelineno-57-48" name="__codelineno-57-48"></a>
<a id="__codelineno-57-49" name="__codelineno-57-49"></a><span class="mf">6.</span><span class="n">查询手机号是110的作者姓名</span>
<a id="__codelineno-57-50" name="__codelineno-57-50"></a><span class="n">author_detail_obj</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">AuthorDetail</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">phone</span><span class="o">=</span><span class="mi">110</span><span class="p">)</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
<a id="__codelineno-57-51" name="__codelineno-57-51"></a><span class="n">res</span> <span class="o">=</span> <span class="n">author_detail_obj</span><span class="o">.</span><span class="n">author</span>
<a id="__codelineno-57-52" name="__codelineno-57-52"></a><span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
<a id="__codelineno-57-53" name="__codelineno-57-53"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-57-54" name="__codelineno-57-54"></a><span class="sd">基于对象 </span>
<a id="__codelineno-57-55" name="__codelineno-57-55"></a><span class="sd">    反向查询的时候</span>
<a id="__codelineno-57-56" name="__codelineno-57-56"></a><span class="sd">        当你的查询结果可以有多个的时候 就必须加_set.all()</span>
<a id="__codelineno-57-57" name="__codelineno-57-57"></a><span class="sd">        当你的结果只有一个的时候 不需要加_set.all()</span>
<a id="__codelineno-57-58" name="__codelineno-57-58"></a><span class="sd">    自己总结出 自己方便记忆的即可 每个人都可以不一样</span>
<a id="__codelineno-57-59" name="__codelineno-57-59"></a><span class="sd">&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
<h4 id="10-2-联表查询基于双下划线的跨表查询">10-2 联表查询(基于双下划线的跨表查询)<a class="headerlink" href="#10-2-联表查询基于双下划线的跨表查询" title="Permanent link">&para;</a></h4>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Text Only</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-58-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-58-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-58-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-58-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-58-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-58-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-58-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-58-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-58-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-58-10">10</a></span>
<span class="normal"><a href="#__codelineno-58-11">11</a></span>
<span class="normal"><a href="#__codelineno-58-12">12</a></span>
<span class="normal"><a href="#__codelineno-58-13">13</a></span>
<span class="normal"><a href="#__codelineno-58-14">14</a></span>
<span class="normal"><a href="#__codelineno-58-15">15</a></span>
<span class="normal"><a href="#__codelineno-58-16">16</a></span>
<span class="normal"><a href="#__codelineno-58-17">17</a></span>
<span class="normal"><a href="#__codelineno-58-18">18</a></span>
<span class="normal"><a href="#__codelineno-58-19">19</a></span>
<span class="normal"><a href="#__codelineno-58-20">20</a></span>
<span class="normal"><a href="#__codelineno-58-21">21</a></span>
<span class="normal"><a href="#__codelineno-58-22">22</a></span>
<span class="normal"><a href="#__codelineno-58-23">23</a></span>
<span class="normal"><a href="#__codelineno-58-24">24</a></span>
<span class="normal"><a href="#__codelineno-58-25">25</a></span>
<span class="normal"><a href="#__codelineno-58-26">26</a></span>
<span class="normal"><a href="#__codelineno-58-27">27</a></span>
<span class="normal"><a href="#__codelineno-58-28">28</a></span>
<span class="normal"><a href="#__codelineno-58-29">29</a></span>
<span class="normal"><a href="#__codelineno-58-30">30</a></span>
<span class="normal"><a href="#__codelineno-58-31">31</a></span>
<span class="normal"><a href="#__codelineno-58-32">32</a></span>
<span class="normal"><a href="#__codelineno-58-33">33</a></span>
<span class="normal"><a href="#__codelineno-58-34">34</a></span>
<span class="normal"><a href="#__codelineno-58-35">35</a></span>
<span class="normal"><a href="#__codelineno-58-36">36</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-58-1" name="__codelineno-58-1"></a># 基于双下划线的跨表查询
<a id="__codelineno-58-2" name="__codelineno-58-2"></a>
<a id="__codelineno-58-3" name="__codelineno-58-3"></a>
<a id="__codelineno-58-4" name="__codelineno-58-4"></a>    1.查询jason的手机号和作者姓名
<a id="__codelineno-58-5" name="__codelineno-58-5"></a>    res = models.Author.objects.filter(name=&#39;jason&#39;).values(&#39;author_detail__phone&#39;,&#39;name&#39;)
<a id="__codelineno-58-6" name="__codelineno-58-6"></a>    print(res)
<a id="__codelineno-58-7" name="__codelineno-58-7"></a>    # 反向
<a id="__codelineno-58-8" name="__codelineno-58-8"></a>    res = models.AuthorDetail.objects.filter(author__name=&#39;jason&#39;)  # 拿作者姓名是jason的作者详情
<a id="__codelineno-58-9" name="__codelineno-58-9"></a>    res = models.AuthorDetail.objects.filter(author__name=&#39;jason&#39;).values(&#39;phone&#39;,&#39;author__name&#39;)
<a id="__codelineno-58-10" name="__codelineno-58-10"></a>    print(res)
<a id="__codelineno-58-11" name="__codelineno-58-11"></a>
<a id="__codelineno-58-12" name="__codelineno-58-12"></a>
<a id="__codelineno-58-13" name="__codelineno-58-13"></a>    2.查询书籍主键为1的出版社名称和书的名称
<a id="__codelineno-58-14" name="__codelineno-58-14"></a>    res = models.Book.objects.filter(pk=1).values(&#39;title&#39;,&#39;publish__name&#39;)
<a id="__codelineno-58-15" name="__codelineno-58-15"></a>    print(res)
<a id="__codelineno-58-16" name="__codelineno-58-16"></a>    反向
<a id="__codelineno-58-17" name="__codelineno-58-17"></a>    res = models.Publish.objects.filter(book__id=1).values(&#39;name&#39;,&#39;book__title&#39;)
<a id="__codelineno-58-18" name="__codelineno-58-18"></a>    print(res)
<a id="__codelineno-58-19" name="__codelineno-58-19"></a>
<a id="__codelineno-58-20" name="__codelineno-58-20"></a>    3.查询书籍主键为1的作者姓名
<a id="__codelineno-58-21" name="__codelineno-58-21"></a>    res = models.Book.objects.filter(pk=1).values(&#39;authors__name&#39;)
<a id="__codelineno-58-22" name="__codelineno-58-22"></a>    print(res)
<a id="__codelineno-58-23" name="__codelineno-58-23"></a>    ## 反向
<a id="__codelineno-58-24" name="__codelineno-58-24"></a>    res = models.Author.objects.filter(book__id=1).values(&#39;name&#39;)
<a id="__codelineno-58-25" name="__codelineno-58-25"></a>    print(res)
<a id="__codelineno-58-26" name="__codelineno-58-26"></a>
<a id="__codelineno-58-27" name="__codelineno-58-27"></a>
<a id="__codelineno-58-28" name="__codelineno-58-28"></a>    查询书籍主键是1的作者的手机号
<a id="__codelineno-58-29" name="__codelineno-58-29"></a>    book author authordetail
<a id="__codelineno-58-30" name="__codelineno-58-30"></a>    res = models.Book.objects.filter(pk=1).values(&#39;authors__author_detail__phone&#39;)
<a id="__codelineno-58-31" name="__codelineno-58-31"></a>    print(res)
<a id="__codelineno-58-32" name="__codelineno-58-32"></a>    &quot;&quot;&quot;
<a id="__codelineno-58-33" name="__codelineno-58-33"></a>    你只要掌握了正反向的概念
<a id="__codelineno-58-34" name="__codelineno-58-34"></a>    以及双下划线
<a id="__codelineno-58-35" name="__codelineno-58-35"></a>    那么你就可以无限制的跨表
<a id="__codelineno-58-36" name="__codelineno-58-36"></a>    &quot;&quot;&quot;
</code></pre></div></td></tr></table></div>
<h3 id="15-11-聚合查询">15-11 聚合查询<a class="headerlink" href="#15-11-聚合查询" title="Permanent link">&para;</a></h3>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-59-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-59-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-59-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-59-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-59-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-59-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-59-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-59-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-59-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-59-10">10</a></span>
<span class="normal"><a href="#__codelineno-59-11">11</a></span>
<span class="normal"><a href="#__codelineno-59-12">12</a></span>
<span class="normal"><a href="#__codelineno-59-13">13</a></span>
<span class="normal"><a href="#__codelineno-59-14">14</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-59-1" name="__codelineno-59-1"></a><span class="sd">&#39;&#39;&#39;</span>
<a id="__codelineno-59-2" name="__codelineno-59-2"></a><span class="sd">    只要跟数据库相关的模块</span>
<a id="__codelineno-59-3" name="__codelineno-59-3"></a><span class="sd">    基本上都在django.db.models里面</span>
<a id="__codelineno-59-4" name="__codelineno-59-4"></a><span class="sd">    如果没有name应该在django.db里面</span>
<a id="__codelineno-59-5" name="__codelineno-59-5"></a><span class="sd">&#39;&#39;&#39;</span>
<a id="__codelineno-59-6" name="__codelineno-59-6"></a><span class="kn">from</span><span class="w"> </span><span class="nn">app01</span><span class="w"> </span><span class="kn">import</span> <span class="n">models</span>
<a id="__codelineno-59-7" name="__codelineno-59-7"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.db.models</span><span class="w"> </span><span class="kn">import</span>  <span class="n">Max</span><span class="p">,</span><span class="n">Min</span><span class="p">,</span><span class="n">Sum</span><span class="p">,</span><span class="n">Count</span><span class="p">,</span><span class="n">Avg</span>
<a id="__codelineno-59-8" name="__codelineno-59-8"></a><span class="c1"># 统计所有数的平均价格</span>
<a id="__codelineno-59-9" name="__codelineno-59-9"></a><span class="n">res</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Book</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">aggregate</span><span class="p">(</span><span class="n">Avg</span><span class="p">(</span><span class="s1">&#39;price&#39;</span><span class="p">))</span>  <span class="c1">## 如果没有跟分组一起搭配使用，则加aggregate</span>
<a id="__codelineno-59-10" name="__codelineno-59-10"></a><span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
<a id="__codelineno-59-11" name="__codelineno-59-11"></a>
<a id="__codelineno-59-12" name="__codelineno-59-12"></a><span class="c1">## 上述方法一次性使用</span>
<a id="__codelineno-59-13" name="__codelineno-59-13"></a><span class="n">res</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Book</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">aggregate</span><span class="p">(</span><span class="n">Max</span><span class="p">(</span><span class="s1">&#39;price&#39;</span><span class="p">),</span><span class="n">Min</span><span class="p">(</span><span class="s1">&#39;price&#39;</span><span class="p">),</span><span class="n">Avg</span><span class="p">(</span><span class="s1">&#39;price&#39;</span><span class="p">),</span><span class="n">Sum</span><span class="p">(</span><span class="s1">&#39;price&#39;</span><span class="p">),</span><span class="n">Count</span><span class="p">(</span><span class="s1">&#39;price&#39;</span><span class="p">))</span>
<a id="__codelineno-59-14" name="__codelineno-59-14"></a><span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<h3 id="15-12-分组查询">15-12 分组查询<a class="headerlink" href="#15-12-分组查询" title="Permanent link">&para;</a></h3>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-60-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-60-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-60-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-60-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-60-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-60-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-60-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-60-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-60-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-60-10">10</a></span>
<span class="normal"><a href="#__codelineno-60-11">11</a></span>
<span class="normal"><a href="#__codelineno-60-12">12</a></span>
<span class="normal"><a href="#__codelineno-60-13">13</a></span>
<span class="normal"><a href="#__codelineno-60-14">14</a></span>
<span class="normal"><a href="#__codelineno-60-15">15</a></span>
<span class="normal"><a href="#__codelineno-60-16">16</a></span>
<span class="normal"><a href="#__codelineno-60-17">17</a></span>
<span class="normal"><a href="#__codelineno-60-18">18</a></span>
<span class="normal"><a href="#__codelineno-60-19">19</a></span>
<span class="normal"><a href="#__codelineno-60-20">20</a></span>
<span class="normal"><a href="#__codelineno-60-21">21</a></span>
<span class="normal"><a href="#__codelineno-60-22">22</a></span>
<span class="normal"><a href="#__codelineno-60-23">23</a></span>
<span class="normal"><a href="#__codelineno-60-24">24</a></span>
<span class="normal"><a href="#__codelineno-60-25">25</a></span>
<span class="normal"><a href="#__codelineno-60-26">26</a></span>
<span class="normal"><a href="#__codelineno-60-27">27</a></span>
<span class="normal"><a href="#__codelineno-60-28">28</a></span>
<span class="normal"><a href="#__codelineno-60-29">29</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-60-1" name="__codelineno-60-1"></a><span class="c1">## 分组查询   关键字 annotate</span>
<a id="__codelineno-60-2" name="__codelineno-60-2"></a><span class="c1">## 1，统计每一本书的作者个数</span>
<a id="__codelineno-60-3" name="__codelineno-60-3"></a><span class="c1"># res = models.Book.objects.annotate()  ## models后面点什么就按照什么分组</span>
<a id="__codelineno-60-4" name="__codelineno-60-4"></a><span class="n">res</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Book</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">author_num</span><span class="o">=</span><span class="n">Count</span><span class="p">(</span><span class="s1">&#39;authors__id&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">values</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">,</span><span class="s1">&#39;author_num&#39;</span><span class="p">)</span>
<a id="__codelineno-60-5" name="__codelineno-60-5"></a><span class="c1">## models后面点什么就按照什么分组</span>
<a id="__codelineno-60-6" name="__codelineno-60-6"></a><span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
<a id="__codelineno-60-7" name="__codelineno-60-7"></a><span class="sd">&#39;&#39;&#39;</span>
<a id="__codelineno-60-8" name="__codelineno-60-8"></a><span class="sd">aythor_num 是我们自己定义的字段，用来存储统计出来的每本书对应的作者个数</span>
<a id="__codelineno-60-9" name="__codelineno-60-9"></a><span class="sd">&#39;&#39;&#39;</span>
<a id="__codelineno-60-10" name="__codelineno-60-10"></a>
<a id="__codelineno-60-11" name="__codelineno-60-11"></a><span class="c1">## 2，统计每个出版社卖的最便宜的书的价格</span>
<a id="__codelineno-60-12" name="__codelineno-60-12"></a><span class="n">res</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Publish</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">min_price</span><span class="o">=</span><span class="n">Min</span><span class="p">(</span><span class="s1">&#39;book__price&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">values</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span><span class="s1">&#39;min_price&#39;</span><span class="p">)</span>
<a id="__codelineno-60-13" name="__codelineno-60-13"></a><span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
<a id="__codelineno-60-14" name="__codelineno-60-14"></a>
<a id="__codelineno-60-15" name="__codelineno-60-15"></a><span class="c1">## 3,统计不止一个作者的图书</span>
<a id="__codelineno-60-16" name="__codelineno-60-16"></a><span class="n">res</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Book</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">author_num</span><span class="o">=</span><span class="n">Count</span><span class="p">(</span><span class="s1">&#39;authors__id&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">author_num__gt</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">,</span><span class="s1">&#39;author_num&#39;</span><span class="p">)</span>
<a id="__codelineno-60-17" name="__codelineno-60-17"></a><span class="sd">&#39;&#39;&#39;</span>
<a id="__codelineno-60-18" name="__codelineno-60-18"></a><span class="sd">只要是ORM查询的结果是一个queryset对象，则可以继续点这个对象封装的方法</span>
<a id="__codelineno-60-19" name="__codelineno-60-19"></a><span class="sd">&#39;&#39;&#39;</span>
<a id="__codelineno-60-20" name="__codelineno-60-20"></a><span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
<a id="__codelineno-60-21" name="__codelineno-60-21"></a>
<a id="__codelineno-60-22" name="__codelineno-60-22"></a>
<a id="__codelineno-60-23" name="__codelineno-60-23"></a><span class="c1">## 4，查询每个作者出版的书的总价格</span>
<a id="__codelineno-60-24" name="__codelineno-60-24"></a><span class="n">res</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Author</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">sum_price</span><span class="o">=</span><span class="n">Sum</span><span class="p">(</span><span class="s1">&#39;book__price&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">values</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span><span class="s1">&#39;sum_price&#39;</span><span class="p">)</span>
<a id="__codelineno-60-25" name="__codelineno-60-25"></a><span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
<a id="__codelineno-60-26" name="__codelineno-60-26"></a><span class="sd">&#39;&#39;&#39;</span>
<a id="__codelineno-60-27" name="__codelineno-60-27"></a><span class="sd">如果按照指定字段分组，应该如何做？</span>
<a id="__codelineno-60-28" name="__codelineno-60-28"></a><span class="sd">models.Book.objects.values(&#39;price&#39;).annotate()  ## 这时候就按照price分组了</span>
<a id="__codelineno-60-29" name="__codelineno-60-29"></a><span class="sd">&#39;&#39;&#39;</span>
</code></pre></div></td></tr></table></div>
<h3 id="15-13-f查询">15-13 F查询<a class="headerlink" href="#15-13-f查询" title="Permanent link">&para;</a></h3>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Text Only</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-61-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-61-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-61-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-61-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-61-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-61-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-61-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-61-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-61-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-61-10">10</a></span>
<span class="normal"><a href="#__codelineno-61-11">11</a></span>
<span class="normal"><a href="#__codelineno-61-12">12</a></span>
<span class="normal"><a href="#__codelineno-61-13">13</a></span>
<span class="normal"><a href="#__codelineno-61-14">14</a></span>
<span class="normal"><a href="#__codelineno-61-15">15</a></span>
<span class="normal"><a href="#__codelineno-61-16">16</a></span>
<span class="normal"><a href="#__codelineno-61-17">17</a></span>
<span class="normal"><a href="#__codelineno-61-18">18</a></span>
<span class="normal"><a href="#__codelineno-61-19">19</a></span>
<span class="normal"><a href="#__codelineno-61-20">20</a></span>
<span class="normal"><a href="#__codelineno-61-21">21</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-61-1" name="__codelineno-61-1"></a>## F查询
<a id="__codelineno-61-2" name="__codelineno-61-2"></a>&#39;&#39;&#39;
<a id="__codelineno-61-3" name="__codelineno-61-3"></a>功能是帮助你直接获取到表中某个字段对应的数据
<a id="__codelineno-61-4" name="__codelineno-61-4"></a>&#39;&#39;&#39;
<a id="__codelineno-61-5" name="__codelineno-61-5"></a># 1 查询卖出书大于库存数的书籍
<a id="__codelineno-61-6" name="__codelineno-61-6"></a>from django.db.models import F
<a id="__codelineno-61-7" name="__codelineno-61-7"></a>res = models.Book.objects.filter(maichu__gt=F(&#39;kucun&#39;)) ## F 可以拿出每一本书的库存
<a id="__codelineno-61-8" name="__codelineno-61-8"></a>print(res)
<a id="__codelineno-61-9" name="__codelineno-61-9"></a>
<a id="__codelineno-61-10" name="__codelineno-61-10"></a># 2，将所有书籍的提升50元
<a id="__codelineno-61-11" name="__codelineno-61-11"></a>res = models.Book.objects.update(price=F(&#39;price&#39;) + 50)
<a id="__codelineno-61-12" name="__codelineno-61-12"></a>print(res)
<a id="__codelineno-61-13" name="__codelineno-61-13"></a>
<a id="__codelineno-61-14" name="__codelineno-61-14"></a>## 3,将所有书的名称后面加上爆款两个字
<a id="__codelineno-61-15" name="__codelineno-61-15"></a>from django.db.models.functions import Concat
<a id="__codelineno-61-16" name="__codelineno-61-16"></a>from django.db.models import Value
<a id="__codelineno-61-17" name="__codelineno-61-17"></a>&#39;&#39;&#39;
<a id="__codelineno-61-18" name="__codelineno-61-18"></a>在操作字符类型的数据的时候，F不能直接做到字符串的拼接，没有效果的,需要用以下方法
<a id="__codelineno-61-19" name="__codelineno-61-19"></a>&#39;&#39;&#39;
<a id="__codelineno-61-20" name="__codelineno-61-20"></a>res = models.Book.objects.update(title=Concat(F(&#39;title&#39;),Value(&#39;——爆款&#39;)))
<a id="__codelineno-61-21" name="__codelineno-61-21"></a>print(res)
</code></pre></div></td></tr></table></div>
<h3 id="15-14-q-查询">15-14 Q 查询<a class="headerlink" href="#15-14-q-查询" title="Permanent link">&para;</a></h3>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-62-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-62-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-62-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-62-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-62-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-62-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-62-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-62-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-62-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-62-10">10</a></span>
<span class="normal"><a href="#__codelineno-62-11">11</a></span>
<span class="normal"><a href="#__codelineno-62-12">12</a></span>
<span class="normal"><a href="#__codelineno-62-13">13</a></span>
<span class="normal"><a href="#__codelineno-62-14">14</a></span>
<span class="normal"><a href="#__codelineno-62-15">15</a></span>
<span class="normal"><a href="#__codelineno-62-16">16</a></span>
<span class="normal"><a href="#__codelineno-62-17">17</a></span>
<span class="normal"><a href="#__codelineno-62-18">18</a></span>
<span class="normal"><a href="#__codelineno-62-19">19</a></span>
<span class="normal"><a href="#__codelineno-62-20">20</a></span>
<span class="normal"><a href="#__codelineno-62-21">21</a></span>
<span class="normal"><a href="#__codelineno-62-22">22</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-62-1" name="__codelineno-62-1"></a><span class="c1">## Q 查询</span>
<a id="__codelineno-62-2" name="__codelineno-62-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.db.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">Q</span>
<a id="__codelineno-62-3" name="__codelineno-62-3"></a><span class="c1">## 1，查询卖出书大于100或者价格小于600的书籍</span>
<a id="__codelineno-62-4" name="__codelineno-62-4"></a><span class="n">res</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Book</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">maichu__gt</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span><span class="n">price__lt</span><span class="o">=</span><span class="mi">600</span><span class="p">)</span>
<a id="__codelineno-62-5" name="__codelineno-62-5"></a><span class="c1">## filter括号内多个参数是and 关系,逗号分割</span>
<a id="__codelineno-62-6" name="__codelineno-62-6"></a><span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
<a id="__codelineno-62-7" name="__codelineno-62-7"></a>
<a id="__codelineno-62-8" name="__codelineno-62-8"></a><span class="n">res</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Book</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">Q</span><span class="p">(</span><span class="n">maichu__gt</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span> <span class="o">|</span> <span class="n">Q</span><span class="p">(</span><span class="n">price__lt</span><span class="o">=</span> <span class="mi">600</span><span class="p">))</span>
<a id="__codelineno-62-9" name="__codelineno-62-9"></a><span class="sd">&#39;&#39;&#39;</span>
<a id="__codelineno-62-10" name="__codelineno-62-10"></a><span class="sd">或  |</span>
<a id="__codelineno-62-11" name="__codelineno-62-11"></a><span class="sd">非  ~  </span>
<a id="__codelineno-62-12" name="__codelineno-62-12"></a><span class="sd">res = models.Book.objects.filter(~Q(maichu__gt=100) | ~Q(price__lt= 600))</span>
<a id="__codelineno-62-13" name="__codelineno-62-13"></a><span class="sd">&#39;&#39;&#39;</span>
<a id="__codelineno-62-14" name="__codelineno-62-14"></a><span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
<a id="__codelineno-62-15" name="__codelineno-62-15"></a>
<a id="__codelineno-62-16" name="__codelineno-62-16"></a><span class="c1">## Q 的高阶用法 可以把查询条件的左边也可以改成字符串的形式</span>
<a id="__codelineno-62-17" name="__codelineno-62-17"></a><span class="n">q</span> <span class="o">=</span> <span class="n">Q</span><span class="p">()</span>
<a id="__codelineno-62-18" name="__codelineno-62-18"></a><span class="n">q</span><span class="o">.</span><span class="n">connector</span> <span class="o">=</span> <span class="s1">&#39;or&#39;</span> <span class="c1">## 可以改默认的and连接关系 </span>
<a id="__codelineno-62-19" name="__codelineno-62-19"></a><span class="n">q</span><span class="o">.</span><span class="n">children</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="s1">&#39;maichu__gt&#39;</span><span class="p">,</span><span class="mi">100</span><span class="p">))</span>
<a id="__codelineno-62-20" name="__codelineno-62-20"></a><span class="n">q</span><span class="o">.</span><span class="n">children</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="s1">&#39;price__lt&#39;</span><span class="p">,</span><span class="mi">600</span><span class="p">))</span>
<a id="__codelineno-62-21" name="__codelineno-62-21"></a><span class="n">res</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Book</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">q</span><span class="p">)</span> <span class="c1">## filter括号内支持直接放Q对象，默认还是and关系</span>
<a id="__codelineno-62-22" name="__codelineno-62-22"></a><span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<h3 id="15-15-django中开启事务">15-15 Django中开启事务<a class="headerlink" href="#15-15-django中开启事务" title="Permanent link">&para;</a></h3>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-63-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-63-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-63-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-63-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-63-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-63-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-63-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-63-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-63-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-63-10">10</a></span>
<span class="normal"><a href="#__codelineno-63-11">11</a></span>
<span class="normal"><a href="#__codelineno-63-12">12</a></span>
<span class="normal"><a href="#__codelineno-63-13">13</a></span>
<span class="normal"><a href="#__codelineno-63-14">14</a></span>
<span class="normal"><a href="#__codelineno-63-15">15</a></span>
<span class="normal"><a href="#__codelineno-63-16">16</a></span>
<span class="normal"><a href="#__codelineno-63-17">17</a></span>
<span class="normal"><a href="#__codelineno-63-18">18</a></span>
<span class="normal"><a href="#__codelineno-63-19">19</a></span>
<span class="normal"><a href="#__codelineno-63-20">20</a></span>
<span class="normal"><a href="#__codelineno-63-21">21</a></span>
<span class="normal"><a href="#__codelineno-63-22">22</a></span>
<span class="normal"><a href="#__codelineno-63-23">23</a></span>
<span class="normal"><a href="#__codelineno-63-24">24</a></span>
<span class="normal"><a href="#__codelineno-63-25">25</a></span>
<span class="normal"><a href="#__codelineno-63-26">26</a></span>
<span class="normal"><a href="#__codelineno-63-27">27</a></span>
<span class="normal"><a href="#__codelineno-63-28">28</a></span>
<span class="normal"><a href="#__codelineno-63-29">29</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-63-1" name="__codelineno-63-1"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-63-2" name="__codelineno-63-2"></a><span class="sd">事务</span>
<a id="__codelineno-63-3" name="__codelineno-63-3"></a><span class="sd">    ACID</span>
<a id="__codelineno-63-4" name="__codelineno-63-4"></a><span class="sd">        原子性</span>
<a id="__codelineno-63-5" name="__codelineno-63-5"></a><span class="sd">            不可分割的最小单位</span>
<a id="__codelineno-63-6" name="__codelineno-63-6"></a><span class="sd">        一致性</span>
<a id="__codelineno-63-7" name="__codelineno-63-7"></a><span class="sd">            跟原子性是相辅相成</span>
<a id="__codelineno-63-8" name="__codelineno-63-8"></a><span class="sd">        隔离性</span>
<a id="__codelineno-63-9" name="__codelineno-63-9"></a><span class="sd">            事务之间互相不干扰</span>
<a id="__codelineno-63-10" name="__codelineno-63-10"></a><span class="sd">        持久性</span>
<a id="__codelineno-63-11" name="__codelineno-63-11"></a><span class="sd">            事务一旦确认永久生效</span>
<a id="__codelineno-63-12" name="__codelineno-63-12"></a>
<a id="__codelineno-63-13" name="__codelineno-63-13"></a><span class="sd">    事务的回滚 </span>
<a id="__codelineno-63-14" name="__codelineno-63-14"></a><span class="sd">        rollback</span>
<a id="__codelineno-63-15" name="__codelineno-63-15"></a><span class="sd">    事务的确认</span>
<a id="__codelineno-63-16" name="__codelineno-63-16"></a><span class="sd">        commit</span>
<a id="__codelineno-63-17" name="__codelineno-63-17"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-63-18" name="__codelineno-63-18"></a><span class="c1"># 目前你只需要掌握Django中如何简单的开启事务</span>
<a id="__codelineno-63-19" name="__codelineno-63-19"></a><span class="c1"># 事务</span>
<a id="__codelineno-63-20" name="__codelineno-63-20"></a>    <span class="kn">from</span><span class="w"> </span><span class="nn">django.db</span><span class="w"> </span><span class="kn">import</span> <span class="n">transaction</span>
<a id="__codelineno-63-21" name="__codelineno-63-21"></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-63-22" name="__codelineno-63-22"></a>        <span class="k">with</span> <span class="n">transaction</span><span class="o">.</span><span class="n">atomic</span><span class="p">():</span>
<a id="__codelineno-63-23" name="__codelineno-63-23"></a>            <span class="c1"># sql1</span>
<a id="__codelineno-63-24" name="__codelineno-63-24"></a>            <span class="c1"># sql2</span>
<a id="__codelineno-63-25" name="__codelineno-63-25"></a>            <span class="o">...</span>
<a id="__codelineno-63-26" name="__codelineno-63-26"></a>            <span class="c1"># 在with代码快内书写的所有orm操作都是属于同一个事务</span>
<a id="__codelineno-63-27" name="__codelineno-63-27"></a>    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<a id="__codelineno-63-28" name="__codelineno-63-28"></a>        <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
<a id="__codelineno-63-29" name="__codelineno-63-29"></a>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;执行其他操作&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<h3 id="15--16-orm中常用字段及参数">15 -16 ORM中常用字段及参数<a class="headerlink" href="#15--16-orm中常用字段及参数" title="Permanent link">&para;</a></h3>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-64-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-64-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-64-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-64-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-64-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-64-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-64-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-64-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-64-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-64-10">10</a></span>
<span class="normal"><a href="#__codelineno-64-11">11</a></span>
<span class="normal"><a href="#__codelineno-64-12">12</a></span>
<span class="normal"><a href="#__codelineno-64-13">13</a></span>
<span class="normal"><a href="#__codelineno-64-14">14</a></span>
<span class="normal"><a href="#__codelineno-64-15">15</a></span>
<span class="normal"><a href="#__codelineno-64-16">16</a></span>
<span class="normal"><a href="#__codelineno-64-17">17</a></span>
<span class="normal"><a href="#__codelineno-64-18">18</a></span>
<span class="normal"><a href="#__codelineno-64-19">19</a></span>
<span class="normal"><a href="#__codelineno-64-20">20</a></span>
<span class="normal"><a href="#__codelineno-64-21">21</a></span>
<span class="normal"><a href="#__codelineno-64-22">22</a></span>
<span class="normal"><a href="#__codelineno-64-23">23</a></span>
<span class="normal"><a href="#__codelineno-64-24">24</a></span>
<span class="normal"><a href="#__codelineno-64-25">25</a></span>
<span class="normal"><a href="#__codelineno-64-26">26</a></span>
<span class="normal"><a href="#__codelineno-64-27">27</a></span>
<span class="normal"><a href="#__codelineno-64-28">28</a></span>
<span class="normal"><a href="#__codelineno-64-29">29</a></span>
<span class="normal"><a href="#__codelineno-64-30">30</a></span>
<span class="normal"><a href="#__codelineno-64-31">31</a></span>
<span class="normal"><a href="#__codelineno-64-32">32</a></span>
<span class="normal"><a href="#__codelineno-64-33">33</a></span>
<span class="normal"><a href="#__codelineno-64-34">34</a></span>
<span class="normal"><a href="#__codelineno-64-35">35</a></span>
<span class="normal"><a href="#__codelineno-64-36">36</a></span>
<span class="normal"><a href="#__codelineno-64-37">37</a></span>
<span class="normal"><a href="#__codelineno-64-38">38</a></span>
<span class="normal"><a href="#__codelineno-64-39">39</a></span>
<span class="normal"><a href="#__codelineno-64-40">40</a></span>
<span class="normal"><a href="#__codelineno-64-41">41</a></span>
<span class="normal"><a href="#__codelineno-64-42">42</a></span>
<span class="normal"><a href="#__codelineno-64-43">43</a></span>
<span class="normal"><a href="#__codelineno-64-44">44</a></span>
<span class="normal"><a href="#__codelineno-64-45">45</a></span>
<span class="normal"><a href="#__codelineno-64-46">46</a></span>
<span class="normal"><a href="#__codelineno-64-47">47</a></span>
<span class="normal"><a href="#__codelineno-64-48">48</a></span>
<span class="normal"><a href="#__codelineno-64-49">49</a></span>
<span class="normal"><a href="#__codelineno-64-50">50</a></span>
<span class="normal"><a href="#__codelineno-64-51">51</a></span>
<span class="normal"><a href="#__codelineno-64-52">52</a></span>
<span class="normal"><a href="#__codelineno-64-53">53</a></span>
<span class="normal"><a href="#__codelineno-64-54">54</a></span>
<span class="normal"><a href="#__codelineno-64-55">55</a></span>
<span class="normal"><a href="#__codelineno-64-56">56</a></span>
<span class="normal"><a href="#__codelineno-64-57">57</a></span>
<span class="normal"><a href="#__codelineno-64-58">58</a></span>
<span class="normal"><a href="#__codelineno-64-59">59</a></span>
<span class="normal"><a href="#__codelineno-64-60">60</a></span>
<span class="normal"><a href="#__codelineno-64-61">61</a></span>
<span class="normal"><a href="#__codelineno-64-62">62</a></span>
<span class="normal"><a href="#__codelineno-64-63">63</a></span>
<span class="normal"><a href="#__codelineno-64-64">64</a></span>
<span class="normal"><a href="#__codelineno-64-65">65</a></span>
<span class="normal"><a href="#__codelineno-64-66">66</a></span>
<span class="normal"><a href="#__codelineno-64-67">67</a></span>
<span class="normal"><a href="#__codelineno-64-68">68</a></span>
<span class="normal"><a href="#__codelineno-64-69">69</a></span>
<span class="normal"><a href="#__codelineno-64-70">70</a></span>
<span class="normal"><a href="#__codelineno-64-71">71</a></span>
<span class="normal"><a href="#__codelineno-64-72">72</a></span>
<span class="normal"><a href="#__codelineno-64-73">73</a></span>
<span class="normal"><a href="#__codelineno-64-74">74</a></span>
<span class="normal"><a href="#__codelineno-64-75">75</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-64-1" name="__codelineno-64-1"></a><span class="n">AutoField</span>
<a id="__codelineno-64-2" name="__codelineno-64-2"></a>    <span class="n">主键字段</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span>
<a id="__codelineno-64-3" name="__codelineno-64-3"></a>
<a id="__codelineno-64-4" name="__codelineno-64-4"></a><span class="n">CharField</span>               <span class="n">varchar</span>
<a id="__codelineno-64-5" name="__codelineno-64-5"></a>    <span class="n">verbose_name</span>    <span class="n">字段的注释</span>
<a id="__codelineno-64-6" name="__codelineno-64-6"></a>     <span class="n">max_length</span>     <span class="n">长度</span>
<a id="__codelineno-64-7" name="__codelineno-64-7"></a>
<a id="__codelineno-64-8" name="__codelineno-64-8"></a><span class="n">IntegerField</span>            <span class="nb">int</span>
<a id="__codelineno-64-9" name="__codelineno-64-9"></a><span class="n">BigIntegerField</span>       <span class="n">bigint</span>
<a id="__codelineno-64-10" name="__codelineno-64-10"></a>
<a id="__codelineno-64-11" name="__codelineno-64-11"></a><span class="n">DecimalField</span>
<a id="__codelineno-64-12" name="__codelineno-64-12"></a>    <span class="n">max_digits</span><span class="o">=</span><span class="mi">8</span>
<a id="__codelineno-64-13" name="__codelineno-64-13"></a>     <span class="n">decimal_places</span><span class="o">=</span><span class="mi">2</span>
<a id="__codelineno-64-14" name="__codelineno-64-14"></a>
<a id="__codelineno-64-15" name="__codelineno-64-15"></a><span class="n">EmailFiled</span>              <span class="n">varchar</span><span class="p">(</span><span class="mi">254</span><span class="p">)</span>
<a id="__codelineno-64-16" name="__codelineno-64-16"></a>
<a id="__codelineno-64-17" name="__codelineno-64-17"></a><span class="n">DateField</span>                   <span class="n">date</span>
<a id="__codelineno-64-18" name="__codelineno-64-18"></a><span class="n">DateTimeField</span>           <span class="n">datetime</span>
<a id="__codelineno-64-19" name="__codelineno-64-19"></a>  <span class="n">auto_now</span><span class="p">:</span> <span class="c1">## 每次修改数据的时候都会自动更新当前时间</span>
<a id="__codelineno-64-20" name="__codelineno-64-20"></a>  <span class="n">auto_now_add</span><span class="p">:</span> <span class="c1">## 只在创建数据的时候记录创建时间后续不会自动修改了</span>
<a id="__codelineno-64-21" name="__codelineno-64-21"></a>
<a id="__codelineno-64-22" name="__codelineno-64-22"></a><span class="n">BooleanField</span><span class="p">(</span><span class="n">Field</span><span class="p">)</span>             <span class="o">-</span> <span class="n">布尔值类型</span>
<a id="__codelineno-64-23" name="__codelineno-64-23"></a>    <span class="n">该字段传布尔值</span><span class="p">(</span><span class="kc">False</span><span class="o">/</span><span class="kc">True</span><span class="p">)</span>     <span class="n">数据库里面存0</span><span class="o">/</span><span class="mi">1</span>
<a id="__codelineno-64-24" name="__codelineno-64-24"></a>
<a id="__codelineno-64-25" name="__codelineno-64-25"></a><span class="n">TextField</span><span class="p">(</span><span class="n">Field</span><span class="p">)</span>                    <span class="o">-</span> <span class="n">文本类型</span>
<a id="__codelineno-64-26" name="__codelineno-64-26"></a>    <span class="n">该字段可以用来存大段内容</span><span class="p">(</span><span class="n">文章</span><span class="err">、</span><span class="n">博客</span><span class="o">...</span><span class="p">)</span>  <span class="n">没有字数限制</span>
<a id="__codelineno-64-27" name="__codelineno-64-27"></a>  <span class="n">后面的bbs作业</span> <span class="n">文章字段用的就是TextField</span>
<a id="__codelineno-64-28" name="__codelineno-64-28"></a>
<a id="__codelineno-64-29" name="__codelineno-64-29"></a>
<a id="__codelineno-64-30" name="__codelineno-64-30"></a><span class="n">FileField</span><span class="p">(</span><span class="n">Field</span><span class="p">)</span>                    <span class="o">-</span> <span class="n">字符类型</span>
<a id="__codelineno-64-31" name="__codelineno-64-31"></a>   <span class="n">upload_to</span> <span class="o">=</span> <span class="s2">&quot;/data&quot;</span>
<a id="__codelineno-64-32" name="__codelineno-64-32"></a>  <span class="n">给该字段传一个文件对象</span><span class="err">，</span><span class="n">会自动将文件保存到</span><span class="o">/</span><span class="n">data目录下然后将文件路径保存到数据库中</span>
<a id="__codelineno-64-33" name="__codelineno-64-33"></a>  <span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="n">a</span><span class="o">.</span><span class="n">txt</span>
<a id="__codelineno-64-34" name="__codelineno-64-34"></a>  <span class="n">后面bbs作业也会涉及</span>
<a id="__codelineno-64-35" name="__codelineno-64-35"></a>
<a id="__codelineno-64-36" name="__codelineno-64-36"></a><span class="c1"># 更多字段</span>
<a id="__codelineno-64-37" name="__codelineno-64-37"></a><span class="n">直接参考博客</span><span class="p">:</span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">www</span><span class="o">.</span><span class="n">cnblogs</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">Dominic</span><span class="o">-</span><span class="n">Ji</span><span class="o">/</span><span class="n">p</span><span class="o">/</span><span class="mf">9203990.</span><span class="n">html</span>
<a id="__codelineno-64-38" name="__codelineno-64-38"></a>
<a id="__codelineno-64-39" name="__codelineno-64-39"></a>
<a id="__codelineno-64-40" name="__codelineno-64-40"></a><span class="c1"># django除了给你提供了很多字段类型之外 还支持你自定义字段</span>
<a id="__codelineno-64-41" name="__codelineno-64-41"></a><span class="k">class</span><span class="w"> </span><span class="nc">MyCharField</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Field</span><span class="p">):</span>
<a id="__codelineno-64-42" name="__codelineno-64-42"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">max_length</span><span class="p">,</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<a id="__codelineno-64-43" name="__codelineno-64-43"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">max_length</span> <span class="o">=</span> <span class="n">max_length</span>
<a id="__codelineno-64-44" name="__codelineno-64-44"></a>        <span class="c1"># 调用父类的init方法</span>
<a id="__codelineno-64-45" name="__codelineno-64-45"></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="n">max_length</span><span class="p">,</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>  <span class="c1"># 一定要是关键字的形式传入</span>
<a id="__codelineno-64-46" name="__codelineno-64-46"></a>
<a id="__codelineno-64-47" name="__codelineno-64-47"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">db_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">connection</span><span class="p">):</span>
<a id="__codelineno-64-48" name="__codelineno-64-48"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-64-49" name="__codelineno-64-49"></a><span class="sd">        返回真正的数据类型及各种约束条件</span>
<a id="__codelineno-64-50" name="__codelineno-64-50"></a><span class="sd">        :param connection:</span>
<a id="__codelineno-64-51" name="__codelineno-64-51"></a><span class="sd">        :return:</span>
<a id="__codelineno-64-52" name="__codelineno-64-52"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-64-53" name="__codelineno-64-53"></a>        <span class="k">return</span> <span class="s1">&#39;char(</span><span class="si">%s</span><span class="s1">)&#39;</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="n">max_length</span>
<a id="__codelineno-64-54" name="__codelineno-64-54"></a>
<a id="__codelineno-64-55" name="__codelineno-64-55"></a><span class="c1"># 自定义字段使用</span>
<a id="__codelineno-64-56" name="__codelineno-64-56"></a><span class="n">myfield</span> <span class="o">=</span> <span class="n">MyCharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span><span class="n">null</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-64-57" name="__codelineno-64-57"></a>
<a id="__codelineno-64-58" name="__codelineno-64-58"></a>
<a id="__codelineno-64-59" name="__codelineno-64-59"></a>
<a id="__codelineno-64-60" name="__codelineno-64-60"></a><span class="c1"># 外键字段及参数</span>
<a id="__codelineno-64-61" name="__codelineno-64-61"></a><span class="n">unique</span><span class="o">=</span><span class="kc">True</span>
<a id="__codelineno-64-62" name="__codelineno-64-62"></a>    <span class="n">ForeignKey</span><span class="p">(</span><span class="n">unique</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>   <span class="o">===</span>           <span class="n">OneToOneField</span><span class="p">()</span>
<a id="__codelineno-64-63" name="__codelineno-64-63"></a>  <span class="c1"># 你在用前面字段创建一对一 orm会有一个提示信息 orm推荐你使用后者但是前者也能用</span>
<a id="__codelineno-64-64" name="__codelineno-64-64"></a>
<a id="__codelineno-64-65" name="__codelineno-64-65"></a><span class="n">db_index</span>
<a id="__codelineno-64-66" name="__codelineno-64-66"></a>    <span class="c1">## 如果db_index=True 则代表着为此字段设置索引</span>
<a id="__codelineno-64-67" name="__codelineno-64-67"></a>
<a id="__codelineno-64-68" name="__codelineno-64-68"></a><span class="n">to_field</span>
<a id="__codelineno-64-69" name="__codelineno-64-69"></a>    <span class="c1">## 设置要关联的表的字段  默认不写关联的就是另外一张的主键字段</span>
<a id="__codelineno-64-70" name="__codelineno-64-70"></a>
<a id="__codelineno-64-71" name="__codelineno-64-71"></a><span class="n">on_delete</span>
<a id="__codelineno-64-72" name="__codelineno-64-72"></a>    <span class="c1">## 当删除关联表中的数据时，当前表与其关联的行的行为。</span>
<a id="__codelineno-64-73" name="__codelineno-64-73"></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-64-74" name="__codelineno-64-74"></a><span class="sd">  django2.X及以上版本 需要你自己指定外键字段的级联更新级联删除</span>
<a id="__codelineno-64-75" name="__codelineno-64-75"></a><span class="sd">  &quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
<h3 id="15-16-数据库查询优化">15-16 数据库查询优化<a class="headerlink" href="#15-16-数据库查询优化" title="Permanent link">&para;</a></h3>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-65-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-65-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-65-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-65-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-65-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-65-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-65-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-65-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-65-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-65-10">10</a></span>
<span class="normal"><a href="#__codelineno-65-11">11</a></span>
<span class="normal"><a href="#__codelineno-65-12">12</a></span>
<span class="normal"><a href="#__codelineno-65-13">13</a></span>
<span class="normal"><a href="#__codelineno-65-14">14</a></span>
<span class="normal"><a href="#__codelineno-65-15">15</a></span>
<span class="normal"><a href="#__codelineno-65-16">16</a></span>
<span class="normal"><a href="#__codelineno-65-17">17</a></span>
<span class="normal"><a href="#__codelineno-65-18">18</a></span>
<span class="normal"><a href="#__codelineno-65-19">19</a></span>
<span class="normal"><a href="#__codelineno-65-20">20</a></span>
<span class="normal"><a href="#__codelineno-65-21">21</a></span>
<span class="normal"><a href="#__codelineno-65-22">22</a></span>
<span class="normal"><a href="#__codelineno-65-23">23</a></span>
<span class="normal"><a href="#__codelineno-65-24">24</a></span>
<span class="normal"><a href="#__codelineno-65-25">25</a></span>
<span class="normal"><a href="#__codelineno-65-26">26</a></span>
<span class="normal"><a href="#__codelineno-65-27">27</a></span>
<span class="normal"><a href="#__codelineno-65-28">28</a></span>
<span class="normal"><a href="#__codelineno-65-29">29</a></span>
<span class="normal"><a href="#__codelineno-65-30">30</a></span>
<span class="normal"><a href="#__codelineno-65-31">31</a></span>
<span class="normal"><a href="#__codelineno-65-32">32</a></span>
<span class="normal"><a href="#__codelineno-65-33">33</a></span>
<span class="normal"><a href="#__codelineno-65-34">34</a></span>
<span class="normal"><a href="#__codelineno-65-35">35</a></span>
<span class="normal"><a href="#__codelineno-65-36">36</a></span>
<span class="normal"><a href="#__codelineno-65-37">37</a></span>
<span class="normal"><a href="#__codelineno-65-38">38</a></span>
<span class="normal"><a href="#__codelineno-65-39">39</a></span>
<span class="normal"><a href="#__codelineno-65-40">40</a></span>
<span class="normal"><a href="#__codelineno-65-41">41</a></span>
<span class="normal"><a href="#__codelineno-65-42">42</a></span>
<span class="normal"><a href="#__codelineno-65-43">43</a></span>
<span class="normal"><a href="#__codelineno-65-44">44</a></span>
<span class="normal"><a href="#__codelineno-65-45">45</a></span>
<span class="normal"><a href="#__codelineno-65-46">46</a></span>
<span class="normal"><a href="#__codelineno-65-47">47</a></span>
<span class="normal"><a href="#__codelineno-65-48">48</a></span>
<span class="normal"><a href="#__codelineno-65-49">49</a></span>
<span class="normal"><a href="#__codelineno-65-50">50</a></span>
<span class="normal"><a href="#__codelineno-65-51">51</a></span>
<span class="normal"><a href="#__codelineno-65-52">52</a></span>
<span class="normal"><a href="#__codelineno-65-53">53</a></span>
<span class="normal"><a href="#__codelineno-65-54">54</a></span>
<span class="normal"><a href="#__codelineno-65-55">55</a></span>
<span class="normal"><a href="#__codelineno-65-56">56</a></span>
<span class="normal"><a href="#__codelineno-65-57">57</a></span>
<span class="normal"><a href="#__codelineno-65-58">58</a></span>
<span class="normal"><a href="#__codelineno-65-59">59</a></span>
<span class="normal"><a href="#__codelineno-65-60">60</a></span>
<span class="normal"><a href="#__codelineno-65-61">61</a></span>
<span class="normal"><a href="#__codelineno-65-62">62</a></span>
<span class="normal"><a href="#__codelineno-65-63">63</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-65-1" name="__codelineno-65-1"></a><span class="n">only与defer</span>  
<a id="__codelineno-65-2" name="__codelineno-65-2"></a><span class="n">select_related与prefetch_related</span>
<a id="__codelineno-65-3" name="__codelineno-65-3"></a>
<a id="__codelineno-65-4" name="__codelineno-65-4"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-65-5" name="__codelineno-65-5"></a><span class="sd">orm语句的特点:</span>
<a id="__codelineno-65-6" name="__codelineno-65-6"></a><span class="sd">    惰性查询</span>
<a id="__codelineno-65-7" name="__codelineno-65-7"></a><span class="sd">        如果你仅仅只是书写了orm语句 在后面根本没有用到该语句所查询出来的参数</span>
<a id="__codelineno-65-8" name="__codelineno-65-8"></a><span class="sd">        那么orm会自动识别 直接不执行</span>
<a id="__codelineno-65-9" name="__codelineno-65-9"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-65-10" name="__codelineno-65-10"></a><span class="c1"># only与defer</span>
<a id="__codelineno-65-11" name="__codelineno-65-11"></a><span class="c1"># res = models.Book.objects.all()</span>
<a id="__codelineno-65-12" name="__codelineno-65-12"></a>    <span class="c1"># print(res)  # 要用数据了才会走数据库</span>
<a id="__codelineno-65-13" name="__codelineno-65-13"></a>
<a id="__codelineno-65-14" name="__codelineno-65-14"></a>    <span class="c1"># 想要获取书籍表中所有数的名字</span>
<a id="__codelineno-65-15" name="__codelineno-65-15"></a>    <span class="c1"># res = models.Book.objects.values(&#39;title&#39;)</span>
<a id="__codelineno-65-16" name="__codelineno-65-16"></a>    <span class="c1"># for d in res:</span>
<a id="__codelineno-65-17" name="__codelineno-65-17"></a>    <span class="c1">#     print(d.get(&#39;title&#39;))</span>
<a id="__codelineno-65-18" name="__codelineno-65-18"></a>    <span class="c1"># 你给我实现获取到的是一个数据对象 然后点title就能够拿到书名 并且没有其他字段</span>
<a id="__codelineno-65-19" name="__codelineno-65-19"></a>    <span class="c1"># res = models.Book.objects.only(&#39;title&#39;)</span>
<a id="__codelineno-65-20" name="__codelineno-65-20"></a>    <span class="c1"># res = models.Book.objects.all()</span>
<a id="__codelineno-65-21" name="__codelineno-65-21"></a>    <span class="c1"># print(res)  # &lt;QuerySet [&lt;Book: 三国演义爆款&gt;, &lt;Book: 红楼梦爆款&gt;, &lt;Book: 论语爆款&gt;, &lt;Book: 聊斋爆款&gt;, &lt;Book: 老子爆款&gt;]&gt;</span>
<a id="__codelineno-65-22" name="__codelineno-65-22"></a>    <span class="c1"># for i in res:</span>
<a id="__codelineno-65-23" name="__codelineno-65-23"></a>        <span class="c1"># print(i.title)  # 点击only括号内的字段 不会走数据库</span>
<a id="__codelineno-65-24" name="__codelineno-65-24"></a>        <span class="c1"># print(i.price)  # 点击only括号内没有的字段 会重新走数据库查询而all不需要走了</span>
<a id="__codelineno-65-25" name="__codelineno-65-25"></a>
<a id="__codelineno-65-26" name="__codelineno-65-26"></a>    <span class="n">res</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Book</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">defer</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">)</span>  <span class="c1"># 对象除了没有title属性之外其他的都有</span>
<a id="__codelineno-65-27" name="__codelineno-65-27"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">res</span><span class="p">:</span>
<a id="__codelineno-65-28" name="__codelineno-65-28"></a>        <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">price</span><span class="p">)</span>
<a id="__codelineno-65-29" name="__codelineno-65-29"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-65-30" name="__codelineno-65-30"></a><span class="sd">    defer与only刚好相反</span>
<a id="__codelineno-65-31" name="__codelineno-65-31"></a><span class="sd">        defer括号内放的字段不在查询出来的对象里面 查询该字段需要重新走数据</span>
<a id="__codelineno-65-32" name="__codelineno-65-32"></a><span class="sd">        而如果查询的是非括号内的字段 则不需要走数据库了</span>
<a id="__codelineno-65-33" name="__codelineno-65-33"></a>
<a id="__codelineno-65-34" name="__codelineno-65-34"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-65-35" name="__codelineno-65-35"></a>
<a id="__codelineno-65-36" name="__codelineno-65-36"></a>
<a id="__codelineno-65-37" name="__codelineno-65-37"></a><span class="c1"># select_related与prefetch_related</span>
<a id="__codelineno-65-38" name="__codelineno-65-38"></a><span class="c1"># select_related与prefetch_related  跟跨表操作有关</span>
<a id="__codelineno-65-39" name="__codelineno-65-39"></a>    <span class="c1"># res = models.Book.objects.all()</span>
<a id="__codelineno-65-40" name="__codelineno-65-40"></a>    <span class="c1"># for i in res:</span>
<a id="__codelineno-65-41" name="__codelineno-65-41"></a>    <span class="c1">#     print(i.publish.name)  # 每循环一次就要走一次数据库查询</span>
<a id="__codelineno-65-42" name="__codelineno-65-42"></a>
<a id="__codelineno-65-43" name="__codelineno-65-43"></a>    <span class="c1"># res = models.Book.objects.select_related(&#39;authors&#39;)  # INNER JOIN</span>
<a id="__codelineno-65-44" name="__codelineno-65-44"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-65-45" name="__codelineno-65-45"></a><span class="sd">    select_related内部直接先将book与publish连起来 然后一次性将大表里面的所有数据</span>
<a id="__codelineno-65-46" name="__codelineno-65-46"></a><span class="sd">    全部封装给查询出来的对象</span>
<a id="__codelineno-65-47" name="__codelineno-65-47"></a><span class="sd">        这个时候对象无论是点击book表的数据还是publish的数据都无需再走数据库查询了</span>
<a id="__codelineno-65-48" name="__codelineno-65-48"></a>
<a id="__codelineno-65-49" name="__codelineno-65-49"></a><span class="sd">    select_related括号内只能放外键字段    一对多 一对一</span>
<a id="__codelineno-65-50" name="__codelineno-65-50"></a><span class="sd">        多对多也不行</span>
<a id="__codelineno-65-51" name="__codelineno-65-51"></a>
<a id="__codelineno-65-52" name="__codelineno-65-52"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-65-53" name="__codelineno-65-53"></a>    <span class="c1"># for i in res:</span>
<a id="__codelineno-65-54" name="__codelineno-65-54"></a>    <span class="c1">#     print(i.publish.name)  # 每循环一次就要走一次数据库查询</span>
<a id="__codelineno-65-55" name="__codelineno-65-55"></a>
<a id="__codelineno-65-56" name="__codelineno-65-56"></a>    <span class="n">res</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Book</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">prefetch_related</span><span class="p">(</span><span class="s1">&#39;publish&#39;</span><span class="p">)</span>  <span class="c1"># 子查询</span>
<a id="__codelineno-65-57" name="__codelineno-65-57"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-65-58" name="__codelineno-65-58"></a><span class="sd">    prefetch_related该方法内部其实就是子查询</span>
<a id="__codelineno-65-59" name="__codelineno-65-59"></a><span class="sd">        将子查询查询出来的所有结果也给你封装到对象中</span>
<a id="__codelineno-65-60" name="__codelineno-65-60"></a><span class="sd">        给你的感觉好像也是一次性搞定的</span>
<a id="__codelineno-65-61" name="__codelineno-65-61"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-65-62" name="__codelineno-65-62"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">res</span><span class="p">:</span>
<a id="__codelineno-65-63" name="__codelineno-65-63"></a>        <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">publish</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<h3 id="15-17-图书馆里系统的增删改查">15-17 图书馆里系统的增删改查<a class="headerlink" href="#15-17-图书馆里系统的增删改查" title="Permanent link">&para;</a></h3>
<h4 id="17-1-modelspy">17-1 models.py<a class="headerlink" href="#17-1-modelspy" title="Permanent link">&para;</a></h4>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-66-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-66-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-66-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-66-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-66-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-66-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-66-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-66-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-66-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-66-10">10</a></span>
<span class="normal"><a href="#__codelineno-66-11">11</a></span>
<span class="normal"><a href="#__codelineno-66-12">12</a></span>
<span class="normal"><a href="#__codelineno-66-13">13</a></span>
<span class="normal"><a href="#__codelineno-66-14">14</a></span>
<span class="normal"><a href="#__codelineno-66-15">15</a></span>
<span class="normal"><a href="#__codelineno-66-16">16</a></span>
<span class="normal"><a href="#__codelineno-66-17">17</a></span>
<span class="normal"><a href="#__codelineno-66-18">18</a></span>
<span class="normal"><a href="#__codelineno-66-19">19</a></span>
<span class="normal"><a href="#__codelineno-66-20">20</a></span>
<span class="normal"><a href="#__codelineno-66-21">21</a></span>
<span class="normal"><a href="#__codelineno-66-22">22</a></span>
<span class="normal"><a href="#__codelineno-66-23">23</a></span>
<span class="normal"><a href="#__codelineno-66-24">24</a></span>
<span class="normal"><a href="#__codelineno-66-25">25</a></span>
<span class="normal"><a href="#__codelineno-66-26">26</a></span>
<span class="normal"><a href="#__codelineno-66-27">27</a></span>
<span class="normal"><a href="#__codelineno-66-28">28</a></span>
<span class="normal"><a href="#__codelineno-66-29">29</a></span>
<span class="normal"><a href="#__codelineno-66-30">30</a></span>
<span class="normal"><a href="#__codelineno-66-31">31</a></span>
<span class="normal"><a href="#__codelineno-66-32">32</a></span>
<span class="normal"><a href="#__codelineno-66-33">33</a></span>
<span class="normal"><a href="#__codelineno-66-34">34</a></span>
<span class="normal"><a href="#__codelineno-66-35">35</a></span>
<span class="normal"><a href="#__codelineno-66-36">36</a></span>
<span class="normal"><a href="#__codelineno-66-37">37</a></span>
<span class="normal"><a href="#__codelineno-66-38">38</a></span>
<span class="normal"><a href="#__codelineno-66-39">39</a></span>
<span class="normal"><a href="#__codelineno-66-40">40</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-66-1" name="__codelineno-66-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.db</span><span class="w"> </span><span class="kn">import</span> <span class="n">models</span>
<a id="__codelineno-66-2" name="__codelineno-66-2"></a>
<a id="__codelineno-66-3" name="__codelineno-66-3"></a><span class="c1"># Create your models here.</span>
<a id="__codelineno-66-4" name="__codelineno-66-4"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.db</span><span class="w"> </span><span class="kn">import</span> <span class="n">models</span>
<a id="__codelineno-66-5" name="__codelineno-66-5"></a>
<a id="__codelineno-66-6" name="__codelineno-66-6"></a><span class="c1"># Create your models here.</span>
<a id="__codelineno-66-7" name="__codelineno-66-7"></a>
<a id="__codelineno-66-8" name="__codelineno-66-8"></a><span class="k">class</span><span class="w"> </span><span class="nc">Book</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
<a id="__codelineno-66-9" name="__codelineno-66-9"></a>    <span class="n">title</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>
<a id="__codelineno-66-10" name="__codelineno-66-10"></a>    <span class="n">price</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DecimalField</span><span class="p">(</span><span class="n">max_digits</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span><span class="n">decimal_places</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<a id="__codelineno-66-11" name="__codelineno-66-11"></a>    <span class="n">publish_date</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DateField</span><span class="p">(</span><span class="n">auto_now_add</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-66-12" name="__codelineno-66-12"></a>
<a id="__codelineno-66-13" name="__codelineno-66-13"></a>
<a id="__codelineno-66-14" name="__codelineno-66-14"></a>    <span class="c1">## 一对多</span>
<a id="__codelineno-66-15" name="__codelineno-66-15"></a>    <span class="n">publish</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="n">to</span><span class="o">=</span><span class="s1">&#39;Publish&#39;</span><span class="p">)</span>
<a id="__codelineno-66-16" name="__codelineno-66-16"></a>    <span class="c1">## 多对多</span>
<a id="__codelineno-66-17" name="__codelineno-66-17"></a>    <span class="n">authors</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ManyToManyField</span><span class="p">(</span><span class="n">to</span><span class="o">=</span><span class="s1">&#39;Author&#39;</span><span class="p">)</span>
<a id="__codelineno-66-18" name="__codelineno-66-18"></a>
<a id="__codelineno-66-19" name="__codelineno-66-19"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-66-20" name="__codelineno-66-20"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">title</span>
<a id="__codelineno-66-21" name="__codelineno-66-21"></a>
<a id="__codelineno-66-22" name="__codelineno-66-22"></a>
<a id="__codelineno-66-23" name="__codelineno-66-23"></a><span class="k">class</span><span class="w"> </span><span class="nc">Publish</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
<a id="__codelineno-66-24" name="__codelineno-66-24"></a>    <span class="n">name</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>
<a id="__codelineno-66-25" name="__codelineno-66-25"></a>    <span class="n">addr</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">64</span><span class="p">)</span>
<a id="__codelineno-66-26" name="__codelineno-66-26"></a>    <span class="n">email</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">EmailField</span><span class="p">()</span> <span class="c1">## 本质是varchar</span>
<a id="__codelineno-66-27" name="__codelineno-66-27"></a>
<a id="__codelineno-66-28" name="__codelineno-66-28"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-66-29" name="__codelineno-66-29"></a>        <span class="k">return</span> <span class="s1">&#39;对象：</span><span class="si">%s</span><span class="s1">&#39;</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span>
<a id="__codelineno-66-30" name="__codelineno-66-30"></a>
<a id="__codelineno-66-31" name="__codelineno-66-31"></a><span class="k">class</span><span class="w"> </span><span class="nc">Author</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
<a id="__codelineno-66-32" name="__codelineno-66-32"></a>    <span class="n">name</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>
<a id="__codelineno-66-33" name="__codelineno-66-33"></a>    <span class="n">age</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">IntegerField</span><span class="p">()</span>
<a id="__codelineno-66-34" name="__codelineno-66-34"></a>
<a id="__codelineno-66-35" name="__codelineno-66-35"></a>    <span class="c1">## 一对一</span>
<a id="__codelineno-66-36" name="__codelineno-66-36"></a>    <span class="n">author_detail</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">OneToOneField</span><span class="p">(</span><span class="n">to</span><span class="o">=</span><span class="s1">&#39;AuthorDetail&#39;</span><span class="p">)</span>
<a id="__codelineno-66-37" name="__codelineno-66-37"></a>
<a id="__codelineno-66-38" name="__codelineno-66-38"></a><span class="k">class</span><span class="w"> </span><span class="nc">AuthorDetail</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
<a id="__codelineno-66-39" name="__codelineno-66-39"></a>    <span class="n">phone</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">BigIntegerField</span><span class="p">()</span>
<a id="__codelineno-66-40" name="__codelineno-66-40"></a>    <span class="n">addr</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">64</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<h4 id="17-2-viewspy">17-2 views.py<a class="headerlink" href="#17-2-viewspy" title="Permanent link">&para;</a></h4>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-67-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-67-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-67-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-67-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-67-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-67-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-67-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-67-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-67-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-67-10">10</a></span>
<span class="normal"><a href="#__codelineno-67-11">11</a></span>
<span class="normal"><a href="#__codelineno-67-12">12</a></span>
<span class="normal"><a href="#__codelineno-67-13">13</a></span>
<span class="normal"><a href="#__codelineno-67-14">14</a></span>
<span class="normal"><a href="#__codelineno-67-15">15</a></span>
<span class="normal"><a href="#__codelineno-67-16">16</a></span>
<span class="normal"><a href="#__codelineno-67-17">17</a></span>
<span class="normal"><a href="#__codelineno-67-18">18</a></span>
<span class="normal"><a href="#__codelineno-67-19">19</a></span>
<span class="normal"><a href="#__codelineno-67-20">20</a></span>
<span class="normal"><a href="#__codelineno-67-21">21</a></span>
<span class="normal"><a href="#__codelineno-67-22">22</a></span>
<span class="normal"><a href="#__codelineno-67-23">23</a></span>
<span class="normal"><a href="#__codelineno-67-24">24</a></span>
<span class="normal"><a href="#__codelineno-67-25">25</a></span>
<span class="normal"><a href="#__codelineno-67-26">26</a></span>
<span class="normal"><a href="#__codelineno-67-27">27</a></span>
<span class="normal"><a href="#__codelineno-67-28">28</a></span>
<span class="normal"><a href="#__codelineno-67-29">29</a></span>
<span class="normal"><a href="#__codelineno-67-30">30</a></span>
<span class="normal"><a href="#__codelineno-67-31">31</a></span>
<span class="normal"><a href="#__codelineno-67-32">32</a></span>
<span class="normal"><a href="#__codelineno-67-33">33</a></span>
<span class="normal"><a href="#__codelineno-67-34">34</a></span>
<span class="normal"><a href="#__codelineno-67-35">35</a></span>
<span class="normal"><a href="#__codelineno-67-36">36</a></span>
<span class="normal"><a href="#__codelineno-67-37">37</a></span>
<span class="normal"><a href="#__codelineno-67-38">38</a></span>
<span class="normal"><a href="#__codelineno-67-39">39</a></span>
<span class="normal"><a href="#__codelineno-67-40">40</a></span>
<span class="normal"><a href="#__codelineno-67-41">41</a></span>
<span class="normal"><a href="#__codelineno-67-42">42</a></span>
<span class="normal"><a href="#__codelineno-67-43">43</a></span>
<span class="normal"><a href="#__codelineno-67-44">44</a></span>
<span class="normal"><a href="#__codelineno-67-45">45</a></span>
<span class="normal"><a href="#__codelineno-67-46">46</a></span>
<span class="normal"><a href="#__codelineno-67-47">47</a></span>
<span class="normal"><a href="#__codelineno-67-48">48</a></span>
<span class="normal"><a href="#__codelineno-67-49">49</a></span>
<span class="normal"><a href="#__codelineno-67-50">50</a></span>
<span class="normal"><a href="#__codelineno-67-51">51</a></span>
<span class="normal"><a href="#__codelineno-67-52">52</a></span>
<span class="normal"><a href="#__codelineno-67-53">53</a></span>
<span class="normal"><a href="#__codelineno-67-54">54</a></span>
<span class="normal"><a href="#__codelineno-67-55">55</a></span>
<span class="normal"><a href="#__codelineno-67-56">56</a></span>
<span class="normal"><a href="#__codelineno-67-57">57</a></span>
<span class="normal"><a href="#__codelineno-67-58">58</a></span>
<span class="normal"><a href="#__codelineno-67-59">59</a></span>
<span class="normal"><a href="#__codelineno-67-60">60</a></span>
<span class="normal"><a href="#__codelineno-67-61">61</a></span>
<span class="normal"><a href="#__codelineno-67-62">62</a></span>
<span class="normal"><a href="#__codelineno-67-63">63</a></span>
<span class="normal"><a href="#__codelineno-67-64">64</a></span>
<span class="normal"><a href="#__codelineno-67-65">65</a></span>
<span class="normal"><a href="#__codelineno-67-66">66</a></span>
<span class="normal"><a href="#__codelineno-67-67">67</a></span>
<span class="normal"><a href="#__codelineno-67-68">68</a></span>
<span class="normal"><a href="#__codelineno-67-69">69</a></span>
<span class="normal"><a href="#__codelineno-67-70">70</a></span>
<span class="normal"><a href="#__codelineno-67-71">71</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-67-1" name="__codelineno-67-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.shortcuts</span><span class="w"> </span><span class="kn">import</span> <span class="n">render</span><span class="p">,</span><span class="n">redirect</span><span class="p">,</span><span class="n">HttpResponse</span>
<a id="__codelineno-67-2" name="__codelineno-67-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">app01</span><span class="w"> </span><span class="kn">import</span> <span class="n">models</span>
<a id="__codelineno-67-3" name="__codelineno-67-3"></a><span class="c1"># Create your views here.</span>
<a id="__codelineno-67-4" name="__codelineno-67-4"></a>
<a id="__codelineno-67-5" name="__codelineno-67-5"></a><span class="k">def</span><span class="w"> </span><span class="nf">home</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
<a id="__codelineno-67-6" name="__codelineno-67-6"></a>    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span><span class="s1">&#39;home.html&#39;</span><span class="p">)</span>
<a id="__codelineno-67-7" name="__codelineno-67-7"></a>
<a id="__codelineno-67-8" name="__codelineno-67-8"></a>
<a id="__codelineno-67-9" name="__codelineno-67-9"></a><span class="k">def</span><span class="w"> </span><span class="nf">book_list</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
<a id="__codelineno-67-10" name="__codelineno-67-10"></a>    <span class="c1"># 先查询出所有的书籍信息 传递给html页面</span>
<a id="__codelineno-67-11" name="__codelineno-67-11"></a>    <span class="n">book_queryset</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Book</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
<a id="__codelineno-67-12" name="__codelineno-67-12"></a>    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span><span class="s1">&#39;book_list.html&#39;</span><span class="p">,</span><span class="nb">locals</span><span class="p">())</span>
<a id="__codelineno-67-13" name="__codelineno-67-13"></a>
<a id="__codelineno-67-14" name="__codelineno-67-14"></a>
<a id="__codelineno-67-15" name="__codelineno-67-15"></a><span class="k">def</span><span class="w"> </span><span class="nf">book_add</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
<a id="__codelineno-67-16" name="__codelineno-67-16"></a>    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;POST&#39;</span><span class="p">:</span>
<a id="__codelineno-67-17" name="__codelineno-67-17"></a>        <span class="c1"># 获取前端提交过来的所有数据</span>
<a id="__codelineno-67-18" name="__codelineno-67-18"></a>        <span class="n">title</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;title&quot;</span><span class="p">)</span>
<a id="__codelineno-67-19" name="__codelineno-67-19"></a>        <span class="n">price</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;price&quot;</span><span class="p">)</span>
<a id="__codelineno-67-20" name="__codelineno-67-20"></a>        <span class="n">publish_date</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;publish_date&quot;</span><span class="p">)</span>
<a id="__codelineno-67-21" name="__codelineno-67-21"></a>        <span class="n">publish_id</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;publish&quot;</span><span class="p">)</span>
<a id="__codelineno-67-22" name="__codelineno-67-22"></a>        <span class="n">authors_list</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="o">.</span><span class="n">getlist</span><span class="p">(</span><span class="s2">&quot;authors&quot;</span><span class="p">)</span>  <span class="c1"># [1,2,3,4,]</span>
<a id="__codelineno-67-23" name="__codelineno-67-23"></a>        <span class="c1"># 操作数据库存储数据</span>
<a id="__codelineno-67-24" name="__codelineno-67-24"></a>        <span class="c1"># 书籍表</span>
<a id="__codelineno-67-25" name="__codelineno-67-25"></a>        <span class="n">book_obj</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Book</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span><span class="n">price</span><span class="o">=</span><span class="n">price</span><span class="p">,</span><span class="n">publish_date</span><span class="o">=</span><span class="n">publish_date</span><span class="p">,</span><span class="n">publish_id</span><span class="o">=</span><span class="n">publish_id</span><span class="p">)</span>
<a id="__codelineno-67-26" name="__codelineno-67-26"></a>        <span class="c1"># 书籍与作者的关系表</span>
<a id="__codelineno-67-27" name="__codelineno-67-27"></a>        <span class="n">book_obj</span><span class="o">.</span><span class="n">authors</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="o">*</span><span class="n">authors_list</span><span class="p">)</span>
<a id="__codelineno-67-28" name="__codelineno-67-28"></a>        <span class="c1"># 跳转到书籍的展示页面</span>
<a id="__codelineno-67-29" name="__codelineno-67-29"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-67-30" name="__codelineno-67-30"></a><span class="sd">        redirect括号内可以直接写url</span>
<a id="__codelineno-67-31" name="__codelineno-67-31"></a><span class="sd">        其实也可以直接写别名</span>
<a id="__codelineno-67-32" name="__codelineno-67-32"></a>
<a id="__codelineno-67-33" name="__codelineno-67-33"></a><span class="sd">        但是如果你的别名需要额外给参数的话，那么就必须使用reverse解析了</span>
<a id="__codelineno-67-34" name="__codelineno-67-34"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-67-35" name="__codelineno-67-35"></a>        <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;book_list&#39;</span><span class="p">)</span>
<a id="__codelineno-67-36" name="__codelineno-67-36"></a>
<a id="__codelineno-67-37" name="__codelineno-67-37"></a>
<a id="__codelineno-67-38" name="__codelineno-67-38"></a>    <span class="c1"># 先获取当前系统中所有的出版社信息和作者信息</span>
<a id="__codelineno-67-39" name="__codelineno-67-39"></a>    <span class="n">publish_queryset</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Publish</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
<a id="__codelineno-67-40" name="__codelineno-67-40"></a>    <span class="n">author_queryset</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Author</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
<a id="__codelineno-67-41" name="__codelineno-67-41"></a>    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span><span class="s1">&#39;book_add.html&#39;</span><span class="p">,</span><span class="nb">locals</span><span class="p">())</span>
<a id="__codelineno-67-42" name="__codelineno-67-42"></a>
<a id="__codelineno-67-43" name="__codelineno-67-43"></a>
<a id="__codelineno-67-44" name="__codelineno-67-44"></a><span class="k">def</span><span class="w"> </span><span class="nf">book_edit</span><span class="p">(</span><span class="n">request</span><span class="p">,</span><span class="n">edit_id</span><span class="p">):</span>
<a id="__codelineno-67-45" name="__codelineno-67-45"></a>    <span class="c1"># 获取当前用户想要编辑的书籍对象 展示给用户看</span>
<a id="__codelineno-67-46" name="__codelineno-67-46"></a>    <span class="n">edit_obj</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Book</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="n">edit_id</span><span class="p">)</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
<a id="__codelineno-67-47" name="__codelineno-67-47"></a>    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;POST&#39;</span><span class="p">:</span>
<a id="__codelineno-67-48" name="__codelineno-67-48"></a>        <span class="n">title</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;title&quot;</span><span class="p">)</span>
<a id="__codelineno-67-49" name="__codelineno-67-49"></a>        <span class="n">price</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;price&quot;</span><span class="p">)</span>
<a id="__codelineno-67-50" name="__codelineno-67-50"></a>        <span class="n">publish_date</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;publish_date&quot;</span><span class="p">)</span>
<a id="__codelineno-67-51" name="__codelineno-67-51"></a>        <span class="n">publish_id</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;publish&quot;</span><span class="p">)</span>
<a id="__codelineno-67-52" name="__codelineno-67-52"></a>        <span class="n">authors_list</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="o">.</span><span class="n">getlist</span><span class="p">(</span><span class="s2">&quot;authors&quot;</span><span class="p">)</span>  <span class="c1"># [1,2,3,4,]</span>
<a id="__codelineno-67-53" name="__codelineno-67-53"></a>        <span class="n">models</span><span class="o">.</span><span class="n">Book</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="n">edit_id</span><span class="p">)</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span>
<a id="__codelineno-67-54" name="__codelineno-67-54"></a>                                                      <span class="n">price</span><span class="o">=</span><span class="n">price</span><span class="p">,</span>
<a id="__codelineno-67-55" name="__codelineno-67-55"></a>                                                      <span class="n">publish_date</span><span class="o">=</span><span class="n">publish_date</span><span class="p">,</span>
<a id="__codelineno-67-56" name="__codelineno-67-56"></a>                                                      <span class="n">publish_id</span><span class="o">=</span><span class="n">publish_id</span>
<a id="__codelineno-67-57" name="__codelineno-67-57"></a>                                                      <span class="p">)</span>
<a id="__codelineno-67-58" name="__codelineno-67-58"></a>        <span class="c1"># 该第三张关系表</span>
<a id="__codelineno-67-59" name="__codelineno-67-59"></a>        <span class="n">edit_obj</span><span class="o">.</span><span class="n">authors</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">authors_list</span><span class="p">)</span>
<a id="__codelineno-67-60" name="__codelineno-67-60"></a>        <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;book_list&#39;</span><span class="p">)</span>
<a id="__codelineno-67-61" name="__codelineno-67-61"></a>
<a id="__codelineno-67-62" name="__codelineno-67-62"></a>    <span class="n">publish_queryset</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Publish</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
<a id="__codelineno-67-63" name="__codelineno-67-63"></a>    <span class="n">author_queryset</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Author</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
<a id="__codelineno-67-64" name="__codelineno-67-64"></a>    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span><span class="s1">&#39;book_edit.html&#39;</span><span class="p">,</span><span class="nb">locals</span><span class="p">())</span>
<a id="__codelineno-67-65" name="__codelineno-67-65"></a>
<a id="__codelineno-67-66" name="__codelineno-67-66"></a>
<a id="__codelineno-67-67" name="__codelineno-67-67"></a><span class="k">def</span><span class="w"> </span><span class="nf">book_delete</span><span class="p">(</span><span class="n">request</span><span class="p">,</span><span class="n">delete_id</span><span class="p">):</span>
<a id="__codelineno-67-68" name="__codelineno-67-68"></a>    <span class="c1"># 简单粗暴 直接删除</span>
<a id="__codelineno-67-69" name="__codelineno-67-69"></a>    <span class="n">models</span><span class="o">.</span><span class="n">Book</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="n">delete_id</span><span class="p">)</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
<a id="__codelineno-67-70" name="__codelineno-67-70"></a>    <span class="c1"># 直接跳转到展示页</span>
<a id="__codelineno-67-71" name="__codelineno-67-71"></a>    <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;book_list&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<h4 id="17-3-urlspy">17-3 urls.py<a class="headerlink" href="#17-3-urlspy" title="Permanent link">&para;</a></h4>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-68-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-68-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-68-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-68-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-68-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-68-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-68-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-68-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-68-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-68-10">10</a></span>
<span class="normal"><a href="#__codelineno-68-11">11</a></span>
<span class="normal"><a href="#__codelineno-68-12">12</a></span>
<span class="normal"><a href="#__codelineno-68-13">13</a></span>
<span class="normal"><a href="#__codelineno-68-14">14</a></span>
<span class="normal"><a href="#__codelineno-68-15">15</a></span>
<span class="normal"><a href="#__codelineno-68-16">16</a></span>
<span class="normal"><a href="#__codelineno-68-17">17</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-68-1" name="__codelineno-68-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.conf.urls</span><span class="w"> </span><span class="kn">import</span> <span class="n">url</span>
<a id="__codelineno-68-2" name="__codelineno-68-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.contrib</span><span class="w"> </span><span class="kn">import</span> <span class="n">admin</span>
<a id="__codelineno-68-3" name="__codelineno-68-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">app01</span><span class="w"> </span><span class="kn">import</span> <span class="n">views</span>
<a id="__codelineno-68-4" name="__codelineno-68-4"></a>
<a id="__codelineno-68-5" name="__codelineno-68-5"></a><span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-68-6" name="__codelineno-68-6"></a>    <span class="n">url</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^admin/&#39;</span><span class="p">,</span> <span class="n">admin</span><span class="o">.</span><span class="n">site</span><span class="o">.</span><span class="n">urls</span><span class="p">),</span>
<a id="__codelineno-68-7" name="__codelineno-68-7"></a>    <span class="c1">## 首页</span>
<a id="__codelineno-68-8" name="__codelineno-68-8"></a>    <span class="n">url</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^$&#39;</span><span class="p">,</span><span class="n">views</span><span class="o">.</span><span class="n">home</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;home&#39;</span><span class="p">),</span>
<a id="__codelineno-68-9" name="__codelineno-68-9"></a>    <span class="c1">## 图书的展示页</span>
<a id="__codelineno-68-10" name="__codelineno-68-10"></a>    <span class="n">url</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^book/list&#39;</span><span class="p">,</span><span class="n">views</span><span class="o">.</span><span class="n">book_list</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;book_list&#39;</span><span class="p">),</span>
<a id="__codelineno-68-11" name="__codelineno-68-11"></a>    <span class="c1">## 书籍的添加</span>
<a id="__codelineno-68-12" name="__codelineno-68-12"></a>    <span class="n">url</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^book/add&#39;</span><span class="p">,</span><span class="n">views</span><span class="o">.</span><span class="n">book_add</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;book_add&#39;</span><span class="p">),</span>
<a id="__codelineno-68-13" name="__codelineno-68-13"></a>    <span class="c1">## 编辑页面的URL</span>
<a id="__codelineno-68-14" name="__codelineno-68-14"></a>    <span class="n">url</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^book/edit/(?P&lt;edit_id&gt;\d+)&#39;</span><span class="p">,</span><span class="n">views</span><span class="o">.</span><span class="n">book_edit</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;book_edit&#39;</span><span class="p">),</span>
<a id="__codelineno-68-15" name="__codelineno-68-15"></a>    <span class="c1">## 书籍的删除</span>
<a id="__codelineno-68-16" name="__codelineno-68-16"></a>    <span class="n">url</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^book/del/(?P&lt;del_id&gt;\d+)&#39;</span><span class="p">,</span><span class="n">views</span><span class="o">.</span><span class="n">book_del</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;book_del&#39;</span><span class="p">)</span>
<a id="__codelineno-68-17" name="__codelineno-68-17"></a><span class="p">]</span>
</code></pre></div></td></tr></table></div>
<h4 id="17-4-homehtml">17-4 home.html<a class="headerlink" href="#17-4-homehtml" title="Permanent link">&para;</a></h4>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">HTML</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-69-1">  1</a></span>
<span class="normal"><a href="#__codelineno-69-2">  2</a></span>
<span class="normal"><a href="#__codelineno-69-3">  3</a></span>
<span class="normal"><a href="#__codelineno-69-4">  4</a></span>
<span class="normal"><a href="#__codelineno-69-5">  5</a></span>
<span class="normal"><a href="#__codelineno-69-6">  6</a></span>
<span class="normal"><a href="#__codelineno-69-7">  7</a></span>
<span class="normal"><a href="#__codelineno-69-8">  8</a></span>
<span class="normal"><a href="#__codelineno-69-9">  9</a></span>
<span class="normal"><a href="#__codelineno-69-10"> 10</a></span>
<span class="normal"><a href="#__codelineno-69-11"> 11</a></span>
<span class="normal"><a href="#__codelineno-69-12"> 12</a></span>
<span class="normal"><a href="#__codelineno-69-13"> 13</a></span>
<span class="normal"><a href="#__codelineno-69-14"> 14</a></span>
<span class="normal"><a href="#__codelineno-69-15"> 15</a></span>
<span class="normal"><a href="#__codelineno-69-16"> 16</a></span>
<span class="normal"><a href="#__codelineno-69-17"> 17</a></span>
<span class="normal"><a href="#__codelineno-69-18"> 18</a></span>
<span class="normal"><a href="#__codelineno-69-19"> 19</a></span>
<span class="normal"><a href="#__codelineno-69-20"> 20</a></span>
<span class="normal"><a href="#__codelineno-69-21"> 21</a></span>
<span class="normal"><a href="#__codelineno-69-22"> 22</a></span>
<span class="normal"><a href="#__codelineno-69-23"> 23</a></span>
<span class="normal"><a href="#__codelineno-69-24"> 24</a></span>
<span class="normal"><a href="#__codelineno-69-25"> 25</a></span>
<span class="normal"><a href="#__codelineno-69-26"> 26</a></span>
<span class="normal"><a href="#__codelineno-69-27"> 27</a></span>
<span class="normal"><a href="#__codelineno-69-28"> 28</a></span>
<span class="normal"><a href="#__codelineno-69-29"> 29</a></span>
<span class="normal"><a href="#__codelineno-69-30"> 30</a></span>
<span class="normal"><a href="#__codelineno-69-31"> 31</a></span>
<span class="normal"><a href="#__codelineno-69-32"> 32</a></span>
<span class="normal"><a href="#__codelineno-69-33"> 33</a></span>
<span class="normal"><a href="#__codelineno-69-34"> 34</a></span>
<span class="normal"><a href="#__codelineno-69-35"> 35</a></span>
<span class="normal"><a href="#__codelineno-69-36"> 36</a></span>
<span class="normal"><a href="#__codelineno-69-37"> 37</a></span>
<span class="normal"><a href="#__codelineno-69-38"> 38</a></span>
<span class="normal"><a href="#__codelineno-69-39"> 39</a></span>
<span class="normal"><a href="#__codelineno-69-40"> 40</a></span>
<span class="normal"><a href="#__codelineno-69-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-69-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-69-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-69-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-69-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-69-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-69-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-69-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-69-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-69-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-69-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-69-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-69-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-69-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-69-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-69-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-69-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-69-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-69-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-69-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-69-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-69-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-69-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-69-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-69-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-69-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-69-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-69-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-69-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-69-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-69-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-69-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-69-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-69-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-69-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-69-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-69-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-69-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-69-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-69-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-69-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-69-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-69-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-69-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-69-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-69-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-69-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-69-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-69-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-69-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-69-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-69-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-69-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-69-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-69-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-69-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-69-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-69-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-69-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-69-100">100</a></span>
<span class="normal"><a href="#__codelineno-69-101">101</a></span>
<span class="normal"><a href="#__codelineno-69-102">102</a></span>
<span class="normal"><a href="#__codelineno-69-103">103</a></span>
<span class="normal"><a href="#__codelineno-69-104">104</a></span>
<span class="normal"><a href="#__codelineno-69-105">105</a></span>
<span class="normal"><a href="#__codelineno-69-106">106</a></span>
<span class="normal"><a href="#__codelineno-69-107">107</a></span>
<span class="normal"><a href="#__codelineno-69-108">108</a></span>
<span class="normal"><a href="#__codelineno-69-109">109</a></span>
<span class="normal"><a href="#__codelineno-69-110">110</a></span>
<span class="normal"><a href="#__codelineno-69-111">111</a></span>
<span class="normal"><a href="#__codelineno-69-112">112</a></span>
<span class="normal"><a href="#__codelineno-69-113">113</a></span>
<span class="normal"><a href="#__codelineno-69-114">114</a></span>
<span class="normal"><a href="#__codelineno-69-115">115</a></span>
<span class="normal"><a href="#__codelineno-69-116">116</a></span>
<span class="normal"><a href="#__codelineno-69-117">117</a></span>
<span class="normal"><a href="#__codelineno-69-118">118</a></span>
<span class="normal"><a href="#__codelineno-69-119">119</a></span>
<span class="normal"><a href="#__codelineno-69-120">120</a></span>
<span class="normal"><a href="#__codelineno-69-121">121</a></span>
<span class="normal"><a href="#__codelineno-69-122">122</a></span>
<span class="normal"><a href="#__codelineno-69-123">123</a></span>
<span class="normal"><a href="#__codelineno-69-124">124</a></span>
<span class="normal"><a href="#__codelineno-69-125">125</a></span>
<span class="normal"><a href="#__codelineno-69-126">126</a></span>
<span class="normal"><a href="#__codelineno-69-127">127</a></span>
<span class="normal"><a href="#__codelineno-69-128">128</a></span>
<span class="normal"><a href="#__codelineno-69-129">129</a></span>
<span class="normal"><a href="#__codelineno-69-130">130</a></span>
<span class="normal"><a href="#__codelineno-69-131">131</a></span>
<span class="normal"><a href="#__codelineno-69-132">132</a></span>
<span class="normal"><a href="#__codelineno-69-133">133</a></span>
<span class="normal"><a href="#__codelineno-69-134">134</a></span>
<span class="normal"><a href="#__codelineno-69-135">135</a></span>
<span class="normal"><a href="#__codelineno-69-136">136</a></span>
<span class="normal"><a href="#__codelineno-69-137">137</a></span>
<span class="normal"><a href="#__codelineno-69-138">138</a></span>
<span class="normal"><a href="#__codelineno-69-139">139</a></span>
<span class="normal"><a href="#__codelineno-69-140">140</a></span>
<span class="normal"><a href="#__codelineno-69-141">141</a></span>
<span class="normal"><a href="#__codelineno-69-142">142</a></span>
<span class="normal"><a href="#__codelineno-69-143">143</a></span>
<span class="normal"><a href="#__codelineno-69-144">144</a></span>
<span class="normal"><a href="#__codelineno-69-145">145</a></span>
<span class="normal"><a href="#__codelineno-69-146">146</a></span>
<span class="normal"><a href="#__codelineno-69-147">147</a></span>
<span class="normal"><a href="#__codelineno-69-148">148</a></span>
<span class="normal"><a href="#__codelineno-69-149">149</a></span>
<span class="normal"><a href="#__codelineno-69-150">150</a></span>
<span class="normal"><a href="#__codelineno-69-151">151</a></span>
<span class="normal"><a href="#__codelineno-69-152">152</a></span>
<span class="normal"><a href="#__codelineno-69-153">153</a></span>
<span class="normal"><a href="#__codelineno-69-154">154</a></span>
<span class="normal"><a href="#__codelineno-69-155">155</a></span>
<span class="normal"><a href="#__codelineno-69-156">156</a></span>
<span class="normal"><a href="#__codelineno-69-157">157</a></span>
<span class="normal"><a href="#__codelineno-69-158">158</a></span>
<span class="normal"><a href="#__codelineno-69-159">159</a></span>
<span class="normal"><a href="#__codelineno-69-160">160</a></span>
<span class="normal"><a href="#__codelineno-69-161">161</a></span>
<span class="normal"><a href="#__codelineno-69-162">162</a></span>
<span class="normal"><a href="#__codelineno-69-163">163</a></span>
<span class="normal"><a href="#__codelineno-69-164">164</a></span>
<span class="normal"><a href="#__codelineno-69-165">165</a></span>
<span class="normal"><a href="#__codelineno-69-166">166</a></span>
<span class="normal"><a href="#__codelineno-69-167">167</a></span>
<span class="normal"><a href="#__codelineno-69-168">168</a></span>
<span class="normal"><a href="#__codelineno-69-169">169</a></span>
<span class="normal"><a href="#__codelineno-69-170">170</a></span>
<span class="normal"><a href="#__codelineno-69-171">171</a></span>
<span class="normal"><a href="#__codelineno-69-172">172</a></span>
<span class="normal"><a href="#__codelineno-69-173">173</a></span>
<span class="normal"><a href="#__codelineno-69-174">174</a></span>
<span class="normal"><a href="#__codelineno-69-175">175</a></span>
<span class="normal"><a href="#__codelineno-69-176">176</a></span>
<span class="normal"><a href="#__codelineno-69-177">177</a></span>
<span class="normal"><a href="#__codelineno-69-178">178</a></span>
<span class="normal"><a href="#__codelineno-69-179">179</a></span>
<span class="normal"><a href="#__codelineno-69-180">180</a></span>
<span class="normal"><a href="#__codelineno-69-181">181</a></span>
<span class="normal"><a href="#__codelineno-69-182">182</a></span>
<span class="normal"><a href="#__codelineno-69-183">183</a></span>
<span class="normal"><a href="#__codelineno-69-184">184</a></span>
<span class="normal"><a href="#__codelineno-69-185">185</a></span>
<span class="normal"><a href="#__codelineno-69-186">186</a></span>
<span class="normal"><a href="#__codelineno-69-187">187</a></span>
<span class="normal"><a href="#__codelineno-69-188">188</a></span>
<span class="normal"><a href="#__codelineno-69-189">189</a></span>
<span class="normal"><a href="#__codelineno-69-190">190</a></span>
<span class="normal"><a href="#__codelineno-69-191">191</a></span>
<span class="normal"><a href="#__codelineno-69-192">192</a></span>
<span class="normal"><a href="#__codelineno-69-193">193</a></span>
<span class="normal"><a href="#__codelineno-69-194">194</a></span>
<span class="normal"><a href="#__codelineno-69-195">195</a></span>
<span class="normal"><a href="#__codelineno-69-196">196</a></span>
<span class="normal"><a href="#__codelineno-69-197">197</a></span>
<span class="normal"><a href="#__codelineno-69-198">198</a></span>
<span class="normal"><a href="#__codelineno-69-199">199</a></span>
<span class="normal"><a href="#__codelineno-69-200">200</a></span>
<span class="normal"><a href="#__codelineno-69-201">201</a></span>
<span class="normal"><a href="#__codelineno-69-202">202</a></span>
<span class="normal"><a href="#__codelineno-69-203">203</a></span>
<span class="normal"><a href="#__codelineno-69-204">204</a></span>
<span class="normal"><a href="#__codelineno-69-205">205</a></span>
<span class="normal"><a href="#__codelineno-69-206">206</a></span>
<span class="normal"><a href="#__codelineno-69-207">207</a></span>
<span class="normal"><a href="#__codelineno-69-208">208</a></span>
<span class="normal"><a href="#__codelineno-69-209">209</a></span>
<span class="normal"><a href="#__codelineno-69-210">210</a></span>
<span class="normal"><a href="#__codelineno-69-211">211</a></span>
<span class="normal"><a href="#__codelineno-69-212">212</a></span>
<span class="normal"><a href="#__codelineno-69-213">213</a></span>
<span class="normal"><a href="#__codelineno-69-214">214</a></span>
<span class="normal"><a href="#__codelineno-69-215">215</a></span>
<span class="normal"><a href="#__codelineno-69-216">216</a></span>
<span class="normal"><a href="#__codelineno-69-217">217</a></span>
<span class="normal"><a href="#__codelineno-69-218">218</a></span>
<span class="normal"><a href="#__codelineno-69-219">219</a></span>
<span class="normal"><a href="#__codelineno-69-220">220</a></span>
<span class="normal"><a href="#__codelineno-69-221">221</a></span>
<span class="normal"><a href="#__codelineno-69-222">222</a></span>
<span class="normal"><a href="#__codelineno-69-223">223</a></span>
<span class="normal"><a href="#__codelineno-69-224">224</a></span>
<span class="normal"><a href="#__codelineno-69-225">225</a></span>
<span class="normal"><a href="#__codelineno-69-226">226</a></span>
<span class="normal"><a href="#__codelineno-69-227">227</a></span>
<span class="normal"><a href="#__codelineno-69-228">228</a></span>
<span class="normal"><a href="#__codelineno-69-229">229</a></span>
<span class="normal"><a href="#__codelineno-69-230">230</a></span>
<span class="normal"><a href="#__codelineno-69-231">231</a></span>
<span class="normal"><a href="#__codelineno-69-232">232</a></span>
<span class="normal"><a href="#__codelineno-69-233">233</a></span>
<span class="normal"><a href="#__codelineno-69-234">234</a></span>
<span class="normal"><a href="#__codelineno-69-235">235</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-69-1" name="__codelineno-69-1"></a><span class="cp">&lt;!DOCTYPE html&gt;</span>
<a id="__codelineno-69-2" name="__codelineno-69-2"></a><span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&quot;en&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-69-3" name="__codelineno-69-3"></a><span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
<a id="__codelineno-69-4" name="__codelineno-69-4"></a>    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&quot;UTF-8&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-69-5" name="__codelineno-69-5"></a>    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>Title<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
<a id="__codelineno-69-6" name="__codelineno-69-6"></a>
<a id="__codelineno-69-7" name="__codelineno-69-7"></a>    <span class="p">&lt;</span><span class="nt">link</span> <span class="na">rel</span><span class="o">=</span><span class="s">&quot;stylesheet&quot;</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/css/bootstrap.min.css&quot;</span>
<a id="__codelineno-69-8" name="__codelineno-69-8"></a>          <span class="na">integrity</span><span class="o">=</span><span class="s">&quot;sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u&quot;</span> <span class="na">crossorigin</span><span class="o">=</span><span class="s">&quot;anonymous&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-69-9" name="__codelineno-69-9"></a>    <span class="p">&lt;</span><span class="nt">link</span> <span class="na">rel</span><span class="o">=</span><span class="s">&quot;stylesheet&quot;</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/css/bootstrap-theme.min.css&quot;</span>
<a id="__codelineno-69-10" name="__codelineno-69-10"></a>          <span class="na">integrity</span><span class="o">=</span><span class="s">&quot;sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp&quot;</span> <span class="na">crossorigin</span><span class="o">=</span><span class="s">&quot;anonymous&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-69-11" name="__codelineno-69-11"></a>    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/js/bootstrap.min.js&quot;</span>
<a id="__codelineno-69-12" name="__codelineno-69-12"></a>            <span class="na">integrity</span><span class="o">=</span><span class="s">&quot;sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa&quot;</span>
<a id="__codelineno-69-13" name="__codelineno-69-13"></a>            <span class="na">crossorigin</span><span class="o">=</span><span class="s">&quot;anonymous&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<a id="__codelineno-69-14" name="__codelineno-69-14"></a>
<a id="__codelineno-69-15" name="__codelineno-69-15"></a>    {% block css %}
<a id="__codelineno-69-16" name="__codelineno-69-16"></a>
<a id="__codelineno-69-17" name="__codelineno-69-17"></a>
<a id="__codelineno-69-18" name="__codelineno-69-18"></a>    {% endblock %}
<a id="__codelineno-69-19" name="__codelineno-69-19"></a><span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<a id="__codelineno-69-20" name="__codelineno-69-20"></a>
<a id="__codelineno-69-21" name="__codelineno-69-21"></a><span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
<a id="__codelineno-69-22" name="__codelineno-69-22"></a><span class="p">&lt;</span><span class="nt">nav</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;navbar navbar-inverse&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-69-23" name="__codelineno-69-23"></a>    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;container-fluid&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-69-24" name="__codelineno-69-24"></a>        <span class="cm">&lt;!-- Brand and toggle get grouped for better mobile display --&gt;</span>
<a id="__codelineno-69-25" name="__codelineno-69-25"></a>        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;navbar-header&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-69-26" name="__codelineno-69-26"></a>            <span class="p">&lt;</span><span class="nt">button</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;button&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;navbar-toggle collapsed&quot;</span> <span class="na">data-toggle</span><span class="o">=</span><span class="s">&quot;collapse&quot;</span>
<a id="__codelineno-69-27" name="__codelineno-69-27"></a>                    <span class="na">data-target</span><span class="o">=</span><span class="s">&quot;#bs-example-navbar-collapse-1&quot;</span> <span class="na">aria-expanded</span><span class="o">=</span><span class="s">&quot;false&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-69-28" name="__codelineno-69-28"></a>                <span class="p">&lt;</span><span class="nt">span</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;sr-only&quot;</span><span class="p">&gt;</span>Toggle navigation<span class="p">&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>
<a id="__codelineno-69-29" name="__codelineno-69-29"></a>
<a id="__codelineno-69-30" name="__codelineno-69-30"></a>                <span class="p">&lt;</span><span class="nt">span</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;icon-bar&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>
<a id="__codelineno-69-31" name="__codelineno-69-31"></a>
<a id="__codelineno-69-32" name="__codelineno-69-32"></a>                <span class="p">&lt;</span><span class="nt">span</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;icon-bar&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>
<a id="__codelineno-69-33" name="__codelineno-69-33"></a>
<a id="__codelineno-69-34" name="__codelineno-69-34"></a>                <span class="p">&lt;</span><span class="nt">span</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;icon-bar&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>
<a id="__codelineno-69-35" name="__codelineno-69-35"></a>
<a id="__codelineno-69-36" name="__codelineno-69-36"></a>            <span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<a id="__codelineno-69-37" name="__codelineno-69-37"></a>
<a id="__codelineno-69-38" name="__codelineno-69-38"></a>            <span class="p">&lt;</span><span class="nt">a</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;navbar-brand&quot;</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;#&quot;</span><span class="p">&gt;</span>图书馆里系统<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
<a id="__codelineno-69-39" name="__codelineno-69-39"></a>
<a id="__codelineno-69-40" name="__codelineno-69-40"></a>        <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a id="__codelineno-69-41" name="__codelineno-69-41"></a>
<a id="__codelineno-69-42" name="__codelineno-69-42"></a>        <span class="cm">&lt;!-- Collect the nav links, forms, and other content for toggling --&gt;</span>
<a id="__codelineno-69-43" name="__codelineno-69-43"></a>        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;collapse navbar-collapse&quot;</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;bs-example-navbar-collapse-1&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-69-44" name="__codelineno-69-44"></a>            <span class="p">&lt;</span><span class="nt">ul</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;nav navbar-nav&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-69-45" name="__codelineno-69-45"></a>                <span class="p">&lt;</span><span class="nt">li</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;active&quot;</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;#&quot;</span><span class="p">&gt;</span>图书<span class="p">&lt;</span><span class="nt">span</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;sr-only&quot;</span><span class="p">&gt;</span>(current)<span class="p">&lt;/</span><span class="nt">span</span><span class="p">&gt;&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
<a id="__codelineno-69-46" name="__codelineno-69-46"></a>
<a id="__codelineno-69-47" name="__codelineno-69-47"></a>                <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;#&quot;</span><span class="p">&gt;</span>作者<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
<a id="__codelineno-69-48" name="__codelineno-69-48"></a>
<a id="__codelineno-69-49" name="__codelineno-69-49"></a>                <span class="p">&lt;</span><span class="nt">li</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;dropdown&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-69-50" name="__codelineno-69-50"></a>                    <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;#&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;dropdown-toggle&quot;</span> <span class="na">data-toggle</span><span class="o">=</span><span class="s">&quot;dropdown&quot;</span> <span class="na">role</span><span class="o">=</span><span class="s">&quot;button&quot;</span> <span class="na">aria-haspopup</span><span class="o">=</span><span class="s">&quot;true&quot;</span>
<a id="__codelineno-69-51" name="__codelineno-69-51"></a>                       <span class="na">aria-expanded</span><span class="o">=</span><span class="s">&quot;false&quot;</span><span class="p">&gt;</span>更多<span class="p">&lt;</span><span class="nt">span</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;caret&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">span</span><span class="p">&gt;&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
<a id="__codelineno-69-52" name="__codelineno-69-52"></a>
<a id="__codelineno-69-53" name="__codelineno-69-53"></a>                    <span class="p">&lt;</span><span class="nt">ul</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;dropdown-menu&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-69-54" name="__codelineno-69-54"></a>                        <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;#&quot;</span><span class="p">&gt;</span>Action<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
<a id="__codelineno-69-55" name="__codelineno-69-55"></a>
<a id="__codelineno-69-56" name="__codelineno-69-56"></a>                        <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;#&quot;</span><span class="p">&gt;</span>Another action<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
<a id="__codelineno-69-57" name="__codelineno-69-57"></a>
<a id="__codelineno-69-58" name="__codelineno-69-58"></a>                        <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;#&quot;</span><span class="p">&gt;</span>Something else here<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
<a id="__codelineno-69-59" name="__codelineno-69-59"></a>
<a id="__codelineno-69-60" name="__codelineno-69-60"></a>                        <span class="p">&lt;</span><span class="nt">li</span> <span class="na">role</span><span class="o">=</span><span class="s">&quot;separator&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;divider&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
<a id="__codelineno-69-61" name="__codelineno-69-61"></a>
<a id="__codelineno-69-62" name="__codelineno-69-62"></a>                        <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;#&quot;</span><span class="p">&gt;</span>Separated link<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
<a id="__codelineno-69-63" name="__codelineno-69-63"></a>
<a id="__codelineno-69-64" name="__codelineno-69-64"></a>                        <span class="p">&lt;</span><span class="nt">li</span> <span class="na">role</span><span class="o">=</span><span class="s">&quot;separator&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;divider&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
<a id="__codelineno-69-65" name="__codelineno-69-65"></a>
<a id="__codelineno-69-66" name="__codelineno-69-66"></a>                        <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;#&quot;</span><span class="p">&gt;</span>One more separated link<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
<a id="__codelineno-69-67" name="__codelineno-69-67"></a>
<a id="__codelineno-69-68" name="__codelineno-69-68"></a>                    <span class="p">&lt;/</span><span class="nt">ul</span><span class="p">&gt;</span>
<a id="__codelineno-69-69" name="__codelineno-69-69"></a>
<a id="__codelineno-69-70" name="__codelineno-69-70"></a>                <span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
<a id="__codelineno-69-71" name="__codelineno-69-71"></a>
<a id="__codelineno-69-72" name="__codelineno-69-72"></a>            <span class="p">&lt;/</span><span class="nt">ul</span><span class="p">&gt;</span>
<a id="__codelineno-69-73" name="__codelineno-69-73"></a>
<a id="__codelineno-69-74" name="__codelineno-69-74"></a>            <span class="p">&lt;</span><span class="nt">form</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;navbar-form navbar-left&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-69-75" name="__codelineno-69-75"></a>                <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;form-group&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-69-76" name="__codelineno-69-76"></a>                    <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;text&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;form-control&quot;</span> <span class="na">placeholder</span><span class="o">=</span><span class="s">&quot;Search&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-69-77" name="__codelineno-69-77"></a>                <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a id="__codelineno-69-78" name="__codelineno-69-78"></a>
<a id="__codelineno-69-79" name="__codelineno-69-79"></a>                <span class="p">&lt;</span><span class="nt">button</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;submit&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;btn btn-default&quot;</span><span class="p">&gt;</span>Submit<span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<a id="__codelineno-69-80" name="__codelineno-69-80"></a>
<a id="__codelineno-69-81" name="__codelineno-69-81"></a>            <span class="p">&lt;/</span><span class="nt">form</span><span class="p">&gt;</span>
<a id="__codelineno-69-82" name="__codelineno-69-82"></a>
<a id="__codelineno-69-83" name="__codelineno-69-83"></a>            <span class="p">&lt;</span><span class="nt">ul</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;nav navbar-nav navbar-right&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-69-84" name="__codelineno-69-84"></a>                <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;#&quot;</span><span class="p">&gt;</span>Aini<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
<a id="__codelineno-69-85" name="__codelineno-69-85"></a>
<a id="__codelineno-69-86" name="__codelineno-69-86"></a>                <span class="p">&lt;</span><span class="nt">li</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;dropdown&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-69-87" name="__codelineno-69-87"></a>                    <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;#&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;dropdown-toggle&quot;</span> <span class="na">data-toggle</span><span class="o">=</span><span class="s">&quot;dropdown&quot;</span> <span class="na">role</span><span class="o">=</span><span class="s">&quot;button&quot;</span> <span class="na">aria-haspopup</span><span class="o">=</span><span class="s">&quot;true&quot;</span>
<a id="__codelineno-69-88" name="__codelineno-69-88"></a>                       <span class="na">aria-expanded</span><span class="o">=</span><span class="s">&quot;false&quot;</span><span class="p">&gt;</span>更多操作<span class="p">&lt;</span><span class="nt">span</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;caret&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">span</span><span class="p">&gt;&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
<a id="__codelineno-69-89" name="__codelineno-69-89"></a>
<a id="__codelineno-69-90" name="__codelineno-69-90"></a>                    <span class="p">&lt;</span><span class="nt">ul</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;dropdown-menu&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-69-91" name="__codelineno-69-91"></a>                        <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;#&quot;</span><span class="p">&gt;</span>Action<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
<a id="__codelineno-69-92" name="__codelineno-69-92"></a>
<a id="__codelineno-69-93" name="__codelineno-69-93"></a>                        <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;#&quot;</span><span class="p">&gt;</span>Another action<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
<a id="__codelineno-69-94" name="__codelineno-69-94"></a>
<a id="__codelineno-69-95" name="__codelineno-69-95"></a>                        <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;#&quot;</span><span class="p">&gt;</span>Something else here<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
<a id="__codelineno-69-96" name="__codelineno-69-96"></a>
<a id="__codelineno-69-97" name="__codelineno-69-97"></a>                        <span class="p">&lt;</span><span class="nt">li</span> <span class="na">role</span><span class="o">=</span><span class="s">&quot;separator&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;divider&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
<a id="__codelineno-69-98" name="__codelineno-69-98"></a>
<a id="__codelineno-69-99" name="__codelineno-69-99"></a>                        <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;#&quot;</span><span class="p">&gt;</span>Separated link<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
<a id="__codelineno-69-100" name="__codelineno-69-100"></a>
<a id="__codelineno-69-101" name="__codelineno-69-101"></a>                    <span class="p">&lt;/</span><span class="nt">ul</span><span class="p">&gt;</span>
<a id="__codelineno-69-102" name="__codelineno-69-102"></a>
<a id="__codelineno-69-103" name="__codelineno-69-103"></a>                <span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
<a id="__codelineno-69-104" name="__codelineno-69-104"></a>
<a id="__codelineno-69-105" name="__codelineno-69-105"></a>            <span class="p">&lt;/</span><span class="nt">ul</span><span class="p">&gt;</span>
<a id="__codelineno-69-106" name="__codelineno-69-106"></a>
<a id="__codelineno-69-107" name="__codelineno-69-107"></a>        <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span><span class="cm">&lt;!-- /.navbar-collapse --&gt;</span>
<a id="__codelineno-69-108" name="__codelineno-69-108"></a>    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span><span class="cm">&lt;!-- /.container-fluid --&gt;</span>
<a id="__codelineno-69-109" name="__codelineno-69-109"></a><span class="p">&lt;/</span><span class="nt">nav</span><span class="p">&gt;</span>
<a id="__codelineno-69-110" name="__codelineno-69-110"></a>
<a id="__codelineno-69-111" name="__codelineno-69-111"></a><span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;container-fluid&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-69-112" name="__codelineno-69-112"></a>    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;row&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-69-113" name="__codelineno-69-113"></a>        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;col-md-3&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-69-114" name="__codelineno-69-114"></a>            <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;list-group&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-69-115" name="__codelineno-69-115"></a>                <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;#&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;list-group-item active&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-69-116" name="__codelineno-69-116"></a>                    首页
<a id="__codelineno-69-117" name="__codelineno-69-117"></a>                <span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
<a id="__codelineno-69-118" name="__codelineno-69-118"></a>
<a id="__codelineno-69-119" name="__codelineno-69-119"></a>                <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;{% url &#39;book_list&#39; %}&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;list-group-item&quot;</span><span class="p">&gt;</span>图书列表<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
<a id="__codelineno-69-120" name="__codelineno-69-120"></a>
<a id="__codelineno-69-121" name="__codelineno-69-121"></a>                <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;#&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;list-group-item&quot;</span><span class="p">&gt;</span>出版社列表<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
<a id="__codelineno-69-122" name="__codelineno-69-122"></a>
<a id="__codelineno-69-123" name="__codelineno-69-123"></a>                <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;#&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;list-group-item&quot;</span><span class="p">&gt;</span>作者列表<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
<a id="__codelineno-69-124" name="__codelineno-69-124"></a>
<a id="__codelineno-69-125" name="__codelineno-69-125"></a>                <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;#&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;list-group-item&quot;</span><span class="p">&gt;</span>更多<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
<a id="__codelineno-69-126" name="__codelineno-69-126"></a>
<a id="__codelineno-69-127" name="__codelineno-69-127"></a>            <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a id="__codelineno-69-128" name="__codelineno-69-128"></a>
<a id="__codelineno-69-129" name="__codelineno-69-129"></a>        <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a id="__codelineno-69-130" name="__codelineno-69-130"></a>
<a id="__codelineno-69-131" name="__codelineno-69-131"></a>        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;col-md-9&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-69-132" name="__codelineno-69-132"></a>            <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;panel panel-primary&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-69-133" name="__codelineno-69-133"></a>                <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;panel-heading&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-69-134" name="__codelineno-69-134"></a>                    <span class="p">&lt;</span><span class="nt">h3</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;panel-title&quot;</span><span class="p">&gt;</span>BMS<span class="p">&lt;/</span><span class="nt">h3</span><span class="p">&gt;</span>
<a id="__codelineno-69-135" name="__codelineno-69-135"></a>
<a id="__codelineno-69-136" name="__codelineno-69-136"></a>                <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a id="__codelineno-69-137" name="__codelineno-69-137"></a>
<a id="__codelineno-69-138" name="__codelineno-69-138"></a>                <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;panel-body&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-69-139" name="__codelineno-69-139"></a>                    {% block content %}
<a id="__codelineno-69-140" name="__codelineno-69-140"></a>                        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;jumbotron&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-69-141" name="__codelineno-69-141"></a>                            <span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span>欢迎来到亚洲最大线上读书平台<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
<a id="__codelineno-69-142" name="__codelineno-69-142"></a>
<a id="__codelineno-69-143" name="__codelineno-69-143"></a>                            <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>想看啥书都有<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<a id="__codelineno-69-144" name="__codelineno-69-144"></a>
<a id="__codelineno-69-145" name="__codelineno-69-145"></a>                            <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;btn btn-primary btn-lg&quot;</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;#&quot;</span> <span class="na">role</span><span class="o">=</span><span class="s">&quot;button&quot;</span><span class="p">&gt;</span>点击有你好看<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<a id="__codelineno-69-146" name="__codelineno-69-146"></a>
<a id="__codelineno-69-147" name="__codelineno-69-147"></a>                        <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a id="__codelineno-69-148" name="__codelineno-69-148"></a>
<a id="__codelineno-69-149" name="__codelineno-69-149"></a>                        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;row&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-69-150" name="__codelineno-69-150"></a>                            <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;col-sm-6 col-md-4&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-69-151" name="__codelineno-69-151"></a>                                <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;thumbnail&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-69-152" name="__codelineno-69-152"></a>                                    <span class="p">&lt;</span><span class="nt">img</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;https://img0.baidu.com/it/u=1226012578,3631571194&amp;fm=253&amp;app=120&amp;size=w931&amp;n=0&amp;f=JPEG&amp;fmt=auto?sec=1696438800&amp;t=a213a0fb1c8620edcd1af5f2bebd341b&quot;</span>
<a id="__codelineno-69-153" name="__codelineno-69-153"></a>                                         <span class="na">alt</span><span class="o">=</span><span class="s">&quot;...&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-69-154" name="__codelineno-69-154"></a>                                    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;caption&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-69-155" name="__codelineno-69-155"></a>                                        <span class="p">&lt;</span><span class="nt">h3</span><span class="p">&gt;</span>Thumbnail label<span class="p">&lt;/</span><span class="nt">h3</span><span class="p">&gt;</span>
<a id="__codelineno-69-156" name="__codelineno-69-156"></a>
<a id="__codelineno-69-157" name="__codelineno-69-157"></a>                                        <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>...<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<a id="__codelineno-69-158" name="__codelineno-69-158"></a>
<a id="__codelineno-69-159" name="__codelineno-69-159"></a>                                        <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>
<a id="__codelineno-69-160" name="__codelineno-69-160"></a>                                            <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;#&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;btn btn-primary&quot;</span> <span class="na">role</span><span class="o">=</span><span class="s">&quot;button&quot;</span><span class="p">&gt;</span>Button<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
<a id="__codelineno-69-161" name="__codelineno-69-161"></a>
<a id="__codelineno-69-162" name="__codelineno-69-162"></a>                                            <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;#&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;btn btn-default&quot;</span> <span class="na">role</span><span class="o">=</span><span class="s">&quot;button&quot;</span><span class="p">&gt;</span>Button<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
<a id="__codelineno-69-163" name="__codelineno-69-163"></a>
<a id="__codelineno-69-164" name="__codelineno-69-164"></a>                                        <span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<a id="__codelineno-69-165" name="__codelineno-69-165"></a>
<a id="__codelineno-69-166" name="__codelineno-69-166"></a>                                    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a id="__codelineno-69-167" name="__codelineno-69-167"></a>
<a id="__codelineno-69-168" name="__codelineno-69-168"></a>                                <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a id="__codelineno-69-169" name="__codelineno-69-169"></a>
<a id="__codelineno-69-170" name="__codelineno-69-170"></a>                            <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a id="__codelineno-69-171" name="__codelineno-69-171"></a>
<a id="__codelineno-69-172" name="__codelineno-69-172"></a>                            <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;col-sm-6 col-md-4&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-69-173" name="__codelineno-69-173"></a>                                <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;thumbnail&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-69-174" name="__codelineno-69-174"></a>                                    <span class="p">&lt;</span><span class="nt">img</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;https://img0.baidu.com/it/u=1226012578,3631571194&amp;fm=253&amp;app=120&amp;size=w931&amp;n=0&amp;f=JPEG&amp;fmt=auto?sec=1696438800&amp;t=a213a0fb1c8620edcd1af5f2bebd341b&quot;</span>
<a id="__codelineno-69-175" name="__codelineno-69-175"></a>                                         <span class="na">alt</span><span class="o">=</span><span class="s">&quot;...&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-69-176" name="__codelineno-69-176"></a>                                    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;caption&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-69-177" name="__codelineno-69-177"></a>                                        <span class="p">&lt;</span><span class="nt">h3</span><span class="p">&gt;</span>Thumbnail label<span class="p">&lt;/</span><span class="nt">h3</span><span class="p">&gt;</span>
<a id="__codelineno-69-178" name="__codelineno-69-178"></a>
<a id="__codelineno-69-179" name="__codelineno-69-179"></a>                                        <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>...<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<a id="__codelineno-69-180" name="__codelineno-69-180"></a>
<a id="__codelineno-69-181" name="__codelineno-69-181"></a>                                        <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>
<a id="__codelineno-69-182" name="__codelineno-69-182"></a>                                            <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;#&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;btn btn-primary&quot;</span> <span class="na">role</span><span class="o">=</span><span class="s">&quot;button&quot;</span><span class="p">&gt;</span>Button<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
<a id="__codelineno-69-183" name="__codelineno-69-183"></a>
<a id="__codelineno-69-184" name="__codelineno-69-184"></a>                                            <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;#&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;btn btn-default&quot;</span> <span class="na">role</span><span class="o">=</span><span class="s">&quot;button&quot;</span><span class="p">&gt;</span>Button<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
<a id="__codelineno-69-185" name="__codelineno-69-185"></a>
<a id="__codelineno-69-186" name="__codelineno-69-186"></a>                                        <span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<a id="__codelineno-69-187" name="__codelineno-69-187"></a>
<a id="__codelineno-69-188" name="__codelineno-69-188"></a>                                    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a id="__codelineno-69-189" name="__codelineno-69-189"></a>
<a id="__codelineno-69-190" name="__codelineno-69-190"></a>                                <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a id="__codelineno-69-191" name="__codelineno-69-191"></a>
<a id="__codelineno-69-192" name="__codelineno-69-192"></a>                            <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a id="__codelineno-69-193" name="__codelineno-69-193"></a>
<a id="__codelineno-69-194" name="__codelineno-69-194"></a>                            <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;col-sm-6 col-md-4&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-69-195" name="__codelineno-69-195"></a>                                <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;thumbnail&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-69-196" name="__codelineno-69-196"></a>                                    <span class="p">&lt;</span><span class="nt">img</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;https://img0.baidu.com/it/u=1226012578,3631571194&amp;fm=253&amp;app=120&amp;size=w931&amp;n=0&amp;f=JPEG&amp;fmt=auto?sec=1696438800&amp;t=a213a0fb1c8620edcd1af5f2bebd341b&quot;</span>
<a id="__codelineno-69-197" name="__codelineno-69-197"></a>                                         <span class="na">alt</span><span class="o">=</span><span class="s">&quot;...&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-69-198" name="__codelineno-69-198"></a>                                    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;caption&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-69-199" name="__codelineno-69-199"></a>                                        <span class="p">&lt;</span><span class="nt">h3</span><span class="p">&gt;</span>Thumbnail label<span class="p">&lt;/</span><span class="nt">h3</span><span class="p">&gt;</span>
<a id="__codelineno-69-200" name="__codelineno-69-200"></a>
<a id="__codelineno-69-201" name="__codelineno-69-201"></a>                                        <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>...<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<a id="__codelineno-69-202" name="__codelineno-69-202"></a>
<a id="__codelineno-69-203" name="__codelineno-69-203"></a>                                        <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>
<a id="__codelineno-69-204" name="__codelineno-69-204"></a>                                            <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;#&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;btn btn-primary&quot;</span> <span class="na">role</span><span class="o">=</span><span class="s">&quot;button&quot;</span><span class="p">&gt;</span>Button<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
<a id="__codelineno-69-205" name="__codelineno-69-205"></a>
<a id="__codelineno-69-206" name="__codelineno-69-206"></a>                                            <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;#&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;btn btn-default&quot;</span> <span class="na">role</span><span class="o">=</span><span class="s">&quot;button&quot;</span><span class="p">&gt;</span>Button<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
<a id="__codelineno-69-207" name="__codelineno-69-207"></a>
<a id="__codelineno-69-208" name="__codelineno-69-208"></a>                                        <span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<a id="__codelineno-69-209" name="__codelineno-69-209"></a>
<a id="__codelineno-69-210" name="__codelineno-69-210"></a>                                    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a id="__codelineno-69-211" name="__codelineno-69-211"></a>
<a id="__codelineno-69-212" name="__codelineno-69-212"></a>                                <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a id="__codelineno-69-213" name="__codelineno-69-213"></a>
<a id="__codelineno-69-214" name="__codelineno-69-214"></a>                            <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a id="__codelineno-69-215" name="__codelineno-69-215"></a>
<a id="__codelineno-69-216" name="__codelineno-69-216"></a>                        <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a id="__codelineno-69-217" name="__codelineno-69-217"></a>
<a id="__codelineno-69-218" name="__codelineno-69-218"></a>                    {% endblock %}
<a id="__codelineno-69-219" name="__codelineno-69-219"></a>
<a id="__codelineno-69-220" name="__codelineno-69-220"></a>                <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a id="__codelineno-69-221" name="__codelineno-69-221"></a>
<a id="__codelineno-69-222" name="__codelineno-69-222"></a>            <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a id="__codelineno-69-223" name="__codelineno-69-223"></a>
<a id="__codelineno-69-224" name="__codelineno-69-224"></a>        <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a id="__codelineno-69-225" name="__codelineno-69-225"></a>
<a id="__codelineno-69-226" name="__codelineno-69-226"></a>    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a id="__codelineno-69-227" name="__codelineno-69-227"></a>
<a id="__codelineno-69-228" name="__codelineno-69-228"></a><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a id="__codelineno-69-229" name="__codelineno-69-229"></a>
<a id="__codelineno-69-230" name="__codelineno-69-230"></a>{% block js %}
<a id="__codelineno-69-231" name="__codelineno-69-231"></a>
<a id="__codelineno-69-232" name="__codelineno-69-232"></a>{% endblock %}
<a id="__codelineno-69-233" name="__codelineno-69-233"></a><span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<a id="__codelineno-69-234" name="__codelineno-69-234"></a>
<a id="__codelineno-69-235" name="__codelineno-69-235"></a><span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></div></td></tr></table></div>
<h4 id="17-5-book_listhtml">17-5 book_list.html<a class="headerlink" href="#17-5-book_listhtml" title="Permanent link">&para;</a></h4>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">HTML</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-70-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-70-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-70-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-70-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-70-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-70-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-70-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-70-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-70-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-70-10">10</a></span>
<span class="normal"><a href="#__codelineno-70-11">11</a></span>
<span class="normal"><a href="#__codelineno-70-12">12</a></span>
<span class="normal"><a href="#__codelineno-70-13">13</a></span>
<span class="normal"><a href="#__codelineno-70-14">14</a></span>
<span class="normal"><a href="#__codelineno-70-15">15</a></span>
<span class="normal"><a href="#__codelineno-70-16">16</a></span>
<span class="normal"><a href="#__codelineno-70-17">17</a></span>
<span class="normal"><a href="#__codelineno-70-18">18</a></span>
<span class="normal"><a href="#__codelineno-70-19">19</a></span>
<span class="normal"><a href="#__codelineno-70-20">20</a></span>
<span class="normal"><a href="#__codelineno-70-21">21</a></span>
<span class="normal"><a href="#__codelineno-70-22">22</a></span>
<span class="normal"><a href="#__codelineno-70-23">23</a></span>
<span class="normal"><a href="#__codelineno-70-24">24</a></span>
<span class="normal"><a href="#__codelineno-70-25">25</a></span>
<span class="normal"><a href="#__codelineno-70-26">26</a></span>
<span class="normal"><a href="#__codelineno-70-27">27</a></span>
<span class="normal"><a href="#__codelineno-70-28">28</a></span>
<span class="normal"><a href="#__codelineno-70-29">29</a></span>
<span class="normal"><a href="#__codelineno-70-30">30</a></span>
<span class="normal"><a href="#__codelineno-70-31">31</a></span>
<span class="normal"><a href="#__codelineno-70-32">32</a></span>
<span class="normal"><a href="#__codelineno-70-33">33</a></span>
<span class="normal"><a href="#__codelineno-70-34">34</a></span>
<span class="normal"><a href="#__codelineno-70-35">35</a></span>
<span class="normal"><a href="#__codelineno-70-36">36</a></span>
<span class="normal"><a href="#__codelineno-70-37">37</a></span>
<span class="normal"><a href="#__codelineno-70-38">38</a></span>
<span class="normal"><a href="#__codelineno-70-39">39</a></span>
<span class="normal"><a href="#__codelineno-70-40">40</a></span>
<span class="normal"><a href="#__codelineno-70-41">41</a></span>
<span class="normal"><a href="#__codelineno-70-42">42</a></span>
<span class="normal"><a href="#__codelineno-70-43">43</a></span>
<span class="normal"><a href="#__codelineno-70-44">44</a></span>
<span class="normal"><a href="#__codelineno-70-45">45</a></span>
<span class="normal"><a href="#__codelineno-70-46">46</a></span>
<span class="normal"><a href="#__codelineno-70-47">47</a></span>
<span class="normal"><a href="#__codelineno-70-48">48</a></span>
<span class="normal"><a href="#__codelineno-70-49">49</a></span>
<span class="normal"><a href="#__codelineno-70-50">50</a></span>
<span class="normal"><a href="#__codelineno-70-51">51</a></span>
<span class="normal"><a href="#__codelineno-70-52">52</a></span>
<span class="normal"><a href="#__codelineno-70-53">53</a></span>
<span class="normal"><a href="#__codelineno-70-54">54</a></span>
<span class="normal"><a href="#__codelineno-70-55">55</a></span>
<span class="normal"><a href="#__codelineno-70-56">56</a></span>
<span class="normal"><a href="#__codelineno-70-57">57</a></span>
<span class="normal"><a href="#__codelineno-70-58">58</a></span>
<span class="normal"><a href="#__codelineno-70-59">59</a></span>
<span class="normal"><a href="#__codelineno-70-60">60</a></span>
<span class="normal"><a href="#__codelineno-70-61">61</a></span>
<span class="normal"><a href="#__codelineno-70-62">62</a></span>
<span class="normal"><a href="#__codelineno-70-63">63</a></span>
<span class="normal"><a href="#__codelineno-70-64">64</a></span>
<span class="normal"><a href="#__codelineno-70-65">65</a></span>
<span class="normal"><a href="#__codelineno-70-66">66</a></span>
<span class="normal"><a href="#__codelineno-70-67">67</a></span>
<span class="normal"><a href="#__codelineno-70-68">68</a></span>
<span class="normal"><a href="#__codelineno-70-69">69</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-70-1" name="__codelineno-70-1"></a>{% extends &#39;home.html&#39; %}
<a id="__codelineno-70-2" name="__codelineno-70-2"></a>{% block content %}
<a id="__codelineno-70-3" name="__codelineno-70-3"></a>    <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;{% url &#39;book_add&#39; %}&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;btn btn-success&quot;</span><span class="p">&gt;</span>添加<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
<a id="__codelineno-70-4" name="__codelineno-70-4"></a>
<a id="__codelineno-70-5" name="__codelineno-70-5"></a>    <span class="p">&lt;/</span><span class="nt">br</span><span class="p">&gt;</span>
<a id="__codelineno-70-6" name="__codelineno-70-6"></a>
<a id="__codelineno-70-7" name="__codelineno-70-7"></a>    <span class="p">&lt;/</span><span class="nt">br</span><span class="p">&gt;</span>
<a id="__codelineno-70-8" name="__codelineno-70-8"></a>
<a id="__codelineno-70-9" name="__codelineno-70-9"></a>    <span class="p">&lt;</span><span class="nt">table</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;border table-hover table-striped table-bordered&quot;</span> <span class="na">style</span><span class="o">=</span><span class="s">&quot;width:100%;text-align:center;&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-70-10" name="__codelineno-70-10"></a>        <span class="p">&lt;</span><span class="nt">thead</span><span class="p">&gt;</span>
<a id="__codelineno-70-11" name="__codelineno-70-11"></a>        <span class="p">&lt;</span><span class="nt">tr</span><span class="p">&gt;</span>
<a id="__codelineno-70-12" name="__codelineno-70-12"></a>            <span class="p">&lt;</span><span class="nt">th</span> <span class="na">style</span><span class="o">=</span><span class="s">&quot;text-align:center;&quot;</span><span class="p">&gt;</span>ID<span class="p">&lt;/</span><span class="nt">th</span><span class="p">&gt;</span>
<a id="__codelineno-70-13" name="__codelineno-70-13"></a>
<a id="__codelineno-70-14" name="__codelineno-70-14"></a>            <span class="p">&lt;</span><span class="nt">th</span> <span class="na">style</span><span class="o">=</span><span class="s">&quot;text-align:center;&quot;</span><span class="p">&gt;</span>书名<span class="p">&lt;/</span><span class="nt">th</span><span class="p">&gt;</span>
<a id="__codelineno-70-15" name="__codelineno-70-15"></a>
<a id="__codelineno-70-16" name="__codelineno-70-16"></a>            <span class="p">&lt;</span><span class="nt">th</span> <span class="na">style</span><span class="o">=</span><span class="s">&quot;text-align:center;&quot;</span><span class="p">&gt;</span>价格<span class="p">&lt;/</span><span class="nt">th</span><span class="p">&gt;</span>
<a id="__codelineno-70-17" name="__codelineno-70-17"></a>
<a id="__codelineno-70-18" name="__codelineno-70-18"></a>            <span class="p">&lt;</span><span class="nt">th</span> <span class="na">style</span><span class="o">=</span><span class="s">&quot;text-align:center;&quot;</span><span class="p">&gt;</span>出版日期<span class="p">&lt;/</span><span class="nt">th</span><span class="p">&gt;</span>
<a id="__codelineno-70-19" name="__codelineno-70-19"></a>
<a id="__codelineno-70-20" name="__codelineno-70-20"></a>            <span class="p">&lt;</span><span class="nt">th</span> <span class="na">style</span><span class="o">=</span><span class="s">&quot;text-align:center;&quot;</span><span class="p">&gt;</span>出版社<span class="p">&lt;/</span><span class="nt">th</span><span class="p">&gt;</span>
<a id="__codelineno-70-21" name="__codelineno-70-21"></a>
<a id="__codelineno-70-22" name="__codelineno-70-22"></a>            <span class="p">&lt;</span><span class="nt">th</span> <span class="na">style</span><span class="o">=</span><span class="s">&quot;text-align:center;&quot;</span><span class="p">&gt;</span>作者<span class="p">&lt;/</span><span class="nt">th</span><span class="p">&gt;</span>
<a id="__codelineno-70-23" name="__codelineno-70-23"></a>
<a id="__codelineno-70-24" name="__codelineno-70-24"></a>            <span class="p">&lt;</span><span class="nt">th</span> <span class="na">style</span><span class="o">=</span><span class="s">&quot;text-align:center;&quot;</span><span class="p">&gt;</span>操作<span class="p">&lt;/</span><span class="nt">th</span><span class="p">&gt;</span>
<a id="__codelineno-70-25" name="__codelineno-70-25"></a>
<a id="__codelineno-70-26" name="__codelineno-70-26"></a>        <span class="p">&lt;/</span><span class="nt">tr</span><span class="p">&gt;</span>
<a id="__codelineno-70-27" name="__codelineno-70-27"></a>
<a id="__codelineno-70-28" name="__codelineno-70-28"></a>        <span class="p">&lt;/</span><span class="nt">thead</span><span class="p">&gt;</span>
<a id="__codelineno-70-29" name="__codelineno-70-29"></a>
<a id="__codelineno-70-30" name="__codelineno-70-30"></a>        <span class="p">&lt;</span><span class="nt">tbody</span><span class="p">&gt;</span>
<a id="__codelineno-70-31" name="__codelineno-70-31"></a>        {% for book_obj in book_queryset %}
<a id="__codelineno-70-32" name="__codelineno-70-32"></a>            <span class="p">&lt;</span><span class="nt">tr</span><span class="p">&gt;</span>
<a id="__codelineno-70-33" name="__codelineno-70-33"></a>                <span class="p">&lt;</span><span class="nt">td</span> <span class="na">style</span><span class="o">=</span><span class="s">&quot;padding:10px 20px;&quot;</span><span class="p">&gt;</span>{{ book_obj.pk }}<span class="p">&lt;/</span><span class="nt">td</span><span class="p">&gt;</span>
<a id="__codelineno-70-34" name="__codelineno-70-34"></a>
<a id="__codelineno-70-35" name="__codelineno-70-35"></a>                <span class="p">&lt;</span><span class="nt">td</span> <span class="na">style</span><span class="o">=</span><span class="s">&quot;padding:10px 20px;&quot;</span><span class="p">&gt;</span>{{ book_obj.title }}<span class="p">&lt;/</span><span class="nt">td</span><span class="p">&gt;</span>
<a id="__codelineno-70-36" name="__codelineno-70-36"></a>
<a id="__codelineno-70-37" name="__codelineno-70-37"></a>                <span class="p">&lt;</span><span class="nt">td</span> <span class="na">style</span><span class="o">=</span><span class="s">&quot;padding:10px 20px;&quot;</span><span class="p">&gt;</span>{{ book_obj.price }}<span class="p">&lt;/</span><span class="nt">td</span><span class="p">&gt;</span>
<a id="__codelineno-70-38" name="__codelineno-70-38"></a>
<a id="__codelineno-70-39" name="__codelineno-70-39"></a>                <span class="p">&lt;</span><span class="nt">td</span> <span class="na">style</span><span class="o">=</span><span class="s">&quot;padding:10px 20px;&quot;</span><span class="p">&gt;</span>{{ book_obj.publish_date | date:&#39;Y-m-d&#39; }}<span class="p">&lt;/</span><span class="nt">td</span><span class="p">&gt;</span>
<a id="__codelineno-70-40" name="__codelineno-70-40"></a>
<a id="__codelineno-70-41" name="__codelineno-70-41"></a>                <span class="p">&lt;</span><span class="nt">td</span> <span class="na">style</span><span class="o">=</span><span class="s">&quot;padding:10px 20px;&quot;</span><span class="p">&gt;</span>{{ book_obj.publish.name }}<span class="p">&lt;/</span><span class="nt">td</span><span class="p">&gt;</span>
<a id="__codelineno-70-42" name="__codelineno-70-42"></a>
<a id="__codelineno-70-43" name="__codelineno-70-43"></a>                <span class="p">&lt;</span><span class="nt">td</span> <span class="na">style</span><span class="o">=</span><span class="s">&quot;padding:10px 20px;&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-70-44" name="__codelineno-70-44"></a>                    {% for item in book_obj.authors.all %}
<a id="__codelineno-70-45" name="__codelineno-70-45"></a>                        {% if forloop.last %}
<a id="__codelineno-70-46" name="__codelineno-70-46"></a>                            {{ item.name }}
<a id="__codelineno-70-47" name="__codelineno-70-47"></a>                        {% else %}
<a id="__codelineno-70-48" name="__codelineno-70-48"></a>                            {{ item.name }},
<a id="__codelineno-70-49" name="__codelineno-70-49"></a>                        {% endif %}
<a id="__codelineno-70-50" name="__codelineno-70-50"></a>                    {% endfor %}
<a id="__codelineno-70-51" name="__codelineno-70-51"></a>
<a id="__codelineno-70-52" name="__codelineno-70-52"></a>                <span class="p">&lt;/</span><span class="nt">td</span><span class="p">&gt;</span>
<a id="__codelineno-70-53" name="__codelineno-70-53"></a>
<a id="__codelineno-70-54" name="__codelineno-70-54"></a>                <span class="p">&lt;</span><span class="nt">td</span> <span class="na">style</span><span class="o">=</span><span class="s">&quot;padding:10px 20px;&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-70-55" name="__codelineno-70-55"></a>                    <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;{% url &#39;book_edit&#39;  book_obj.pk %}&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;btn btn-primary btn-sm&quot;</span><span class="p">&gt;</span>编辑<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
<a id="__codelineno-70-56" name="__codelineno-70-56"></a>
<a id="__codelineno-70-57" name="__codelineno-70-57"></a>                    <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;{% url &#39;book_del&#39;  book_obj.pk %}&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;btn btn-danger btn-sm&quot;</span><span class="p">&gt;</span>删除<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
<a id="__codelineno-70-58" name="__codelineno-70-58"></a>
<a id="__codelineno-70-59" name="__codelineno-70-59"></a>                <span class="p">&lt;/</span><span class="nt">td</span><span class="p">&gt;</span>
<a id="__codelineno-70-60" name="__codelineno-70-60"></a>
<a id="__codelineno-70-61" name="__codelineno-70-61"></a>            <span class="p">&lt;/</span><span class="nt">tr</span><span class="p">&gt;</span>
<a id="__codelineno-70-62" name="__codelineno-70-62"></a>
<a id="__codelineno-70-63" name="__codelineno-70-63"></a>        {% endfor %}
<a id="__codelineno-70-64" name="__codelineno-70-64"></a>
<a id="__codelineno-70-65" name="__codelineno-70-65"></a>        <span class="p">&lt;/</span><span class="nt">tbody</span><span class="p">&gt;</span>
<a id="__codelineno-70-66" name="__codelineno-70-66"></a>
<a id="__codelineno-70-67" name="__codelineno-70-67"></a>    <span class="p">&lt;/</span><span class="nt">table</span><span class="p">&gt;</span>
<a id="__codelineno-70-68" name="__codelineno-70-68"></a>
<a id="__codelineno-70-69" name="__codelineno-70-69"></a>{% endblock %}
</code></pre></div></td></tr></table></div>
<h4 id="17-6-book_addhtml">17-6 book_add.html<a class="headerlink" href="#17-6-book_addhtml" title="Permanent link">&para;</a></h4>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">HTML</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-71-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-71-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-71-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-71-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-71-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-71-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-71-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-71-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-71-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-71-10">10</a></span>
<span class="normal"><a href="#__codelineno-71-11">11</a></span>
<span class="normal"><a href="#__codelineno-71-12">12</a></span>
<span class="normal"><a href="#__codelineno-71-13">13</a></span>
<span class="normal"><a href="#__codelineno-71-14">14</a></span>
<span class="normal"><a href="#__codelineno-71-15">15</a></span>
<span class="normal"><a href="#__codelineno-71-16">16</a></span>
<span class="normal"><a href="#__codelineno-71-17">17</a></span>
<span class="normal"><a href="#__codelineno-71-18">18</a></span>
<span class="normal"><a href="#__codelineno-71-19">19</a></span>
<span class="normal"><a href="#__codelineno-71-20">20</a></span>
<span class="normal"><a href="#__codelineno-71-21">21</a></span>
<span class="normal"><a href="#__codelineno-71-22">22</a></span>
<span class="normal"><a href="#__codelineno-71-23">23</a></span>
<span class="normal"><a href="#__codelineno-71-24">24</a></span>
<span class="normal"><a href="#__codelineno-71-25">25</a></span>
<span class="normal"><a href="#__codelineno-71-26">26</a></span>
<span class="normal"><a href="#__codelineno-71-27">27</a></span>
<span class="normal"><a href="#__codelineno-71-28">28</a></span>
<span class="normal"><a href="#__codelineno-71-29">29</a></span>
<span class="normal"><a href="#__codelineno-71-30">30</a></span>
<span class="normal"><a href="#__codelineno-71-31">31</a></span>
<span class="normal"><a href="#__codelineno-71-32">32</a></span>
<span class="normal"><a href="#__codelineno-71-33">33</a></span>
<span class="normal"><a href="#__codelineno-71-34">34</a></span>
<span class="normal"><a href="#__codelineno-71-35">35</a></span>
<span class="normal"><a href="#__codelineno-71-36">36</a></span>
<span class="normal"><a href="#__codelineno-71-37">37</a></span>
<span class="normal"><a href="#__codelineno-71-38">38</a></span>
<span class="normal"><a href="#__codelineno-71-39">39</a></span>
<span class="normal"><a href="#__codelineno-71-40">40</a></span>
<span class="normal"><a href="#__codelineno-71-41">41</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-71-1" name="__codelineno-71-1"></a>{%  extends &#39;home.html&#39; %}
<a id="__codelineno-71-2" name="__codelineno-71-2"></a>{% block content %}
<a id="__codelineno-71-3" name="__codelineno-71-3"></a>    <span class="p">&lt;</span><span class="nt">h1</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;text-center&quot;</span><span class="p">&gt;</span>书籍的添加<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
<a id="__codelineno-71-4" name="__codelineno-71-4"></a>
<a id="__codelineno-71-5" name="__codelineno-71-5"></a>    <span class="p">&lt;</span><span class="nt">form</span> <span class="na">action</span><span class="o">=</span><span class="s">&quot;&quot;</span> <span class="na">method</span><span class="o">=</span><span class="s">&quot;post&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-71-6" name="__codelineno-71-6"></a>    <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>书名
<a id="__codelineno-71-7" name="__codelineno-71-7"></a>        <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;text&quot;</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;title&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;form-control&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-71-8" name="__codelineno-71-8"></a>    <span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<a id="__codelineno-71-9" name="__codelineno-71-9"></a>
<a id="__codelineno-71-10" name="__codelineno-71-10"></a>    <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>价格
<a id="__codelineno-71-11" name="__codelineno-71-11"></a>        <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;text&quot;</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;price&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;form-control&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-71-12" name="__codelineno-71-12"></a>    <span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<a id="__codelineno-71-13" name="__codelineno-71-13"></a>
<a id="__codelineno-71-14" name="__codelineno-71-14"></a>    <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>出版日期
<a id="__codelineno-71-15" name="__codelineno-71-15"></a>        <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;date&quot;</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;publish_date&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;form-control&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-71-16" name="__codelineno-71-16"></a>    <span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<a id="__codelineno-71-17" name="__codelineno-71-17"></a>
<a id="__codelineno-71-18" name="__codelineno-71-18"></a>    <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>出版社
<a id="__codelineno-71-19" name="__codelineno-71-19"></a>        <span class="p">&lt;</span><span class="nt">select</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;publish&quot;</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;form-control&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-71-20" name="__codelineno-71-20"></a>            {% for item in publish_queryset %}
<a id="__codelineno-71-21" name="__codelineno-71-21"></a>                <span class="p">&lt;</span><span class="nt">option</span> <span class="na">value</span><span class="o">=</span><span class="s">&quot;{{ item.pk }}&quot;</span><span class="p">&gt;</span>{{ item.name }}<span class="p">&lt;/</span><span class="nt">option</span><span class="p">&gt;</span>
<a id="__codelineno-71-22" name="__codelineno-71-22"></a>
<a id="__codelineno-71-23" name="__codelineno-71-23"></a>            {% endfor %}
<a id="__codelineno-71-24" name="__codelineno-71-24"></a>        <span class="p">&lt;/</span><span class="nt">select</span><span class="p">&gt;</span>
<a id="__codelineno-71-25" name="__codelineno-71-25"></a>
<a id="__codelineno-71-26" name="__codelineno-71-26"></a>    <span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<a id="__codelineno-71-27" name="__codelineno-71-27"></a>
<a id="__codelineno-71-28" name="__codelineno-71-28"></a>    <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>作者
<a id="__codelineno-71-29" name="__codelineno-71-29"></a>        <span class="p">&lt;</span><span class="nt">select</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;authors&quot;</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;&quot;</span> <span class="na">multiple</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;form-control&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-71-30" name="__codelineno-71-30"></a>            {% for item in author_queryset %}
<a id="__codelineno-71-31" name="__codelineno-71-31"></a>                <span class="p">&lt;</span><span class="nt">option</span> <span class="na">value</span><span class="o">=</span><span class="s">&quot;{{ item.pk }}&quot;</span><span class="p">&gt;</span>{{ item.name }}<span class="p">&lt;/</span><span class="nt">option</span><span class="p">&gt;</span>
<a id="__codelineno-71-32" name="__codelineno-71-32"></a>
<a id="__codelineno-71-33" name="__codelineno-71-33"></a>            {% endfor %}
<a id="__codelineno-71-34" name="__codelineno-71-34"></a>        <span class="p">&lt;/</span><span class="nt">select</span><span class="p">&gt;</span>
<a id="__codelineno-71-35" name="__codelineno-71-35"></a>
<a id="__codelineno-71-36" name="__codelineno-71-36"></a>    <span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<a id="__codelineno-71-37" name="__codelineno-71-37"></a>
<a id="__codelineno-71-38" name="__codelineno-71-38"></a>        <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;submit&quot;</span> <span class="na">value</span><span class="o">=</span><span class="s">&quot;新增&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;btn btn-primary btn-block&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-71-39" name="__codelineno-71-39"></a>    <span class="p">&lt;/</span><span class="nt">form</span><span class="p">&gt;</span>
<a id="__codelineno-71-40" name="__codelineno-71-40"></a>
<a id="__codelineno-71-41" name="__codelineno-71-41"></a>{% endblock %}
</code></pre></div></td></tr></table></div>
<h4 id="17-7-book_delhtml">17-7 book_del.html<a class="headerlink" href="#17-7-book_delhtml" title="Permanent link">&para;</a></h4>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">HTML</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-72-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-72-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-72-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-72-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-72-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-72-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-72-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-72-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-72-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-72-10">10</a></span>
<span class="normal"><a href="#__codelineno-72-11">11</a></span>
<span class="normal"><a href="#__codelineno-72-12">12</a></span>
<span class="normal"><a href="#__codelineno-72-13">13</a></span>
<span class="normal"><a href="#__codelineno-72-14">14</a></span>
<span class="normal"><a href="#__codelineno-72-15">15</a></span>
<span class="normal"><a href="#__codelineno-72-16">16</a></span>
<span class="normal"><a href="#__codelineno-72-17">17</a></span>
<span class="normal"><a href="#__codelineno-72-18">18</a></span>
<span class="normal"><a href="#__codelineno-72-19">19</a></span>
<span class="normal"><a href="#__codelineno-72-20">20</a></span>
<span class="normal"><a href="#__codelineno-72-21">21</a></span>
<span class="normal"><a href="#__codelineno-72-22">22</a></span>
<span class="normal"><a href="#__codelineno-72-23">23</a></span>
<span class="normal"><a href="#__codelineno-72-24">24</a></span>
<span class="normal"><a href="#__codelineno-72-25">25</a></span>
<span class="normal"><a href="#__codelineno-72-26">26</a></span>
<span class="normal"><a href="#__codelineno-72-27">27</a></span>
<span class="normal"><a href="#__codelineno-72-28">28</a></span>
<span class="normal"><a href="#__codelineno-72-29">29</a></span>
<span class="normal"><a href="#__codelineno-72-30">30</a></span>
<span class="normal"><a href="#__codelineno-72-31">31</a></span>
<span class="normal"><a href="#__codelineno-72-32">32</a></span>
<span class="normal"><a href="#__codelineno-72-33">33</a></span>
<span class="normal"><a href="#__codelineno-72-34">34</a></span>
<span class="normal"><a href="#__codelineno-72-35">35</a></span>
<span class="normal"><a href="#__codelineno-72-36">36</a></span>
<span class="normal"><a href="#__codelineno-72-37">37</a></span>
<span class="normal"><a href="#__codelineno-72-38">38</a></span>
<span class="normal"><a href="#__codelineno-72-39">39</a></span>
<span class="normal"><a href="#__codelineno-72-40">40</a></span>
<span class="normal"><a href="#__codelineno-72-41">41</a></span>
<span class="normal"><a href="#__codelineno-72-42">42</a></span>
<span class="normal"><a href="#__codelineno-72-43">43</a></span>
<span class="normal"><a href="#__codelineno-72-44">44</a></span>
<span class="normal"><a href="#__codelineno-72-45">45</a></span>
<span class="normal"><a href="#__codelineno-72-46">46</a></span>
<span class="normal"><a href="#__codelineno-72-47">47</a></span>
<span class="normal"><a href="#__codelineno-72-48">48</a></span>
<span class="normal"><a href="#__codelineno-72-49">49</a></span>
<span class="normal"><a href="#__codelineno-72-50">50</a></span>
<span class="normal"><a href="#__codelineno-72-51">51</a></span>
<span class="normal"><a href="#__codelineno-72-52">52</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-72-1" name="__codelineno-72-1"></a>{% extends &#39;home.html&#39; %}
<a id="__codelineno-72-2" name="__codelineno-72-2"></a>{% block content %}
<a id="__codelineno-72-3" name="__codelineno-72-3"></a>    <span class="p">&lt;</span><span class="nt">h1</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;text-center&quot;</span><span class="p">&gt;</span>书籍的编辑<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
<a id="__codelineno-72-4" name="__codelineno-72-4"></a>
<a id="__codelineno-72-5" name="__codelineno-72-5"></a>    <span class="p">&lt;</span><span class="nt">form</span> <span class="na">action</span><span class="o">=</span><span class="s">&quot;&quot;</span> <span class="na">method</span><span class="o">=</span><span class="s">&quot;post&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-72-6" name="__codelineno-72-6"></a>    <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>书名
<a id="__codelineno-72-7" name="__codelineno-72-7"></a>        <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;text&quot;</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;title&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;form-control&quot;</span> <span class="na">value</span><span class="o">=</span><span class="s">&quot;{{ edit_obj.title }}&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-72-8" name="__codelineno-72-8"></a>    <span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<a id="__codelineno-72-9" name="__codelineno-72-9"></a>
<a id="__codelineno-72-10" name="__codelineno-72-10"></a>    <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>价格
<a id="__codelineno-72-11" name="__codelineno-72-11"></a>        <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;text&quot;</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;price&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;form-control&quot;</span>  <span class="na">value</span><span class="o">=</span><span class="s">&quot;{{ edit_obj.price }}&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-72-12" name="__codelineno-72-12"></a>    <span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<a id="__codelineno-72-13" name="__codelineno-72-13"></a>
<a id="__codelineno-72-14" name="__codelineno-72-14"></a>    <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>出版日期
<a id="__codelineno-72-15" name="__codelineno-72-15"></a>        <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;date&quot;</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;publish_date&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;form-control&quot;</span> <span class="na">value</span><span class="o">=</span><span class="s">&quot;{{ edit_obj.publish_date | date:&#39;Y-m-d&#39; }}&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-72-16" name="__codelineno-72-16"></a>    <span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<a id="__codelineno-72-17" name="__codelineno-72-17"></a>
<a id="__codelineno-72-18" name="__codelineno-72-18"></a>    <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>出版社
<a id="__codelineno-72-19" name="__codelineno-72-19"></a>        <span class="p">&lt;</span><span class="nt">select</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;publish&quot;</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;form-control&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-72-20" name="__codelineno-72-20"></a>            {% for item in publish_queryset %}
<a id="__codelineno-72-21" name="__codelineno-72-21"></a>{#                当前书籍出版社应该默认选中昂#}
<a id="__codelineno-72-22" name="__codelineno-72-22"></a>                {% if edit_obj.publish == item  %}
<a id="__codelineno-72-23" name="__codelineno-72-23"></a>                    <span class="p">&lt;</span><span class="nt">option</span> <span class="na">value</span><span class="o">=</span><span class="s">&quot;{{ item.pk }}&quot;</span> <span class="na">selected</span><span class="p">&gt;</span>{{ item.name }}<span class="p">&lt;/</span><span class="nt">option</span><span class="p">&gt;</span>
<a id="__codelineno-72-24" name="__codelineno-72-24"></a>
<a id="__codelineno-72-25" name="__codelineno-72-25"></a>                {% else %}
<a id="__codelineno-72-26" name="__codelineno-72-26"></a>                    <span class="p">&lt;</span><span class="nt">option</span> <span class="na">value</span><span class="o">=</span><span class="s">&quot;{{ item.pk }}&quot;</span><span class="p">&gt;</span>{{ item.name }}<span class="p">&lt;/</span><span class="nt">option</span><span class="p">&gt;</span>
<a id="__codelineno-72-27" name="__codelineno-72-27"></a>
<a id="__codelineno-72-28" name="__codelineno-72-28"></a>                {% endif %}
<a id="__codelineno-72-29" name="__codelineno-72-29"></a>            {% endfor %}
<a id="__codelineno-72-30" name="__codelineno-72-30"></a>        <span class="p">&lt;/</span><span class="nt">select</span><span class="p">&gt;</span>
<a id="__codelineno-72-31" name="__codelineno-72-31"></a>
<a id="__codelineno-72-32" name="__codelineno-72-32"></a>    <span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<a id="__codelineno-72-33" name="__codelineno-72-33"></a>
<a id="__codelineno-72-34" name="__codelineno-72-34"></a>    <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>作者
<a id="__codelineno-72-35" name="__codelineno-72-35"></a>        <span class="p">&lt;</span><span class="nt">select</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;authors&quot;</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;&quot;</span> <span class="na">multiple</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;form-control&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-72-36" name="__codelineno-72-36"></a>            {% for item in author_queryset %}
<a id="__codelineno-72-37" name="__codelineno-72-37"></a>                {% if item in edit_obj.authors.all %}
<a id="__codelineno-72-38" name="__codelineno-72-38"></a>                    <span class="p">&lt;</span><span class="nt">option</span> <span class="na">value</span><span class="o">=</span><span class="s">&quot;{{ item.pk }}&quot;</span> <span class="na">selected</span><span class="p">&gt;</span>{{ item.name }}<span class="p">&lt;/</span><span class="nt">option</span><span class="p">&gt;</span>
<a id="__codelineno-72-39" name="__codelineno-72-39"></a>
<a id="__codelineno-72-40" name="__codelineno-72-40"></a>                {% else %}
<a id="__codelineno-72-41" name="__codelineno-72-41"></a>                    <span class="p">&lt;</span><span class="nt">option</span> <span class="na">value</span><span class="o">=</span><span class="s">&quot;{{ item.pk }}&quot;</span><span class="p">&gt;</span>{{ item.name }}<span class="p">&lt;/</span><span class="nt">option</span><span class="p">&gt;</span>
<a id="__codelineno-72-42" name="__codelineno-72-42"></a>
<a id="__codelineno-72-43" name="__codelineno-72-43"></a>                {% endif %}
<a id="__codelineno-72-44" name="__codelineno-72-44"></a>            {% endfor %}
<a id="__codelineno-72-45" name="__codelineno-72-45"></a>        <span class="p">&lt;/</span><span class="nt">select</span><span class="p">&gt;</span>
<a id="__codelineno-72-46" name="__codelineno-72-46"></a>
<a id="__codelineno-72-47" name="__codelineno-72-47"></a>    <span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<a id="__codelineno-72-48" name="__codelineno-72-48"></a>
<a id="__codelineno-72-49" name="__codelineno-72-49"></a>        <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;submit&quot;</span> <span class="na">value</span><span class="o">=</span><span class="s">&quot;确定&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;btn btn-warning btn-block&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-72-50" name="__codelineno-72-50"></a>    <span class="p">&lt;/</span><span class="nt">form</span><span class="p">&gt;</span>
<a id="__codelineno-72-51" name="__codelineno-72-51"></a>
<a id="__codelineno-72-52" name="__codelineno-72-52"></a>{% endblock %}
</code></pre></div></td></tr></table></div>
<h3 id="15-18-choices参数">15-18 choices参数<a class="headerlink" href="#15-18-choices参数" title="Permanent link">&para;</a></h3>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-73-1">  1</a></span>
<span class="normal"><a href="#__codelineno-73-2">  2</a></span>
<span class="normal"><a href="#__codelineno-73-3">  3</a></span>
<span class="normal"><a href="#__codelineno-73-4">  4</a></span>
<span class="normal"><a href="#__codelineno-73-5">  5</a></span>
<span class="normal"><a href="#__codelineno-73-6">  6</a></span>
<span class="normal"><a href="#__codelineno-73-7">  7</a></span>
<span class="normal"><a href="#__codelineno-73-8">  8</a></span>
<span class="normal"><a href="#__codelineno-73-9">  9</a></span>
<span class="normal"><a href="#__codelineno-73-10"> 10</a></span>
<span class="normal"><a href="#__codelineno-73-11"> 11</a></span>
<span class="normal"><a href="#__codelineno-73-12"> 12</a></span>
<span class="normal"><a href="#__codelineno-73-13"> 13</a></span>
<span class="normal"><a href="#__codelineno-73-14"> 14</a></span>
<span class="normal"><a href="#__codelineno-73-15"> 15</a></span>
<span class="normal"><a href="#__codelineno-73-16"> 16</a></span>
<span class="normal"><a href="#__codelineno-73-17"> 17</a></span>
<span class="normal"><a href="#__codelineno-73-18"> 18</a></span>
<span class="normal"><a href="#__codelineno-73-19"> 19</a></span>
<span class="normal"><a href="#__codelineno-73-20"> 20</a></span>
<span class="normal"><a href="#__codelineno-73-21"> 21</a></span>
<span class="normal"><a href="#__codelineno-73-22"> 22</a></span>
<span class="normal"><a href="#__codelineno-73-23"> 23</a></span>
<span class="normal"><a href="#__codelineno-73-24"> 24</a></span>
<span class="normal"><a href="#__codelineno-73-25"> 25</a></span>
<span class="normal"><a href="#__codelineno-73-26"> 26</a></span>
<span class="normal"><a href="#__codelineno-73-27"> 27</a></span>
<span class="normal"><a href="#__codelineno-73-28"> 28</a></span>
<span class="normal"><a href="#__codelineno-73-29"> 29</a></span>
<span class="normal"><a href="#__codelineno-73-30"> 30</a></span>
<span class="normal"><a href="#__codelineno-73-31"> 31</a></span>
<span class="normal"><a href="#__codelineno-73-32"> 32</a></span>
<span class="normal"><a href="#__codelineno-73-33"> 33</a></span>
<span class="normal"><a href="#__codelineno-73-34"> 34</a></span>
<span class="normal"><a href="#__codelineno-73-35"> 35</a></span>
<span class="normal"><a href="#__codelineno-73-36"> 36</a></span>
<span class="normal"><a href="#__codelineno-73-37"> 37</a></span>
<span class="normal"><a href="#__codelineno-73-38"> 38</a></span>
<span class="normal"><a href="#__codelineno-73-39"> 39</a></span>
<span class="normal"><a href="#__codelineno-73-40"> 40</a></span>
<span class="normal"><a href="#__codelineno-73-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-73-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-73-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-73-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-73-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-73-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-73-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-73-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-73-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-73-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-73-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-73-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-73-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-73-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-73-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-73-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-73-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-73-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-73-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-73-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-73-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-73-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-73-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-73-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-73-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-73-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-73-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-73-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-73-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-73-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-73-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-73-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-73-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-73-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-73-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-73-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-73-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-73-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-73-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-73-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-73-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-73-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-73-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-73-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-73-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-73-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-73-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-73-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-73-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-73-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-73-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-73-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-73-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-73-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-73-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-73-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-73-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-73-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-73-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-73-100">100</a></span>
<span class="normal"><a href="#__codelineno-73-101">101</a></span>
<span class="normal"><a href="#__codelineno-73-102">102</a></span>
<span class="normal"><a href="#__codelineno-73-103">103</a></span>
<span class="normal"><a href="#__codelineno-73-104">104</a></span>
<span class="normal"><a href="#__codelineno-73-105">105</a></span>
<span class="normal"><a href="#__codelineno-73-106">106</a></span>
<span class="normal"><a href="#__codelineno-73-107">107</a></span>
<span class="normal"><a href="#__codelineno-73-108">108</a></span>
<span class="normal"><a href="#__codelineno-73-109">109</a></span>
<span class="normal"><a href="#__codelineno-73-110">110</a></span>
<span class="normal"><a href="#__codelineno-73-111">111</a></span>
<span class="normal"><a href="#__codelineno-73-112">112</a></span>
<span class="normal"><a href="#__codelineno-73-113">113</a></span>
<span class="normal"><a href="#__codelineno-73-114">114</a></span>
<span class="normal"><a href="#__codelineno-73-115">115</a></span>
<span class="normal"><a href="#__codelineno-73-116">116</a></span>
<span class="normal"><a href="#__codelineno-73-117">117</a></span>
<span class="normal"><a href="#__codelineno-73-118">118</a></span>
<span class="normal"><a href="#__codelineno-73-119">119</a></span>
<span class="normal"><a href="#__codelineno-73-120">120</a></span>
<span class="normal"><a href="#__codelineno-73-121">121</a></span>
<span class="normal"><a href="#__codelineno-73-122">122</a></span>
<span class="normal"><a href="#__codelineno-73-123">123</a></span>
<span class="normal"><a href="#__codelineno-73-124">124</a></span>
<span class="normal"><a href="#__codelineno-73-125">125</a></span>
<span class="normal"><a href="#__codelineno-73-126">126</a></span>
<span class="normal"><a href="#__codelineno-73-127">127</a></span>
<span class="normal"><a href="#__codelineno-73-128">128</a></span>
<span class="normal"><a href="#__codelineno-73-129">129</a></span>
<span class="normal"><a href="#__codelineno-73-130">130</a></span>
<span class="normal"><a href="#__codelineno-73-131">131</a></span>
<span class="normal"><a href="#__codelineno-73-132">132</a></span>
<span class="normal"><a href="#__codelineno-73-133">133</a></span>
<span class="normal"><a href="#__codelineno-73-134">134</a></span>
<span class="normal"><a href="#__codelineno-73-135">135</a></span>
<span class="normal"><a href="#__codelineno-73-136">136</a></span>
<span class="normal"><a href="#__codelineno-73-137">137</a></span>
<span class="normal"><a href="#__codelineno-73-138">138</a></span>
<span class="normal"><a href="#__codelineno-73-139">139</a></span>
<span class="normal"><a href="#__codelineno-73-140">140</a></span>
<span class="normal"><a href="#__codelineno-73-141">141</a></span>
<span class="normal"><a href="#__codelineno-73-142">142</a></span>
<span class="normal"><a href="#__codelineno-73-143">143</a></span>
<span class="normal"><a href="#__codelineno-73-144">144</a></span>
<span class="normal"><a href="#__codelineno-73-145">145</a></span>
<span class="normal"><a href="#__codelineno-73-146">146</a></span>
<span class="normal"><a href="#__codelineno-73-147">147</a></span>
<span class="normal"><a href="#__codelineno-73-148">148</a></span>
<span class="normal"><a href="#__codelineno-73-149">149</a></span>
<span class="normal"><a href="#__codelineno-73-150">150</a></span>
<span class="normal"><a href="#__codelineno-73-151">151</a></span>
<span class="normal"><a href="#__codelineno-73-152">152</a></span>
<span class="normal"><a href="#__codelineno-73-153">153</a></span>
<span class="normal"><a href="#__codelineno-73-154">154</a></span>
<span class="normal"><a href="#__codelineno-73-155">155</a></span>
<span class="normal"><a href="#__codelineno-73-156">156</a></span>
<span class="normal"><a href="#__codelineno-73-157">157</a></span>
<span class="normal"><a href="#__codelineno-73-158">158</a></span>
<span class="normal"><a href="#__codelineno-73-159">159</a></span>
<span class="normal"><a href="#__codelineno-73-160">160</a></span>
<span class="normal"><a href="#__codelineno-73-161">161</a></span>
<span class="normal"><a href="#__codelineno-73-162">162</a></span>
<span class="normal"><a href="#__codelineno-73-163">163</a></span>
<span class="normal"><a href="#__codelineno-73-164">164</a></span>
<span class="normal"><a href="#__codelineno-73-165">165</a></span>
<span class="normal"><a href="#__codelineno-73-166">166</a></span>
<span class="normal"><a href="#__codelineno-73-167">167</a></span>
<span class="normal"><a href="#__codelineno-73-168">168</a></span>
<span class="normal"><a href="#__codelineno-73-169">169</a></span>
<span class="normal"><a href="#__codelineno-73-170">170</a></span>
<span class="normal"><a href="#__codelineno-73-171">171</a></span>
<span class="normal"><a href="#__codelineno-73-172">172</a></span>
<span class="normal"><a href="#__codelineno-73-173">173</a></span>
<span class="normal"><a href="#__codelineno-73-174">174</a></span>
<span class="normal"><a href="#__codelineno-73-175">175</a></span>
<span class="normal"><a href="#__codelineno-73-176">176</a></span>
<span class="normal"><a href="#__codelineno-73-177">177</a></span>
<span class="normal"><a href="#__codelineno-73-178">178</a></span>
<span class="normal"><a href="#__codelineno-73-179">179</a></span>
<span class="normal"><a href="#__codelineno-73-180">180</a></span>
<span class="normal"><a href="#__codelineno-73-181">181</a></span>
<span class="normal"><a href="#__codelineno-73-182">182</a></span>
<span class="normal"><a href="#__codelineno-73-183">183</a></span>
<span class="normal"><a href="#__codelineno-73-184">184</a></span>
<span class="normal"><a href="#__codelineno-73-185">185</a></span>
<span class="normal"><a href="#__codelineno-73-186">186</a></span>
<span class="normal"><a href="#__codelineno-73-187">187</a></span>
<span class="normal"><a href="#__codelineno-73-188">188</a></span>
<span class="normal"><a href="#__codelineno-73-189">189</a></span>
<span class="normal"><a href="#__codelineno-73-190">190</a></span>
<span class="normal"><a href="#__codelineno-73-191">191</a></span>
<span class="normal"><a href="#__codelineno-73-192">192</a></span>
<span class="normal"><a href="#__codelineno-73-193">193</a></span>
<span class="normal"><a href="#__codelineno-73-194">194</a></span>
<span class="normal"><a href="#__codelineno-73-195">195</a></span>
<span class="normal"><a href="#__codelineno-73-196">196</a></span>
<span class="normal"><a href="#__codelineno-73-197">197</a></span>
<span class="normal"><a href="#__codelineno-73-198">198</a></span>
<span class="normal"><a href="#__codelineno-73-199">199</a></span>
<span class="normal"><a href="#__codelineno-73-200">200</a></span>
<span class="normal"><a href="#__codelineno-73-201">201</a></span>
<span class="normal"><a href="#__codelineno-73-202">202</a></span>
<span class="normal"><a href="#__codelineno-73-203">203</a></span>
<span class="normal"><a href="#__codelineno-73-204">204</a></span>
<span class="normal"><a href="#__codelineno-73-205">205</a></span>
<span class="normal"><a href="#__codelineno-73-206">206</a></span>
<span class="normal"><a href="#__codelineno-73-207">207</a></span>
<span class="normal"><a href="#__codelineno-73-208">208</a></span>
<span class="normal"><a href="#__codelineno-73-209">209</a></span>
<span class="normal"><a href="#__codelineno-73-210">210</a></span>
<span class="normal"><a href="#__codelineno-73-211">211</a></span>
<span class="normal"><a href="#__codelineno-73-212">212</a></span>
<span class="normal"><a href="#__codelineno-73-213">213</a></span>
<span class="normal"><a href="#__codelineno-73-214">214</a></span>
<span class="normal"><a href="#__codelineno-73-215">215</a></span>
<span class="normal"><a href="#__codelineno-73-216">216</a></span>
<span class="normal"><a href="#__codelineno-73-217">217</a></span>
<span class="normal"><a href="#__codelineno-73-218">218</a></span>
<span class="normal"><a href="#__codelineno-73-219">219</a></span>
<span class="normal"><a href="#__codelineno-73-220">220</a></span>
<span class="normal"><a href="#__codelineno-73-221">221</a></span>
<span class="normal"><a href="#__codelineno-73-222">222</a></span>
<span class="normal"><a href="#__codelineno-73-223">223</a></span>
<span class="normal"><a href="#__codelineno-73-224">224</a></span>
<span class="normal"><a href="#__codelineno-73-225">225</a></span>
<span class="normal"><a href="#__codelineno-73-226">226</a></span>
<span class="normal"><a href="#__codelineno-73-227">227</a></span>
<span class="normal"><a href="#__codelineno-73-228">228</a></span>
<span class="normal"><a href="#__codelineno-73-229">229</a></span>
<span class="normal"><a href="#__codelineno-73-230">230</a></span>
<span class="normal"><a href="#__codelineno-73-231">231</a></span>
<span class="normal"><a href="#__codelineno-73-232">232</a></span>
<span class="normal"><a href="#__codelineno-73-233">233</a></span>
<span class="normal"><a href="#__codelineno-73-234">234</a></span>
<span class="normal"><a href="#__codelineno-73-235">235</a></span>
<span class="normal"><a href="#__codelineno-73-236">236</a></span>
<span class="normal"><a href="#__codelineno-73-237">237</a></span>
<span class="normal"><a href="#__codelineno-73-238">238</a></span>
<span class="normal"><a href="#__codelineno-73-239">239</a></span>
<span class="normal"><a href="#__codelineno-73-240">240</a></span>
<span class="normal"><a href="#__codelineno-73-241">241</a></span>
<span class="normal"><a href="#__codelineno-73-242">242</a></span>
<span class="normal"><a href="#__codelineno-73-243">243</a></span>
<span class="normal"><a href="#__codelineno-73-244">244</a></span>
<span class="normal"><a href="#__codelineno-73-245">245</a></span>
<span class="normal"><a href="#__codelineno-73-246">246</a></span>
<span class="normal"><a href="#__codelineno-73-247">247</a></span>
<span class="normal"><a href="#__codelineno-73-248">248</a></span>
<span class="normal"><a href="#__codelineno-73-249">249</a></span>
<span class="normal"><a href="#__codelineno-73-250">250</a></span>
<span class="normal"><a href="#__codelineno-73-251">251</a></span>
<span class="normal"><a href="#__codelineno-73-252">252</a></span>
<span class="normal"><a href="#__codelineno-73-253">253</a></span>
<span class="normal"><a href="#__codelineno-73-254">254</a></span>
<span class="normal"><a href="#__codelineno-73-255">255</a></span>
<span class="normal"><a href="#__codelineno-73-256">256</a></span>
<span class="normal"><a href="#__codelineno-73-257">257</a></span>
<span class="normal"><a href="#__codelineno-73-258">258</a></span>
<span class="normal"><a href="#__codelineno-73-259">259</a></span>
<span class="normal"><a href="#__codelineno-73-260">260</a></span>
<span class="normal"><a href="#__codelineno-73-261">261</a></span>
<span class="normal"><a href="#__codelineno-73-262">262</a></span>
<span class="normal"><a href="#__codelineno-73-263">263</a></span>
<span class="normal"><a href="#__codelineno-73-264">264</a></span>
<span class="normal"><a href="#__codelineno-73-265">265</a></span>
<span class="normal"><a href="#__codelineno-73-266">266</a></span>
<span class="normal"><a href="#__codelineno-73-267">267</a></span>
<span class="normal"><a href="#__codelineno-73-268">268</a></span>
<span class="normal"><a href="#__codelineno-73-269">269</a></span>
<span class="normal"><a href="#__codelineno-73-270">270</a></span>
<span class="normal"><a href="#__codelineno-73-271">271</a></span>
<span class="normal"><a href="#__codelineno-73-272">272</a></span>
<span class="normal"><a href="#__codelineno-73-273">273</a></span>
<span class="normal"><a href="#__codelineno-73-274">274</a></span>
<span class="normal"><a href="#__codelineno-73-275">275</a></span>
<span class="normal"><a href="#__codelineno-73-276">276</a></span>
<span class="normal"><a href="#__codelineno-73-277">277</a></span>
<span class="normal"><a href="#__codelineno-73-278">278</a></span>
<span class="normal"><a href="#__codelineno-73-279">279</a></span>
<span class="normal"><a href="#__codelineno-73-280">280</a></span>
<span class="normal"><a href="#__codelineno-73-281">281</a></span>
<span class="normal"><a href="#__codelineno-73-282">282</a></span>
<span class="normal"><a href="#__codelineno-73-283">283</a></span>
<span class="normal"><a href="#__codelineno-73-284">284</a></span>
<span class="normal"><a href="#__codelineno-73-285">285</a></span>
<span class="normal"><a href="#__codelineno-73-286">286</a></span>
<span class="normal"><a href="#__codelineno-73-287">287</a></span>
<span class="normal"><a href="#__codelineno-73-288">288</a></span>
<span class="normal"><a href="#__codelineno-73-289">289</a></span>
<span class="normal"><a href="#__codelineno-73-290">290</a></span>
<span class="normal"><a href="#__codelineno-73-291">291</a></span>
<span class="normal"><a href="#__codelineno-73-292">292</a></span>
<span class="normal"><a href="#__codelineno-73-293">293</a></span>
<span class="normal"><a href="#__codelineno-73-294">294</a></span>
<span class="normal"><a href="#__codelineno-73-295">295</a></span>
<span class="normal"><a href="#__codelineno-73-296">296</a></span>
<span class="normal"><a href="#__codelineno-73-297">297</a></span>
<span class="normal"><a href="#__codelineno-73-298">298</a></span>
<span class="normal"><a href="#__codelineno-73-299">299</a></span>
<span class="normal"><a href="#__codelineno-73-300">300</a></span>
<span class="normal"><a href="#__codelineno-73-301">301</a></span>
<span class="normal"><a href="#__codelineno-73-302">302</a></span>
<span class="normal"><a href="#__codelineno-73-303">303</a></span>
<span class="normal"><a href="#__codelineno-73-304">304</a></span>
<span class="normal"><a href="#__codelineno-73-305">305</a></span>
<span class="normal"><a href="#__codelineno-73-306">306</a></span>
<span class="normal"><a href="#__codelineno-73-307">307</a></span>
<span class="normal"><a href="#__codelineno-73-308">308</a></span>
<span class="normal"><a href="#__codelineno-73-309">309</a></span>
<span class="normal"><a href="#__codelineno-73-310">310</a></span>
<span class="normal"><a href="#__codelineno-73-311">311</a></span>
<span class="normal"><a href="#__codelineno-73-312">312</a></span>
<span class="normal"><a href="#__codelineno-73-313">313</a></span>
<span class="normal"><a href="#__codelineno-73-314">314</a></span>
<span class="normal"><a href="#__codelineno-73-315">315</a></span>
<span class="normal"><a href="#__codelineno-73-316">316</a></span>
<span class="normal"><a href="#__codelineno-73-317">317</a></span>
<span class="normal"><a href="#__codelineno-73-318">318</a></span>
<span class="normal"><a href="#__codelineno-73-319">319</a></span>
<span class="normal"><a href="#__codelineno-73-320">320</a></span>
<span class="normal"><a href="#__codelineno-73-321">321</a></span>
<span class="normal"><a href="#__codelineno-73-322">322</a></span>
<span class="normal"><a href="#__codelineno-73-323">323</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-73-1" name="__codelineno-73-1"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-73-2" name="__codelineno-73-2"></a><span class="sd">用户表 </span>
<a id="__codelineno-73-3" name="__codelineno-73-3"></a><span class="sd">    性别</span>
<a id="__codelineno-73-4" name="__codelineno-73-4"></a><span class="sd">    学历</span>
<a id="__codelineno-73-5" name="__codelineno-73-5"></a><span class="sd">    工作经验</span>
<a id="__codelineno-73-6" name="__codelineno-73-6"></a><span class="sd">    是否结婚</span>
<a id="__codelineno-73-7" name="__codelineno-73-7"></a><span class="sd">    是否生子</span>
<a id="__codelineno-73-8" name="__codelineno-73-8"></a><span class="sd">    客户来源</span>
<a id="__codelineno-73-9" name="__codelineno-73-9"></a><span class="sd">    ...</span>
<a id="__codelineno-73-10" name="__codelineno-73-10"></a><span class="sd">针对某个可以列举完全的可能性字段，我们应该如何存储</span>
<a id="__codelineno-73-11" name="__codelineno-73-11"></a>
<a id="__codelineno-73-12" name="__codelineno-73-12"></a><span class="sd">只要某个字段的可能性是可以列举完全的，那么一般情况下都会采用choices参数</span>
<a id="__codelineno-73-13" name="__codelineno-73-13"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-73-14" name="__codelineno-73-14"></a><span class="k">class</span><span class="w"> </span><span class="nc">User</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
<a id="__codelineno-73-15" name="__codelineno-73-15"></a>    <span class="n">username</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>
<a id="__codelineno-73-16" name="__codelineno-73-16"></a>    <span class="n">age</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">IntegerField</span><span class="p">()</span>
<a id="__codelineno-73-17" name="__codelineno-73-17"></a>    <span class="c1"># 性别</span>
<a id="__codelineno-73-18" name="__codelineno-73-18"></a>    <span class="n">gender_choices</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-73-19" name="__codelineno-73-19"></a>        <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;男&#39;</span><span class="p">),</span>
<a id="__codelineno-73-20" name="__codelineno-73-20"></a>        <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;女&#39;</span><span class="p">),</span>
<a id="__codelineno-73-21" name="__codelineno-73-21"></a>        <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="s1">&#39;其他&#39;</span><span class="p">),</span>
<a id="__codelineno-73-22" name="__codelineno-73-22"></a>    <span class="p">)</span>
<a id="__codelineno-73-23" name="__codelineno-73-23"></a>    <span class="n">gender</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">IntegerField</span><span class="p">(</span><span class="n">choices</span><span class="o">=</span><span class="n">gender_choices</span><span class="p">)</span>
<a id="__codelineno-73-24" name="__codelineno-73-24"></a>
<a id="__codelineno-73-25" name="__codelineno-73-25"></a>    <span class="n">score_choices</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-73-26" name="__codelineno-73-26"></a>        <span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="s1">&#39;优秀&#39;</span><span class="p">),</span>
<a id="__codelineno-73-27" name="__codelineno-73-27"></a>        <span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="s1">&#39;良好&#39;</span><span class="p">),</span>
<a id="__codelineno-73-28" name="__codelineno-73-28"></a>        <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span><span class="s1">&#39;及格&#39;</span><span class="p">),</span>
<a id="__codelineno-73-29" name="__codelineno-73-29"></a>        <span class="p">(</span><span class="s1">&#39;D&#39;</span><span class="p">,</span><span class="s1">&#39;不合格&#39;</span><span class="p">),</span>
<a id="__codelineno-73-30" name="__codelineno-73-30"></a>    <span class="p">)</span>
<a id="__codelineno-73-31" name="__codelineno-73-31"></a>    <span class="c1"># 保证字段类型跟列举出来的元祖第一个数据类型一致即可</span>
<a id="__codelineno-73-32" name="__codelineno-73-32"></a>    <span class="n">score</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">choices</span><span class="o">=</span><span class="n">score_choices</span><span class="p">,</span><span class="n">null</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-73-33" name="__codelineno-73-33"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-73-34" name="__codelineno-73-34"></a><span class="sd">    该gender字段存的还是数字 但是如果存的数字在上面元祖列举的范围之内</span>
<a id="__codelineno-73-35" name="__codelineno-73-35"></a><span class="sd">    那么可以非常轻松的获取到数字对应的真正的内容</span>
<a id="__codelineno-73-36" name="__codelineno-73-36"></a>
<a id="__codelineno-73-37" name="__codelineno-73-37"></a><span class="sd">    1.gender字段存的数字不在上述元祖列举的范围内容</span>
<a id="__codelineno-73-38" name="__codelineno-73-38"></a><span class="sd">    2.如果在 如何获取对应的中文信息</span>
<a id="__codelineno-73-39" name="__codelineno-73-39"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-73-40" name="__codelineno-73-40"></a>
<a id="__codelineno-73-41" name="__codelineno-73-41"></a>
<a id="__codelineno-73-42" name="__codelineno-73-42"></a>    <span class="kn">from</span><span class="w"> </span><span class="nn">app01</span><span class="w"> </span><span class="kn">import</span> <span class="n">models</span>
<a id="__codelineno-73-43" name="__codelineno-73-43"></a>    <span class="c1"># models.User.objects.create(username=&#39;jason&#39;,age=18,gender=1)</span>
<a id="__codelineno-73-44" name="__codelineno-73-44"></a>    <span class="c1"># models.User.objects.create(username=&#39;egon&#39;,age=85,gender=2)</span>
<a id="__codelineno-73-45" name="__codelineno-73-45"></a>    <span class="c1"># models.User.objects.create(username=&#39;tank&#39;,age=40,gender=3)</span>
<a id="__codelineno-73-46" name="__codelineno-73-46"></a>    <span class="c1"># 存的时候 没有列举出来的数字也能存（范围还是按照字段类型决定）</span>
<a id="__codelineno-73-47" name="__codelineno-73-47"></a>    <span class="c1"># models.User.objects.create(username=&#39;tony&#39;,age=45,gender=4)</span>
<a id="__codelineno-73-48" name="__codelineno-73-48"></a>
<a id="__codelineno-73-49" name="__codelineno-73-49"></a>    <span class="c1"># 取</span>
<a id="__codelineno-73-50" name="__codelineno-73-50"></a>    <span class="c1"># user_obj = models.User.objects.filter(pk=1).first()</span>
<a id="__codelineno-73-51" name="__codelineno-73-51"></a>    <span class="c1"># print(user_obj.gender)</span>
<a id="__codelineno-73-52" name="__codelineno-73-52"></a>    <span class="c1"># 只要是choices参数的字段 如果你想要获取对应信息 固定写法 get_字段名_display()</span>
<a id="__codelineno-73-53" name="__codelineno-73-53"></a>    <span class="c1"># print(user_obj.get_gender_display())</span>
<a id="__codelineno-73-54" name="__codelineno-73-54"></a>
<a id="__codelineno-73-55" name="__codelineno-73-55"></a>    <span class="n">user_obj</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">User</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
<a id="__codelineno-73-56" name="__codelineno-73-56"></a>    <span class="c1"># 如果没有对应关系 那么字段是什么还是展示什么</span>
<a id="__codelineno-73-57" name="__codelineno-73-57"></a>    <span class="nb">print</span><span class="p">(</span><span class="n">user_obj</span><span class="o">.</span><span class="n">get_gender_display</span><span class="p">())</span>  <span class="c1"># 4</span>
<a id="__codelineno-73-58" name="__codelineno-73-58"></a>
<a id="__codelineno-73-59" name="__codelineno-73-59"></a>
<a id="__codelineno-73-60" name="__codelineno-73-60"></a><span class="c1"># 实际项目案例</span>
<a id="__codelineno-73-61" name="__codelineno-73-61"></a><span class="c1"># CRM相关内部表</span>
<a id="__codelineno-73-62" name="__codelineno-73-62"></a><span class="k">class</span><span class="w"> </span><span class="nc">School</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
<a id="__codelineno-73-63" name="__codelineno-73-63"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-73-64" name="__codelineno-73-64"></a><span class="sd">    校区表</span>
<a id="__codelineno-73-65" name="__codelineno-73-65"></a><span class="sd">    如：</span>
<a id="__codelineno-73-66" name="__codelineno-73-66"></a><span class="sd">        北京沙河校区</span>
<a id="__codelineno-73-67" name="__codelineno-73-67"></a><span class="sd">        上海校区</span>
<a id="__codelineno-73-68" name="__codelineno-73-68"></a>
<a id="__codelineno-73-69" name="__codelineno-73-69"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-73-70" name="__codelineno-73-70"></a>    <span class="n">title</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">verbose_name</span><span class="o">=</span><span class="s1">&#39;校区名称&#39;</span><span class="p">,</span> <span class="n">max_length</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>
<a id="__codelineno-73-71" name="__codelineno-73-71"></a>
<a id="__codelineno-73-72" name="__codelineno-73-72"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-73-73" name="__codelineno-73-73"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">title</span>
<a id="__codelineno-73-74" name="__codelineno-73-74"></a>
<a id="__codelineno-73-75" name="__codelineno-73-75"></a><span class="k">class</span><span class="w"> </span><span class="nc">Course</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
<a id="__codelineno-73-76" name="__codelineno-73-76"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-73-77" name="__codelineno-73-77"></a><span class="sd">    课程表</span>
<a id="__codelineno-73-78" name="__codelineno-73-78"></a><span class="sd">    如：</span>
<a id="__codelineno-73-79" name="__codelineno-73-79"></a><span class="sd">        Linux基础</span>
<a id="__codelineno-73-80" name="__codelineno-73-80"></a><span class="sd">        Linux架构师</span>
<a id="__codelineno-73-81" name="__codelineno-73-81"></a><span class="sd">        Python自动化开发精英班</span>
<a id="__codelineno-73-82" name="__codelineno-73-82"></a><span class="sd">        Python自动化开发架构师班</span>
<a id="__codelineno-73-83" name="__codelineno-73-83"></a><span class="sd">        Python基础班</span>
<a id="__codelineno-73-84" name="__codelineno-73-84"></a><span class="sd">        go基础班</span>
<a id="__codelineno-73-85" name="__codelineno-73-85"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-73-86" name="__codelineno-73-86"></a>    <span class="n">name</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">verbose_name</span><span class="o">=</span><span class="s1">&#39;课程名称&#39;</span><span class="p">,</span> <span class="n">max_length</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>
<a id="__codelineno-73-87" name="__codelineno-73-87"></a>
<a id="__codelineno-73-88" name="__codelineno-73-88"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-73-89" name="__codelineno-73-89"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>
<a id="__codelineno-73-90" name="__codelineno-73-90"></a>
<a id="__codelineno-73-91" name="__codelineno-73-91"></a><span class="k">class</span><span class="w"> </span><span class="nc">Department</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
<a id="__codelineno-73-92" name="__codelineno-73-92"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-73-93" name="__codelineno-73-93"></a><span class="sd">    部门表</span>
<a id="__codelineno-73-94" name="__codelineno-73-94"></a><span class="sd">    市场部     1000</span>
<a id="__codelineno-73-95" name="__codelineno-73-95"></a><span class="sd">    销售       1001</span>
<a id="__codelineno-73-96" name="__codelineno-73-96"></a>
<a id="__codelineno-73-97" name="__codelineno-73-97"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-73-98" name="__codelineno-73-98"></a>    <span class="n">title</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">verbose_name</span><span class="o">=</span><span class="s1">&#39;部门名称&#39;</span><span class="p">,</span> <span class="n">max_length</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<a id="__codelineno-73-99" name="__codelineno-73-99"></a>    <span class="n">code</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">IntegerField</span><span class="p">(</span><span class="n">verbose_name</span><span class="o">=</span><span class="s1">&#39;部门编号&#39;</span><span class="p">,</span> <span class="n">unique</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-73-100" name="__codelineno-73-100"></a>
<a id="__codelineno-73-101" name="__codelineno-73-101"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-73-102" name="__codelineno-73-102"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">title</span>
<a id="__codelineno-73-103" name="__codelineno-73-103"></a>
<a id="__codelineno-73-104" name="__codelineno-73-104"></a><span class="k">class</span><span class="w"> </span><span class="nc">UserInfo</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
<a id="__codelineno-73-105" name="__codelineno-73-105"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-73-106" name="__codelineno-73-106"></a><span class="sd">    员工表</span>
<a id="__codelineno-73-107" name="__codelineno-73-107"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-73-108" name="__codelineno-73-108"></a>
<a id="__codelineno-73-109" name="__codelineno-73-109"></a>    <span class="n">name</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">verbose_name</span><span class="o">=</span><span class="s1">&#39;员工姓名&#39;</span><span class="p">,</span> <span class="n">max_length</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<a id="__codelineno-73-110" name="__codelineno-73-110"></a>    <span class="n">email</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">EmailField</span><span class="p">(</span><span class="n">verbose_name</span><span class="o">=</span><span class="s1">&#39;邮箱&#39;</span><span class="p">,</span> <span class="n">max_length</span><span class="o">=</span><span class="mi">64</span><span class="p">)</span>
<a id="__codelineno-73-111" name="__codelineno-73-111"></a>    <span class="n">depart</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="n">verbose_name</span><span class="o">=</span><span class="s1">&#39;部门&#39;</span><span class="p">,</span> <span class="n">to</span><span class="o">=</span><span class="s2">&quot;Department&quot;</span><span class="p">,</span><span class="n">to_field</span><span class="o">=</span><span class="s2">&quot;code&quot;</span><span class="p">)</span>
<a id="__codelineno-73-112" name="__codelineno-73-112"></a>    <span class="n">user</span><span class="o">=</span><span class="n">models</span><span class="o">.</span><span class="n">OneToOneField</span><span class="p">(</span><span class="s2">&quot;User&quot;</span><span class="p">,</span><span class="n">default</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-73-113" name="__codelineno-73-113"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-73-114" name="__codelineno-73-114"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>
<a id="__codelineno-73-115" name="__codelineno-73-115"></a>
<a id="__codelineno-73-116" name="__codelineno-73-116"></a><span class="k">class</span><span class="w"> </span><span class="nc">ClassList</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
<a id="__codelineno-73-117" name="__codelineno-73-117"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-73-118" name="__codelineno-73-118"></a><span class="sd">    班级表</span>
<a id="__codelineno-73-119" name="__codelineno-73-119"></a><span class="sd">    如：</span>
<a id="__codelineno-73-120" name="__codelineno-73-120"></a><span class="sd">        Python全栈  面授班  5期  10000  2017-11-11  2018-5-11</span>
<a id="__codelineno-73-121" name="__codelineno-73-121"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-73-122" name="__codelineno-73-122"></a>    <span class="n">school</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="n">verbose_name</span><span class="o">=</span><span class="s1">&#39;校区&#39;</span><span class="p">,</span> <span class="n">to</span><span class="o">=</span><span class="s1">&#39;School&#39;</span><span class="p">)</span>
<a id="__codelineno-73-123" name="__codelineno-73-123"></a>    <span class="n">course</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="n">verbose_name</span><span class="o">=</span><span class="s1">&#39;课程名称&#39;</span><span class="p">,</span> <span class="n">to</span><span class="o">=</span><span class="s1">&#39;Course&#39;</span><span class="p">)</span>
<a id="__codelineno-73-124" name="__codelineno-73-124"></a>    <span class="n">semester</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">IntegerField</span><span class="p">(</span><span class="n">verbose_name</span><span class="o">=</span><span class="s2">&quot;班级(期)&quot;</span><span class="p">)</span>
<a id="__codelineno-73-125" name="__codelineno-73-125"></a>
<a id="__codelineno-73-126" name="__codelineno-73-126"></a>
<a id="__codelineno-73-127" name="__codelineno-73-127"></a>    <span class="n">price</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">IntegerField</span><span class="p">(</span><span class="n">verbose_name</span><span class="o">=</span><span class="s2">&quot;学费&quot;</span><span class="p">)</span>
<a id="__codelineno-73-128" name="__codelineno-73-128"></a>    <span class="n">start_date</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DateField</span><span class="p">(</span><span class="n">verbose_name</span><span class="o">=</span><span class="s2">&quot;开班日期&quot;</span><span class="p">)</span>
<a id="__codelineno-73-129" name="__codelineno-73-129"></a>    <span class="n">graduate_date</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DateField</span><span class="p">(</span><span class="n">verbose_name</span><span class="o">=</span><span class="s2">&quot;结业日期&quot;</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">blank</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-73-130" name="__codelineno-73-130"></a>    <span class="n">memo</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">verbose_name</span><span class="o">=</span><span class="s1">&#39;说明&#39;</span><span class="p">,</span> <span class="n">max_length</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span> <span class="n">blank</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="p">)</span>
<a id="__codelineno-73-131" name="__codelineno-73-131"></a>
<a id="__codelineno-73-132" name="__codelineno-73-132"></a>    <span class="n">teachers</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ManyToManyField</span><span class="p">(</span><span class="n">verbose_name</span><span class="o">=</span><span class="s1">&#39;任课老师&#39;</span><span class="p">,</span> <span class="n">to</span><span class="o">=</span><span class="s1">&#39;UserInfo&#39;</span><span class="p">,</span><span class="n">limit_choices_to</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;depart&#39;</span><span class="p">:</span><span class="mi">1002</span><span class="p">})</span>
<a id="__codelineno-73-133" name="__codelineno-73-133"></a>    <span class="n">tutor</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="n">verbose_name</span><span class="o">=</span><span class="s1">&#39;班主任&#39;</span><span class="p">,</span> <span class="n">to</span><span class="o">=</span><span class="s1">&#39;UserInfo&#39;</span><span class="p">,</span><span class="n">related_name</span><span class="o">=</span><span class="s2">&quot;class_list&quot;</span><span class="p">,</span><span class="n">limit_choices_to</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;depart&#39;</span><span class="p">:</span><span class="mi">1006</span><span class="p">})</span>
<a id="__codelineno-73-134" name="__codelineno-73-134"></a>
<a id="__codelineno-73-135" name="__codelineno-73-135"></a>
<a id="__codelineno-73-136" name="__codelineno-73-136"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-73-137" name="__codelineno-73-137"></a>        <span class="k">return</span> <span class="s2">&quot;</span><span class="si">{0}</span><span class="s2">(</span><span class="si">{1}</span><span class="s2">期)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">course</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">semester</span><span class="p">)</span>
<a id="__codelineno-73-138" name="__codelineno-73-138"></a>
<a id="__codelineno-73-139" name="__codelineno-73-139"></a>
<a id="__codelineno-73-140" name="__codelineno-73-140"></a><span class="k">class</span><span class="w"> </span><span class="nc">Customer</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
<a id="__codelineno-73-141" name="__codelineno-73-141"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-73-142" name="__codelineno-73-142"></a><span class="sd">    客户表</span>
<a id="__codelineno-73-143" name="__codelineno-73-143"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-73-144" name="__codelineno-73-144"></a>    <span class="n">qq</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">verbose_name</span><span class="o">=</span><span class="s1">&#39;qq&#39;</span><span class="p">,</span> <span class="n">max_length</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span> <span class="n">unique</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">help_text</span><span class="o">=</span><span class="s1">&#39;QQ号必须唯一&#39;</span><span class="p">)</span>
<a id="__codelineno-73-145" name="__codelineno-73-145"></a>
<a id="__codelineno-73-146" name="__codelineno-73-146"></a>    <span class="n">name</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">verbose_name</span><span class="o">=</span><span class="s1">&#39;学生姓名&#39;</span><span class="p">,</span> <span class="n">max_length</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<a id="__codelineno-73-147" name="__codelineno-73-147"></a>    <span class="n">gender_choices</span> <span class="o">=</span> <span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;男&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;女&#39;</span><span class="p">))</span>
<a id="__codelineno-73-148" name="__codelineno-73-148"></a>    <span class="n">gender</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">SmallIntegerField</span><span class="p">(</span><span class="n">verbose_name</span><span class="o">=</span><span class="s1">&#39;性别&#39;</span><span class="p">,</span> <span class="n">choices</span><span class="o">=</span><span class="n">gender_choices</span><span class="p">)</span>
<a id="__codelineno-73-149" name="__codelineno-73-149"></a>
<a id="__codelineno-73-150" name="__codelineno-73-150"></a>    <span class="n">education_choices</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-73-151" name="__codelineno-73-151"></a>        <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;重点大学&#39;</span><span class="p">),</span>
<a id="__codelineno-73-152" name="__codelineno-73-152"></a>        <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;普通本科&#39;</span><span class="p">),</span>
<a id="__codelineno-73-153" name="__codelineno-73-153"></a>        <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;独立院校&#39;</span><span class="p">),</span>
<a id="__codelineno-73-154" name="__codelineno-73-154"></a>        <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;民办本科&#39;</span><span class="p">),</span>
<a id="__codelineno-73-155" name="__codelineno-73-155"></a>        <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;大专&#39;</span><span class="p">),</span>
<a id="__codelineno-73-156" name="__codelineno-73-156"></a>        <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;民办专科&#39;</span><span class="p">),</span>
<a id="__codelineno-73-157" name="__codelineno-73-157"></a>        <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="s1">&#39;高中&#39;</span><span class="p">),</span>
<a id="__codelineno-73-158" name="__codelineno-73-158"></a>        <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="s1">&#39;其他&#39;</span><span class="p">)</span>
<a id="__codelineno-73-159" name="__codelineno-73-159"></a>    <span class="p">)</span>
<a id="__codelineno-73-160" name="__codelineno-73-160"></a>    <span class="n">education</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">IntegerField</span><span class="p">(</span><span class="n">verbose_name</span><span class="o">=</span><span class="s1">&#39;学历&#39;</span><span class="p">,</span> <span class="n">choices</span><span class="o">=</span><span class="n">education_choices</span><span class="p">,</span> <span class="n">blank</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="p">)</span>
<a id="__codelineno-73-161" name="__codelineno-73-161"></a>    <span class="n">graduation_school</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">verbose_name</span><span class="o">=</span><span class="s1">&#39;毕业学校&#39;</span><span class="p">,</span> <span class="n">max_length</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span> <span class="n">blank</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-73-162" name="__codelineno-73-162"></a>    <span class="n">major</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">verbose_name</span><span class="o">=</span><span class="s1">&#39;所学专业&#39;</span><span class="p">,</span> <span class="n">max_length</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span> <span class="n">blank</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-73-163" name="__codelineno-73-163"></a>
<a id="__codelineno-73-164" name="__codelineno-73-164"></a>    <span class="n">experience_choices</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-73-165" name="__codelineno-73-165"></a>        <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;在校生&#39;</span><span class="p">),</span>
<a id="__codelineno-73-166" name="__codelineno-73-166"></a>        <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;应届毕业&#39;</span><span class="p">),</span>
<a id="__codelineno-73-167" name="__codelineno-73-167"></a>        <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;半年以内&#39;</span><span class="p">),</span>
<a id="__codelineno-73-168" name="__codelineno-73-168"></a>        <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;半年至一年&#39;</span><span class="p">),</span>
<a id="__codelineno-73-169" name="__codelineno-73-169"></a>        <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;一年至三年&#39;</span><span class="p">),</span>
<a id="__codelineno-73-170" name="__codelineno-73-170"></a>        <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;三年至五年&#39;</span><span class="p">),</span>
<a id="__codelineno-73-171" name="__codelineno-73-171"></a>        <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="s1">&#39;五年以上&#39;</span><span class="p">),</span>
<a id="__codelineno-73-172" name="__codelineno-73-172"></a>    <span class="p">]</span>
<a id="__codelineno-73-173" name="__codelineno-73-173"></a>    <span class="n">experience</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">IntegerField</span><span class="p">(</span><span class="n">verbose_name</span><span class="o">=</span><span class="s1">&#39;工作经验&#39;</span><span class="p">,</span> <span class="n">blank</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">choices</span><span class="o">=</span><span class="n">experience_choices</span><span class="p">)</span>
<a id="__codelineno-73-174" name="__codelineno-73-174"></a>    <span class="n">work_status_choices</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-73-175" name="__codelineno-73-175"></a>        <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;在职&#39;</span><span class="p">),</span>
<a id="__codelineno-73-176" name="__codelineno-73-176"></a>        <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;无业&#39;</span><span class="p">)</span>
<a id="__codelineno-73-177" name="__codelineno-73-177"></a>    <span class="p">]</span>
<a id="__codelineno-73-178" name="__codelineno-73-178"></a>    <span class="n">work_status</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">IntegerField</span><span class="p">(</span><span class="n">verbose_name</span><span class="o">=</span><span class="s2">&quot;职业状态&quot;</span><span class="p">,</span> <span class="n">choices</span><span class="o">=</span><span class="n">work_status_choices</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">blank</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-73-179" name="__codelineno-73-179"></a>                                      <span class="n">null</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-73-180" name="__codelineno-73-180"></a>    <span class="n">company</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">verbose_name</span><span class="o">=</span><span class="s2">&quot;目前就职公司&quot;</span><span class="p">,</span> <span class="n">max_length</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span> <span class="n">blank</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-73-181" name="__codelineno-73-181"></a>    <span class="n">salary</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">verbose_name</span><span class="o">=</span><span class="s2">&quot;当前薪资&quot;</span><span class="p">,</span> <span class="n">max_length</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span> <span class="n">blank</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-73-182" name="__codelineno-73-182"></a>
<a id="__codelineno-73-183" name="__codelineno-73-183"></a>    <span class="n">source_choices</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-73-184" name="__codelineno-73-184"></a>        <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;qq群&quot;</span><span class="p">),</span>
<a id="__codelineno-73-185" name="__codelineno-73-185"></a>        <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;内部转介绍&quot;</span><span class="p">),</span>
<a id="__codelineno-73-186" name="__codelineno-73-186"></a>        <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;官方网站&quot;</span><span class="p">),</span>
<a id="__codelineno-73-187" name="__codelineno-73-187"></a>        <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;百度推广&quot;</span><span class="p">),</span>
<a id="__codelineno-73-188" name="__codelineno-73-188"></a>        <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s2">&quot;360推广&quot;</span><span class="p">),</span>
<a id="__codelineno-73-189" name="__codelineno-73-189"></a>        <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="s2">&quot;搜狗推广&quot;</span><span class="p">),</span>
<a id="__codelineno-73-190" name="__codelineno-73-190"></a>        <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="s2">&quot;腾讯课堂&quot;</span><span class="p">),</span>
<a id="__codelineno-73-191" name="__codelineno-73-191"></a>        <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="s2">&quot;广点通&quot;</span><span class="p">),</span>
<a id="__codelineno-73-192" name="__codelineno-73-192"></a>        <span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="s2">&quot;高校宣讲&quot;</span><span class="p">),</span>
<a id="__codelineno-73-193" name="__codelineno-73-193"></a>        <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="s2">&quot;渠道代理&quot;</span><span class="p">),</span>
<a id="__codelineno-73-194" name="__codelineno-73-194"></a>        <span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="s2">&quot;51cto&quot;</span><span class="p">),</span>
<a id="__codelineno-73-195" name="__codelineno-73-195"></a>        <span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="s2">&quot;智汇推&quot;</span><span class="p">),</span>
<a id="__codelineno-73-196" name="__codelineno-73-196"></a>        <span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="s2">&quot;网盟&quot;</span><span class="p">),</span>
<a id="__codelineno-73-197" name="__codelineno-73-197"></a>        <span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="s2">&quot;DSP&quot;</span><span class="p">),</span>
<a id="__codelineno-73-198" name="__codelineno-73-198"></a>        <span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="s2">&quot;SEO&quot;</span><span class="p">),</span>
<a id="__codelineno-73-199" name="__codelineno-73-199"></a>        <span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="s2">&quot;其它&quot;</span><span class="p">),</span>
<a id="__codelineno-73-200" name="__codelineno-73-200"></a>    <span class="p">]</span>
<a id="__codelineno-73-201" name="__codelineno-73-201"></a>    <span class="n">source</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">SmallIntegerField</span><span class="p">(</span><span class="s1">&#39;客户来源&#39;</span><span class="p">,</span> <span class="n">choices</span><span class="o">=</span><span class="n">source_choices</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-73-202" name="__codelineno-73-202"></a>    <span class="n">referral_from</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span>
<a id="__codelineno-73-203" name="__codelineno-73-203"></a>        <span class="s1">&#39;self&#39;</span><span class="p">,</span>
<a id="__codelineno-73-204" name="__codelineno-73-204"></a>        <span class="n">blank</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-73-205" name="__codelineno-73-205"></a>        <span class="n">null</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-73-206" name="__codelineno-73-206"></a>        <span class="n">verbose_name</span><span class="o">=</span><span class="s2">&quot;转介绍自学员&quot;</span><span class="p">,</span>
<a id="__codelineno-73-207" name="__codelineno-73-207"></a>        <span class="n">help_text</span><span class="o">=</span><span class="s2">&quot;若此客户是转介绍自内部学员,请在此处选择内部学员姓名&quot;</span><span class="p">,</span>
<a id="__codelineno-73-208" name="__codelineno-73-208"></a>        <span class="n">related_name</span><span class="o">=</span><span class="s2">&quot;internal_referral&quot;</span>
<a id="__codelineno-73-209" name="__codelineno-73-209"></a>    <span class="p">)</span>
<a id="__codelineno-73-210" name="__codelineno-73-210"></a>    <span class="n">course</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ManyToManyField</span><span class="p">(</span><span class="n">verbose_name</span><span class="o">=</span><span class="s2">&quot;咨询课程&quot;</span><span class="p">,</span> <span class="n">to</span><span class="o">=</span><span class="s2">&quot;Course&quot;</span><span class="p">)</span>
<a id="__codelineno-73-211" name="__codelineno-73-211"></a>
<a id="__codelineno-73-212" name="__codelineno-73-212"></a>    <span class="n">status_choices</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-73-213" name="__codelineno-73-213"></a>        <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;已报名&quot;</span><span class="p">),</span>
<a id="__codelineno-73-214" name="__codelineno-73-214"></a>        <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;未报名&quot;</span><span class="p">)</span>
<a id="__codelineno-73-215" name="__codelineno-73-215"></a>    <span class="p">]</span>
<a id="__codelineno-73-216" name="__codelineno-73-216"></a>    <span class="n">status</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">IntegerField</span><span class="p">(</span>
<a id="__codelineno-73-217" name="__codelineno-73-217"></a>        <span class="n">verbose_name</span><span class="o">=</span><span class="s2">&quot;状态&quot;</span><span class="p">,</span>
<a id="__codelineno-73-218" name="__codelineno-73-218"></a>        <span class="n">choices</span><span class="o">=</span><span class="n">status_choices</span><span class="p">,</span>
<a id="__codelineno-73-219" name="__codelineno-73-219"></a>        <span class="n">default</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<a id="__codelineno-73-220" name="__codelineno-73-220"></a>        <span class="n">help_text</span><span class="o">=</span><span class="sa">u</span><span class="s2">&quot;选择客户此时的状态&quot;</span>
<a id="__codelineno-73-221" name="__codelineno-73-221"></a>    <span class="p">)</span>
<a id="__codelineno-73-222" name="__codelineno-73-222"></a>
<a id="__codelineno-73-223" name="__codelineno-73-223"></a>    <span class="n">consultant</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="n">verbose_name</span><span class="o">=</span><span class="s2">&quot;课程顾问&quot;</span><span class="p">,</span> <span class="n">to</span><span class="o">=</span><span class="s1">&#39;UserInfo&#39;</span><span class="p">,</span> <span class="n">related_name</span><span class="o">=</span><span class="s1">&#39;consultanter&#39;</span><span class="p">,</span><span class="n">limit_choices_to</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;depart&#39;</span><span class="p">:</span><span class="mi">1001</span><span class="p">})</span>
<a id="__codelineno-73-224" name="__codelineno-73-224"></a>
<a id="__codelineno-73-225" name="__codelineno-73-225"></a>    <span class="n">date</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DateField</span><span class="p">(</span><span class="n">verbose_name</span><span class="o">=</span><span class="s2">&quot;咨询日期&quot;</span><span class="p">,</span> <span class="n">auto_now_add</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-73-226" name="__codelineno-73-226"></a>    <span class="n">recv_date</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DateField</span><span class="p">(</span><span class="n">verbose_name</span><span class="o">=</span><span class="s2">&quot;当前课程顾问的接单日期&quot;</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-73-227" name="__codelineno-73-227"></a>    <span class="n">last_consult_date</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DateField</span><span class="p">(</span><span class="n">verbose_name</span><span class="o">=</span><span class="s2">&quot;最后跟进日期&quot;</span><span class="p">,</span> <span class="p">)</span>
<a id="__codelineno-73-228" name="__codelineno-73-228"></a>
<a id="__codelineno-73-229" name="__codelineno-73-229"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-73-230" name="__codelineno-73-230"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>
<a id="__codelineno-73-231" name="__codelineno-73-231"></a>
<a id="__codelineno-73-232" name="__codelineno-73-232"></a><span class="k">class</span><span class="w"> </span><span class="nc">ConsultRecord</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
<a id="__codelineno-73-233" name="__codelineno-73-233"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-73-234" name="__codelineno-73-234"></a><span class="sd">    客户跟进记录</span>
<a id="__codelineno-73-235" name="__codelineno-73-235"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-73-236" name="__codelineno-73-236"></a>    <span class="n">customer</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="n">verbose_name</span><span class="o">=</span><span class="s2">&quot;所咨询客户&quot;</span><span class="p">,</span> <span class="n">to</span><span class="o">=</span><span class="s1">&#39;Customer&#39;</span><span class="p">)</span>
<a id="__codelineno-73-237" name="__codelineno-73-237"></a>    <span class="n">consultant</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="n">verbose_name</span><span class="o">=</span><span class="s2">&quot;跟踪人&quot;</span><span class="p">,</span> <span class="n">to</span><span class="o">=</span><span class="s1">&#39;UserInfo&#39;</span><span class="p">,</span><span class="n">limit_choices_to</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;depart&#39;</span><span class="p">:</span><span class="mi">1001</span><span class="p">})</span>
<a id="__codelineno-73-238" name="__codelineno-73-238"></a>    <span class="n">date</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DateField</span><span class="p">(</span><span class="n">verbose_name</span><span class="o">=</span><span class="s2">&quot;跟进日期&quot;</span><span class="p">,</span> <span class="n">auto_now_add</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-73-239" name="__codelineno-73-239"></a>    <span class="n">note</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">TextField</span><span class="p">(</span><span class="n">verbose_name</span><span class="o">=</span><span class="s2">&quot;跟进内容...&quot;</span><span class="p">)</span>
<a id="__codelineno-73-240" name="__codelineno-73-240"></a>
<a id="__codelineno-73-241" name="__codelineno-73-241"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-73-242" name="__codelineno-73-242"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">customer</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">consultant</span><span class="o">.</span><span class="n">name</span>
<a id="__codelineno-73-243" name="__codelineno-73-243"></a>
<a id="__codelineno-73-244" name="__codelineno-73-244"></a><span class="k">class</span><span class="w"> </span><span class="nc">Student</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
<a id="__codelineno-73-245" name="__codelineno-73-245"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-73-246" name="__codelineno-73-246"></a><span class="sd">    学生表（已报名）</span>
<a id="__codelineno-73-247" name="__codelineno-73-247"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-73-248" name="__codelineno-73-248"></a>    <span class="n">customer</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">OneToOneField</span><span class="p">(</span><span class="n">verbose_name</span><span class="o">=</span><span class="s1">&#39;客户信息&#39;</span><span class="p">,</span> <span class="n">to</span><span class="o">=</span><span class="s1">&#39;Customer&#39;</span><span class="p">)</span>
<a id="__codelineno-73-249" name="__codelineno-73-249"></a>    <span class="n">class_list</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ManyToManyField</span><span class="p">(</span><span class="n">verbose_name</span><span class="o">=</span><span class="s2">&quot;已报班级&quot;</span><span class="p">,</span> <span class="n">to</span><span class="o">=</span><span class="s1">&#39;ClassList&#39;</span><span class="p">,</span> <span class="n">blank</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-73-250" name="__codelineno-73-250"></a>
<a id="__codelineno-73-251" name="__codelineno-73-251"></a>    <span class="n">emergency_contract</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">blank</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verbose_name</span><span class="o">=</span><span class="s1">&#39;紧急联系人&#39;</span><span class="p">)</span>
<a id="__codelineno-73-252" name="__codelineno-73-252"></a>    <span class="n">company</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">verbose_name</span><span class="o">=</span><span class="s1">&#39;公司&#39;</span><span class="p">,</span> <span class="n">max_length</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span> <span class="n">blank</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-73-253" name="__codelineno-73-253"></a>    <span class="n">location</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span> <span class="n">verbose_name</span><span class="o">=</span><span class="s1">&#39;所在区域&#39;</span><span class="p">,</span> <span class="n">blank</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-73-254" name="__codelineno-73-254"></a>    <span class="n">position</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">verbose_name</span><span class="o">=</span><span class="s1">&#39;岗位&#39;</span><span class="p">,</span> <span class="n">max_length</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span> <span class="n">blank</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-73-255" name="__codelineno-73-255"></a>    <span class="n">salary</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">IntegerField</span><span class="p">(</span><span class="n">verbose_name</span><span class="o">=</span><span class="s1">&#39;薪资&#39;</span><span class="p">,</span> <span class="n">blank</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-73-256" name="__codelineno-73-256"></a>    <span class="n">welfare</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">verbose_name</span><span class="o">=</span><span class="s1">&#39;福利&#39;</span><span class="p">,</span> <span class="n">max_length</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span> <span class="n">blank</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-73-257" name="__codelineno-73-257"></a>    <span class="n">date</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DateField</span><span class="p">(</span><span class="n">verbose_name</span><span class="o">=</span><span class="s1">&#39;入职时间&#39;</span><span class="p">,</span> <span class="n">help_text</span><span class="o">=</span><span class="s1">&#39;格式yyyy-mm-dd&#39;</span><span class="p">,</span> <span class="n">blank</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-73-258" name="__codelineno-73-258"></a>    <span class="n">memo</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">verbose_name</span><span class="o">=</span><span class="s1">&#39;备注&#39;</span><span class="p">,</span> <span class="n">max_length</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span> <span class="n">blank</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-73-259" name="__codelineno-73-259"></a>
<a id="__codelineno-73-260" name="__codelineno-73-260"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-73-261" name="__codelineno-73-261"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">customer</span><span class="o">.</span><span class="n">name</span>
<a id="__codelineno-73-262" name="__codelineno-73-262"></a>
<a id="__codelineno-73-263" name="__codelineno-73-263"></a><span class="k">class</span><span class="w"> </span><span class="nc">ClassStudyRecord</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
<a id="__codelineno-73-264" name="__codelineno-73-264"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-73-265" name="__codelineno-73-265"></a><span class="sd">    上课记录表 （班级记录）</span>
<a id="__codelineno-73-266" name="__codelineno-73-266"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-73-267" name="__codelineno-73-267"></a>    <span class="n">class_obj</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="n">verbose_name</span><span class="o">=</span><span class="s2">&quot;班级&quot;</span><span class="p">,</span> <span class="n">to</span><span class="o">=</span><span class="s2">&quot;ClassList&quot;</span><span class="p">)</span>
<a id="__codelineno-73-268" name="__codelineno-73-268"></a>    <span class="n">day_num</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">IntegerField</span><span class="p">(</span><span class="n">verbose_name</span><span class="o">=</span><span class="s2">&quot;节次&quot;</span><span class="p">,</span> <span class="n">help_text</span><span class="o">=</span><span class="sa">u</span><span class="s2">&quot;此处填写第几节课或第几天课程...,必须为数字&quot;</span><span class="p">)</span>
<a id="__codelineno-73-269" name="__codelineno-73-269"></a>    <span class="n">teacher</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="n">verbose_name</span><span class="o">=</span><span class="s2">&quot;讲师&quot;</span><span class="p">,</span> <span class="n">to</span><span class="o">=</span><span class="s1">&#39;UserInfo&#39;</span><span class="p">,</span><span class="n">limit_choices_to</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;depart&#39;</span><span class="p">:</span><span class="mi">1002</span><span class="p">})</span>
<a id="__codelineno-73-270" name="__codelineno-73-270"></a>    <span class="n">date</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DateField</span><span class="p">(</span><span class="n">verbose_name</span><span class="o">=</span><span class="s2">&quot;上课日期&quot;</span><span class="p">,</span> <span class="n">auto_now_add</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-73-271" name="__codelineno-73-271"></a>
<a id="__codelineno-73-272" name="__codelineno-73-272"></a>    <span class="n">course_title</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">verbose_name</span><span class="o">=</span><span class="s1">&#39;本节课程标题&#39;</span><span class="p">,</span> <span class="n">max_length</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span> <span class="n">blank</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-73-273" name="__codelineno-73-273"></a>    <span class="n">course_memo</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">TextField</span><span class="p">(</span><span class="n">verbose_name</span><span class="o">=</span><span class="s1">&#39;本节课程内容概要&#39;</span><span class="p">,</span> <span class="n">blank</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-73-274" name="__codelineno-73-274"></a>    <span class="n">has_homework</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">BooleanField</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verbose_name</span><span class="o">=</span><span class="s2">&quot;本节有作业&quot;</span><span class="p">)</span>
<a id="__codelineno-73-275" name="__codelineno-73-275"></a>    <span class="n">homework_title</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">verbose_name</span><span class="o">=</span><span class="s1">&#39;本节作业标题&#39;</span><span class="p">,</span> <span class="n">max_length</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span> <span class="n">blank</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-73-276" name="__codelineno-73-276"></a>    <span class="n">homework_memo</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">TextField</span><span class="p">(</span><span class="n">verbose_name</span><span class="o">=</span><span class="s1">&#39;作业描述&#39;</span><span class="p">,</span> <span class="n">max_length</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">blank</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-73-277" name="__codelineno-73-277"></a>    <span class="n">exam</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">TextField</span><span class="p">(</span><span class="n">verbose_name</span><span class="o">=</span><span class="s1">&#39;踩分点&#39;</span><span class="p">,</span> <span class="n">max_length</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">blank</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-73-278" name="__codelineno-73-278"></a>
<a id="__codelineno-73-279" name="__codelineno-73-279"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-73-280" name="__codelineno-73-280"></a>        <span class="k">return</span> <span class="s2">&quot;</span><span class="si">{0}</span><span class="s2"> day</span><span class="si">{1}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">class_obj</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">day_num</span><span class="p">)</span>
<a id="__codelineno-73-281" name="__codelineno-73-281"></a>
<a id="__codelineno-73-282" name="__codelineno-73-282"></a><span class="k">class</span><span class="w"> </span><span class="nc">StudentStudyRecord</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
<a id="__codelineno-73-283" name="__codelineno-73-283"></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<a id="__codelineno-73-284" name="__codelineno-73-284"></a><span class="sd">    学生学习记录</span>
<a id="__codelineno-73-285" name="__codelineno-73-285"></a><span class="sd">    &#39;&#39;&#39;</span>
<a id="__codelineno-73-286" name="__codelineno-73-286"></a>    <span class="n">classstudyrecord</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="n">verbose_name</span><span class="o">=</span><span class="s2">&quot;第几天课程&quot;</span><span class="p">,</span> <span class="n">to</span><span class="o">=</span><span class="s2">&quot;ClassStudyRecord&quot;</span><span class="p">)</span>
<a id="__codelineno-73-287" name="__codelineno-73-287"></a>    <span class="n">student</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="n">verbose_name</span><span class="o">=</span><span class="s2">&quot;学员&quot;</span><span class="p">,</span> <span class="n">to</span><span class="o">=</span><span class="s1">&#39;Student&#39;</span><span class="p">)</span>
<a id="__codelineno-73-288" name="__codelineno-73-288"></a>
<a id="__codelineno-73-289" name="__codelineno-73-289"></a>
<a id="__codelineno-73-290" name="__codelineno-73-290"></a>    <span class="n">record_choices</span> <span class="o">=</span> <span class="p">((</span><span class="s1">&#39;checked&#39;</span><span class="p">,</span> <span class="s2">&quot;已签到&quot;</span><span class="p">),</span>
<a id="__codelineno-73-291" name="__codelineno-73-291"></a>                      <span class="p">(</span><span class="s1">&#39;vacate&#39;</span><span class="p">,</span> <span class="s2">&quot;请假&quot;</span><span class="p">),</span>
<a id="__codelineno-73-292" name="__codelineno-73-292"></a>                      <span class="p">(</span><span class="s1">&#39;late&#39;</span><span class="p">,</span> <span class="s2">&quot;迟到&quot;</span><span class="p">),</span>
<a id="__codelineno-73-293" name="__codelineno-73-293"></a>                      <span class="p">(</span><span class="s1">&#39;noshow&#39;</span><span class="p">,</span> <span class="s2">&quot;缺勤&quot;</span><span class="p">),</span>
<a id="__codelineno-73-294" name="__codelineno-73-294"></a>                      <span class="p">(</span><span class="s1">&#39;leave_early&#39;</span><span class="p">,</span> <span class="s2">&quot;早退&quot;</span><span class="p">),</span>
<a id="__codelineno-73-295" name="__codelineno-73-295"></a>                      <span class="p">)</span>
<a id="__codelineno-73-296" name="__codelineno-73-296"></a>    <span class="n">record</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="s2">&quot;上课纪录&quot;</span><span class="p">,</span> <span class="n">choices</span><span class="o">=</span><span class="n">record_choices</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;checked&quot;</span><span class="p">,</span> <span class="n">max_length</span><span class="o">=</span><span class="mi">64</span><span class="p">)</span>
<a id="__codelineno-73-297" name="__codelineno-73-297"></a>    <span class="n">score_choices</span> <span class="o">=</span> <span class="p">((</span><span class="mi">100</span><span class="p">,</span> <span class="s1">&#39;A+&#39;</span><span class="p">),</span>
<a id="__codelineno-73-298" name="__codelineno-73-298"></a>                     <span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">),</span>
<a id="__codelineno-73-299" name="__codelineno-73-299"></a>                     <span class="p">(</span><span class="mi">85</span><span class="p">,</span> <span class="s1">&#39;B+&#39;</span><span class="p">),</span>
<a id="__codelineno-73-300" name="__codelineno-73-300"></a>                     <span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">),</span>
<a id="__codelineno-73-301" name="__codelineno-73-301"></a>                     <span class="p">(</span><span class="mi">70</span><span class="p">,</span> <span class="s1">&#39;B-&#39;</span><span class="p">),</span>
<a id="__codelineno-73-302" name="__codelineno-73-302"></a>                     <span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="s1">&#39;C+&#39;</span><span class="p">),</span>
<a id="__codelineno-73-303" name="__codelineno-73-303"></a>                     <span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">),</span>
<a id="__codelineno-73-304" name="__codelineno-73-304"></a>                     <span class="p">(</span><span class="mi">40</span><span class="p">,</span> <span class="s1">&#39;C-&#39;</span><span class="p">),</span>
<a id="__codelineno-73-305" name="__codelineno-73-305"></a>                     <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39; D&#39;</span><span class="p">),</span>
<a id="__codelineno-73-306" name="__codelineno-73-306"></a>                     <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;N/A&#39;</span><span class="p">),</span>
<a id="__codelineno-73-307" name="__codelineno-73-307"></a>                     <span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="s1">&#39;COPY&#39;</span><span class="p">),</span>
<a id="__codelineno-73-308" name="__codelineno-73-308"></a>                     <span class="p">(</span><span class="o">-</span><span class="mi">1000</span><span class="p">,</span> <span class="s1">&#39;FAIL&#39;</span><span class="p">),</span>
<a id="__codelineno-73-309" name="__codelineno-73-309"></a>                     <span class="p">)</span>
<a id="__codelineno-73-310" name="__codelineno-73-310"></a>    <span class="n">score</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">IntegerField</span><span class="p">(</span><span class="s2">&quot;本节成绩&quot;</span><span class="p">,</span> <span class="n">choices</span><span class="o">=</span><span class="n">score_choices</span><span class="p">,</span> <span class="n">default</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-73-311" name="__codelineno-73-311"></a>    <span class="n">homework_note</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">verbose_name</span><span class="o">=</span><span class="s1">&#39;作业评语&#39;</span><span class="p">,</span> <span class="n">max_length</span><span class="o">=</span><span class="mi">255</span><span class="p">,</span> <span class="n">blank</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-73-312" name="__codelineno-73-312"></a>    <span class="n">note</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">verbose_name</span><span class="o">=</span><span class="s2">&quot;备注&quot;</span><span class="p">,</span> <span class="n">max_length</span><span class="o">=</span><span class="mi">255</span><span class="p">,</span> <span class="n">blank</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-73-313" name="__codelineno-73-313"></a>
<a id="__codelineno-73-314" name="__codelineno-73-314"></a>    <span class="n">homework</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">FileField</span><span class="p">(</span><span class="n">verbose_name</span><span class="o">=</span><span class="s1">&#39;作业文件&#39;</span><span class="p">,</span> <span class="n">blank</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<a id="__codelineno-73-315" name="__codelineno-73-315"></a>    <span class="n">stu_memo</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">TextField</span><span class="p">(</span><span class="n">verbose_name</span><span class="o">=</span><span class="s1">&#39;学员备注&#39;</span><span class="p">,</span> <span class="n">blank</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-73-316" name="__codelineno-73-316"></a>    <span class="n">date</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DateTimeField</span><span class="p">(</span><span class="n">verbose_name</span><span class="o">=</span><span class="s1">&#39;提交作业日期&#39;</span><span class="p">,</span> <span class="n">auto_now_add</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-73-317" name="__codelineno-73-317"></a>
<a id="__codelineno-73-318" name="__codelineno-73-318"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-73-319" name="__codelineno-73-319"></a>        <span class="k">return</span> <span class="s2">&quot;</span><span class="si">{0}</span><span class="s2">-</span><span class="si">{1}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">classstudyrecord</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">student</span><span class="p">)</span>
<a id="__codelineno-73-320" name="__codelineno-73-320"></a>
<a id="__codelineno-73-321" name="__codelineno-73-321"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-73-322" name="__codelineno-73-322"></a><span class="sd">chocies参数使用场景是非常广泛的</span>
<a id="__codelineno-73-323" name="__codelineno-73-323"></a><span class="sd">&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
<h3 id="15-19-mtv与mvc模型">15-19 MTV与MVC模型<a class="headerlink" href="#15-19-mtv与mvc模型" title="Permanent link">&para;</a></h3>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-74-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-74-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-74-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-74-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-74-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-74-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-74-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-74-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-74-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-74-10">10</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-74-1" name="__codelineno-74-1"></a><span class="c1"># MTV:Django号称是MTV模型</span>
<a id="__codelineno-74-2" name="__codelineno-74-2"></a><span class="n">M</span><span class="p">:</span><span class="n">models</span>
<a id="__codelineno-74-3" name="__codelineno-74-3"></a><span class="n">T</span><span class="p">:</span><span class="n">templates</span>
<a id="__codelineno-74-4" name="__codelineno-74-4"></a><span class="n">V</span><span class="p">:</span><span class="n">views</span>
<a id="__codelineno-74-5" name="__codelineno-74-5"></a><span class="c1"># MVC:其实django本质也是MVC</span>
<a id="__codelineno-74-6" name="__codelineno-74-6"></a><span class="n">M</span><span class="p">:</span><span class="n">models</span>
<a id="__codelineno-74-7" name="__codelineno-74-7"></a><span class="n">V</span><span class="p">:</span><span class="n">views</span>
<a id="__codelineno-74-8" name="__codelineno-74-8"></a><span class="n">C</span><span class="p">:</span><span class="n">controller</span>
<a id="__codelineno-74-9" name="__codelineno-74-9"></a>
<a id="__codelineno-74-10" name="__codelineno-74-10"></a><span class="c1"># vue框架:MVVM模型</span>
</code></pre></div></td></tr></table></div>
<h3 id="15-20-多对多三种创建方式">15-20 多对多三种创建方式<a class="headerlink" href="#15-20-多对多三种创建方式" title="Permanent link">&para;</a></h3>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-75-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-75-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-75-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-75-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-75-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-75-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-75-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-75-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-75-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-75-10">10</a></span>
<span class="normal"><a href="#__codelineno-75-11">11</a></span>
<span class="normal"><a href="#__codelineno-75-12">12</a></span>
<span class="normal"><a href="#__codelineno-75-13">13</a></span>
<span class="normal"><a href="#__codelineno-75-14">14</a></span>
<span class="normal"><a href="#__codelineno-75-15">15</a></span>
<span class="normal"><a href="#__codelineno-75-16">16</a></span>
<span class="normal"><a href="#__codelineno-75-17">17</a></span>
<span class="normal"><a href="#__codelineno-75-18">18</a></span>
<span class="normal"><a href="#__codelineno-75-19">19</a></span>
<span class="normal"><a href="#__codelineno-75-20">20</a></span>
<span class="normal"><a href="#__codelineno-75-21">21</a></span>
<span class="normal"><a href="#__codelineno-75-22">22</a></span>
<span class="normal"><a href="#__codelineno-75-23">23</a></span>
<span class="normal"><a href="#__codelineno-75-24">24</a></span>
<span class="normal"><a href="#__codelineno-75-25">25</a></span>
<span class="normal"><a href="#__codelineno-75-26">26</a></span>
<span class="normal"><a href="#__codelineno-75-27">27</a></span>
<span class="normal"><a href="#__codelineno-75-28">28</a></span>
<span class="normal"><a href="#__codelineno-75-29">29</a></span>
<span class="normal"><a href="#__codelineno-75-30">30</a></span>
<span class="normal"><a href="#__codelineno-75-31">31</a></span>
<span class="normal"><a href="#__codelineno-75-32">32</a></span>
<span class="normal"><a href="#__codelineno-75-33">33</a></span>
<span class="normal"><a href="#__codelineno-75-34">34</a></span>
<span class="normal"><a href="#__codelineno-75-35">35</a></span>
<span class="normal"><a href="#__codelineno-75-36">36</a></span>
<span class="normal"><a href="#__codelineno-75-37">37</a></span>
<span class="normal"><a href="#__codelineno-75-38">38</a></span>
<span class="normal"><a href="#__codelineno-75-39">39</a></span>
<span class="normal"><a href="#__codelineno-75-40">40</a></span>
<span class="normal"><a href="#__codelineno-75-41">41</a></span>
<span class="normal"><a href="#__codelineno-75-42">42</a></span>
<span class="normal"><a href="#__codelineno-75-43">43</a></span>
<span class="normal"><a href="#__codelineno-75-44">44</a></span>
<span class="normal"><a href="#__codelineno-75-45">45</a></span>
<span class="normal"><a href="#__codelineno-75-46">46</a></span>
<span class="normal"><a href="#__codelineno-75-47">47</a></span>
<span class="normal"><a href="#__codelineno-75-48">48</a></span>
<span class="normal"><a href="#__codelineno-75-49">49</a></span>
<span class="normal"><a href="#__codelineno-75-50">50</a></span>
<span class="normal"><a href="#__codelineno-75-51">51</a></span>
<span class="normal"><a href="#__codelineno-75-52">52</a></span>
<span class="normal"><a href="#__codelineno-75-53">53</a></span>
<span class="normal"><a href="#__codelineno-75-54">54</a></span>
<span class="normal"><a href="#__codelineno-75-55">55</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-75-1" name="__codelineno-75-1"></a><span class="c1"># 全自动:利用orm自动帮我们创建第三张关系表</span>
<a id="__codelineno-75-2" name="__codelineno-75-2"></a>    <span class="k">class</span><span class="w"> </span><span class="nc">Book</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
<a id="__codelineno-75-3" name="__codelineno-75-3"></a>        <span class="n">name</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>
<a id="__codelineno-75-4" name="__codelineno-75-4"></a>        <span class="n">authors</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ManyToManyField</span><span class="p">(</span><span class="n">to</span><span class="o">=</span><span class="s1">&#39;Author&#39;</span><span class="p">)</span>
<a id="__codelineno-75-5" name="__codelineno-75-5"></a>    <span class="k">class</span><span class="w"> </span><span class="nc">Author</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
<a id="__codelineno-75-6" name="__codelineno-75-6"></a>        <span class="n">name</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>
<a id="__codelineno-75-7" name="__codelineno-75-7"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-75-8" name="__codelineno-75-8"></a><span class="sd">    优点:代码不需要你写 非常的方便 还支持orm提供操作第三张关系表的方法...</span>
<a id="__codelineno-75-9" name="__codelineno-75-9"></a><span class="sd">    不足之处:第三张关系表的扩展性极差(没有办法额外添加字段...)</span>
<a id="__codelineno-75-10" name="__codelineno-75-10"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-75-11" name="__codelineno-75-11"></a><span class="c1"># 纯手动</span>
<a id="__codelineno-75-12" name="__codelineno-75-12"></a>    <span class="k">class</span><span class="w"> </span><span class="nc">Book</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
<a id="__codelineno-75-13" name="__codelineno-75-13"></a>        <span class="n">name</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>
<a id="__codelineno-75-14" name="__codelineno-75-14"></a>
<a id="__codelineno-75-15" name="__codelineno-75-15"></a>    <span class="k">class</span><span class="w"> </span><span class="nc">Author</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
<a id="__codelineno-75-16" name="__codelineno-75-16"></a>        <span class="n">name</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>
<a id="__codelineno-75-17" name="__codelineno-75-17"></a>
<a id="__codelineno-75-18" name="__codelineno-75-18"></a>  <span class="k">class</span><span class="w"> </span><span class="nc">Book2Author</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
<a id="__codelineno-75-19" name="__codelineno-75-19"></a>        <span class="n">book_id</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="n">to</span><span class="o">=</span><span class="s1">&#39;Book&#39;</span><span class="p">)</span>
<a id="__codelineno-75-20" name="__codelineno-75-20"></a>     <span class="n">author_id</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="n">to</span><span class="o">=</span><span class="s1">&#39;Author&#39;</span><span class="p">)</span>
<a id="__codelineno-75-21" name="__codelineno-75-21"></a><span class="w">  </span><span class="sd">&#39;&#39;&#39;</span>
<a id="__codelineno-75-22" name="__codelineno-75-22"></a><span class="sd">  优点:第三张表完全取决于你自己进行额外的扩展</span>
<a id="__codelineno-75-23" name="__codelineno-75-23"></a><span class="sd">  不足之处:需要写的代码较多，不能够再使用orm提供的简单的方法</span>
<a id="__codelineno-75-24" name="__codelineno-75-24"></a><span class="sd">  不建议你用该方式</span>
<a id="__codelineno-75-25" name="__codelineno-75-25"></a><span class="sd">  &#39;&#39;&#39;</span>
<a id="__codelineno-75-26" name="__codelineno-75-26"></a>
<a id="__codelineno-75-27" name="__codelineno-75-27"></a><span class="c1"># 半自动</span>
<a id="__codelineno-75-28" name="__codelineno-75-28"></a><span class="k">class</span><span class="w"> </span><span class="nc">Book</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
<a id="__codelineno-75-29" name="__codelineno-75-29"></a>    <span class="n">name</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>
<a id="__codelineno-75-30" name="__codelineno-75-30"></a>    <span class="n">authors</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ManyToManyField</span><span class="p">(</span><span class="n">to</span><span class="o">=</span><span class="s1">&#39;Author&#39;</span><span class="p">,</span>
<a id="__codelineno-75-31" name="__codelineno-75-31"></a>                                     <span class="n">through</span><span class="o">=</span><span class="s1">&#39;Book2Author&#39;</span><span class="p">,</span>
<a id="__codelineno-75-32" name="__codelineno-75-32"></a>                                     <span class="n">through_fields</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;book&#39;</span><span class="p">,</span><span class="s1">&#39;author&#39;</span><span class="p">)</span>
<a id="__codelineno-75-33" name="__codelineno-75-33"></a>                                     <span class="p">)</span>
<a id="__codelineno-75-34" name="__codelineno-75-34"></a><span class="k">class</span><span class="w"> </span><span class="nc">Author</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
<a id="__codelineno-75-35" name="__codelineno-75-35"></a>    <span class="n">name</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>
<a id="__codelineno-75-36" name="__codelineno-75-36"></a>    <span class="c1"># books = models.ManyToManyField(to=&#39;Book&#39;,</span>
<a id="__codelineno-75-37" name="__codelineno-75-37"></a>    <span class="c1">#                                  through=&#39;Book2Author&#39;,</span>
<a id="__codelineno-75-38" name="__codelineno-75-38"></a>    <span class="c1">#                                  through_fields=(&#39;author&#39;,&#39;book&#39;)</span>
<a id="__codelineno-75-39" name="__codelineno-75-39"></a>    <span class="c1">#                                  )</span>
<a id="__codelineno-75-40" name="__codelineno-75-40"></a><span class="k">class</span><span class="w"> </span><span class="nc">Book2Author</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
<a id="__codelineno-75-41" name="__codelineno-75-41"></a>    <span class="n">book</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="n">to</span><span class="o">=</span><span class="s1">&#39;Book&#39;</span><span class="p">)</span>
<a id="__codelineno-75-42" name="__codelineno-75-42"></a>    <span class="n">author</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="n">to</span><span class="o">=</span><span class="s1">&#39;Author&#39;</span><span class="p">)</span>
<a id="__codelineno-75-43" name="__codelineno-75-43"></a>
<a id="__codelineno-75-44" name="__codelineno-75-44"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-75-45" name="__codelineno-75-45"></a><span class="sd">through_fields字段先后顺序</span>
<a id="__codelineno-75-46" name="__codelineno-75-46"></a><span class="sd">    判断的本质：</span>
<a id="__codelineno-75-47" name="__codelineno-75-47"></a><span class="sd">        通过第三张表查询对应的表 需要用到哪个字段就把哪个字段放前面</span>
<a id="__codelineno-75-48" name="__codelineno-75-48"></a><span class="sd">    你也可以简化判断</span>
<a id="__codelineno-75-49" name="__codelineno-75-49"></a><span class="sd">        当前表是谁 就把对应的关联字段放前面</span>
<a id="__codelineno-75-50" name="__codelineno-75-50"></a>
<a id="__codelineno-75-51" name="__codelineno-75-51"></a>
<a id="__codelineno-75-52" name="__codelineno-75-52"></a><span class="sd">半自动:可以使用orm的正反向查询 但是没法使用add,set,remove,clear这四个方法</span>
<a id="__codelineno-75-53" name="__codelineno-75-53"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-75-54" name="__codelineno-75-54"></a>
<a id="__codelineno-75-55" name="__codelineno-75-55"></a><span class="c1"># 总结:你需要掌握的是全自动和半自动 为了扩展性更高 一般我们都会采用半自动(写代码要给自己留一条后路)</span>
</code></pre></div></td></tr></table></div>
<h2 id="16-ajax">16 Ajax<a class="headerlink" href="#16-ajax" title="Permanent link">&para;</a></h2>
<h3 id="16-1-小例子">16-1 小例子<a class="headerlink" href="#16-1-小例子" title="Permanent link">&para;</a></h3>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">JavaScript</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-76-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-76-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-76-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-76-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-76-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-76-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-76-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-76-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-76-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-76-10">10</a></span>
<span class="normal"><a href="#__codelineno-76-11">11</a></span>
<span class="normal"><a href="#__codelineno-76-12">12</a></span>
<span class="normal"><a href="#__codelineno-76-13">13</a></span>
<span class="normal"><a href="#__codelineno-76-14">14</a></span>
<span class="normal"><a href="#__codelineno-76-15">15</a></span>
<span class="normal"><a href="#__codelineno-76-16">16</a></span>
<span class="normal"><a href="#__codelineno-76-17">17</a></span>
<span class="normal"><a href="#__codelineno-76-18">18</a></span>
<span class="normal"><a href="#__codelineno-76-19">19</a></span>
<span class="normal"><a href="#__codelineno-76-20">20</a></span>
<span class="normal"><a href="#__codelineno-76-21">21</a></span>
<span class="normal"><a href="#__codelineno-76-22">22</a></span>
<span class="normal"><a href="#__codelineno-76-23">23</a></span>
<span class="normal"><a href="#__codelineno-76-24">24</a></span>
<span class="normal"><a href="#__codelineno-76-25">25</a></span>
<span class="normal"><a href="#__codelineno-76-26">26</a></span>
<span class="normal"><a href="#__codelineno-76-27">27</a></span>
<span class="normal"><a href="#__codelineno-76-28">28</a></span>
<span class="normal"><a href="#__codelineno-76-29">29</a></span>
<span class="normal"><a href="#__codelineno-76-30">30</a></span>
<span class="normal"><a href="#__codelineno-76-31">31</a></span>
<span class="normal"><a href="#__codelineno-76-32">32</a></span>
<span class="normal"><a href="#__codelineno-76-33">33</a></span>
<span class="normal"><a href="#__codelineno-76-34">34</a></span>
<span class="normal"><a href="#__codelineno-76-35">35</a></span>
<span class="normal"><a href="#__codelineno-76-36">36</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-76-1" name="__codelineno-76-1"></a><span class="cm">/*</span>
<a id="__codelineno-76-2" name="__codelineno-76-2"></a><span class="cm">页面上有三个input框</span>
<a id="__codelineno-76-3" name="__codelineno-76-3"></a><span class="cm">    在前两个框中输入数字 点击按钮 朝后端发送ajax请求</span>
<a id="__codelineno-76-4" name="__codelineno-76-4"></a><span class="cm">    后端计算出结果 再返回给前端动态展示的到第三个input框中</span>
<a id="__codelineno-76-5" name="__codelineno-76-5"></a><span class="cm">    (整个过程页面不准有刷新,也不能在前端计算)</span>
<a id="__codelineno-76-6" name="__codelineno-76-6"></a><span class="cm">*/</span>
<a id="__codelineno-76-7" name="__codelineno-76-7"></a><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#btn&#39;</span><span class="p">).</span><span class="nx">click</span><span class="p">(</span><span class="kd">function</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-76-8" name="__codelineno-76-8"></a><span class="w">        </span><span class="c1">// 朝后端发送ajax请求</span>
<a id="__codelineno-76-9" name="__codelineno-76-9"></a><span class="w">        </span><span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
<a id="__codelineno-76-10" name="__codelineno-76-10"></a><span class="w">            </span><span class="c1">// 1.指定朝哪个后端发送ajax请求</span>
<a id="__codelineno-76-11" name="__codelineno-76-11"></a><span class="w">            </span><span class="nx">url</span><span class="o">:</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="w"> </span><span class="c1">// 不写就是朝当前地址提交</span>
<a id="__codelineno-76-12" name="__codelineno-76-12"></a><span class="w">            </span><span class="c1">// 2.请求方式</span>
<a id="__codelineno-76-13" name="__codelineno-76-13"></a><span class="w">            </span><span class="nx">type</span><span class="o">:</span><span class="s1">&#39;post&#39;</span><span class="p">,</span><span class="w">  </span><span class="c1">// 不指定默认就是get 都是小写</span>
<a id="__codelineno-76-14" name="__codelineno-76-14"></a><span class="w">            </span><span class="c1">// 3.数据</span>
<a id="__codelineno-76-15" name="__codelineno-76-15"></a><span class="w">            </span><span class="p">{</span><span class="n">#data</span><span class="o">:</span><span class="p">{</span><span class="s1">&#39;username&#39;</span><span class="o">:</span><span class="s1">&#39;jason&#39;</span><span class="p">,</span><span class="s1">&#39;password&#39;</span><span class="o">:</span><span class="mf">123</span><span class="p">},</span><span class="err">#</span><span class="p">}</span>
<a id="__codelineno-76-16" name="__codelineno-76-16"></a><span class="w">            </span><span class="nx">data</span><span class="o">:</span><span class="p">{</span><span class="s1">&#39;i1&#39;</span><span class="o">:</span><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#d1&#39;</span><span class="p">).</span><span class="nx">val</span><span class="p">(),</span><span class="s1">&#39;i2&#39;</span><span class="o">:</span><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#d2&#39;</span><span class="p">).</span><span class="nx">val</span><span class="p">()},</span>
<a id="__codelineno-76-17" name="__codelineno-76-17"></a><span class="w">            </span><span class="c1">// 4.回调函数:当后端给你返回结果的时候会自动触发 args接受后端的返回结果</span>
<a id="__codelineno-76-18" name="__codelineno-76-18"></a><span class="w">            </span><span class="nx">success</span><span class="o">:</span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-76-19" name="__codelineno-76-19"></a><span class="w">                </span><span class="p">{</span><span class="n">#alert</span><span class="p">(</span><span class="nx">args</span><span class="p">)</span><span class="w">  </span><span class="c1">// 通过DOM操作动态渲染到第三个input里面#}</span>
<a id="__codelineno-76-20" name="__codelineno-76-20"></a><span class="w">                </span><span class="p">{</span><span class="err">#</span><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#d3&#39;</span><span class="p">).</span><span class="nx">val</span><span class="p">(</span><span class="nx">args</span><span class="p">)</span><span class="err">#</span><span class="p">}</span>
<a id="__codelineno-76-21" name="__codelineno-76-21"></a><span class="w">                </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="ow">typeof</span><span class="w"> </span><span class="nx">args</span><span class="p">)</span>
<a id="__codelineno-76-22" name="__codelineno-76-22"></a>
<a id="__codelineno-76-23" name="__codelineno-76-23"></a><span class="w">            </span><span class="p">}</span>
<a id="__codelineno-76-24" name="__codelineno-76-24"></a><span class="w">        </span><span class="p">})</span>
<a id="__codelineno-76-25" name="__codelineno-76-25"></a><span class="w">    </span><span class="p">})</span>
<a id="__codelineno-76-26" name="__codelineno-76-26"></a>
<a id="__codelineno-76-27" name="__codelineno-76-27"></a>
<a id="__codelineno-76-28" name="__codelineno-76-28"></a><span class="cm">/*</span>
<a id="__codelineno-76-29" name="__codelineno-76-29"></a><span class="cm">针对后端如果是用HttpResponse返回的数据 回调函数不会自动帮你反序列化,需要在前端进行反序化</span>
<a id="__codelineno-76-30" name="__codelineno-76-30"></a><span class="cm">如果后端直接用的是JsonResponse返回的数据 回调函数会自动帮你反序列化</span>
<a id="__codelineno-76-31" name="__codelineno-76-31"></a>
<a id="__codelineno-76-32" name="__codelineno-76-32"></a><span class="cm">HttpResponse解决方式</span>
<a id="__codelineno-76-33" name="__codelineno-76-33"></a><span class="cm">    1.自己在前端利用JSON.parse()</span>
<a id="__codelineno-76-34" name="__codelineno-76-34"></a><span class="cm">    2.在ajax里面配置一个参数</span>
<a id="__codelineno-76-35" name="__codelineno-76-35"></a><span class="cm">        dataType:true,   // 数据会自动帮我们反序列化</span>
<a id="__codelineno-76-36" name="__codelineno-76-36"></a><span class="cm">*/</span>
</code></pre></div></td></tr></table></div>
<h3 id="16-2-前后端传输数据的编码格式">16-2 前后端传输数据的编码格式<a class="headerlink" href="#16-2-前后端传输数据的编码格式" title="Permanent link">&para;</a></h3>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-77-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-77-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-77-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-77-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-77-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-77-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-77-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-77-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-77-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-77-10">10</a></span>
<span class="normal"><a href="#__codelineno-77-11">11</a></span>
<span class="normal"><a href="#__codelineno-77-12">12</a></span>
<span class="normal"><a href="#__codelineno-77-13">13</a></span>
<span class="normal"><a href="#__codelineno-77-14">14</a></span>
<span class="normal"><a href="#__codelineno-77-15">15</a></span>
<span class="normal"><a href="#__codelineno-77-16">16</a></span>
<span class="normal"><a href="#__codelineno-77-17">17</a></span>
<span class="normal"><a href="#__codelineno-77-18">18</a></span>
<span class="normal"><a href="#__codelineno-77-19">19</a></span>
<span class="normal"><a href="#__codelineno-77-20">20</a></span>
<span class="normal"><a href="#__codelineno-77-21">21</a></span>
<span class="normal"><a href="#__codelineno-77-22">22</a></span>
<span class="normal"><a href="#__codelineno-77-23">23</a></span>
<span class="normal"><a href="#__codelineno-77-24">24</a></span>
<span class="normal"><a href="#__codelineno-77-25">25</a></span>
<span class="normal"><a href="#__codelineno-77-26">26</a></span>
<span class="normal"><a href="#__codelineno-77-27">27</a></span>
<span class="normal"><a href="#__codelineno-77-28">28</a></span>
<span class="normal"><a href="#__codelineno-77-29">29</a></span>
<span class="normal"><a href="#__codelineno-77-30">30</a></span>
<span class="normal"><a href="#__codelineno-77-31">31</a></span>
<span class="normal"><a href="#__codelineno-77-32">32</a></span>
<span class="normal"><a href="#__codelineno-77-33">33</a></span>
<span class="normal"><a href="#__codelineno-77-34">34</a></span>
<span class="normal"><a href="#__codelineno-77-35">35</a></span>
<span class="normal"><a href="#__codelineno-77-36">36</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-77-1" name="__codelineno-77-1"></a><span class="c1"># 我们主要研究post请求数据的编码格式</span>
<a id="__codelineno-77-2" name="__codelineno-77-2"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-77-3" name="__codelineno-77-3"></a><span class="sd">get请求数据就是直接放在url后面的</span>
<a id="__codelineno-77-4" name="__codelineno-77-4"></a><span class="sd">url?username=jason&amp;password=123</span>
<a id="__codelineno-77-5" name="__codelineno-77-5"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-77-6" name="__codelineno-77-6"></a>
<a id="__codelineno-77-7" name="__codelineno-77-7"></a><span class="c1"># 可以朝后端发送post请求的方式</span>
<a id="__codelineno-77-8" name="__codelineno-77-8"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-77-9" name="__codelineno-77-9"></a><span class="sd">    1.form表单</span>
<a id="__codelineno-77-10" name="__codelineno-77-10"></a><span class="sd">    2.ajax请求</span>
<a id="__codelineno-77-11" name="__codelineno-77-11"></a><span class="sd">    &quot;&quot;&quot;</span> 
<a id="__codelineno-77-12" name="__codelineno-77-12"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-77-13" name="__codelineno-77-13"></a><span class="sd">前后端传输数据的编码格式</span>
<a id="__codelineno-77-14" name="__codelineno-77-14"></a><span class="sd">    urlencoded</span>
<a id="__codelineno-77-15" name="__codelineno-77-15"></a><span class="sd">    formdata</span>
<a id="__codelineno-77-16" name="__codelineno-77-16"></a><span class="sd">    json</span>
<a id="__codelineno-77-17" name="__codelineno-77-17"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-77-18" name="__codelineno-77-18"></a><span class="c1"># 研究form表单</span>
<a id="__codelineno-77-19" name="__codelineno-77-19"></a><span class="sd">&#39;&#39;&#39;</span>
<a id="__codelineno-77-20" name="__codelineno-77-20"></a><span class="sd">## 第一种</span>
<a id="__codelineno-77-21" name="__codelineno-77-21"></a><span class="sd">  默认的数据编码格式是：aplication/x-www-form-urlencoded</span>
<a id="__codelineno-77-22" name="__codelineno-77-22"></a><span class="sd">  数据格式:username=jason&amp;password=123</span>
<a id="__codelineno-77-23" name="__codelineno-77-23"></a><span class="sd">  django后端针对符合urlencoded编码格式的数据都会自动帮你解析封装到request.POST中</span>
<a id="__codelineno-77-24" name="__codelineno-77-24"></a><span class="sd">  username=jason&amp;password=123   &gt;&gt;&gt; request.POST</span>
<a id="__codelineno-77-25" name="__codelineno-77-25"></a><span class="sd"> ## 第二种</span>
<a id="__codelineno-77-26" name="__codelineno-77-26"></a><span class="sd">  如果你把编码格式改成formdata，那么针对普通的键值对还是解析到request.POST中而将文件解析到request.FILES中</span>
<a id="__codelineno-77-27" name="__codelineno-77-27"></a>
<a id="__codelineno-77-28" name="__codelineno-77-28"></a><span class="sd">  form表单是没有办法发送json格式数据的</span>
<a id="__codelineno-77-29" name="__codelineno-77-29"></a><span class="sd">&#39;&#39;&#39;</span>
<a id="__codelineno-77-30" name="__codelineno-77-30"></a><span class="c1"># 研究ajax</span>
<a id="__codelineno-77-31" name="__codelineno-77-31"></a><span class="sd">&#39;&#39;&#39;</span>
<a id="__codelineno-77-32" name="__codelineno-77-32"></a><span class="sd">  默认的编码格式也是urlencoded</span>
<a id="__codelineno-77-33" name="__codelineno-77-33"></a><span class="sd">  数据格式:username=jason&amp;age=20</span>
<a id="__codelineno-77-34" name="__codelineno-77-34"></a><span class="sd">  django后端针对符合urlencoded编码格式的数据都会自动帮你解析封装到request.POST中</span>
<a id="__codelineno-77-35" name="__codelineno-77-35"></a><span class="sd">  username=jason&amp;age=20 &gt;&gt;&gt; request.POST</span>
<a id="__codelineno-77-36" name="__codelineno-77-36"></a><span class="sd">&#39;&#39;&#39;</span>
</code></pre></div></td></tr></table></div>
<h3 id="16-3-ajax发送json格式">16-3 Ajax发送JSON格式<a class="headerlink" href="#16-3-ajax发送json格式" title="Permanent link">&para;</a></h3>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">JavaScript</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-78-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-78-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-78-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-78-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-78-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-78-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-78-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-78-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-78-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-78-10">10</a></span>
<span class="normal"><a href="#__codelineno-78-11">11</a></span>
<span class="normal"><a href="#__codelineno-78-12">12</a></span>
<span class="normal"><a href="#__codelineno-78-13">13</a></span>
<span class="normal"><a href="#__codelineno-78-14">14</a></span>
<span class="normal"><a href="#__codelineno-78-15">15</a></span>
<span class="normal"><a href="#__codelineno-78-16">16</a></span>
<span class="normal"><a href="#__codelineno-78-17">17</a></span>
<span class="normal"><a href="#__codelineno-78-18">18</a></span>
<span class="normal"><a href="#__codelineno-78-19">19</a></span>
<span class="normal"><a href="#__codelineno-78-20">20</a></span>
<span class="normal"><a href="#__codelineno-78-21">21</a></span>
<span class="normal"><a href="#__codelineno-78-22">22</a></span>
<span class="normal"><a href="#__codelineno-78-23">23</a></span>
<span class="normal"><a href="#__codelineno-78-24">24</a></span>
<span class="normal"><a href="#__codelineno-78-25">25</a></span>
<span class="normal"><a href="#__codelineno-78-26">26</a></span>
<span class="normal"><a href="#__codelineno-78-27">27</a></span>
<span class="normal"><a href="#__codelineno-78-28">28</a></span>
<span class="normal"><a href="#__codelineno-78-29">29</a></span>
<span class="normal"><a href="#__codelineno-78-30">30</a></span>
<span class="normal"><a href="#__codelineno-78-31">31</a></span>
<span class="normal"><a href="#__codelineno-78-32">32</a></span>
<span class="normal"><a href="#__codelineno-78-33">33</a></span>
<span class="normal"><a href="#__codelineno-78-34">34</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-78-1" name="__codelineno-78-1"></a><span class="cm">/*</span>
<a id="__codelineno-78-2" name="__codelineno-78-2"></a><span class="cm">前后端传输数据的时候一定要确保编码格式跟数据真正的格式是一致的</span>
<a id="__codelineno-78-3" name="__codelineno-78-3"></a><span class="cm">不要骗人家!!!</span>
<a id="__codelineno-78-4" name="__codelineno-78-4"></a>
<a id="__codelineno-78-5" name="__codelineno-78-5"></a><span class="cm">{&quot;username&quot;:&quot;jason&quot;,&quot;age&quot;:25}  </span>
<a id="__codelineno-78-6" name="__codelineno-78-6"></a><span class="cm">    在request.POST里面肯定找不到</span>
<a id="__codelineno-78-7" name="__codelineno-78-7"></a>
<a id="__codelineno-78-8" name="__codelineno-78-8"></a><span class="cm">    django针对json格式的数据 不会做任何的处理 </span>
<a id="__codelineno-78-9" name="__codelineno-78-9"></a>
<a id="__codelineno-78-10" name="__codelineno-78-10"></a><span class="cm">request对象方法补充</span>
<a id="__codelineno-78-11" name="__codelineno-78-11"></a><span class="cm">    request.is_ajax()</span>
<a id="__codelineno-78-12" name="__codelineno-78-12"></a><span class="cm">        判断当前请求是否是ajax请求 返回布尔值</span>
<a id="__codelineno-78-13" name="__codelineno-78-13"></a>
<a id="__codelineno-78-14" name="__codelineno-78-14"></a><span class="cm">*/</span>
<a id="__codelineno-78-15" name="__codelineno-78-15"></a><span class="o">&lt;</span><span class="nx">script</span><span class="o">&gt;</span>
<a id="__codelineno-78-16" name="__codelineno-78-16"></a><span class="w">    </span><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#d1&#39;</span><span class="p">).</span><span class="nx">click</span><span class="p">(</span><span class="kd">function</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-78-17" name="__codelineno-78-17"></a><span class="w">        </span><span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
<a id="__codelineno-78-18" name="__codelineno-78-18"></a><span class="w">            </span><span class="nx">url</span><span class="o">:</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
<a id="__codelineno-78-19" name="__codelineno-78-19"></a><span class="w">            </span><span class="nx">type</span><span class="o">:</span><span class="s1">&#39;post&#39;</span><span class="p">,</span>
<a id="__codelineno-78-20" name="__codelineno-78-20"></a><span class="w">            </span><span class="nx">data</span><span class="o">:</span><span class="nb">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">({</span><span class="s1">&#39;username&#39;</span><span class="o">:</span><span class="s1">&#39;jason&#39;</span><span class="p">,</span><span class="s1">&#39;age&#39;</span><span class="o">:</span><span class="mf">25</span><span class="p">}),</span>
<a id="__codelineno-78-21" name="__codelineno-78-21"></a><span class="w">            </span><span class="nx">contentType</span><span class="o">:</span><span class="s1">&#39;application/json&#39;</span><span class="p">,</span><span class="w">  </span><span class="c1">// 指定编码格式</span>
<a id="__codelineno-78-22" name="__codelineno-78-22"></a><span class="w">            </span><span class="nx">success</span><span class="o">:</span><span class="kd">function</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-78-23" name="__codelineno-78-23"></a>
<a id="__codelineno-78-24" name="__codelineno-78-24"></a><span class="w">            </span><span class="p">}</span>
<a id="__codelineno-78-25" name="__codelineno-78-25"></a><span class="w">        </span><span class="p">})</span>
<a id="__codelineno-78-26" name="__codelineno-78-26"></a><span class="w">    </span><span class="p">})</span>
<a id="__codelineno-78-27" name="__codelineno-78-27"></a><span class="o">&lt;</span><span class="err">/script&gt;</span>
<a id="__codelineno-78-28" name="__codelineno-78-28"></a>
<a id="__codelineno-78-29" name="__codelineno-78-29"></a><span class="cm">/*</span>
<a id="__codelineno-78-30" name="__codelineno-78-30"></a><span class="cm">ajax发送json格式数据需要注意点</span>
<a id="__codelineno-78-31" name="__codelineno-78-31"></a><span class="cm">    1.contentType参数指定成:application/json</span>
<a id="__codelineno-78-32" name="__codelineno-78-32"></a><span class="cm">    2.数据是真正的json格式数据</span>
<a id="__codelineno-78-33" name="__codelineno-78-33"></a><span class="cm">    3.django后端不会帮你处理json格式数据需要你自己去request.body获取并处理</span>
<a id="__codelineno-78-34" name="__codelineno-78-34"></a><span class="cm">*/</span>
</code></pre></div></td></tr></table></div>
<p>python后端解析JSON数据</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-79-1">1</a></span>
<span class="normal"><a href="#__codelineno-79-2">2</a></span>
<span class="normal"><a href="#__codelineno-79-3">3</a></span>
<span class="normal"><a href="#__codelineno-79-4">4</a></span>
<span class="normal"><a href="#__codelineno-79-5">5</a></span>
<span class="normal"><a href="#__codelineno-79-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-79-1" name="__codelineno-79-1"></a><span class="n">json_bytes</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">body</span>
<a id="__codelineno-79-2" name="__codelineno-79-2"></a><span class="n">json_str</span> <span class="o">=</span> <span class="n">json_bytes</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
<a id="__codelineno-79-3" name="__codelineno-79-3"></a><span class="n">json_dict</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">json_str</span><span class="p">)</span>
<a id="__codelineno-79-4" name="__codelineno-79-4"></a>
<a id="__codelineno-79-5" name="__codelineno-79-5"></a><span class="c1"># json.loads括号内如果传入了一个二进制格式的数据那么内部自动解码再反序列化</span>
<a id="__codelineno-79-6" name="__codelineno-79-6"></a><span class="n">json_dict</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">json_bytes</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<h3 id="16-4-ajax发送文件">16-4 Ajax发送文件<a class="headerlink" href="#16-4-ajax发送文件" title="Permanent link">&para;</a></h3>
<h4 id="4-1-笔记上的方法">4-1 笔记上的方法<a class="headerlink" href="#4-1-笔记上的方法" title="Permanent link">&para;</a></h4>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-80-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-80-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-80-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-80-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-80-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-80-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-80-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-80-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-80-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-80-10">10</a></span>
<span class="normal"><a href="#__codelineno-80-11">11</a></span>
<span class="normal"><a href="#__codelineno-80-12">12</a></span>
<span class="normal"><a href="#__codelineno-80-13">13</a></span>
<span class="normal"><a href="#__codelineno-80-14">14</a></span>
<span class="normal"><a href="#__codelineno-80-15">15</a></span>
<span class="normal"><a href="#__codelineno-80-16">16</a></span>
<span class="normal"><a href="#__codelineno-80-17">17</a></span>
<span class="normal"><a href="#__codelineno-80-18">18</a></span>
<span class="normal"><a href="#__codelineno-80-19">19</a></span>
<span class="normal"><a href="#__codelineno-80-20">20</a></span>
<span class="normal"><a href="#__codelineno-80-21">21</a></span>
<span class="normal"><a href="#__codelineno-80-22">22</a></span>
<span class="normal"><a href="#__codelineno-80-23">23</a></span>
<span class="normal"><a href="#__codelineno-80-24">24</a></span>
<span class="normal"><a href="#__codelineno-80-25">25</a></span>
<span class="normal"><a href="#__codelineno-80-26">26</a></span>
<span class="normal"><a href="#__codelineno-80-27">27</a></span>
<span class="normal"><a href="#__codelineno-80-28">28</a></span>
<span class="normal"><a href="#__codelineno-80-29">29</a></span>
<span class="normal"><a href="#__codelineno-80-30">30</a></span>
<span class="normal"><a href="#__codelineno-80-31">31</a></span>
<span class="normal"><a href="#__codelineno-80-32">32</a></span>
<span class="normal"><a href="#__codelineno-80-33">33</a></span>
<span class="normal"><a href="#__codelineno-80-34">34</a></span>
<span class="normal"><a href="#__codelineno-80-35">35</a></span>
<span class="normal"><a href="#__codelineno-80-36">36</a></span>
<span class="normal"><a href="#__codelineno-80-37">37</a></span>
<span class="normal"><a href="#__codelineno-80-38">38</a></span>
<span class="normal"><a href="#__codelineno-80-39">39</a></span>
<span class="normal"><a href="#__codelineno-80-40">40</a></span>
<span class="normal"><a href="#__codelineno-80-41">41</a></span>
<span class="normal"><a href="#__codelineno-80-42">42</a></span>
<span class="normal"><a href="#__codelineno-80-43">43</a></span>
<span class="normal"><a href="#__codelineno-80-44">44</a></span>
<span class="normal"><a href="#__codelineno-80-45">45</a></span>
<span class="normal"><a href="#__codelineno-80-46">46</a></span>
<span class="normal"><a href="#__codelineno-80-47">47</a></span>
<span class="normal"><a href="#__codelineno-80-48">48</a></span>
<span class="normal"><a href="#__codelineno-80-49">49</a></span>
<span class="normal"><a href="#__codelineno-80-50">50</a></span>
<span class="normal"><a href="#__codelineno-80-51">51</a></span>
<span class="normal"><a href="#__codelineno-80-52">52</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-80-1" name="__codelineno-80-1"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-80-2" name="__codelineno-80-2"></a><span class="sd">ajax发送文件需要借助于js内置对象FormData</span>
<a id="__codelineno-80-3" name="__codelineno-80-3"></a>
<a id="__codelineno-80-4" name="__codelineno-80-4"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-80-5" name="__codelineno-80-5"></a><span class="o">&lt;</span><span class="n">script</span><span class="o">&gt;</span>
<a id="__codelineno-80-6" name="__codelineno-80-6"></a>    <span class="o">//</span> <span class="n">点击按钮朝后端发送普通键值对和文件数据</span>
<a id="__codelineno-80-7" name="__codelineno-80-7"></a>    <span class="err">$</span><span class="p">(</span><span class="s1">&#39;#d4&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">on</span><span class="p">(</span><span class="s1">&#39;click&#39;</span><span class="p">,</span><span class="n">function</span> <span class="p">()</span> <span class="p">{</span>
<a id="__codelineno-80-8" name="__codelineno-80-8"></a>        <span class="o">//</span> <span class="mi">1</span> <span class="n">需要先利用FormData内置对象</span>
<a id="__codelineno-80-9" name="__codelineno-80-9"></a>        <span class="n">let</span> <span class="n">formDateObj</span> <span class="o">=</span> <span class="n">new</span> <span class="n">FormData</span><span class="p">();</span>
<a id="__codelineno-80-10" name="__codelineno-80-10"></a>        <span class="o">//</span> <span class="mi">2</span> <span class="n">添加普通的键值对</span>
<a id="__codelineno-80-11" name="__codelineno-80-11"></a>        <span class="n">formDateObj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;username&#39;</span><span class="p">,</span><span class="err">$</span><span class="p">(</span><span class="s1">&#39;#d1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">val</span><span class="p">());</span>
<a id="__codelineno-80-12" name="__codelineno-80-12"></a>        <span class="n">formDateObj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;password&#39;</span><span class="p">,</span><span class="err">$</span><span class="p">(</span><span class="s1">&#39;#d2&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">val</span><span class="p">());</span>
<a id="__codelineno-80-13" name="__codelineno-80-13"></a>        <span class="o">//</span> <span class="mi">3</span> <span class="n">添加文件对象</span>
<a id="__codelineno-80-14" name="__codelineno-80-14"></a>        <span class="n">formDateObj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;myfile&#39;</span><span class="p">,</span><span class="err">$</span><span class="p">(</span><span class="s1">&#39;#d3&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">files</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<a id="__codelineno-80-15" name="__codelineno-80-15"></a>        <span class="o">//</span> <span class="mi">4</span> <span class="n">将对象基于ajax发送给后端</span>
<a id="__codelineno-80-16" name="__codelineno-80-16"></a>        <span class="err">$</span><span class="o">.</span><span class="n">ajax</span><span class="p">({</span>
<a id="__codelineno-80-17" name="__codelineno-80-17"></a>            <span class="n">url</span><span class="p">:</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
<a id="__codelineno-80-18" name="__codelineno-80-18"></a>            <span class="nb">type</span><span class="p">:</span><span class="s1">&#39;post&#39;</span><span class="p">,</span>
<a id="__codelineno-80-19" name="__codelineno-80-19"></a>            <span class="n">data</span><span class="p">:</span><span class="n">formDateObj</span><span class="p">,</span>  <span class="o">//</span> <span class="n">直接将对象放在data后面即可</span>
<a id="__codelineno-80-20" name="__codelineno-80-20"></a>
<a id="__codelineno-80-21" name="__codelineno-80-21"></a>            <span class="o">//</span> <span class="n">ajax发送文件必须要指定的两个参数</span>
<a id="__codelineno-80-22" name="__codelineno-80-22"></a>            <span class="n">contentType</span><span class="p">:</span><span class="n">false</span><span class="p">,</span>  <span class="o">//</span> <span class="n">不需使用任何编码</span> <span class="n">django后端能够自动识别formdata对象</span>
<a id="__codelineno-80-23" name="__codelineno-80-23"></a>            <span class="n">processData</span><span class="p">:</span><span class="n">false</span><span class="p">,</span>  <span class="o">//</span> <span class="n">告诉你的浏览器不要对你的数据进行任何处理</span>
<a id="__codelineno-80-24" name="__codelineno-80-24"></a>
<a id="__codelineno-80-25" name="__codelineno-80-25"></a>            <span class="n">success</span><span class="p">:</span><span class="n">function</span> <span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="p">{</span>
<a id="__codelineno-80-26" name="__codelineno-80-26"></a>            <span class="p">}</span>
<a id="__codelineno-80-27" name="__codelineno-80-27"></a>        <span class="p">})</span>
<a id="__codelineno-80-28" name="__codelineno-80-28"></a>
<a id="__codelineno-80-29" name="__codelineno-80-29"></a>
<a id="__codelineno-80-30" name="__codelineno-80-30"></a>    <span class="p">})</span>
<a id="__codelineno-80-31" name="__codelineno-80-31"></a><span class="o">&lt;/</span><span class="n">script</span><span class="o">&gt;</span>
<a id="__codelineno-80-32" name="__codelineno-80-32"></a>
<a id="__codelineno-80-33" name="__codelineno-80-33"></a><span class="k">def</span><span class="w"> </span><span class="nf">ab_file</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
<a id="__codelineno-80-34" name="__codelineno-80-34"></a>    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">is_ajax</span><span class="p">():</span>
<a id="__codelineno-80-35" name="__codelineno-80-35"></a>        <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;POST&#39;</span><span class="p">:</span>
<a id="__codelineno-80-36" name="__codelineno-80-36"></a>            <span class="nb">print</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="p">)</span>
<a id="__codelineno-80-37" name="__codelineno-80-37"></a>            <span class="nb">print</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">FILES</span><span class="p">)</span>
<a id="__codelineno-80-38" name="__codelineno-80-38"></a>    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span><span class="s1">&#39;ab_file.html&#39;</span><span class="p">)</span>
<a id="__codelineno-80-39" name="__codelineno-80-39"></a>
<a id="__codelineno-80-40" name="__codelineno-80-40"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-80-41" name="__codelineno-80-41"></a><span class="sd">总结:</span>
<a id="__codelineno-80-42" name="__codelineno-80-42"></a><span class="sd">    1.需要利用内置对象FormData</span>
<a id="__codelineno-80-43" name="__codelineno-80-43"></a><span class="sd">       // 2 添加普通的键值对</span>
<a id="__codelineno-80-44" name="__codelineno-80-44"></a><span class="sd">        formDateObj.append(&#39;username&#39;,$(&#39;#d1&#39;).val());</span>
<a id="__codelineno-80-45" name="__codelineno-80-45"></a><span class="sd">        formDateObj.append(&#39;password&#39;,$(&#39;#d2&#39;).val());</span>
<a id="__codelineno-80-46" name="__codelineno-80-46"></a><span class="sd">        // 3 添加文件对象</span>
<a id="__codelineno-80-47" name="__codelineno-80-47"></a><span class="sd">        formDateObj.append(&#39;myfile&#39;,$(&#39;#d3&#39;)[0].files[0])</span>
<a id="__codelineno-80-48" name="__codelineno-80-48"></a><span class="sd">    2.需要指定两个关键性的参数</span>
<a id="__codelineno-80-49" name="__codelineno-80-49"></a><span class="sd">       contentType:false,  // 不需使用任何编码 django后端能够自动识别formdata对象</span>
<a id="__codelineno-80-50" name="__codelineno-80-50"></a><span class="sd">        processData:false,  // 告诉你的浏览器不要对你的数据进行任何处理</span>
<a id="__codelineno-80-51" name="__codelineno-80-51"></a><span class="sd">    3.django后端能够直接识别到formdata对象并且能够将内部的普通键值自动解析并封装到request.POST中 文件数据自动解析并封装到request.FILES中</span>
<a id="__codelineno-80-52" name="__codelineno-80-52"></a><span class="sd">&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
<h4 id="4-2-原生js实现文件上传">4-2 原生JS实现文件上传<a class="headerlink" href="#4-2-原生js实现文件上传" title="Permanent link">&para;</a></h4>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">JavaScript</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-81-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-81-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-81-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-81-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-81-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-81-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-81-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-81-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-81-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-81-10">10</a></span>
<span class="normal"><a href="#__codelineno-81-11">11</a></span>
<span class="normal"><a href="#__codelineno-81-12">12</a></span>
<span class="normal"><a href="#__codelineno-81-13">13</a></span>
<span class="normal"><a href="#__codelineno-81-14">14</a></span>
<span class="normal"><a href="#__codelineno-81-15">15</a></span>
<span class="normal"><a href="#__codelineno-81-16">16</a></span>
<span class="normal"><a href="#__codelineno-81-17">17</a></span>
<span class="normal"><a href="#__codelineno-81-18">18</a></span>
<span class="normal"><a href="#__codelineno-81-19">19</a></span>
<span class="normal"><a href="#__codelineno-81-20">20</a></span>
<span class="normal"><a href="#__codelineno-81-21">21</a></span>
<span class="normal"><a href="#__codelineno-81-22">22</a></span>
<span class="normal"><a href="#__codelineno-81-23">23</a></span>
<span class="normal"><a href="#__codelineno-81-24">24</a></span>
<span class="normal"><a href="#__codelineno-81-25">25</a></span>
<span class="normal"><a href="#__codelineno-81-26">26</a></span>
<span class="normal"><a href="#__codelineno-81-27">27</a></span>
<span class="normal"><a href="#__codelineno-81-28">28</a></span>
<span class="normal"><a href="#__codelineno-81-29">29</a></span>
<span class="normal"><a href="#__codelineno-81-30">30</a></span>
<span class="normal"><a href="#__codelineno-81-31">31</a></span>
<span class="normal"><a href="#__codelineno-81-32">32</a></span>
<span class="normal"><a href="#__codelineno-81-33">33</a></span>
<span class="normal"><a href="#__codelineno-81-34">34</a></span>
<span class="normal"><a href="#__codelineno-81-35">35</a></span>
<span class="normal"><a href="#__codelineno-81-36">36</a></span>
<span class="normal"><a href="#__codelineno-81-37">37</a></span>
<span class="normal"><a href="#__codelineno-81-38">38</a></span>
<span class="normal"><a href="#__codelineno-81-39">39</a></span>
<span class="normal"><a href="#__codelineno-81-40">40</a></span>
<span class="normal"><a href="#__codelineno-81-41">41</a></span>
<span class="normal"><a href="#__codelineno-81-42">42</a></span>
<span class="normal"><a href="#__codelineno-81-43">43</a></span>
<span class="normal"><a href="#__codelineno-81-44">44</a></span>
<span class="normal"><a href="#__codelineno-81-45">45</a></span>
<span class="normal"><a href="#__codelineno-81-46">46</a></span>
<span class="normal"><a href="#__codelineno-81-47">47</a></span>
<span class="normal"><a href="#__codelineno-81-48">48</a></span>
<span class="normal"><a href="#__codelineno-81-49">49</a></span>
<span class="normal"><a href="#__codelineno-81-50">50</a></span>
<span class="normal"><a href="#__codelineno-81-51">51</a></span>
<span class="normal"><a href="#__codelineno-81-52">52</a></span>
<span class="normal"><a href="#__codelineno-81-53">53</a></span>
<span class="normal"><a href="#__codelineno-81-54">54</a></span>
<span class="normal"><a href="#__codelineno-81-55">55</a></span>
<span class="normal"><a href="#__codelineno-81-56">56</a></span>
<span class="normal"><a href="#__codelineno-81-57">57</a></span>
<span class="normal"><a href="#__codelineno-81-58">58</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-81-1" name="__codelineno-81-1"></a><span class="c1">// 新版 XMLHttpRequest 对象，不仅可以发送文本信息，还可以上传文件。</span>
<a id="__codelineno-81-2" name="__codelineno-81-2"></a><span class="nx">实现步骤</span><span class="err">：</span>
<a id="__codelineno-81-3" name="__codelineno-81-3"></a><span class="err">①</span><span class="w"> </span><span class="nx">定义</span><span class="w"> </span><span class="nx">UI</span><span class="w"> </span><span class="nx">结构</span>
<a id="__codelineno-81-4" name="__codelineno-81-4"></a><span class="err">②</span><span class="w"> </span><span class="nx">验证是否选择了文件</span>
<a id="__codelineno-81-5" name="__codelineno-81-5"></a><span class="err">③</span><span class="w"> </span><span class="nx">向</span><span class="w"> </span><span class="nx">FormData</span><span class="w"> </span><span class="nx">中追加文件</span>
<a id="__codelineno-81-6" name="__codelineno-81-6"></a><span class="err">④</span><span class="w"> </span><span class="nx">使用</span><span class="w"> </span><span class="nx">xhr</span><span class="w"> </span><span class="nx">发起上传文件的请求</span>
<a id="__codelineno-81-7" name="__codelineno-81-7"></a><span class="err">⑤</span><span class="w"> </span><span class="nx">监听</span><span class="w"> </span><span class="nx">onreadystatechange</span><span class="w"> </span><span class="nx">事件</span>
<a id="__codelineno-81-8" name="__codelineno-81-8"></a>
<a id="__codelineno-81-9" name="__codelineno-81-9"></a><span class="mf">1.</span><span class="w"> </span><span class="nx">定义UI结构</span>
<a id="__codelineno-81-10" name="__codelineno-81-10"></a><span class="w">    </span><span class="c">&lt;!--</span><span class="w"> </span><span class="mf">1.</span><span class="w"> </span><span class="nx">文件选择框</span><span class="w"> </span><span class="o">--&gt;</span>
<a id="__codelineno-81-11" name="__codelineno-81-11"></a><span class="w">    </span><span class="o">&lt;</span><span class="nx">input</span><span class="w"> </span><span class="nx">type</span><span class="o">=</span><span class="s2">&quot;file&quot;</span><span class="w"> </span><span class="nx">id</span><span class="o">=</span><span class="s2">&quot;file1&quot;</span><span class="w"> </span><span class="o">/&gt;</span>
<a id="__codelineno-81-12" name="__codelineno-81-12"></a><span class="w">    </span><span class="c">&lt;!--</span><span class="w"> </span><span class="mf">2.</span><span class="w"> </span><span class="nx">上传按钮</span><span class="w"> </span><span class="o">--&gt;</span>
<a id="__codelineno-81-13" name="__codelineno-81-13"></a><span class="w">    </span><span class="o">&lt;</span><span class="nx">button</span><span class="w"> </span><span class="nx">id</span><span class="o">=</span><span class="s2">&quot;btnUpload&quot;</span><span class="o">&gt;</span><span class="nx">上传文件</span><span class="o">&lt;</span><span class="err">/button&gt;</span>
<a id="__codelineno-81-14" name="__codelineno-81-14"></a>
<a id="__codelineno-81-15" name="__codelineno-81-15"></a><span class="w">    </span><span class="o">&lt;</span><span class="nx">br</span><span class="w"> </span><span class="o">/&gt;</span>
<a id="__codelineno-81-16" name="__codelineno-81-16"></a><span class="w">    </span><span class="c">&lt;!--</span><span class="w"> </span><span class="mf">3.</span><span class="w"> </span><span class="nx">显示上传到服务器上的图片</span><span class="w"> </span><span class="o">--&gt;</span>
<a id="__codelineno-81-17" name="__codelineno-81-17"></a><span class="w">    </span><span class="o">&lt;</span><span class="nx">img</span><span class="w"> </span><span class="nx">src</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="w"> </span><span class="nx">alt</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="w"> </span><span class="nx">id</span><span class="o">=</span><span class="s2">&quot;img&quot;</span><span class="w"> </span><span class="nx">width</span><span class="o">=</span><span class="s2">&quot;800&quot;</span><span class="w"> </span><span class="o">/&gt;</span>
<a id="__codelineno-81-18" name="__codelineno-81-18"></a>
<a id="__codelineno-81-19" name="__codelineno-81-19"></a><span class="mf">2.</span><span class="w"> </span><span class="nx">验证是否选择了文件</span>
<a id="__codelineno-81-20" name="__codelineno-81-20"></a><span class="w">    </span><span class="c1">// 1. 获取上传文件的按钮</span>
<a id="__codelineno-81-21" name="__codelineno-81-21"></a><span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">btnUpload</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">&#39;#btnUpload&#39;</span><span class="p">)</span>
<a id="__codelineno-81-22" name="__codelineno-81-22"></a><span class="w">    </span><span class="c1">// 2. 为按钮添加 click 事件监听</span>
<a id="__codelineno-81-23" name="__codelineno-81-23"></a><span class="w">    </span><span class="nx">btnUpload</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">&#39;click&#39;</span><span class="p">,</span><span class="w"> </span><span class="kd">function</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-81-24" name="__codelineno-81-24"></a><span class="w">    </span><span class="c1">// 3. 获取到选择的文件列表</span>
<a id="__codelineno-81-25" name="__codelineno-81-25"></a><span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">files</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">&#39;#file1&#39;</span><span class="p">).</span><span class="nx">files</span>
<a id="__codelineno-81-26" name="__codelineno-81-26"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">files</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-81-27" name="__codelineno-81-27"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">alert</span><span class="p">(</span><span class="s1">&#39;请选择要上传的文件！&#39;</span><span class="p">)</span>
<a id="__codelineno-81-28" name="__codelineno-81-28"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-81-29" name="__codelineno-81-29"></a><span class="w">    </span><span class="c1">// ...后续业务逻辑</span>
<a id="__codelineno-81-30" name="__codelineno-81-30"></a><span class="w">    </span><span class="p">})</span>
<a id="__codelineno-81-31" name="__codelineno-81-31"></a>
<a id="__codelineno-81-32" name="__codelineno-81-32"></a><span class="mf">3.</span><span class="w"> </span><span class="nx">向FormData中追加文件</span>
<a id="__codelineno-81-33" name="__codelineno-81-33"></a><span class="w">    </span><span class="c1">// 1. 创建 FormData 对象</span>
<a id="__codelineno-81-34" name="__codelineno-81-34"></a><span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">fd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">FormData</span><span class="p">()</span>
<a id="__codelineno-81-35" name="__codelineno-81-35"></a><span class="w">    </span><span class="c1">// 2. 向 FormData 中追加文件</span>
<a id="__codelineno-81-36" name="__codelineno-81-36"></a><span class="w">    </span><span class="nx">fd</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">&#39;avatar&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">files</span><span class="p">[</span><span class="mf">0</span><span class="p">])</span>
<a id="__codelineno-81-37" name="__codelineno-81-37"></a>
<a id="__codelineno-81-38" name="__codelineno-81-38"></a><span class="mf">4.</span><span class="w"> </span><span class="nx">使用</span><span class="w"> </span><span class="nx">xhr</span><span class="w"> </span><span class="nx">发起上传文件的请求</span>
<a id="__codelineno-81-39" name="__codelineno-81-39"></a><span class="w">    </span><span class="c1">// 1. 创建 xhr 对象</span>
<a id="__codelineno-81-40" name="__codelineno-81-40"></a><span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">xhr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">XMLHttpRequest</span><span class="p">()</span>
<a id="__codelineno-81-41" name="__codelineno-81-41"></a><span class="w">    </span><span class="c1">// 2. 调用 open 函数，指定请求类型与URL地址。其中，请求类型必须为 POST</span>
<a id="__codelineno-81-42" name="__codelineno-81-42"></a><span class="w">    </span><span class="nx">xhr</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="s1">&#39;POST&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;http://www.liulongbin.top:3006/api/upload/avatar&#39;</span><span class="p">)</span>
<a id="__codelineno-81-43" name="__codelineno-81-43"></a><span class="w">    </span><span class="c1">// 3. 发起请求</span>
<a id="__codelineno-81-44" name="__codelineno-81-44"></a><span class="w">    </span><span class="nx">xhr</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="nx">fd</span><span class="p">)</span>
<a id="__codelineno-81-45" name="__codelineno-81-45"></a>
<a id="__codelineno-81-46" name="__codelineno-81-46"></a>
<a id="__codelineno-81-47" name="__codelineno-81-47"></a><span class="mf">5.</span><span class="w"> </span><span class="nx">监听onreadystatechange事件</span>
<a id="__codelineno-81-48" name="__codelineno-81-48"></a><span class="w">    </span><span class="nx">xhr</span><span class="p">.</span><span class="nx">onreadystatechange</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-81-49" name="__codelineno-81-49"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">xhr</span><span class="p">.</span><span class="nx">readyState</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="mf">4</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">xhr</span><span class="p">.</span><span class="nx">status</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="mf">200</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-81-50" name="__codelineno-81-50"></a><span class="w">            </span><span class="kd">var</span><span class="w"> </span><span class="nx">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">xhr</span><span class="p">.</span><span class="nx">responseText</span><span class="p">)</span>
<a id="__codelineno-81-51" name="__codelineno-81-51"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">status</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="mf">200</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">// 上传文件成功</span>
<a id="__codelineno-81-52" name="__codelineno-81-52"></a><span class="w">            </span><span class="c1">// 将服务器返回的图片地址，设置为 &lt;img&gt; 标签的 src 属性</span>
<a id="__codelineno-81-53" name="__codelineno-81-53"></a><span class="w">            </span><span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">&#39;#img&#39;</span><span class="p">).</span><span class="nx">src</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;http://www.liulongbin.top:3006&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">data</span><span class="p">.</span><span class="nx">url</span>
<a id="__codelineno-81-54" name="__codelineno-81-54"></a><span class="w">            </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">// 上传文件失败</span>
<a id="__codelineno-81-55" name="__codelineno-81-55"></a><span class="w">            </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">message</span><span class="p">)</span>
<a id="__codelineno-81-56" name="__codelineno-81-56"></a><span class="w">            </span><span class="p">}</span>
<a id="__codelineno-81-57" name="__codelineno-81-57"></a><span class="w">        </span><span class="p">}</span>
<a id="__codelineno-81-58" name="__codelineno-81-58"></a><span class="w">    </span><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<h4 id="4-3-jquery实现文件上传">4-3 jQuery实现文件上传<a class="headerlink" href="#4-3-jquery实现文件上传" title="Permanent link">&para;</a></h4>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Text Only</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-82-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-82-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-82-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-82-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-82-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-82-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-82-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-82-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-82-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-82-10">10</a></span>
<span class="normal"><a href="#__codelineno-82-11">11</a></span>
<span class="normal"><a href="#__codelineno-82-12">12</a></span>
<span class="normal"><a href="#__codelineno-82-13">13</a></span>
<span class="normal"><a href="#__codelineno-82-14">14</a></span>
<span class="normal"><a href="#__codelineno-82-15">15</a></span>
<span class="normal"><a href="#__codelineno-82-16">16</a></span>
<span class="normal"><a href="#__codelineno-82-17">17</a></span>
<span class="normal"><a href="#__codelineno-82-18">18</a></span>
<span class="normal"><a href="#__codelineno-82-19">19</a></span>
<span class="normal"><a href="#__codelineno-82-20">20</a></span>
<span class="normal"><a href="#__codelineno-82-21">21</a></span>
<span class="normal"><a href="#__codelineno-82-22">22</a></span>
<span class="normal"><a href="#__codelineno-82-23">23</a></span>
<span class="normal"><a href="#__codelineno-82-24">24</a></span>
<span class="normal"><a href="#__codelineno-82-25">25</a></span>
<span class="normal"><a href="#__codelineno-82-26">26</a></span>
<span class="normal"><a href="#__codelineno-82-27">27</a></span>
<span class="normal"><a href="#__codelineno-82-28">28</a></span>
<span class="normal"><a href="#__codelineno-82-29">29</a></span>
<span class="normal"><a href="#__codelineno-82-30">30</a></span>
<span class="normal"><a href="#__codelineno-82-31">31</a></span>
<span class="normal"><a href="#__codelineno-82-32">32</a></span>
<span class="normal"><a href="#__codelineno-82-33">33</a></span>
<span class="normal"><a href="#__codelineno-82-34">34</a></span>
<span class="normal"><a href="#__codelineno-82-35">35</a></span>
<span class="normal"><a href="#__codelineno-82-36">36</a></span>
<span class="normal"><a href="#__codelineno-82-37">37</a></span>
<span class="normal"><a href="#__codelineno-82-38">38</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-82-1" name="__codelineno-82-1"></a>1. 定义UI结构
<a id="__codelineno-82-2" name="__codelineno-82-2"></a>    &lt;!-- 导入 jQuery --&gt;
<a id="__codelineno-82-3" name="__codelineno-82-3"></a>    &lt;script src=&quot;./lib/jquery.js&quot;&gt;&lt;/script&gt;
<a id="__codelineno-82-4" name="__codelineno-82-4"></a>
<a id="__codelineno-82-5" name="__codelineno-82-5"></a>    &lt;!-- 文件选择框 --&gt;
<a id="__codelineno-82-6" name="__codelineno-82-6"></a>    &lt;input type=&quot;file&quot; id=&quot;file1&quot; /&gt;
<a id="__codelineno-82-7" name="__codelineno-82-7"></a>    &lt;!-- 上传文件按钮 --&gt;
<a id="__codelineno-82-8" name="__codelineno-82-8"></a>    &lt;button id=&quot;btnUpload&quot;&gt;上传&lt;/button&gt;
<a id="__codelineno-82-9" name="__codelineno-82-9"></a>
<a id="__codelineno-82-10" name="__codelineno-82-10"></a>2. 验证是否选择了文件
<a id="__codelineno-82-11" name="__codelineno-82-11"></a>    $(&#39;#btnUpload&#39;).on(&#39;click&#39;, function() {
<a id="__codelineno-82-12" name="__codelineno-82-12"></a>        // 1. 将 jQuery 对象转化为 DOM 对象，并获取选中的文件列表
<a id="__codelineno-82-13" name="__codelineno-82-13"></a>        var files = $(&#39;#file1&#39;)[0].files
<a id="__codelineno-82-14" name="__codelineno-82-14"></a>        // 2. 判断是否选择了文件
<a id="__codelineno-82-15" name="__codelineno-82-15"></a>        if (files.length &lt;= 0) {
<a id="__codelineno-82-16" name="__codelineno-82-16"></a>        return alert(&#39;请选择图片后再上传！‘)
<a id="__codelineno-82-17" name="__codelineno-82-17"></a>        }
<a id="__codelineno-82-18" name="__codelineno-82-18"></a>    })
<a id="__codelineno-82-19" name="__codelineno-82-19"></a>
<a id="__codelineno-82-20" name="__codelineno-82-20"></a>3. 向FormData中追加文件
<a id="__codelineno-82-21" name="__codelineno-82-21"></a>    // 向 FormData 中追加文件
<a id="__codelineno-82-22" name="__codelineno-82-22"></a>    var fd = new FormData()
<a id="__codelineno-82-23" name="__codelineno-82-23"></a>    fd.append(&#39;avatar&#39;, files[0])
<a id="__codelineno-82-24" name="__codelineno-82-24"></a>
<a id="__codelineno-82-25" name="__codelineno-82-25"></a>
<a id="__codelineno-82-26" name="__codelineno-82-26"></a>4. 使用jQuery发起上传文件的请求
<a id="__codelineno-82-27" name="__codelineno-82-27"></a>    $.ajax({
<a id="__codelineno-82-28" name="__codelineno-82-28"></a>        method: &#39;POST&#39;,
<a id="__codelineno-82-29" name="__codelineno-82-29"></a>        url: &#39;http://www.liulongbin.top:3006/api/upload/avatar&#39;,
<a id="__codelineno-82-30" name="__codelineno-82-30"></a>        data: fd,
<a id="__codelineno-82-31" name="__codelineno-82-31"></a>        // 不修改 Content-Type 属性，使用 FormData 默认的 Content-Type 值
<a id="__codelineno-82-32" name="__codelineno-82-32"></a>        contentType: false,
<a id="__codelineno-82-33" name="__codelineno-82-33"></a>        // 不对 FormData 中的数据进行 url 编码，而是将 FormData 数据原样发送到服务器
<a id="__codelineno-82-34" name="__codelineno-82-34"></a>        processData: false,
<a id="__codelineno-82-35" name="__codelineno-82-35"></a>        success: function(res) {
<a id="__codelineno-82-36" name="__codelineno-82-36"></a>            console.log(res)
<a id="__codelineno-82-37" name="__codelineno-82-37"></a>        }
<a id="__codelineno-82-38" name="__codelineno-82-38"></a>    })
</code></pre></div></td></tr></table></div>
<h3 id="16-5-显示文件上传的进度">16-5 显示文件上传的进度<a class="headerlink" href="#16-5-显示文件上传的进度" title="Permanent link">&para;</a></h3>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">JavaScript</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-83-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-83-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-83-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-83-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-83-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-83-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-83-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-83-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-83-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-83-10">10</a></span>
<span class="normal"><a href="#__codelineno-83-11">11</a></span>
<span class="normal"><a href="#__codelineno-83-12">12</a></span>
<span class="normal"><a href="#__codelineno-83-13">13</a></span>
<span class="normal"><a href="#__codelineno-83-14">14</a></span>
<span class="normal"><a href="#__codelineno-83-15">15</a></span>
<span class="normal"><a href="#__codelineno-83-16">16</a></span>
<span class="normal"><a href="#__codelineno-83-17">17</a></span>
<span class="normal"><a href="#__codelineno-83-18">18</a></span>
<span class="normal"><a href="#__codelineno-83-19">19</a></span>
<span class="normal"><a href="#__codelineno-83-20">20</a></span>
<span class="normal"><a href="#__codelineno-83-21">21</a></span>
<span class="normal"><a href="#__codelineno-83-22">22</a></span>
<span class="normal"><a href="#__codelineno-83-23">23</a></span>
<span class="normal"><a href="#__codelineno-83-24">24</a></span>
<span class="normal"><a href="#__codelineno-83-25">25</a></span>
<span class="normal"><a href="#__codelineno-83-26">26</a></span>
<span class="normal"><a href="#__codelineno-83-27">27</a></span>
<span class="normal"><a href="#__codelineno-83-28">28</a></span>
<span class="normal"><a href="#__codelineno-83-29">29</a></span>
<span class="normal"><a href="#__codelineno-83-30">30</a></span>
<span class="normal"><a href="#__codelineno-83-31">31</a></span>
<span class="normal"><a href="#__codelineno-83-32">32</a></span>
<span class="normal"><a href="#__codelineno-83-33">33</a></span>
<span class="normal"><a href="#__codelineno-83-34">34</a></span>
<span class="normal"><a href="#__codelineno-83-35">35</a></span>
<span class="normal"><a href="#__codelineno-83-36">36</a></span>
<span class="normal"><a href="#__codelineno-83-37">37</a></span>
<span class="normal"><a href="#__codelineno-83-38">38</a></span>
<span class="normal"><a href="#__codelineno-83-39">39</a></span>
<span class="normal"><a href="#__codelineno-83-40">40</a></span>
<span class="normal"><a href="#__codelineno-83-41">41</a></span>
<span class="normal"><a href="#__codelineno-83-42">42</a></span>
<span class="normal"><a href="#__codelineno-83-43">43</a></span>
<span class="normal"><a href="#__codelineno-83-44">44</a></span>
<span class="normal"><a href="#__codelineno-83-45">45</a></span>
<span class="normal"><a href="#__codelineno-83-46">46</a></span>
<span class="normal"><a href="#__codelineno-83-47">47</a></span>
<span class="normal"><a href="#__codelineno-83-48">48</a></span>
<span class="normal"><a href="#__codelineno-83-49">49</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-83-1" name="__codelineno-83-1"></a><span class="c1">// 新版本的 XMLHttpRequest 对象中，可以通过监听 xhr.upload.onprogress 事件，来获取到文件的上传进度。</span>
<a id="__codelineno-83-2" name="__codelineno-83-2"></a><span class="nx">语法格式如下</span><span class="err">：</span>
<a id="__codelineno-83-3" name="__codelineno-83-3"></a><span class="c1">// 创建 XHR 对象</span>
<a id="__codelineno-83-4" name="__codelineno-83-4"></a><span class="kd">var</span><span class="w"> </span><span class="nx">xhr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">XMLHttpRequest</span><span class="p">()</span>
<a id="__codelineno-83-5" name="__codelineno-83-5"></a><span class="c1">// 监听 xhr.upload 的 onprogress 事件</span>
<a id="__codelineno-83-6" name="__codelineno-83-6"></a><span class="nx">xhr</span><span class="p">.</span><span class="nx">upload</span><span class="p">.</span><span class="nx">onprogress</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-83-7" name="__codelineno-83-7"></a><span class="c1">// e.lengthComputable 是一个布尔值，表示当前上传的资源是否具有可计算的长度</span>
<a id="__codelineno-83-8" name="__codelineno-83-8"></a><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">lengthComputable</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-83-9" name="__codelineno-83-9"></a><span class="w">    </span><span class="c1">// e.loaded 已传输的字节</span>
<a id="__codelineno-83-10" name="__codelineno-83-10"></a><span class="w">    </span><span class="c1">// e.total 需传输的总字节</span>
<a id="__codelineno-83-11" name="__codelineno-83-11"></a><span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">percentComplete</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">ceil</span><span class="p">((</span><span class="nx">e</span><span class="p">.</span><span class="nx">loaded</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nx">e</span><span class="p">.</span><span class="nx">total</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">100</span><span class="p">)</span>
<a id="__codelineno-83-12" name="__codelineno-83-12"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-83-13" name="__codelineno-83-13"></a><span class="p">}</span>
<a id="__codelineno-83-14" name="__codelineno-83-14"></a>
<a id="__codelineno-83-15" name="__codelineno-83-15"></a>
<a id="__codelineno-83-16" name="__codelineno-83-16"></a><span class="mf">1.</span><span class="w"> </span><span class="nx">导入需要的库</span>
<a id="__codelineno-83-17" name="__codelineno-83-17"></a><span class="w">    </span><span class="o">&lt;</span><span class="nx">link</span><span class="w"> </span><span class="nx">rel</span><span class="o">=</span><span class="s2">&quot;stylesheet&quot;</span><span class="w"> </span><span class="nx">href</span><span class="o">=</span><span class="s2">&quot;./lib/bootstrap.css&quot;</span><span class="w"> </span><span class="o">/&gt;</span>
<a id="__codelineno-83-18" name="__codelineno-83-18"></a><span class="w">    </span><span class="o">&lt;</span><span class="nx">script</span><span class="w"> </span><span class="nx">src</span><span class="o">=</span><span class="s2">&quot;./lib/jquery.js&quot;</span><span class="o">&gt;&lt;</span><span class="err">/script&gt;</span>
<a id="__codelineno-83-19" name="__codelineno-83-19"></a>
<a id="__codelineno-83-20" name="__codelineno-83-20"></a><span class="mf">2.</span><span class="w"> </span><span class="nx">基于Bootstrap渲染进度条</span>
<a id="__codelineno-83-21" name="__codelineno-83-21"></a><span class="w">    </span><span class="c">&lt;!--</span><span class="w"> </span><span class="nx">进度条</span><span class="w"> </span><span class="o">--&gt;</span>
<a id="__codelineno-83-22" name="__codelineno-83-22"></a><span class="w">    </span><span class="o">&lt;</span><span class="nx">div</span><span class="w"> </span><span class="kd">class</span><span class="o">=</span><span class="s2">&quot;progress&quot;</span><span class="w"> </span><span class="nx">style</span><span class="o">=</span><span class="s2">&quot;width: 500px; margin: 10px 0;&quot;</span><span class="o">&gt;</span>
<a id="__codelineno-83-23" name="__codelineno-83-23"></a><span class="w">        </span><span class="o">&lt;</span><span class="nx">div</span><span class="w"> </span><span class="kd">class</span><span class="o">=</span><span class="s2">&quot;progress-bar progress-bar-info progress-barstriped active&quot;</span><span class="w"> </span><span class="nx">id</span><span class="o">=</span><span class="s2">&quot;percent&quot;</span><span class="w"> </span><span class="nx">style</span><span class="o">=</span><span class="s2">&quot;width: 0%&quot;</span><span class="o">&gt;</span>
<a id="__codelineno-83-24" name="__codelineno-83-24"></a><span class="w">        </span><span class="mf">0</span><span class="o">%</span>
<a id="__codelineno-83-25" name="__codelineno-83-25"></a><span class="w">        </span><span class="o">&lt;</span><span class="err">/div&gt;</span>
<a id="__codelineno-83-26" name="__codelineno-83-26"></a>
<a id="__codelineno-83-27" name="__codelineno-83-27"></a><span class="w">    </span><span class="o">&lt;</span><span class="err">/div&gt;</span>
<a id="__codelineno-83-28" name="__codelineno-83-28"></a>
<a id="__codelineno-83-29" name="__codelineno-83-29"></a><span class="mf">3.</span><span class="w"> </span><span class="nx">监听上传进度的事件</span>
<a id="__codelineno-83-30" name="__codelineno-83-30"></a><span class="w">    </span><span class="nx">xhr</span><span class="p">.</span><span class="nx">upload</span><span class="p">.</span><span class="nx">onprogress</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-83-31" name="__codelineno-83-31"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">lengthComputable</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-83-32" name="__codelineno-83-32"></a><span class="w">        </span><span class="c1">// 1. 计算出当前上传进度的百分比</span>
<a id="__codelineno-83-33" name="__codelineno-83-33"></a><span class="w">        </span><span class="kd">var</span><span class="w"> </span><span class="nx">percentComplete</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">ceil</span><span class="p">((</span><span class="nx">e</span><span class="p">.</span><span class="nx">loaded</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nx">e</span><span class="p">.</span><span class="nx">total</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">100</span><span class="p">)</span>
<a id="__codelineno-83-34" name="__codelineno-83-34"></a><span class="w">        </span><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#percent&#39;</span><span class="p">)</span>
<a id="__codelineno-83-35" name="__codelineno-83-35"></a><span class="w">        </span><span class="c1">// 2. 设置进度条的宽度</span>
<a id="__codelineno-83-36" name="__codelineno-83-36"></a><span class="w">        </span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;style&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;width:&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">percentComplete</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;%&#39;</span><span class="p">)</span>
<a id="__codelineno-83-37" name="__codelineno-83-37"></a><span class="w">        </span><span class="c1">// 3. 显示当前的上传进度百分比</span>
<a id="__codelineno-83-38" name="__codelineno-83-38"></a><span class="w">        </span><span class="p">.</span><span class="nx">html</span><span class="p">(</span><span class="nx">percentComplete</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;%&#39;</span><span class="p">)</span>
<a id="__codelineno-83-39" name="__codelineno-83-39"></a><span class="w">        </span><span class="p">}</span>
<a id="__codelineno-83-40" name="__codelineno-83-40"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-83-41" name="__codelineno-83-41"></a>
<a id="__codelineno-83-42" name="__codelineno-83-42"></a><span class="mf">4.</span><span class="w"> </span><span class="nx">监听上传完成的事件</span>
<a id="__codelineno-83-43" name="__codelineno-83-43"></a><span class="w">    </span><span class="nx">xhr</span><span class="p">.</span><span class="nx">upload</span><span class="p">.</span><span class="nx">onload</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-83-44" name="__codelineno-83-44"></a><span class="w">        </span><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#percent&#39;</span><span class="p">)</span>
<a id="__codelineno-83-45" name="__codelineno-83-45"></a><span class="w">        </span><span class="c1">// 移除上传中的类样式</span>
<a id="__codelineno-83-46" name="__codelineno-83-46"></a><span class="w">        </span><span class="p">.</span><span class="nx">removeClass</span><span class="p">()</span>
<a id="__codelineno-83-47" name="__codelineno-83-47"></a><span class="w">        </span><span class="c1">// 添加上传完成的类样式</span>
<a id="__codelineno-83-48" name="__codelineno-83-48"></a><span class="w">        </span><span class="p">.</span><span class="nx">addClass</span><span class="p">(</span><span class="s1">&#39;progress-bar progress-bar-success&#39;</span><span class="p">)</span>
<a id="__codelineno-83-49" name="__codelineno-83-49"></a><span class="w">    </span><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<h3 id="16-6-jquery实现loading效果">16-6  jQuery实现loading效果<a class="headerlink" href="#16-6-jquery实现loading效果" title="Permanent link">&para;</a></h3>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">JavaScript</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-84-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-84-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-84-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-84-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-84-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-84-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-84-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-84-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-84-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-84-10">10</a></span>
<span class="normal"><a href="#__codelineno-84-11">11</a></span>
<span class="normal"><a href="#__codelineno-84-12">12</a></span>
<span class="normal"><a href="#__codelineno-84-13">13</a></span>
<span class="normal"><a href="#__codelineno-84-14">14</a></span>
<span class="normal"><a href="#__codelineno-84-15">15</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-84-1" name="__codelineno-84-1"></a><span class="mf">1.</span><span class="w"> </span><span class="nx">ajaxStart</span><span class="p">(</span><span class="nx">callback</span><span class="p">)</span>
<a id="__codelineno-84-2" name="__codelineno-84-2"></a><span class="w">    </span><span class="c1">//Ajax 请求开始时，执行 ajaxStart 函数。可以在 ajaxStart 的 callback 中显示 loading 效果，示例代码如下：</span>
<a id="__codelineno-84-3" name="__codelineno-84-3"></a><span class="w">        </span><span class="c1">// 自 jQuery 版本 1.8 起，该方法只能被附加到文档</span>
<a id="__codelineno-84-4" name="__codelineno-84-4"></a><span class="w">        </span><span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nx">ajaxStart</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-84-5" name="__codelineno-84-5"></a><span class="w">            </span><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#loading&#39;</span><span class="p">).</span><span class="nx">show</span><span class="p">()</span>
<a id="__codelineno-84-6" name="__codelineno-84-6"></a><span class="w">        </span><span class="p">})</span>
<a id="__codelineno-84-7" name="__codelineno-84-7"></a><span class="w">        </span><span class="nx">注意</span><span class="err">：</span><span class="w"> </span><span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nx">ajaxStart</span><span class="p">()</span><span class="w"> </span><span class="nx">函数会监听当前文档内所有的</span><span class="w"> </span><span class="nx">Ajax</span><span class="w"> </span><span class="nx">请求</span><span class="err">。</span>
<a id="__codelineno-84-8" name="__codelineno-84-8"></a>
<a id="__codelineno-84-9" name="__codelineno-84-9"></a>
<a id="__codelineno-84-10" name="__codelineno-84-10"></a><span class="mf">2.</span><span class="w"> </span><span class="nx">ajaxStop</span><span class="p">(</span><span class="nx">callback</span><span class="p">)</span>
<a id="__codelineno-84-11" name="__codelineno-84-11"></a><span class="w">    </span><span class="c1">// Ajax 请求结束时，执行 ajaxStop 函数。可以在 ajaxStop 的 callback 中隐藏 loading 效果，示例代码如下：</span>
<a id="__codelineno-84-12" name="__codelineno-84-12"></a><span class="w">        </span><span class="c1">// 自 jQuery 版本 1.8 起，该方法只能被附加到文档</span>
<a id="__codelineno-84-13" name="__codelineno-84-13"></a><span class="w">        </span><span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nx">ajaxStop</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-84-14" name="__codelineno-84-14"></a><span class="w">            </span><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#loading&#39;</span><span class="p">).</span><span class="nx">hide</span><span class="p">()</span>
<a id="__codelineno-84-15" name="__codelineno-84-15"></a><span class="w">        </span><span class="p">})</span>
</code></pre></div></td></tr></table></div>
<h3 id="16-7-axios">16-7   Axios<a class="headerlink" href="#16-7-axios" title="Permanent link">&para;</a></h3>
<h4 id="71-axios发起get请求">7.1 axios发起GET请求<a class="headerlink" href="#71-axios发起get请求" title="Permanent link">&para;</a></h4>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">JavaScript</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-85-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-85-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-85-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-85-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-85-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-85-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-85-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-85-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-85-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-85-10">10</a></span>
<span class="normal"><a href="#__codelineno-85-11">11</a></span>
<span class="normal"><a href="#__codelineno-85-12">12</a></span>
<span class="normal"><a href="#__codelineno-85-13">13</a></span>
<span class="normal"><a href="#__codelineno-85-14">14</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-85-1" name="__codelineno-85-1"></a><span class="c1">// axios 发起 get 请求的语法：</span>
<a id="__codelineno-85-2" name="__codelineno-85-2"></a><span class="nx">axios</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;url&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">params</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="cm">/*参数*/</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">}).</span><span class="nx">then</span><span class="p">(</span><span class="nx">callback</span><span class="p">)</span>
<a id="__codelineno-85-3" name="__codelineno-85-3"></a>
<a id="__codelineno-85-4" name="__codelineno-85-4"></a><span class="c1">//具体的请求示例如下：</span>
<a id="__codelineno-85-5" name="__codelineno-85-5"></a><span class="w">    </span><span class="c1">// 请求的 URL 地址</span>
<a id="__codelineno-85-6" name="__codelineno-85-6"></a><span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">url</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;http://www.liulongbin.top:3006/api/get&#39;</span>
<a id="__codelineno-85-7" name="__codelineno-85-7"></a><span class="w">    </span><span class="c1">// 请求的参数对象</span>
<a id="__codelineno-85-8" name="__codelineno-85-8"></a><span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">paramsObj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;zs&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">age</span><span class="o">:</span><span class="w"> </span><span class="mf">20</span><span class="w"> </span><span class="p">}</span>
<a id="__codelineno-85-9" name="__codelineno-85-9"></a><span class="w">    </span><span class="c1">// 调用 axios.get() 发起 GET 请求</span>
<a id="__codelineno-85-10" name="__codelineno-85-10"></a><span class="w">    </span><span class="nx">axios</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">params</span><span class="o">:</span><span class="w"> </span><span class="nx">paramsObj</span><span class="w"> </span><span class="p">}).</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-85-11" name="__codelineno-85-11"></a><span class="w">        </span><span class="c1">// res.data 是服务器返回的数据</span>
<a id="__codelineno-85-12" name="__codelineno-85-12"></a><span class="w">        </span><span class="kd">var</span><span class="w"> </span><span class="nx">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">res</span><span class="p">.</span><span class="nx">data</span>
<a id="__codelineno-85-13" name="__codelineno-85-13"></a><span class="w">        </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span>
<a id="__codelineno-85-14" name="__codelineno-85-14"></a><span class="w">    </span><span class="p">})</span>
</code></pre></div></td></tr></table></div>
<h4 id="72-直接使用axios发起post请求">7.2 直接使用axios发起POST请求<a class="headerlink" href="#72-直接使用axios发起post请求" title="Permanent link">&para;</a></h4>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">JavaScript</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-86-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-86-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-86-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-86-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-86-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-86-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-86-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-86-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-86-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-86-10">10</a></span>
<span class="normal"><a href="#__codelineno-86-11">11</a></span>
<span class="normal"><a href="#__codelineno-86-12">12</a></span>
<span class="normal"><a href="#__codelineno-86-13">13</a></span>
<span class="normal"><a href="#__codelineno-86-14">14</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-86-1" name="__codelineno-86-1"></a><span class="c1">// axios 发起 post 请求的语法：</span>
<a id="__codelineno-86-2" name="__codelineno-86-2"></a><span class="w">    </span><span class="nx">axios</span><span class="p">.</span><span class="nx">post</span><span class="p">(</span><span class="s1">&#39;url&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="cm">/*参数*/</span><span class="w"> </span><span class="p">}).</span><span class="nx">then</span><span class="p">(</span><span class="nx">callback</span><span class="p">)</span>
<a id="__codelineno-86-3" name="__codelineno-86-3"></a>
<a id="__codelineno-86-4" name="__codelineno-86-4"></a><span class="w">    </span><span class="nx">具体的请求示例如下</span><span class="err">：</span>
<a id="__codelineno-86-5" name="__codelineno-86-5"></a><span class="w">    </span><span class="c1">// 请求的 URL 地址</span>
<a id="__codelineno-86-6" name="__codelineno-86-6"></a><span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">url</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;http://www.liulongbin.top:3006/api/post&#39;</span>
<a id="__codelineno-86-7" name="__codelineno-86-7"></a><span class="w">    </span><span class="c1">// 要提交到服务器的数据</span>
<a id="__codelineno-86-8" name="__codelineno-86-8"></a><span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">dataObj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">location</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;北京&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">address</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;顺义&#39;</span><span class="w"> </span><span class="p">}</span>
<a id="__codelineno-86-9" name="__codelineno-86-9"></a><span class="w">    </span><span class="c1">// 调用 axios.post() 发起 POST 请求</span>
<a id="__codelineno-86-10" name="__codelineno-86-10"></a><span class="w">    </span><span class="nx">axios</span><span class="p">.</span><span class="nx">post</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span><span class="w"> </span><span class="nx">dataObj</span><span class="p">).</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-86-11" name="__codelineno-86-11"></a><span class="w">        </span><span class="c1">// res.data 是服务器返回的数据</span>
<a id="__codelineno-86-12" name="__codelineno-86-12"></a><span class="w">        </span><span class="kd">var</span><span class="w"> </span><span class="nx">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">res</span><span class="p">.</span><span class="nx">data</span>
<a id="__codelineno-86-13" name="__codelineno-86-13"></a><span class="w">        </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span>
<a id="__codelineno-86-14" name="__codelineno-86-14"></a><span class="w">    </span><span class="p">})</span>
</code></pre></div></td></tr></table></div>
<h4 id="73-直接使用axios发起请求">7,3 直接使用axios发起请求<a class="headerlink" href="#73-直接使用axios发起请求" title="Permanent link">&para;</a></h4>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">JavaScript</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-87-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-87-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-87-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-87-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-87-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-87-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-87-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-87-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-87-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-87-10">10</a></span>
<span class="normal"><a href="#__codelineno-87-11">11</a></span>
<span class="normal"><a href="#__codelineno-87-12">12</a></span>
<span class="normal"><a href="#__codelineno-87-13">13</a></span>
<span class="normal"><a href="#__codelineno-87-14">14</a></span>
<span class="normal"><a href="#__codelineno-87-15">15</a></span>
<span class="normal"><a href="#__codelineno-87-16">16</a></span>
<span class="normal"><a href="#__codelineno-87-17">17</a></span>
<span class="normal"><a href="#__codelineno-87-18">18</a></span>
<span class="normal"><a href="#__codelineno-87-19">19</a></span>
<span class="normal"><a href="#__codelineno-87-20">20</a></span>
<span class="normal"><a href="#__codelineno-87-21">21</a></span>
<span class="normal"><a href="#__codelineno-87-22">22</a></span>
<span class="normal"><a href="#__codelineno-87-23">23</a></span>
<span class="normal"><a href="#__codelineno-87-24">24</a></span>
<span class="normal"><a href="#__codelineno-87-25">25</a></span>
<span class="normal"><a href="#__codelineno-87-26">26</a></span>
<span class="normal"><a href="#__codelineno-87-27">27</a></span>
<span class="normal"><a href="#__codelineno-87-28">28</a></span>
<span class="normal"><a href="#__codelineno-87-29">29</a></span>
<span class="normal"><a href="#__codelineno-87-30">30</a></span>
<span class="normal"><a href="#__codelineno-87-31">31</a></span>
<span class="normal"><a href="#__codelineno-87-32">32</a></span>
<span class="normal"><a href="#__codelineno-87-33">33</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-87-1" name="__codelineno-87-1"></a><span class="c1">// axios 也提供了类似于 jQuery 中 $.ajax() 的函数，语法如下：</span>
<a id="__codelineno-87-2" name="__codelineno-87-2"></a><span class="w">    </span><span class="nx">axios</span><span class="p">({</span>
<a id="__codelineno-87-3" name="__codelineno-87-3"></a><span class="w">    </span><span class="nx">method</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;请求类型&#39;</span><span class="p">,</span>
<a id="__codelineno-87-4" name="__codelineno-87-4"></a><span class="w">    </span><span class="nx">url</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;请求的URL地址&#39;</span><span class="p">,</span>
<a id="__codelineno-87-5" name="__codelineno-87-5"></a><span class="w">    </span><span class="nx">data</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="cm">/* POST数据 */</span><span class="w"> </span><span class="p">},</span>
<a id="__codelineno-87-6" name="__codelineno-87-6"></a><span class="w">    </span><span class="nx">params</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="cm">/* GET参数 */</span><span class="w"> </span><span class="p">}</span>
<a id="__codelineno-87-7" name="__codelineno-87-7"></a><span class="w">    </span><span class="p">})</span><span class="w"> </span><span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">callback</span><span class="p">)</span>
<a id="__codelineno-87-8" name="__codelineno-87-8"></a>
<a id="__codelineno-87-9" name="__codelineno-87-9"></a>
<a id="__codelineno-87-10" name="__codelineno-87-10"></a>
<a id="__codelineno-87-11" name="__codelineno-87-11"></a><span class="mf">1.</span><span class="w"> </span><span class="nx">直接使用axios发起GET请求</span>
<a id="__codelineno-87-12" name="__codelineno-87-12"></a><span class="w">    </span><span class="nx">axios</span><span class="p">({</span>
<a id="__codelineno-87-13" name="__codelineno-87-13"></a><span class="w">        </span><span class="nx">method</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;GET&#39;</span><span class="p">,</span>
<a id="__codelineno-87-14" name="__codelineno-87-14"></a><span class="w">        </span><span class="nx">url</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;http://www.liulongbin.top:3006/api/get&#39;</span><span class="p">,</span>
<a id="__codelineno-87-15" name="__codelineno-87-15"></a><span class="w">        </span><span class="nx">params</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">// GET 参数要通过 params 属性提供</span>
<a id="__codelineno-87-16" name="__codelineno-87-16"></a><span class="w">        </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;zs&#39;</span><span class="p">,</span>
<a id="__codelineno-87-17" name="__codelineno-87-17"></a><span class="w">        </span><span class="nx">age</span><span class="o">:</span><span class="w"> </span><span class="mf">20</span>
<a id="__codelineno-87-18" name="__codelineno-87-18"></a><span class="w">        </span><span class="p">}</span>
<a id="__codelineno-87-19" name="__codelineno-87-19"></a><span class="w">        </span><span class="p">}).</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-87-20" name="__codelineno-87-20"></a><span class="w">        </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">res</span><span class="p">.</span><span class="nx">data</span><span class="p">)</span>
<a id="__codelineno-87-21" name="__codelineno-87-21"></a><span class="w">    </span><span class="p">})</span>
<a id="__codelineno-87-22" name="__codelineno-87-22"></a>
<a id="__codelineno-87-23" name="__codelineno-87-23"></a><span class="mf">2.</span><span class="w"> </span><span class="nx">直接使用axios发起POST请求</span>
<a id="__codelineno-87-24" name="__codelineno-87-24"></a><span class="w">    </span><span class="nx">axios</span><span class="p">({</span>
<a id="__codelineno-87-25" name="__codelineno-87-25"></a><span class="w">        </span><span class="nx">method</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;POST&#39;</span><span class="p">,</span>
<a id="__codelineno-87-26" name="__codelineno-87-26"></a><span class="w">        </span><span class="nx">url</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;http://www.liulongbin.top:3006/api/post&#39;</span><span class="p">,</span>
<a id="__codelineno-87-27" name="__codelineno-87-27"></a><span class="w">        </span><span class="nx">data</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">// POST 数据要通过 data 属性提供</span>
<a id="__codelineno-87-28" name="__codelineno-87-28"></a><span class="w">        </span><span class="nx">bookname</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;程序员的自我修养&#39;</span><span class="p">,</span>
<a id="__codelineno-87-29" name="__codelineno-87-29"></a><span class="w">        </span><span class="nx">price</span><span class="o">:</span><span class="w"> </span><span class="mf">666</span>
<a id="__codelineno-87-30" name="__codelineno-87-30"></a><span class="w">        </span><span class="p">}</span>
<a id="__codelineno-87-31" name="__codelineno-87-31"></a><span class="w">        </span><span class="p">}).</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-87-32" name="__codelineno-87-32"></a><span class="w">        </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">res</span><span class="p">.</span><span class="nx">data</span><span class="p">)</span>
<a id="__codelineno-87-33" name="__codelineno-87-33"></a><span class="w">    </span><span class="p">})</span>
</code></pre></div></td></tr></table></div>
<h3 id="16-8-django自带的序列化组件drf做铺垫">16-8 django自带的序列化组件(drf做铺垫)<a class="headerlink" href="#16-8-django自带的序列化组件drf做铺垫" title="Permanent link">&para;</a></h3>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-88-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-88-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-88-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-88-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-88-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-88-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-88-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-88-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-88-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-88-10">10</a></span>
<span class="normal"><a href="#__codelineno-88-11">11</a></span>
<span class="normal"><a href="#__codelineno-88-12">12</a></span>
<span class="normal"><a href="#__codelineno-88-13">13</a></span>
<span class="normal"><a href="#__codelineno-88-14">14</a></span>
<span class="normal"><a href="#__codelineno-88-15">15</a></span>
<span class="normal"><a href="#__codelineno-88-16">16</a></span>
<span class="normal"><a href="#__codelineno-88-17">17</a></span>
<span class="normal"><a href="#__codelineno-88-18">18</a></span>
<span class="normal"><a href="#__codelineno-88-19">19</a></span>
<span class="normal"><a href="#__codelineno-88-20">20</a></span>
<span class="normal"><a href="#__codelineno-88-21">21</a></span>
<span class="normal"><a href="#__codelineno-88-22">22</a></span>
<span class="normal"><a href="#__codelineno-88-23">23</a></span>
<span class="normal"><a href="#__codelineno-88-24">24</a></span>
<span class="normal"><a href="#__codelineno-88-25">25</a></span>
<span class="normal"><a href="#__codelineno-88-26">26</a></span>
<span class="normal"><a href="#__codelineno-88-27">27</a></span>
<span class="normal"><a href="#__codelineno-88-28">28</a></span>
<span class="normal"><a href="#__codelineno-88-29">29</a></span>
<span class="normal"><a href="#__codelineno-88-30">30</a></span>
<span class="normal"><a href="#__codelineno-88-31">31</a></span>
<span class="normal"><a href="#__codelineno-88-32">32</a></span>
<span class="normal"><a href="#__codelineno-88-33">33</a></span>
<span class="normal"><a href="#__codelineno-88-34">34</a></span>
<span class="normal"><a href="#__codelineno-88-35">35</a></span>
<span class="normal"><a href="#__codelineno-88-36">36</a></span>
<span class="normal"><a href="#__codelineno-88-37">37</a></span>
<span class="normal"><a href="#__codelineno-88-38">38</a></span>
<span class="normal"><a href="#__codelineno-88-39">39</a></span>
<span class="normal"><a href="#__codelineno-88-40">40</a></span>
<span class="normal"><a href="#__codelineno-88-41">41</a></span>
<span class="normal"><a href="#__codelineno-88-42">42</a></span>
<span class="normal"><a href="#__codelineno-88-43">43</a></span>
<span class="normal"><a href="#__codelineno-88-44">44</a></span>
<span class="normal"><a href="#__codelineno-88-45">45</a></span>
<span class="normal"><a href="#__codelineno-88-46">46</a></span>
<span class="normal"><a href="#__codelineno-88-47">47</a></span>
<span class="normal"><a href="#__codelineno-88-48">48</a></span>
<span class="normal"><a href="#__codelineno-88-49">49</a></span>
<span class="normal"><a href="#__codelineno-88-50">50</a></span>
<span class="normal"><a href="#__codelineno-88-51">51</a></span>
<span class="normal"><a href="#__codelineno-88-52">52</a></span>
<span class="normal"><a href="#__codelineno-88-53">53</a></span>
<span class="normal"><a href="#__codelineno-88-54">54</a></span>
<span class="normal"><a href="#__codelineno-88-55">55</a></span>
<span class="normal"><a href="#__codelineno-88-56">56</a></span>
<span class="normal"><a href="#__codelineno-88-57">57</a></span>
<span class="normal"><a href="#__codelineno-88-58">58</a></span>
<span class="normal"><a href="#__codelineno-88-59">59</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-88-1" name="__codelineno-88-1"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-88-2" name="__codelineno-88-2"></a><span class="sd">如果发现你可以直接使用MySQL但是无法使用sqlite3</span>
<a id="__codelineno-88-3" name="__codelineno-88-3"></a><span class="sd">不要慌张不要恐惧 你只需要按照之前MySQL的操作将sqlite3的驱动装一下即可</span>
<a id="__codelineno-88-4" name="__codelineno-88-4"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-88-5" name="__codelineno-88-5"></a><span class="c1"># 需求:在前端给我获取到后端用户表里面所有的数据 并且要是列表套字典</span>
<a id="__codelineno-88-6" name="__codelineno-88-6"></a><span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
<a id="__codelineno-88-7" name="__codelineno-88-7"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.http</span><span class="w"> </span><span class="kn">import</span> <span class="n">JsonResponse</span>
<a id="__codelineno-88-8" name="__codelineno-88-8"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.core</span><span class="w"> </span><span class="kn">import</span> <span class="n">serializers</span>
<a id="__codelineno-88-9" name="__codelineno-88-9"></a><span class="k">def</span><span class="w"> </span><span class="nf">ab_ser</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
<a id="__codelineno-88-10" name="__codelineno-88-10"></a>    <span class="n">user_queryset</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">User</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
<a id="__codelineno-88-11" name="__codelineno-88-11"></a>    <span class="c1"># [{},{},{},{},{}]</span>
<a id="__codelineno-88-12" name="__codelineno-88-12"></a>    <span class="c1"># user_list = []</span>
<a id="__codelineno-88-13" name="__codelineno-88-13"></a>    <span class="c1"># for user_obj in user_queryset:</span>
<a id="__codelineno-88-14" name="__codelineno-88-14"></a>    <span class="c1">#     tmp = {</span>
<a id="__codelineno-88-15" name="__codelineno-88-15"></a>    <span class="c1">#         &#39;pk&#39;:user_obj.pk,</span>
<a id="__codelineno-88-16" name="__codelineno-88-16"></a>    <span class="c1">#         &#39;username&#39;:user_obj.username,</span>
<a id="__codelineno-88-17" name="__codelineno-88-17"></a>    <span class="c1">#         &#39;age&#39;:user_obj.age,</span>
<a id="__codelineno-88-18" name="__codelineno-88-18"></a>    <span class="c1">#         &#39;gender&#39;:user_obj.get_gender_display()</span>
<a id="__codelineno-88-19" name="__codelineno-88-19"></a>    <span class="c1">#     }</span>
<a id="__codelineno-88-20" name="__codelineno-88-20"></a>    <span class="c1">#     user_list.append(tmp)</span>
<a id="__codelineno-88-21" name="__codelineno-88-21"></a>    <span class="c1"># return JsonResponse(user_list,safe=False)</span>
<a id="__codelineno-88-22" name="__codelineno-88-22"></a>    <span class="c1"># return render(request,&#39;ab_ser.html&#39;,locals())</span>
<a id="__codelineno-88-23" name="__codelineno-88-23"></a>
<a id="__codelineno-88-24" name="__codelineno-88-24"></a>    <span class="c1"># 序列化</span>
<a id="__codelineno-88-25" name="__codelineno-88-25"></a>    <span class="n">res</span> <span class="o">=</span> <span class="n">serializers</span><span class="o">.</span><span class="n">serialize</span><span class="p">(</span><span class="s1">&#39;json&#39;</span><span class="p">,</span><span class="n">user_queryset</span><span class="p">)</span>
<a id="__codelineno-88-26" name="__codelineno-88-26"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;会自动帮你将数据变成json格式的字符串 并且内部非常的全面&quot;&quot;&quot;</span>
<a id="__codelineno-88-27" name="__codelineno-88-27"></a>    <span class="k">return</span> <span class="n">HttpResponse</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
<a id="__codelineno-88-28" name="__codelineno-88-28"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-88-29" name="__codelineno-88-29"></a><span class="sd">[</span>
<a id="__codelineno-88-30" name="__codelineno-88-30"></a><span class="sd"> {&quot;pk&quot;: 1, &quot;username&quot;: &quot;jason&quot;, &quot;age&quot;: 25, &quot;gender&quot;: &quot;male&quot;}, </span>
<a id="__codelineno-88-31" name="__codelineno-88-31"></a><span class="sd"> {&quot;pk&quot;: 2, &quot;username&quot;: &quot;egon&quot;, &quot;age&quot;: 31, &quot;gender&quot;: &quot;female&quot;},</span>
<a id="__codelineno-88-32" name="__codelineno-88-32"></a><span class="sd"> {&quot;pk&quot;: 3, &quot;username&quot;: &quot;kevin&quot;, &quot;age&quot;: 32, &quot;gender&quot;: &quot;others&quot;}, </span>
<a id="__codelineno-88-33" name="__codelineno-88-33"></a><span class="sd"> {&quot;pk&quot;: 4, &quot;username&quot;: &quot;tank&quot;, &quot;age&quot;: 40, &quot;gender&quot;: 4}</span>
<a id="__codelineno-88-34" name="__codelineno-88-34"></a><span class="sd"> ]</span>
<a id="__codelineno-88-35" name="__codelineno-88-35"></a><span class="sd">前后端分离的项目</span>
<a id="__codelineno-88-36" name="__codelineno-88-36"></a><span class="sd">    作为后端开发的你只需要写代码将数据处理好</span>
<a id="__codelineno-88-37" name="__codelineno-88-37"></a><span class="sd">    能够序列化返回给前端即可 </span>
<a id="__codelineno-88-38" name="__codelineno-88-38"></a><span class="sd">        再写一个接口文档 告诉前端每个字段代表的意思即可</span>
<a id="__codelineno-88-39" name="__codelineno-88-39"></a>
<a id="__codelineno-88-40" name="__codelineno-88-40"></a>
<a id="__codelineno-88-41" name="__codelineno-88-41"></a><span class="sd">[</span>
<a id="__codelineno-88-42" name="__codelineno-88-42"></a><span class="sd">{   &quot;model&quot;: &quot;app01.user&quot;, </span>
<a id="__codelineno-88-43" name="__codelineno-88-43"></a><span class="sd">    &quot;pk&quot;: 1, </span>
<a id="__codelineno-88-44" name="__codelineno-88-44"></a><span class="sd">    &quot;fields&quot;: {&quot;username&quot;: &quot;jason&quot;, &quot;age&quot;: 25, &quot;gender&quot;: 1}}, </span>
<a id="__codelineno-88-45" name="__codelineno-88-45"></a>
<a id="__codelineno-88-46" name="__codelineno-88-46"></a><span class="sd">{   &quot;model&quot;: &quot;app01.user&quot;, </span>
<a id="__codelineno-88-47" name="__codelineno-88-47"></a><span class="sd">    &quot;pk&quot;: 2, </span>
<a id="__codelineno-88-48" name="__codelineno-88-48"></a><span class="sd">    &quot;fields&quot;: {&quot;username&quot;: &quot;egon&quot;, &quot;age&quot;: 31, &quot;gender&quot;: 2}}, </span>
<a id="__codelineno-88-49" name="__codelineno-88-49"></a>
<a id="__codelineno-88-50" name="__codelineno-88-50"></a><span class="sd">{   &quot;model&quot;: &quot;app01.user&quot;, </span>
<a id="__codelineno-88-51" name="__codelineno-88-51"></a><span class="sd">    &quot;pk&quot;: 3, </span>
<a id="__codelineno-88-52" name="__codelineno-88-52"></a><span class="sd">    &quot;fields&quot;: {&quot;username&quot;: &quot;kevin&quot;, &quot;age&quot;: 32, &quot;gender&quot;: 3}},</span>
<a id="__codelineno-88-53" name="__codelineno-88-53"></a>
<a id="__codelineno-88-54" name="__codelineno-88-54"></a><span class="sd">{   &quot;model&quot;: &quot;app01.user&quot;, </span>
<a id="__codelineno-88-55" name="__codelineno-88-55"></a><span class="sd">    &quot;pk&quot;: 4, </span>
<a id="__codelineno-88-56" name="__codelineno-88-56"></a><span class="sd">    &quot;fields&quot;: {&quot;username&quot;: &quot;tank&quot;, &quot;age&quot;: 40, &quot;gender&quot;: 4}}</span>
<a id="__codelineno-88-57" name="__codelineno-88-57"></a><span class="sd">]</span>
<a id="__codelineno-88-58" name="__codelineno-88-58"></a><span class="sd">写接口就是利用序列化组件渲染数据然后写一个接口文档 该交代交代一下就完事</span>
<a id="__codelineno-88-59" name="__codelineno-88-59"></a><span class="sd">&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
<h3 id="16-9-ajax结合sweetalert">16-9 ajax结合sweetalert<a class="headerlink" href="#16-9-ajax结合sweetalert" title="Permanent link">&para;</a></h3>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">JavaScript</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-89-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-89-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-89-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-89-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-89-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-89-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-89-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-89-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-89-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-89-10">10</a></span>
<span class="normal"><a href="#__codelineno-89-11">11</a></span>
<span class="normal"><a href="#__codelineno-89-12">12</a></span>
<span class="normal"><a href="#__codelineno-89-13">13</a></span>
<span class="normal"><a href="#__codelineno-89-14">14</a></span>
<span class="normal"><a href="#__codelineno-89-15">15</a></span>
<span class="normal"><a href="#__codelineno-89-16">16</a></span>
<span class="normal"><a href="#__codelineno-89-17">17</a></span>
<span class="normal"><a href="#__codelineno-89-18">18</a></span>
<span class="normal"><a href="#__codelineno-89-19">19</a></span>
<span class="normal"><a href="#__codelineno-89-20">20</a></span>
<span class="normal"><a href="#__codelineno-89-21">21</a></span>
<span class="normal"><a href="#__codelineno-89-22">22</a></span>
<span class="normal"><a href="#__codelineno-89-23">23</a></span>
<span class="normal"><a href="#__codelineno-89-24">24</a></span>
<span class="normal"><a href="#__codelineno-89-25">25</a></span>
<span class="normal"><a href="#__codelineno-89-26">26</a></span>
<span class="normal"><a href="#__codelineno-89-27">27</a></span>
<span class="normal"><a href="#__codelineno-89-28">28</a></span>
<span class="normal"><a href="#__codelineno-89-29">29</a></span>
<span class="normal"><a href="#__codelineno-89-30">30</a></span>
<span class="normal"><a href="#__codelineno-89-31">31</a></span>
<span class="normal"><a href="#__codelineno-89-32">32</a></span>
<span class="normal"><a href="#__codelineno-89-33">33</a></span>
<span class="normal"><a href="#__codelineno-89-34">34</a></span>
<span class="normal"><a href="#__codelineno-89-35">35</a></span>
<span class="normal"><a href="#__codelineno-89-36">36</a></span>
<span class="normal"><a href="#__codelineno-89-37">37</a></span>
<span class="normal"><a href="#__codelineno-89-38">38</a></span>
<span class="normal"><a href="#__codelineno-89-39">39</a></span>
<span class="normal"><a href="#__codelineno-89-40">40</a></span>
<span class="normal"><a href="#__codelineno-89-41">41</a></span>
<span class="normal"><a href="#__codelineno-89-42">42</a></span>
<span class="normal"><a href="#__codelineno-89-43">43</a></span>
<span class="normal"><a href="#__codelineno-89-44">44</a></span>
<span class="normal"><a href="#__codelineno-89-45">45</a></span>
<span class="normal"><a href="#__codelineno-89-46">46</a></span>
<span class="normal"><a href="#__codelineno-89-47">47</a></span>
<span class="normal"><a href="#__codelineno-89-48">48</a></span>
<span class="normal"><a href="#__codelineno-89-49">49</a></span>
<span class="normal"><a href="#__codelineno-89-50">50</a></span>
<span class="normal"><a href="#__codelineno-89-51">51</a></span>
<span class="normal"><a href="#__codelineno-89-52">52</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-89-1" name="__codelineno-89-1"></a><span class="cm">/*</span>
<a id="__codelineno-89-2" name="__codelineno-89-2"></a><span class="cm">自己要学会如何拷贝</span>
<a id="__codelineno-89-3" name="__codelineno-89-3"></a><span class="cm">学会基于别人的基础之上做修改</span>
<a id="__codelineno-89-4" name="__codelineno-89-4"></a><span class="cm">研究各个参数表示的意思 然后找葫芦画瓢</span>
<a id="__codelineno-89-5" name="__codelineno-89-5"></a><span class="cm">*/</span>
<a id="__codelineno-89-6" name="__codelineno-89-6"></a><span class="o">&lt;</span><span class="nx">script</span><span class="o">&gt;</span>
<a id="__codelineno-89-7" name="__codelineno-89-7"></a><span class="w">    </span><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;.del&#39;</span><span class="p">).</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;click&#39;</span><span class="p">,</span><span class="kd">function</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-89-8" name="__codelineno-89-8"></a><span class="w">        </span><span class="c1">// 先将当前标签对象存储起来</span>
<a id="__codelineno-89-9" name="__codelineno-89-9"></a><span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="nx">currentBtn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
<a id="__codelineno-89-10" name="__codelineno-89-10"></a><span class="w">        </span><span class="c1">// 二次确认弹框</span>
<a id="__codelineno-89-11" name="__codelineno-89-11"></a><span class="w">        </span><span class="nx">swal</span><span class="p">({</span>
<a id="__codelineno-89-12" name="__codelineno-89-12"></a><span class="w">          </span><span class="nx">title</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;你确定要删吗?&quot;</span><span class="p">,</span>
<a id="__codelineno-89-13" name="__codelineno-89-13"></a><span class="w">          </span><span class="nx">text</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;你可要考虑清除哦，可能需要拎包跑路哦!&quot;</span><span class="p">,</span>
<a id="__codelineno-89-14" name="__codelineno-89-14"></a><span class="w">          </span><span class="nx">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;warning&quot;</span><span class="p">,</span>
<a id="__codelineno-89-15" name="__codelineno-89-15"></a><span class="w">          </span><span class="nx">showCancelButton</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<a id="__codelineno-89-16" name="__codelineno-89-16"></a><span class="w">          </span><span class="nx">confirmButtonClass</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;btn-danger&quot;</span><span class="p">,</span>
<a id="__codelineno-89-17" name="__codelineno-89-17"></a><span class="w">          </span><span class="nx">confirmButtonText</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;是的，老子就要删!&quot;</span><span class="p">,</span>
<a id="__codelineno-89-18" name="__codelineno-89-18"></a><span class="w">          </span><span class="nx">cancelButtonText</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;算了,算了!&quot;</span><span class="p">,</span>
<a id="__codelineno-89-19" name="__codelineno-89-19"></a><span class="w">          </span><span class="nx">closeOnConfirm</span><span class="o">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<a id="__codelineno-89-20" name="__codelineno-89-20"></a><span class="w">          </span><span class="nx">closeOnCancel</span><span class="o">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<a id="__codelineno-89-21" name="__codelineno-89-21"></a><span class="w">          </span><span class="nx">showLoaderOnConfirm</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span>
<a id="__codelineno-89-22" name="__codelineno-89-22"></a><span class="w">        </span><span class="p">},</span>
<a id="__codelineno-89-23" name="__codelineno-89-23"></a><span class="w">        </span><span class="kd">function</span><span class="p">(</span><span class="nx">isConfirm</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-89-24" name="__codelineno-89-24"></a><span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">isConfirm</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-89-25" name="__codelineno-89-25"></a><span class="w">                </span><span class="c1">// 朝后端发送ajax请求删除数据之后 再弹下面的提示框</span>
<a id="__codelineno-89-26" name="__codelineno-89-26"></a><span class="w">                </span><span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
<a id="__codelineno-89-27" name="__codelineno-89-27"></a><span class="w">                    </span><span class="p">{</span><span class="n">#url</span><span class="o">:</span><span class="s1">&#39;/delete/user/&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">currentBtn</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;delete_id&#39;</span><span class="p">),</span><span class="w">  </span><span class="c1">// 1 传递主键值方式1#}</span>
<a id="__codelineno-89-28" name="__codelineno-89-28"></a><span class="w">                    </span><span class="nx">url</span><span class="o">:</span><span class="s1">&#39;/delete/user/&#39;</span><span class="p">,</span><span class="w">  </span><span class="c1">// 2 放在请求体里面</span>
<a id="__codelineno-89-29" name="__codelineno-89-29"></a><span class="w">                    </span><span class="nx">type</span><span class="o">:</span><span class="s1">&#39;post&#39;</span><span class="p">,</span>
<a id="__codelineno-89-30" name="__codelineno-89-30"></a><span class="w">                    </span><span class="nx">data</span><span class="o">:</span><span class="p">{</span><span class="s1">&#39;delete_id&#39;</span><span class="o">:</span><span class="nx">currentBtn</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;delete_id&#39;</span><span class="p">)},</span>
<a id="__codelineno-89-31" name="__codelineno-89-31"></a><span class="w">                    </span><span class="nx">success</span><span class="o">:</span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">  </span><span class="c1">// args = {&#39;code&#39;:&#39;&#39;,&#39;msg&#39;:&#39;&#39;}</span>
<a id="__codelineno-89-32" name="__codelineno-89-32"></a><span class="w">                        </span><span class="c1">// 判断响应状态码 然后做不同的处理</span>
<a id="__codelineno-89-33" name="__codelineno-89-33"></a><span class="w">                        </span><span class="k">if</span><span class="p">(</span><span class="nx">args</span><span class="p">.</span><span class="nx">code</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="mf">1000</span><span class="p">){</span>
<a id="__codelineno-89-34" name="__codelineno-89-34"></a><span class="w">                            </span><span class="nx">swal</span><span class="p">(</span><span class="s2">&quot;删了!&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">args</span><span class="p">.</span><span class="nx">msg</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;success&quot;</span><span class="p">);</span>
<a id="__codelineno-89-35" name="__codelineno-89-35"></a><span class="w">                            </span><span class="c1">// 1.lowb版本 直接刷新当前页面</span>
<a id="__codelineno-89-36" name="__codelineno-89-36"></a><span class="w">                            </span><span class="p">{</span><span class="n">#window</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">reload</span><span class="p">()</span><span class="err">#</span><span class="p">}</span>
<a id="__codelineno-89-37" name="__codelineno-89-37"></a><span class="w">                            </span><span class="c1">// 2.利用DOM操作 动态刷新</span>
<a id="__codelineno-89-38" name="__codelineno-89-38"></a><span class="w">                            </span><span class="nx">currentBtn</span><span class="p">.</span><span class="nx">parent</span><span class="p">().</span><span class="nx">parent</span><span class="p">().</span><span class="nx">remove</span><span class="p">()</span>
<a id="__codelineno-89-39" name="__codelineno-89-39"></a><span class="w">                        </span><span class="p">}</span><span class="k">else</span><span class="p">{</span>
<a id="__codelineno-89-40" name="__codelineno-89-40"></a><span class="w">                            </span><span class="nx">swal</span><span class="p">(</span><span class="s1">&#39;完了&#39;</span><span class="p">,</span><span class="s1">&#39;出现了位置的错误&#39;</span><span class="p">,</span><span class="s1">&#39;info&#39;</span><span class="p">)</span>
<a id="__codelineno-89-41" name="__codelineno-89-41"></a><span class="w">                        </span><span class="p">}</span>
<a id="__codelineno-89-42" name="__codelineno-89-42"></a><span class="w">                    </span><span class="p">}</span>
<a id="__codelineno-89-43" name="__codelineno-89-43"></a>
<a id="__codelineno-89-44" name="__codelineno-89-44"></a><span class="w">                </span><span class="p">})</span>
<a id="__codelineno-89-45" name="__codelineno-89-45"></a>
<a id="__codelineno-89-46" name="__codelineno-89-46"></a><span class="w">          </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-89-47" name="__codelineno-89-47"></a><span class="w">            </span><span class="nx">swal</span><span class="p">(</span><span class="s2">&quot;怂逼&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;不要说我认识你&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;error&quot;</span><span class="p">);</span>
<a id="__codelineno-89-48" name="__codelineno-89-48"></a><span class="w">          </span><span class="p">}</span>
<a id="__codelineno-89-49" name="__codelineno-89-49"></a><span class="w">        </span><span class="p">});</span>
<a id="__codelineno-89-50" name="__codelineno-89-50"></a><span class="w">    </span><span class="p">})</span>
<a id="__codelineno-89-51" name="__codelineno-89-51"></a>
<a id="__codelineno-89-52" name="__codelineno-89-52"></a><span class="o">&lt;</span><span class="err">/script&gt;</span>
</code></pre></div></td></tr></table></div>
<h3 id="16-10-批量插入">16-10 批量插入<a class="headerlink" href="#16-10-批量插入" title="Permanent link">&para;</a></h3>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-90-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-90-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-90-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-90-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-90-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-90-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-90-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-90-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-90-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-90-10">10</a></span>
<span class="normal"><a href="#__codelineno-90-11">11</a></span>
<span class="normal"><a href="#__codelineno-90-12">12</a></span>
<span class="normal"><a href="#__codelineno-90-13">13</a></span>
<span class="normal"><a href="#__codelineno-90-14">14</a></span>
<span class="normal"><a href="#__codelineno-90-15">15</a></span>
<span class="normal"><a href="#__codelineno-90-16">16</a></span>
<span class="normal"><a href="#__codelineno-90-17">17</a></span>
<span class="normal"><a href="#__codelineno-90-18">18</a></span>
<span class="normal"><a href="#__codelineno-90-19">19</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-90-1" name="__codelineno-90-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">ab_pl</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
<a id="__codelineno-90-2" name="__codelineno-90-2"></a>    <span class="c1"># 先给Book插入一万条数据</span>
<a id="__codelineno-90-3" name="__codelineno-90-3"></a>    <span class="c1"># for i in range(10000):</span>
<a id="__codelineno-90-4" name="__codelineno-90-4"></a>    <span class="c1">#     models.Book.objects.create(title=&#39;第%s本书&#39;%i)</span>
<a id="__codelineno-90-5" name="__codelineno-90-5"></a>    <span class="c1"># # 再将所有的数据查询并展示到前端页面</span>
<a id="__codelineno-90-6" name="__codelineno-90-6"></a>    <span class="n">book_queryset</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Book</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
<a id="__codelineno-90-7" name="__codelineno-90-7"></a>
<a id="__codelineno-90-8" name="__codelineno-90-8"></a>    <span class="c1"># 批量插入</span>
<a id="__codelineno-90-9" name="__codelineno-90-9"></a>    <span class="n">book_list</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-90-10" name="__codelineno-90-10"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100000</span><span class="p">):</span>
<a id="__codelineno-90-11" name="__codelineno-90-11"></a>        <span class="n">book_obj</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Book</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;第</span><span class="si">%s</span><span class="s1">本书&#39;</span><span class="o">%</span><span class="n">i</span><span class="p">)</span>
<a id="__codelineno-90-12" name="__codelineno-90-12"></a>        <span class="n">book_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">book_obj</span><span class="p">)</span>
<a id="__codelineno-90-13" name="__codelineno-90-13"></a>    <span class="n">models</span><span class="o">.</span><span class="n">Book</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">bulk_create</span><span class="p">(</span><span class="n">book_list</span><span class="p">)</span>
<a id="__codelineno-90-14" name="__codelineno-90-14"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-90-15" name="__codelineno-90-15"></a><span class="sd">    当你想要批量插入数据的时候 使用orm给你提供的bulk_create能够大大的减少操作时间</span>
<a id="__codelineno-90-16" name="__codelineno-90-16"></a><span class="sd">    :param request: </span>
<a id="__codelineno-90-17" name="__codelineno-90-17"></a><span class="sd">    :return: </span>
<a id="__codelineno-90-18" name="__codelineno-90-18"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-90-19" name="__codelineno-90-19"></a>    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span><span class="s1">&#39;ab_pl.html&#39;</span><span class="p">,</span><span class="nb">locals</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
<h3 id="16-11-分页器">16-11 分页器<a class="headerlink" href="#16-11-分页器" title="Permanent link">&para;</a></h3>
<h4 id="11-1-基础班">11-1 基础班<a class="headerlink" href="#11-1-基础班" title="Permanent link">&para;</a></h4>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-91-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-91-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-91-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-91-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-91-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-91-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-91-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-91-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-91-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-91-10">10</a></span>
<span class="normal"><a href="#__codelineno-91-11">11</a></span>
<span class="normal"><a href="#__codelineno-91-12">12</a></span>
<span class="normal"><a href="#__codelineno-91-13">13</a></span>
<span class="normal"><a href="#__codelineno-91-14">14</a></span>
<span class="normal"><a href="#__codelineno-91-15">15</a></span>
<span class="normal"><a href="#__codelineno-91-16">16</a></span>
<span class="normal"><a href="#__codelineno-91-17">17</a></span>
<span class="normal"><a href="#__codelineno-91-18">18</a></span>
<span class="normal"><a href="#__codelineno-91-19">19</a></span>
<span class="normal"><a href="#__codelineno-91-20">20</a></span>
<span class="normal"><a href="#__codelineno-91-21">21</a></span>
<span class="normal"><a href="#__codelineno-91-22">22</a></span>
<span class="normal"><a href="#__codelineno-91-23">23</a></span>
<span class="normal"><a href="#__codelineno-91-24">24</a></span>
<span class="normal"><a href="#__codelineno-91-25">25</a></span>
<span class="normal"><a href="#__codelineno-91-26">26</a></span>
<span class="normal"><a href="#__codelineno-91-27">27</a></span>
<span class="normal"><a href="#__codelineno-91-28">28</a></span>
<span class="normal"><a href="#__codelineno-91-29">29</a></span>
<span class="normal"><a href="#__codelineno-91-30">30</a></span>
<span class="normal"><a href="#__codelineno-91-31">31</a></span>
<span class="normal"><a href="#__codelineno-91-32">32</a></span>
<span class="normal"><a href="#__codelineno-91-33">33</a></span>
<span class="normal"><a href="#__codelineno-91-34">34</a></span>
<span class="normal"><a href="#__codelineno-91-35">35</a></span>
<span class="normal"><a href="#__codelineno-91-36">36</a></span>
<span class="normal"><a href="#__codelineno-91-37">37</a></span>
<span class="normal"><a href="#__codelineno-91-38">38</a></span>
<span class="normal"><a href="#__codelineno-91-39">39</a></span>
<span class="normal"><a href="#__codelineno-91-40">40</a></span>
<span class="normal"><a href="#__codelineno-91-41">41</a></span>
<span class="normal"><a href="#__codelineno-91-42">42</a></span>
<span class="normal"><a href="#__codelineno-91-43">43</a></span>
<span class="normal"><a href="#__codelineno-91-44">44</a></span>
<span class="normal"><a href="#__codelineno-91-45">45</a></span>
<span class="normal"><a href="#__codelineno-91-46">46</a></span>
<span class="normal"><a href="#__codelineno-91-47">47</a></span>
<span class="normal"><a href="#__codelineno-91-48">48</a></span>
<span class="normal"><a href="#__codelineno-91-49">49</a></span>
<span class="normal"><a href="#__codelineno-91-50">50</a></span>
<span class="normal"><a href="#__codelineno-91-51">51</a></span>
<span class="normal"><a href="#__codelineno-91-52">52</a></span>
<span class="normal"><a href="#__codelineno-91-53">53</a></span>
<span class="normal"><a href="#__codelineno-91-54">54</a></span>
<span class="normal"><a href="#__codelineno-91-55">55</a></span>
<span class="normal"><a href="#__codelineno-91-56">56</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-91-1" name="__codelineno-91-1"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-91-2" name="__codelineno-91-2"></a><span class="sd">总数据100 每页展示10 需要10</span>
<a id="__codelineno-91-3" name="__codelineno-91-3"></a><span class="sd">总数据101 每页展示10 需要11</span>
<a id="__codelineno-91-4" name="__codelineno-91-4"></a><span class="sd">总数据99 每页展示10  需要10</span>
<a id="__codelineno-91-5" name="__codelineno-91-5"></a>
<a id="__codelineno-91-6" name="__codelineno-91-6"></a><span class="sd">如何通过代码动态的计算出到底需要多少页？</span>
<a id="__codelineno-91-7" name="__codelineno-91-7"></a>
<a id="__codelineno-91-8" name="__codelineno-91-8"></a><span class="sd">在制作页码个数的时候 一般情况下都是奇数个       符合中国人对称美的标准</span>
<a id="__codelineno-91-9" name="__codelineno-91-9"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-91-10" name="__codelineno-91-10"></a><span class="c1"># 分页</span>
<a id="__codelineno-91-11" name="__codelineno-91-11"></a>    <span class="n">book_list</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Book</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
<a id="__codelineno-91-12" name="__codelineno-91-12"></a>
<a id="__codelineno-91-13" name="__codelineno-91-13"></a>    <span class="c1"># 想访问哪一页</span>
<a id="__codelineno-91-14" name="__codelineno-91-14"></a>    <span class="n">current_page</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;page&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># 如果获取不到当前页码 就展示第一页</span>
<a id="__codelineno-91-15" name="__codelineno-91-15"></a>    <span class="c1"># 数据类型转换</span>
<a id="__codelineno-91-16" name="__codelineno-91-16"></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-91-17" name="__codelineno-91-17"></a>        <span class="n">current_page</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">current_page</span><span class="p">)</span>
<a id="__codelineno-91-18" name="__codelineno-91-18"></a>    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
<a id="__codelineno-91-19" name="__codelineno-91-19"></a>        <span class="n">current_page</span> <span class="o">=</span> <span class="mi">1</span>
<a id="__codelineno-91-20" name="__codelineno-91-20"></a>    <span class="c1"># 每页展示多少条</span>
<a id="__codelineno-91-21" name="__codelineno-91-21"></a>    <span class="n">per_page_num</span> <span class="o">=</span> <span class="mi">10</span>
<a id="__codelineno-91-22" name="__codelineno-91-22"></a>    <span class="c1"># 起始位置</span>
<a id="__codelineno-91-23" name="__codelineno-91-23"></a>    <span class="n">start_page</span> <span class="o">=</span> <span class="p">(</span><span class="n">current_page</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">per_page_num</span>
<a id="__codelineno-91-24" name="__codelineno-91-24"></a>    <span class="c1"># 终止位置</span>
<a id="__codelineno-91-25" name="__codelineno-91-25"></a>    <span class="n">end_page</span> <span class="o">=</span> <span class="n">current_page</span> <span class="o">*</span> <span class="n">per_page_num</span>
<a id="__codelineno-91-26" name="__codelineno-91-26"></a>
<a id="__codelineno-91-27" name="__codelineno-91-27"></a>    <span class="c1"># 计算出到底需要多少页</span>
<a id="__codelineno-91-28" name="__codelineno-91-28"></a>    <span class="n">all_count</span> <span class="o">=</span> <span class="n">book_list</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
<a id="__codelineno-91-29" name="__codelineno-91-29"></a>
<a id="__codelineno-91-30" name="__codelineno-91-30"></a>    <span class="n">page_count</span><span class="p">,</span> <span class="n">more</span> <span class="o">=</span> <span class="nb">divmod</span><span class="p">(</span><span class="n">all_count</span><span class="p">,</span> <span class="n">per_page_num</span><span class="p">)</span>
<a id="__codelineno-91-31" name="__codelineno-91-31"></a>    <span class="k">if</span> <span class="n">more</span><span class="p">:</span>
<a id="__codelineno-91-32" name="__codelineno-91-32"></a>        <span class="n">page_count</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-91-33" name="__codelineno-91-33"></a>
<a id="__codelineno-91-34" name="__codelineno-91-34"></a>    <span class="n">page_html</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<a id="__codelineno-91-35" name="__codelineno-91-35"></a>    <span class="n">xxx</span> <span class="o">=</span> <span class="n">current_page</span>
<a id="__codelineno-91-36" name="__codelineno-91-36"></a>    <span class="k">if</span> <span class="n">current_page</span> <span class="o">&lt;</span> <span class="mi">6</span><span class="p">:</span>
<a id="__codelineno-91-37" name="__codelineno-91-37"></a>        <span class="n">current_page</span> <span class="o">=</span> <span class="mi">6</span>
<a id="__codelineno-91-38" name="__codelineno-91-38"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">current_page</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="n">current_page</span><span class="o">+</span><span class="mi">6</span><span class="p">):</span>
<a id="__codelineno-91-39" name="__codelineno-91-39"></a>        <span class="k">if</span> <span class="n">xxx</span> <span class="o">==</span> <span class="n">i</span><span class="p">:</span>
<a id="__codelineno-91-40" name="__codelineno-91-40"></a>            <span class="n">page_html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;li class=&quot;active&quot;&gt;&lt;a href=&quot;?page=</span><span class="si">%s</span><span class="s1">&quot;&gt;</span><span class="si">%s</span><span class="s1">&lt;/a&gt;&lt;/li&gt;&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="p">)</span>
<a id="__codelineno-91-41" name="__codelineno-91-41"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-91-42" name="__codelineno-91-42"></a>            <span class="n">page_html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;li&gt;&lt;a href=&quot;?page=</span><span class="si">%s</span><span class="s1">&quot;&gt;</span><span class="si">%s</span><span class="s1">&lt;/a&gt;&lt;/li&gt;&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="p">)</span>
<a id="__codelineno-91-43" name="__codelineno-91-43"></a>
<a id="__codelineno-91-44" name="__codelineno-91-44"></a>
<a id="__codelineno-91-45" name="__codelineno-91-45"></a>
<a id="__codelineno-91-46" name="__codelineno-91-46"></a>    <span class="n">book_queryset</span> <span class="o">=</span>  <span class="n">book_list</span><span class="p">[</span><span class="n">start_page</span><span class="p">:</span><span class="n">end_page</span><span class="p">]</span>
<a id="__codelineno-91-47" name="__codelineno-91-47"></a>
<a id="__codelineno-91-48" name="__codelineno-91-48"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-91-49" name="__codelineno-91-49"></a><span class="sd">django中有自带的分页器模块 但是书写起来很麻烦并且功能太简单</span>
<a id="__codelineno-91-50" name="__codelineno-91-50"></a><span class="sd">所以我们自己想法和设法的写自定义分页器</span>
<a id="__codelineno-91-51" name="__codelineno-91-51"></a>
<a id="__codelineno-91-52" name="__codelineno-91-52"></a><span class="sd">上述推导代码你无需掌握 只需要知道内部逻辑即可</span>
<a id="__codelineno-91-53" name="__codelineno-91-53"></a>
<a id="__codelineno-91-54" name="__codelineno-91-54"></a><span class="sd">我们基于上述的思路 已经封装好了我们自己的自定义分页器 </span>
<a id="__codelineno-91-55" name="__codelineno-91-55"></a><span class="sd">之后需要使用直接拷贝即可</span>
<a id="__codelineno-91-56" name="__codelineno-91-56"></a><span class="sd">&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
<h4 id="11-2-现成的代码直接用">11-2 现成的代码（直接用）<a class="headerlink" href="#11-2-现成的代码直接用" title="Permanent link">&para;</a></h4>
<h5 id="utilsmypagepy">utils.mypage.py<a class="headerlink" href="#utilsmypagepy" title="Permanent link">&para;</a></h5>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Text Only</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-92-1">  1</a></span>
<span class="normal"><a href="#__codelineno-92-2">  2</a></span>
<span class="normal"><a href="#__codelineno-92-3">  3</a></span>
<span class="normal"><a href="#__codelineno-92-4">  4</a></span>
<span class="normal"><a href="#__codelineno-92-5">  5</a></span>
<span class="normal"><a href="#__codelineno-92-6">  6</a></span>
<span class="normal"><a href="#__codelineno-92-7">  7</a></span>
<span class="normal"><a href="#__codelineno-92-8">  8</a></span>
<span class="normal"><a href="#__codelineno-92-9">  9</a></span>
<span class="normal"><a href="#__codelineno-92-10"> 10</a></span>
<span class="normal"><a href="#__codelineno-92-11"> 11</a></span>
<span class="normal"><a href="#__codelineno-92-12"> 12</a></span>
<span class="normal"><a href="#__codelineno-92-13"> 13</a></span>
<span class="normal"><a href="#__codelineno-92-14"> 14</a></span>
<span class="normal"><a href="#__codelineno-92-15"> 15</a></span>
<span class="normal"><a href="#__codelineno-92-16"> 16</a></span>
<span class="normal"><a href="#__codelineno-92-17"> 17</a></span>
<span class="normal"><a href="#__codelineno-92-18"> 18</a></span>
<span class="normal"><a href="#__codelineno-92-19"> 19</a></span>
<span class="normal"><a href="#__codelineno-92-20"> 20</a></span>
<span class="normal"><a href="#__codelineno-92-21"> 21</a></span>
<span class="normal"><a href="#__codelineno-92-22"> 22</a></span>
<span class="normal"><a href="#__codelineno-92-23"> 23</a></span>
<span class="normal"><a href="#__codelineno-92-24"> 24</a></span>
<span class="normal"><a href="#__codelineno-92-25"> 25</a></span>
<span class="normal"><a href="#__codelineno-92-26"> 26</a></span>
<span class="normal"><a href="#__codelineno-92-27"> 27</a></span>
<span class="normal"><a href="#__codelineno-92-28"> 28</a></span>
<span class="normal"><a href="#__codelineno-92-29"> 29</a></span>
<span class="normal"><a href="#__codelineno-92-30"> 30</a></span>
<span class="normal"><a href="#__codelineno-92-31"> 31</a></span>
<span class="normal"><a href="#__codelineno-92-32"> 32</a></span>
<span class="normal"><a href="#__codelineno-92-33"> 33</a></span>
<span class="normal"><a href="#__codelineno-92-34"> 34</a></span>
<span class="normal"><a href="#__codelineno-92-35"> 35</a></span>
<span class="normal"><a href="#__codelineno-92-36"> 36</a></span>
<span class="normal"><a href="#__codelineno-92-37"> 37</a></span>
<span class="normal"><a href="#__codelineno-92-38"> 38</a></span>
<span class="normal"><a href="#__codelineno-92-39"> 39</a></span>
<span class="normal"><a href="#__codelineno-92-40"> 40</a></span>
<span class="normal"><a href="#__codelineno-92-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-92-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-92-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-92-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-92-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-92-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-92-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-92-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-92-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-92-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-92-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-92-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-92-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-92-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-92-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-92-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-92-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-92-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-92-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-92-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-92-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-92-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-92-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-92-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-92-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-92-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-92-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-92-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-92-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-92-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-92-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-92-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-92-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-92-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-92-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-92-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-92-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-92-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-92-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-92-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-92-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-92-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-92-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-92-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-92-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-92-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-92-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-92-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-92-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-92-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-92-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-92-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-92-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-92-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-92-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-92-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-92-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-92-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-92-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-92-100">100</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-92-1" name="__codelineno-92-1"></a>class Pagination(object):
<a id="__codelineno-92-2" name="__codelineno-92-2"></a>    def __init__(self, current_page, all_count, per_page_num=10, pager_count=11):
<a id="__codelineno-92-3" name="__codelineno-92-3"></a>        &quot;&quot;&quot;
<a id="__codelineno-92-4" name="__codelineno-92-4"></a>        封装分页相关数据
<a id="__codelineno-92-5" name="__codelineno-92-5"></a>        :param current_page: 当前页
<a id="__codelineno-92-6" name="__codelineno-92-6"></a>        :param all_count:    数据库中的数据总条数
<a id="__codelineno-92-7" name="__codelineno-92-7"></a>        :param per_page_num: 每页显示的数据条数
<a id="__codelineno-92-8" name="__codelineno-92-8"></a>        :param pager_count:  最多显示的页码个数
<a id="__codelineno-92-9" name="__codelineno-92-9"></a>        &quot;&quot;&quot;
<a id="__codelineno-92-10" name="__codelineno-92-10"></a>        try:
<a id="__codelineno-92-11" name="__codelineno-92-11"></a>            current_page = int(current_page)
<a id="__codelineno-92-12" name="__codelineno-92-12"></a>        except Exception as e:
<a id="__codelineno-92-13" name="__codelineno-92-13"></a>            current_page = 1
<a id="__codelineno-92-14" name="__codelineno-92-14"></a>
<a id="__codelineno-92-15" name="__codelineno-92-15"></a>        if current_page &lt; 1:
<a id="__codelineno-92-16" name="__codelineno-92-16"></a>            current_page = 1
<a id="__codelineno-92-17" name="__codelineno-92-17"></a>
<a id="__codelineno-92-18" name="__codelineno-92-18"></a>        self.current_page = current_page
<a id="__codelineno-92-19" name="__codelineno-92-19"></a>
<a id="__codelineno-92-20" name="__codelineno-92-20"></a>        self.all_count = all_count
<a id="__codelineno-92-21" name="__codelineno-92-21"></a>        self.per_page_num = per_page_num
<a id="__codelineno-92-22" name="__codelineno-92-22"></a>
<a id="__codelineno-92-23" name="__codelineno-92-23"></a>        # 总页码
<a id="__codelineno-92-24" name="__codelineno-92-24"></a>        all_pager, tmp = divmod(all_count, per_page_num)
<a id="__codelineno-92-25" name="__codelineno-92-25"></a>        if tmp:
<a id="__codelineno-92-26" name="__codelineno-92-26"></a>            all_pager += 1
<a id="__codelineno-92-27" name="__codelineno-92-27"></a>        self.all_pager = all_pager
<a id="__codelineno-92-28" name="__codelineno-92-28"></a>
<a id="__codelineno-92-29" name="__codelineno-92-29"></a>        self.pager_count = pager_count
<a id="__codelineno-92-30" name="__codelineno-92-30"></a>        self.pager_count_half = int((pager_count - 1) / 2)
<a id="__codelineno-92-31" name="__codelineno-92-31"></a>
<a id="__codelineno-92-32" name="__codelineno-92-32"></a>    @property
<a id="__codelineno-92-33" name="__codelineno-92-33"></a>    def start(self):
<a id="__codelineno-92-34" name="__codelineno-92-34"></a>        return (self.current_page - 1) * self.per_page_num
<a id="__codelineno-92-35" name="__codelineno-92-35"></a>
<a id="__codelineno-92-36" name="__codelineno-92-36"></a>    @property
<a id="__codelineno-92-37" name="__codelineno-92-37"></a>    def end(self):
<a id="__codelineno-92-38" name="__codelineno-92-38"></a>        return self.current_page * self.per_page_num
<a id="__codelineno-92-39" name="__codelineno-92-39"></a>
<a id="__codelineno-92-40" name="__codelineno-92-40"></a>    def page_html(self):
<a id="__codelineno-92-41" name="__codelineno-92-41"></a>        # 如果总页码 &lt; 11个：
<a id="__codelineno-92-42" name="__codelineno-92-42"></a>        if self.all_pager &lt;= self.pager_count:
<a id="__codelineno-92-43" name="__codelineno-92-43"></a>            pager_start = 1
<a id="__codelineno-92-44" name="__codelineno-92-44"></a>            pager_end = self.all_pager + 1
<a id="__codelineno-92-45" name="__codelineno-92-45"></a>        # 总页码  &gt; 11
<a id="__codelineno-92-46" name="__codelineno-92-46"></a>        else:
<a id="__codelineno-92-47" name="__codelineno-92-47"></a>            # 当前页如果&lt;=页面上最多显示11/2个页码
<a id="__codelineno-92-48" name="__codelineno-92-48"></a>            if self.current_page &lt;= self.pager_count_half:
<a id="__codelineno-92-49" name="__codelineno-92-49"></a>                pager_start = 1
<a id="__codelineno-92-50" name="__codelineno-92-50"></a>                pager_end = self.pager_count + 1
<a id="__codelineno-92-51" name="__codelineno-92-51"></a>
<a id="__codelineno-92-52" name="__codelineno-92-52"></a>            # 当前页大于5
<a id="__codelineno-92-53" name="__codelineno-92-53"></a>            else:
<a id="__codelineno-92-54" name="__codelineno-92-54"></a>                # 页码翻到最后
<a id="__codelineno-92-55" name="__codelineno-92-55"></a>                if (self.current_page + self.pager_count_half) &gt; self.all_pager:
<a id="__codelineno-92-56" name="__codelineno-92-56"></a>                    pager_end = self.all_pager + 1
<a id="__codelineno-92-57" name="__codelineno-92-57"></a>                    pager_start = self.all_pager - self.pager_count + 1
<a id="__codelineno-92-58" name="__codelineno-92-58"></a>                else:
<a id="__codelineno-92-59" name="__codelineno-92-59"></a>                    pager_start = self.current_page - self.pager_count_half
<a id="__codelineno-92-60" name="__codelineno-92-60"></a>                    pager_end = self.current_page + self.pager_count_half + 1
<a id="__codelineno-92-61" name="__codelineno-92-61"></a>
<a id="__codelineno-92-62" name="__codelineno-92-62"></a>        page_html_list = []
<a id="__codelineno-92-63" name="__codelineno-92-63"></a>        # 添加前面的nav和ul标签
<a id="__codelineno-92-64" name="__codelineno-92-64"></a>        page_html_list.append(&#39;&#39;&#39;
<a id="__codelineno-92-65" name="__codelineno-92-65"></a>                    &lt;nav aria-label=&#39;Page navigation&gt;&#39;
<a id="__codelineno-92-66" name="__codelineno-92-66"></a>                    &lt;ul class=&#39;pagination&#39;&gt;
<a id="__codelineno-92-67" name="__codelineno-92-67"></a>                &#39;&#39;&#39;)
<a id="__codelineno-92-68" name="__codelineno-92-68"></a>        first_page = &#39;&lt;li&gt;&lt;a href=&quot;?page=%s&quot;&gt;首页&lt;/a&gt;&lt;/li&gt;&#39; % (1)
<a id="__codelineno-92-69" name="__codelineno-92-69"></a>        page_html_list.append(first_page)
<a id="__codelineno-92-70" name="__codelineno-92-70"></a>
<a id="__codelineno-92-71" name="__codelineno-92-71"></a>        if self.current_page &lt;= 1:
<a id="__codelineno-92-72" name="__codelineno-92-72"></a>            prev_page = &#39;&lt;li class=&quot;disabled&quot;&gt;&lt;a href=&quot;#&quot;&gt;上一页&lt;/a&gt;&lt;/li&gt;&#39;
<a id="__codelineno-92-73" name="__codelineno-92-73"></a>        else:
<a id="__codelineno-92-74" name="__codelineno-92-74"></a>            prev_page = &#39;&lt;li&gt;&lt;a href=&quot;?page=%s&quot;&gt;上一页&lt;/a&gt;&lt;/li&gt;&#39; % (self.current_page - 1,)
<a id="__codelineno-92-75" name="__codelineno-92-75"></a>
<a id="__codelineno-92-76" name="__codelineno-92-76"></a>        page_html_list.append(prev_page)
<a id="__codelineno-92-77" name="__codelineno-92-77"></a>
<a id="__codelineno-92-78" name="__codelineno-92-78"></a>        for i in range(pager_start, pager_end):
<a id="__codelineno-92-79" name="__codelineno-92-79"></a>            if i == self.current_page:
<a id="__codelineno-92-80" name="__codelineno-92-80"></a>                temp = &#39;&lt;li class=&quot;active&quot;&gt;&lt;a href=&quot;?page=%s&quot;&gt;%s&lt;/a&gt;&lt;/li&gt;&#39; % (i, i,)
<a id="__codelineno-92-81" name="__codelineno-92-81"></a>            else:
<a id="__codelineno-92-82" name="__codelineno-92-82"></a>                temp = &#39;&lt;li&gt;&lt;a href=&quot;?page=%s&quot;&gt;%s&lt;/a&gt;&lt;/li&gt;&#39; % (i, i,)
<a id="__codelineno-92-83" name="__codelineno-92-83"></a>            page_html_list.append(temp)
<a id="__codelineno-92-84" name="__codelineno-92-84"></a>
<a id="__codelineno-92-85" name="__codelineno-92-85"></a>        if self.current_page &gt;= self.all_pager:
<a id="__codelineno-92-86" name="__codelineno-92-86"></a>            next_page = &#39;&lt;li class=&quot;disabled&quot;&gt;&lt;a href=&quot;#&quot;&gt;下一页&lt;/a&gt;&lt;/li&gt;&#39;
<a id="__codelineno-92-87" name="__codelineno-92-87"></a>        else:
<a id="__codelineno-92-88" name="__codelineno-92-88"></a>            next_page = &#39;&lt;li&gt;&lt;a href=&quot;?page=%s&quot;&gt;下一页&lt;/a&gt;&lt;/li&gt;&#39; % (self.current_page + 1,)
<a id="__codelineno-92-89" name="__codelineno-92-89"></a>        page_html_list.append(next_page)
<a id="__codelineno-92-90" name="__codelineno-92-90"></a>
<a id="__codelineno-92-91" name="__codelineno-92-91"></a>        last_page = &#39;&lt;li&gt;&lt;a href=&quot;?page=%s&quot;&gt;尾页&lt;/a&gt;&lt;/li&gt;&#39; % (self.all_pager,)
<a id="__codelineno-92-92" name="__codelineno-92-92"></a>        page_html_list.append(last_page)
<a id="__codelineno-92-93" name="__codelineno-92-93"></a>        # 尾部添加标签
<a id="__codelineno-92-94" name="__codelineno-92-94"></a>        page_html_list.append(&#39;&#39;&#39;
<a id="__codelineno-92-95" name="__codelineno-92-95"></a>                                           &lt;/nav&gt;
<a id="__codelineno-92-96" name="__codelineno-92-96"></a>
<a id="__codelineno-92-97" name="__codelineno-92-97"></a>                                           &lt;/ul&gt;
<a id="__codelineno-92-98" name="__codelineno-92-98"></a>
<a id="__codelineno-92-99" name="__codelineno-92-99"></a>                                       &#39;&#39;&#39;)
<a id="__codelineno-92-100" name="__codelineno-92-100"></a>        return &#39;&#39;.join(page_html_list)
</code></pre></div></td></tr></table></div>
<h5 id="viewspy">views.py<a class="headerlink" href="#viewspy" title="Permanent link">&para;</a></h5>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Text Only</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-93-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-93-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-93-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-93-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-93-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-93-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-93-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-93-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-93-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-93-10">10</a></span>
<span class="normal"><a href="#__codelineno-93-11">11</a></span>
<span class="normal"><a href="#__codelineno-93-12">12</a></span>
<span class="normal"><a href="#__codelineno-93-13">13</a></span>
<span class="normal"><a href="#__codelineno-93-14">14</a></span>
<span class="normal"><a href="#__codelineno-93-15">15</a></span>
<span class="normal"><a href="#__codelineno-93-16">16</a></span>
<span class="normal"><a href="#__codelineno-93-17">17</a></span>
<span class="normal"><a href="#__codelineno-93-18">18</a></span>
<span class="normal"><a href="#__codelineno-93-19">19</a></span>
<span class="normal"><a href="#__codelineno-93-20">20</a></span>
<span class="normal"><a href="#__codelineno-93-21">21</a></span>
<span class="normal"><a href="#__codelineno-93-22">22</a></span>
<span class="normal"><a href="#__codelineno-93-23">23</a></span>
<span class="normal"><a href="#__codelineno-93-24">24</a></span>
<span class="normal"><a href="#__codelineno-93-25">25</a></span>
<span class="normal"><a href="#__codelineno-93-26">26</a></span>
<span class="normal"><a href="#__codelineno-93-27">27</a></span>
<span class="normal"><a href="#__codelineno-93-28">28</a></span>
<span class="normal"><a href="#__codelineno-93-29">29</a></span>
<span class="normal"><a href="#__codelineno-93-30">30</a></span>
<span class="normal"><a href="#__codelineno-93-31">31</a></span>
<span class="normal"><a href="#__codelineno-93-32">32</a></span>
<span class="normal"><a href="#__codelineno-93-33">33</a></span>
<span class="normal"><a href="#__codelineno-93-34">34</a></span>
<span class="normal"><a href="#__codelineno-93-35">35</a></span>
<span class="normal"><a href="#__codelineno-93-36">36</a></span>
<span class="normal"><a href="#__codelineno-93-37">37</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-93-1" name="__codelineno-93-1"></a>from django.shortcuts import render,HttpResponse
<a id="__codelineno-93-2" name="__codelineno-93-2"></a>from app01 import models
<a id="__codelineno-93-3" name="__codelineno-93-3"></a>
<a id="__codelineno-93-4" name="__codelineno-93-4"></a>
<a id="__codelineno-93-5" name="__codelineno-93-5"></a>from utils.mypage import Pagination
<a id="__codelineno-93-6" name="__codelineno-93-6"></a>
<a id="__codelineno-93-7" name="__codelineno-93-7"></a>def ab_pl(request):
<a id="__codelineno-93-8" name="__codelineno-93-8"></a>
<a id="__codelineno-93-9" name="__codelineno-93-9"></a>    book_queryset = models.Book.objects.all()
<a id="__codelineno-93-10" name="__codelineno-93-10"></a>    current_page = request.GET.get(&#39;page&#39;,1)
<a id="__codelineno-93-11" name="__codelineno-93-11"></a>    all_count = book_queryset.count()
<a id="__codelineno-93-12" name="__codelineno-93-12"></a>
<a id="__codelineno-93-13" name="__codelineno-93-13"></a>    # 1 传值生成对象
<a id="__codelineno-93-14" name="__codelineno-93-14"></a>    page_obj = Pagination(current_page=current_page,all_count=all_count)
<a id="__codelineno-93-15" name="__codelineno-93-15"></a>    # 2 直接对总数据进行切片操作
<a id="__codelineno-93-16" name="__codelineno-93-16"></a>    page_queryset = book_queryset[page_obj.start:page_obj.end]
<a id="__codelineno-93-17" name="__codelineno-93-17"></a>    # 3 将page_queryset传递到页面 替换之前的book_queryset
<a id="__codelineno-93-18" name="__codelineno-93-18"></a>    return render(request,&#39;ab_pl.html&#39;,locals())
<a id="__codelineno-93-19" name="__codelineno-93-19"></a>&quot;&quot;&quot;
<a id="__codelineno-93-20" name="__codelineno-93-20"></a>per_page_num = 10
<a id="__codelineno-93-21" name="__codelineno-93-21"></a>current_page                start_page                  end_page
<a id="__codelineno-93-22" name="__codelineno-93-22"></a>    1                           0                           10
<a id="__codelineno-93-23" name="__codelineno-93-23"></a>    2                           10                          20
<a id="__codelineno-93-24" name="__codelineno-93-24"></a>    3                           20                          30
<a id="__codelineno-93-25" name="__codelineno-93-25"></a>    4                           30                          40
<a id="__codelineno-93-26" name="__codelineno-93-26"></a>
<a id="__codelineno-93-27" name="__codelineno-93-27"></a>
<a id="__codelineno-93-28" name="__codelineno-93-28"></a>per_page_num = 5
<a id="__codelineno-93-29" name="__codelineno-93-29"></a>current_page                start_page                  end_page
<a id="__codelineno-93-30" name="__codelineno-93-30"></a>    1                           0                           5
<a id="__codelineno-93-31" name="__codelineno-93-31"></a>    2                           5                           10
<a id="__codelineno-93-32" name="__codelineno-93-32"></a>    3                           10                          15
<a id="__codelineno-93-33" name="__codelineno-93-33"></a>    4                           15                          20
<a id="__codelineno-93-34" name="__codelineno-93-34"></a>
<a id="__codelineno-93-35" name="__codelineno-93-35"></a>start_page = (current_page - 1) * per_page_num
<a id="__codelineno-93-36" name="__codelineno-93-36"></a>end_page = current_page * per_page_num
<a id="__codelineno-93-37" name="__codelineno-93-37"></a>&quot;&quot;&quot;
</code></pre></div></td></tr></table></div>
<h5 id="ab_plhtml">ab_pl.html<a class="headerlink" href="#ab_plhtml" title="Permanent link">&para;</a></h5>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">HTML</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-94-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-94-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-94-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-94-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-94-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-94-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-94-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-94-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-94-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-94-10">10</a></span>
<span class="normal"><a href="#__codelineno-94-11">11</a></span>
<span class="normal"><a href="#__codelineno-94-12">12</a></span>
<span class="normal"><a href="#__codelineno-94-13">13</a></span>
<span class="normal"><a href="#__codelineno-94-14">14</a></span>
<span class="normal"><a href="#__codelineno-94-15">15</a></span>
<span class="normal"><a href="#__codelineno-94-16">16</a></span>
<span class="normal"><a href="#__codelineno-94-17">17</a></span>
<span class="normal"><a href="#__codelineno-94-18">18</a></span>
<span class="normal"><a href="#__codelineno-94-19">19</a></span>
<span class="normal"><a href="#__codelineno-94-20">20</a></span>
<span class="normal"><a href="#__codelineno-94-21">21</a></span>
<span class="normal"><a href="#__codelineno-94-22">22</a></span>
<span class="normal"><a href="#__codelineno-94-23">23</a></span>
<span class="normal"><a href="#__codelineno-94-24">24</a></span>
<span class="normal"><a href="#__codelineno-94-25">25</a></span>
<span class="normal"><a href="#__codelineno-94-26">26</a></span>
<span class="normal"><a href="#__codelineno-94-27">27</a></span>
<span class="normal"><a href="#__codelineno-94-28">28</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-94-1" name="__codelineno-94-1"></a><span class="cp">&lt;!DOCTYPE html&gt;</span>
<a id="__codelineno-94-2" name="__codelineno-94-2"></a><span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&quot;en&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-94-3" name="__codelineno-94-3"></a><span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
<a id="__codelineno-94-4" name="__codelineno-94-4"></a>    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&quot;UTF-8&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-94-5" name="__codelineno-94-5"></a>    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>Title<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
<a id="__codelineno-94-6" name="__codelineno-94-6"></a>
<a id="__codelineno-94-7" name="__codelineno-94-7"></a>    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;viewport&quot;</span> <span class="na">content</span><span class="o">=</span><span class="s">&quot;width=device-width, initial-scale=1&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-94-8" name="__codelineno-94-8"></a>    <span class="p">&lt;</span><span class="nt">link</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;https://cdn.bootcss.com/twitter-bootstrap/3.4.1/css/bootstrap.min.css&quot;</span> <span class="na">rel</span><span class="o">=</span><span class="s">&quot;stylesheet&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-94-9" name="__codelineno-94-9"></a>    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<a id="__codelineno-94-10" name="__codelineno-94-10"></a>
<a id="__codelineno-94-11" name="__codelineno-94-11"></a>    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;https://cdn.bootcss.com/twitter-bootstrap/3.4.1/js/bootstrap.min.js&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<a id="__codelineno-94-12" name="__codelineno-94-12"></a>
<a id="__codelineno-94-13" name="__codelineno-94-13"></a><span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<a id="__codelineno-94-14" name="__codelineno-94-14"></a>
<a id="__codelineno-94-15" name="__codelineno-94-15"></a><span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
<a id="__codelineno-94-16" name="__codelineno-94-16"></a>{% for book_obj in page_queryset %}
<a id="__codelineno-94-17" name="__codelineno-94-17"></a>    <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>{{ book_obj.title }}<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<a id="__codelineno-94-18" name="__codelineno-94-18"></a>
<a id="__codelineno-94-19" name="__codelineno-94-19"></a>    <span class="p">&lt;</span><span class="nt">nav</span> <span class="na">aria-label</span><span class="o">=</span><span class="s">&quot;Page navigation&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-94-20" name="__codelineno-94-20"></a><span class="p">&lt;/</span><span class="nt">nav</span><span class="p">&gt;</span>
<a id="__codelineno-94-21" name="__codelineno-94-21"></a>
<a id="__codelineno-94-22" name="__codelineno-94-22"></a>{% endfor %}
<a id="__codelineno-94-23" name="__codelineno-94-23"></a>{#利用自定义分页器直接显示分页器样式#}
<a id="__codelineno-94-24" name="__codelineno-94-24"></a>{{ page_obj.page_html|safe }}
<a id="__codelineno-94-25" name="__codelineno-94-25"></a>
<a id="__codelineno-94-26" name="__codelineno-94-26"></a><span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<a id="__codelineno-94-27" name="__codelineno-94-27"></a>
<a id="__codelineno-94-28" name="__codelineno-94-28"></a><span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></div></td></tr></table></div>
<h3 id="16-12-自定义分页器的拷贝及使用">16-12 自定义分页器的拷贝及使用<a class="headerlink" href="#16-12-自定义分页器的拷贝及使用" title="Permanent link">&para;</a></h3>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-95-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-95-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-95-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-95-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-95-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-95-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-95-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-95-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-95-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-95-10">10</a></span>
<span class="normal"><a href="#__codelineno-95-11">11</a></span>
<span class="normal"><a href="#__codelineno-95-12">12</a></span>
<span class="normal"><a href="#__codelineno-95-13">13</a></span>
<span class="normal"><a href="#__codelineno-95-14">14</a></span>
<span class="normal"><a href="#__codelineno-95-15">15</a></span>
<span class="normal"><a href="#__codelineno-95-16">16</a></span>
<span class="normal"><a href="#__codelineno-95-17">17</a></span>
<span class="normal"><a href="#__codelineno-95-18">18</a></span>
<span class="normal"><a href="#__codelineno-95-19">19</a></span>
<span class="normal"><a href="#__codelineno-95-20">20</a></span>
<span class="normal"><a href="#__codelineno-95-21">21</a></span>
<span class="normal"><a href="#__codelineno-95-22">22</a></span>
<span class="normal"><a href="#__codelineno-95-23">23</a></span>
<span class="normal"><a href="#__codelineno-95-24">24</a></span>
<span class="normal"><a href="#__codelineno-95-25">25</a></span>
<span class="normal"><a href="#__codelineno-95-26">26</a></span>
<span class="normal"><a href="#__codelineno-95-27">27</a></span>
<span class="normal"><a href="#__codelineno-95-28">28</a></span>
<span class="normal"><a href="#__codelineno-95-29">29</a></span>
<span class="normal"><a href="#__codelineno-95-30">30</a></span>
<span class="normal"><a href="#__codelineno-95-31">31</a></span>
<span class="normal"><a href="#__codelineno-95-32">32</a></span>
<span class="normal"><a href="#__codelineno-95-33">33</a></span>
<span class="normal"><a href="#__codelineno-95-34">34</a></span>
<span class="normal"><a href="#__codelineno-95-35">35</a></span>
<span class="normal"><a href="#__codelineno-95-36">36</a></span>
<span class="normal"><a href="#__codelineno-95-37">37</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-95-1" name="__codelineno-95-1"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-95-2" name="__codelineno-95-2"></a><span class="sd">当我们需要使用到非django内置的第三方功能或者组件代码的时候</span>
<a id="__codelineno-95-3" name="__codelineno-95-3"></a><span class="sd">我们一般情况下会创建一个名为utils文件夹 在该文件夹内对模块进行功能性划分</span>
<a id="__codelineno-95-4" name="__codelineno-95-4"></a><span class="sd">    utils可以在每个应用下创建 具体结合实际情况</span>
<a id="__codelineno-95-5" name="__codelineno-95-5"></a>
<a id="__codelineno-95-6" name="__codelineno-95-6"></a><span class="sd">我们到了后期封装代码的时候 不再局限于函数</span>
<a id="__codelineno-95-7" name="__codelineno-95-7"></a><span class="sd">还是尽量朝面向对象去封装</span>
<a id="__codelineno-95-8" name="__codelineno-95-8"></a>
<a id="__codelineno-95-9" name="__codelineno-95-9"></a><span class="sd">我们自定义的分页器是基于bootstrap样式来的 所以你需要提前导入bootstrap</span>
<a id="__codelineno-95-10" name="__codelineno-95-10"></a><span class="sd">    bootstrap 版本 v3</span>
<a id="__codelineno-95-11" name="__codelineno-95-11"></a><span class="sd">    jQuery      版本 v3</span>
<a id="__codelineno-95-12" name="__codelineno-95-12"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-95-13" name="__codelineno-95-13"></a><span class="c1"># 后端</span>
<a id="__codelineno-95-14" name="__codelineno-95-14"></a><span class="n">book_queryset</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Book</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
<a id="__codelineno-95-15" name="__codelineno-95-15"></a><span class="n">current_page</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;page&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-95-16" name="__codelineno-95-16"></a><span class="n">all_count</span> <span class="o">=</span> <span class="n">book_queryset</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
<a id="__codelineno-95-17" name="__codelineno-95-17"></a><span class="c1"># 1 传值生成对象</span>
<a id="__codelineno-95-18" name="__codelineno-95-18"></a><span class="n">page_obj</span> <span class="o">=</span> <span class="n">Pagination</span><span class="p">(</span><span class="n">current_page</span><span class="o">=</span><span class="n">current_page</span><span class="p">,</span><span class="n">all_count</span><span class="o">=</span><span class="n">all_count</span><span class="p">)</span>
<a id="__codelineno-95-19" name="__codelineno-95-19"></a><span class="c1"># 2 直接对总数据进行切片操作</span>
<a id="__codelineno-95-20" name="__codelineno-95-20"></a><span class="n">page_queryset</span> <span class="o">=</span> <span class="n">book_queryset</span><span class="p">[</span><span class="n">page_obj</span><span class="o">.</span><span class="n">start</span><span class="p">:</span><span class="n">page_obj</span><span class="o">.</span><span class="n">end</span><span class="p">]</span>
<a id="__codelineno-95-21" name="__codelineno-95-21"></a><span class="c1"># 3 将page_queryset传递到页面 替换之前的book_queryset</span>
<a id="__codelineno-95-22" name="__codelineno-95-22"></a>
<a id="__codelineno-95-23" name="__codelineno-95-23"></a>
<a id="__codelineno-95-24" name="__codelineno-95-24"></a><span class="c1"># 前端</span>
<a id="__codelineno-95-25" name="__codelineno-95-25"></a><span class="p">{</span><span class="o">%</span> <span class="k">for</span> <span class="n">book_obj</span> <span class="ow">in</span> <span class="n">page_queryset</span> <span class="o">%</span><span class="p">}</span>
<a id="__codelineno-95-26" name="__codelineno-95-26"></a>    <span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="p">{{</span> <span class="n">book_obj</span><span class="o">.</span><span class="n">title</span> <span class="p">}}</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
<a id="__codelineno-95-27" name="__codelineno-95-27"></a>
<a id="__codelineno-95-28" name="__codelineno-95-28"></a>    <span class="o">&lt;</span><span class="n">nav</span> <span class="n">aria</span><span class="o">-</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;Page navigation&quot;</span><span class="o">&gt;</span>
<a id="__codelineno-95-29" name="__codelineno-95-29"></a><span class="o">&lt;/</span><span class="n">nav</span><span class="o">&gt;</span>
<a id="__codelineno-95-30" name="__codelineno-95-30"></a>
<a id="__codelineno-95-31" name="__codelineno-95-31"></a><span class="p">{</span><span class="o">%</span> <span class="n">endfor</span> <span class="o">%</span><span class="p">}</span>
<a id="__codelineno-95-32" name="__codelineno-95-32"></a><span class="p">{</span><span class="c1">#利用自定义分页器直接显示分页器样式#}</span>
<a id="__codelineno-95-33" name="__codelineno-95-33"></a><span class="p">{{</span> <span class="n">page_obj</span><span class="o">.</span><span class="n">page_html</span><span class="o">|</span><span class="n">safe</span> <span class="p">}}</span>
<a id="__codelineno-95-34" name="__codelineno-95-34"></a>
<a id="__codelineno-95-35" name="__codelineno-95-35"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-95-36" name="__codelineno-95-36"></a><span class="sd">你们只需要掌握如何拷贝使用 以及大致的推导思路即可</span>
<a id="__codelineno-95-37" name="__codelineno-95-37"></a><span class="sd">&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
<h2 id="17-表单的基本使用">17 表单的基本使用<a class="headerlink" href="#17-表单的基本使用" title="Permanent link">&para;</a></h2>
<h3 id="171">17.1<a class="headerlink" href="#171" title="Permanent link">&para;</a></h3>
<p>标签的属性</p>
<p><img alt="" src="../../../images/image-20230701183418411.png" /></p>
<h5 id="1-1-target">1-1  target<a class="headerlink" href="#1-1-target" title="Permanent link">&para;</a></h5>
<p><img alt="" src="../../../images/image-20230701183439173.png" /></p>
<h5 id="1-2-enctype">1-2 enctype<a class="headerlink" href="#1-2-enctype" title="Permanent link">&para;</a></h5>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Text Only</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-96-1">1</a></span>
<span class="normal"><a href="#__codelineno-96-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-96-1" name="__codelineno-96-1"></a>// 在涉及到文件上传的操作时，必须将 enctype 的值设置为 multipart/form-data
<a id="__codelineno-96-2" name="__codelineno-96-2"></a>// 如果表单的提交不涉及到文件上传操作，则直接将 enctype 的值设置为 application/x-www-form-urlencoded 即可！
</code></pre></div></td></tr></table></div>
<p><img alt="" src="../../../images/image-20230701183505975.png" /></p>
<h3 id="17-2-表单的同步提交及缺点">17-2 表单的同步提交及缺点<a class="headerlink" href="#17-2-表单的同步提交及缺点" title="Permanent link">&para;</a></h3>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">JavaScript</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-97-1">1</a></span>
<span class="normal"><a href="#__codelineno-97-2">2</a></span>
<span class="normal"><a href="#__codelineno-97-3">3</a></span>
<span class="normal"><a href="#__codelineno-97-4">4</a></span>
<span class="normal"><a href="#__codelineno-97-5">5</a></span>
<span class="normal"><a href="#__codelineno-97-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-97-1" name="__codelineno-97-1"></a><span class="mf">1.</span><span class="w"> </span><span class="nx">什么是表单的同步提交</span>
<a id="__codelineno-97-2" name="__codelineno-97-2"></a><span class="w">    </span><span class="c1">// 通过点击 submit 按钮，触发表单提交的操作，从而使页面跳转到 action URL 的行为，叫做表单的同步提交。</span>
<a id="__codelineno-97-3" name="__codelineno-97-3"></a><span class="mf">2</span><span class="err">，</span><span class="nx">表单同步提交的缺点</span>
<a id="__codelineno-97-4" name="__codelineno-97-4"></a><span class="w">    </span><span class="c1">// 页面会发生跳转</span>
<a id="__codelineno-97-5" name="__codelineno-97-5"></a><span class="w">    </span><span class="c1">// 页面之前的状态和数据会丢失</span>
<a id="__codelineno-97-6" name="__codelineno-97-6"></a><span class="mf">3</span><span class="err">，</span><span class="nx">解决方案</span><span class="err">：</span><span class="nx">表单只负责采集数据</span><span class="err">，</span><span class="nx">Ajax</span><span class="w"> </span><span class="nx">负责将数据提交到服务器</span><span class="err">。</span>
</code></pre></div></td></tr></table></div>
<h3 id="17-3-通过ajax提交表单数据">17-3 通过Ajax提交表单数据<a class="headerlink" href="#17-3-通过ajax提交表单数据" title="Permanent link">&para;</a></h3>
<h4 id="31-监听表单提交事件">3.1 监听表单提交事件<a class="headerlink" href="#31-监听表单提交事件" title="Permanent link">&para;</a></h4>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">JavaScript</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-98-1">1</a></span>
<span class="normal"><a href="#__codelineno-98-2">2</a></span>
<span class="normal"><a href="#__codelineno-98-3">3</a></span>
<span class="normal"><a href="#__codelineno-98-4">4</a></span>
<span class="normal"><a href="#__codelineno-98-5">5</a></span>
<span class="normal"><a href="#__codelineno-98-6">6</a></span>
<span class="normal"><a href="#__codelineno-98-7">7</a></span>
<span class="normal"><a href="#__codelineno-98-8">8</a></span>
<span class="normal"><a href="#__codelineno-98-9">9</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-98-1" name="__codelineno-98-1"></a><span class="c1">// 在 jQuery 中，可以使用如下两种方式，监听到表单的提交事件：</span>
<a id="__codelineno-98-2" name="__codelineno-98-2"></a>
<a id="__codelineno-98-3" name="__codelineno-98-3"></a><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#form1&#39;</span><span class="p">).</span><span class="nx">submit</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-98-4" name="__codelineno-98-4"></a><span class="w">    </span><span class="nx">alert</span><span class="p">(</span><span class="s1">&#39;监听到了表单的提交事件&#39;</span><span class="p">)</span>
<a id="__codelineno-98-5" name="__codelineno-98-5"></a><span class="p">})</span>
<a id="__codelineno-98-6" name="__codelineno-98-6"></a>
<a id="__codelineno-98-7" name="__codelineno-98-7"></a><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#form1&#39;</span><span class="p">).</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;submit&#39;</span><span class="p">,</span><span class="w"> </span><span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-98-8" name="__codelineno-98-8"></a><span class="w">    </span><span class="nx">alert</span><span class="p">(</span><span class="s1">&#39;监听到了表单的提交事件&#39;</span><span class="p">)</span>
<a id="__codelineno-98-9" name="__codelineno-98-9"></a><span class="p">})</span>
</code></pre></div></td></tr></table></div>
<h4 id="3-2-阻止表单默认提交行为">3-2 阻止表单默认提交行为<a class="headerlink" href="#3-2-阻止表单默认提交行为" title="Permanent link">&para;</a></h4>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">JavaScript</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-99-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-99-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-99-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-99-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-99-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-99-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-99-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-99-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-99-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-99-10">10</a></span>
<span class="normal"><a href="#__codelineno-99-11">11</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-99-1" name="__codelineno-99-1"></a><span class="c1">// 当监听到表单的提交事件以后，可以调用事件对象的 event.preventDefault() 函数，来阻止表单的提交和页面的跳转，示例代码如下：</span>
<a id="__codelineno-99-2" name="__codelineno-99-2"></a>
<a id="__codelineno-99-3" name="__codelineno-99-3"></a><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#form1&#39;</span><span class="p">).</span><span class="nx">submit</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-99-4" name="__codelineno-99-4"></a><span class="w">    </span><span class="c1">// 阻止表单的提交和页面的跳转</span>
<a id="__codelineno-99-5" name="__codelineno-99-5"></a><span class="w">    </span><span class="nx">e</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">()</span>
<a id="__codelineno-99-6" name="__codelineno-99-6"></a><span class="p">})</span>
<a id="__codelineno-99-7" name="__codelineno-99-7"></a>
<a id="__codelineno-99-8" name="__codelineno-99-8"></a><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#form1&#39;</span><span class="p">).</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;submit&#39;</span><span class="p">,</span><span class="w"> </span><span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-99-9" name="__codelineno-99-9"></a><span class="w">    </span><span class="c1">// 阻止表单的提交和页面的跳转</span>
<a id="__codelineno-99-10" name="__codelineno-99-10"></a><span class="w">    </span><span class="nx">e</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">()</span>
<a id="__codelineno-99-11" name="__codelineno-99-11"></a><span class="p">})</span>
</code></pre></div></td></tr></table></div>
<h4 id="3-3-快速获取表单中的数据">3-3 快速获取表单中的数据<a class="headerlink" href="#3-3-快速获取表单中的数据" title="Permanent link">&para;</a></h4>
<h5 id="serialize函数">serialize()函数<a class="headerlink" href="#serialize函数" title="Permanent link">&para;</a></h5>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">JavaScript</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-100-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-100-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-100-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-100-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-100-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-100-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-100-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-100-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-100-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-100-10">10</a></span>
<span class="normal"><a href="#__codelineno-100-11">11</a></span>
<span class="normal"><a href="#__codelineno-100-12">12</a></span>
<span class="normal"><a href="#__codelineno-100-13">13</a></span>
<span class="normal"><a href="#__codelineno-100-14">14</a></span>
<span class="normal"><a href="#__codelineno-100-15">15</a></span>
<span class="normal"><a href="#__codelineno-100-16">16</a></span>
<span class="normal"><a href="#__codelineno-100-17">17</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-100-1" name="__codelineno-100-1"></a><span class="c1">// 为了简化表单中数据的获取操作，jQuery 提供了 serialize() 函数，其语法格式如下]</span>
<a id="__codelineno-100-2" name="__codelineno-100-2"></a>
<a id="__codelineno-100-3" name="__codelineno-100-3"></a><span class="nx">$</span><span class="p">(</span><span class="nx">selector</span><span class="p">).</span><span class="nx">serialize</span><span class="p">()</span>
<a id="__codelineno-100-4" name="__codelineno-100-4"></a>
<a id="__codelineno-100-5" name="__codelineno-100-5"></a><span class="c1">// serialize() 函数的好处：可以一次性获取到表单中的所有的数据。</span>
<a id="__codelineno-100-6" name="__codelineno-100-6"></a><span class="c1">// 注意：在使用 serialize() 函数快速获取表单数据时，必须为每个表单元素添加 name 属性！</span>
<a id="__codelineno-100-7" name="__codelineno-100-7"></a>
<a id="__codelineno-100-8" name="__codelineno-100-8"></a><span class="o">&lt;</span><span class="nx">form</span><span class="w"> </span><span class="nx">id</span><span class="o">=</span><span class="s2">&quot;form1&quot;</span><span class="o">&gt;</span>
<a id="__codelineno-100-9" name="__codelineno-100-9"></a><span class="o">&lt;</span><span class="nx">input</span><span class="w"> </span><span class="nx">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="w"> </span><span class="nx">name</span><span class="o">=</span><span class="s2">&quot;username&quot;</span><span class="w"> </span><span class="o">/&gt;</span>
<a id="__codelineno-100-10" name="__codelineno-100-10"></a><span class="o">&lt;</span><span class="nx">input</span><span class="w"> </span><span class="nx">type</span><span class="o">=</span><span class="s2">&quot;password&quot;</span><span class="w"> </span><span class="nx">name</span><span class="o">=</span><span class="s2">&quot;password&quot;</span><span class="w"> </span><span class="o">/&gt;</span>
<a id="__codelineno-100-11" name="__codelineno-100-11"></a><span class="o">&lt;</span><span class="nx">button</span><span class="w"> </span><span class="nx">type</span><span class="o">=</span><span class="s2">&quot;submit&quot;</span><span class="o">&gt;</span><span class="nx">提交</span><span class="o">&lt;</span><span class="err">/button&gt;</span>
<a id="__codelineno-100-12" name="__codelineno-100-12"></a>
<a id="__codelineno-100-13" name="__codelineno-100-13"></a><span class="o">&lt;</span><span class="err">/form&gt;</span>
<a id="__codelineno-100-14" name="__codelineno-100-14"></a>
<a id="__codelineno-100-15" name="__codelineno-100-15"></a><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#form1&#39;</span><span class="p">).</span><span class="nx">serialize</span><span class="p">()</span>
<a id="__codelineno-100-16" name="__codelineno-100-16"></a><span class="c1">// 调用的结果：</span>
<a id="__codelineno-100-17" name="__codelineno-100-17"></a><span class="c1">// username=用户名的值&amp;password=密码的值</span>
</code></pre></div></td></tr></table></div>
<h2 id="18-forms组件">18 forms组件<a class="headerlink" href="#18-forms组件" title="Permanent link">&para;</a></h2>
<h3 id="18-1-前戏">18-1 前戏<a class="headerlink" href="#18-1-前戏" title="Permanent link">&para;</a></h3>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-101-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-101-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-101-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-101-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-101-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-101-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-101-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-101-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-101-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-101-10">10</a></span>
<span class="normal"><a href="#__codelineno-101-11">11</a></span>
<span class="normal"><a href="#__codelineno-101-12">12</a></span>
<span class="normal"><a href="#__codelineno-101-13">13</a></span>
<span class="normal"><a href="#__codelineno-101-14">14</a></span>
<span class="normal"><a href="#__codelineno-101-15">15</a></span>
<span class="normal"><a href="#__codelineno-101-16">16</a></span>
<span class="normal"><a href="#__codelineno-101-17">17</a></span>
<span class="normal"><a href="#__codelineno-101-18">18</a></span>
<span class="normal"><a href="#__codelineno-101-19">19</a></span>
<span class="normal"><a href="#__codelineno-101-20">20</a></span>
<span class="normal"><a href="#__codelineno-101-21">21</a></span>
<span class="normal"><a href="#__codelineno-101-22">22</a></span>
<span class="normal"><a href="#__codelineno-101-23">23</a></span>
<span class="normal"><a href="#__codelineno-101-24">24</a></span>
<span class="normal"><a href="#__codelineno-101-25">25</a></span>
<span class="normal"><a href="#__codelineno-101-26">26</a></span>
<span class="normal"><a href="#__codelineno-101-27">27</a></span>
<span class="normal"><a href="#__codelineno-101-28">28</a></span>
<span class="normal"><a href="#__codelineno-101-29">29</a></span>
<span class="normal"><a href="#__codelineno-101-30">30</a></span>
<span class="normal"><a href="#__codelineno-101-31">31</a></span>
<span class="normal"><a href="#__codelineno-101-32">32</a></span>
<span class="normal"><a href="#__codelineno-101-33">33</a></span>
<span class="normal"><a href="#__codelineno-101-34">34</a></span>
<span class="normal"><a href="#__codelineno-101-35">35</a></span>
<span class="normal"><a href="#__codelineno-101-36">36</a></span>
<span class="normal"><a href="#__codelineno-101-37">37</a></span>
<span class="normal"><a href="#__codelineno-101-38">38</a></span>
<span class="normal"><a href="#__codelineno-101-39">39</a></span>
<span class="normal"><a href="#__codelineno-101-40">40</a></span>
<span class="normal"><a href="#__codelineno-101-41">41</a></span>
<span class="normal"><a href="#__codelineno-101-42">42</a></span>
<span class="normal"><a href="#__codelineno-101-43">43</a></span>
<span class="normal"><a href="#__codelineno-101-44">44</a></span>
<span class="normal"><a href="#__codelineno-101-45">45</a></span>
<span class="normal"><a href="#__codelineno-101-46">46</a></span>
<span class="normal"><a href="#__codelineno-101-47">47</a></span>
<span class="normal"><a href="#__codelineno-101-48">48</a></span>
<span class="normal"><a href="#__codelineno-101-49">49</a></span>
<span class="normal"><a href="#__codelineno-101-50">50</a></span>
<span class="normal"><a href="#__codelineno-101-51">51</a></span>
<span class="normal"><a href="#__codelineno-101-52">52</a></span>
<span class="normal"><a href="#__codelineno-101-53">53</a></span>
<span class="normal"><a href="#__codelineno-101-54">54</a></span>
<span class="normal"><a href="#__codelineno-101-55">55</a></span>
<span class="normal"><a href="#__codelineno-101-56">56</a></span>
<span class="normal"><a href="#__codelineno-101-57">57</a></span>
<span class="normal"><a href="#__codelineno-101-58">58</a></span>
<span class="normal"><a href="#__codelineno-101-59">59</a></span>
<span class="normal"><a href="#__codelineno-101-60">60</a></span>
<span class="normal"><a href="#__codelineno-101-61">61</a></span>
<span class="normal"><a href="#__codelineno-101-62">62</a></span>
<span class="normal"><a href="#__codelineno-101-63">63</a></span>
<span class="normal"><a href="#__codelineno-101-64">64</a></span>
<span class="normal"><a href="#__codelineno-101-65">65</a></span>
<span class="normal"><a href="#__codelineno-101-66">66</a></span>
<span class="normal"><a href="#__codelineno-101-67">67</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-101-1" name="__codelineno-101-1"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-101-2" name="__codelineno-101-2"></a><span class="sd">写一个注册功能</span>
<a id="__codelineno-101-3" name="__codelineno-101-3"></a><span class="sd">    获取用户名和密码 利用form表单提交数据</span>
<a id="__codelineno-101-4" name="__codelineno-101-4"></a><span class="sd">    在后端判断用户名和密码是否符合一定的条件</span>
<a id="__codelineno-101-5" name="__codelineno-101-5"></a><span class="sd">        用户名中不能含有金瓶梅</span>
<a id="__codelineno-101-6" name="__codelineno-101-6"></a><span class="sd">        密码不能少于三位</span>
<a id="__codelineno-101-7" name="__codelineno-101-7"></a>
<a id="__codelineno-101-8" name="__codelineno-101-8"></a><span class="sd">    如何符合条件需要你将提示信息展示到前端页面</span>
<a id="__codelineno-101-9" name="__codelineno-101-9"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-101-10" name="__codelineno-101-10"></a><span class="k">def</span><span class="w"> </span><span class="nf">ab_form</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
<a id="__codelineno-101-11" name="__codelineno-101-11"></a>    <span class="n">back_dic</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;username&#39;</span><span class="p">:</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="s1">&#39;password&#39;</span><span class="p">:</span><span class="s1">&#39;&#39;</span><span class="p">}</span>
<a id="__codelineno-101-12" name="__codelineno-101-12"></a>    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;POST&#39;</span><span class="p">:</span>
<a id="__codelineno-101-13" name="__codelineno-101-13"></a>        <span class="n">username</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;username&#39;</span><span class="p">)</span>
<a id="__codelineno-101-14" name="__codelineno-101-14"></a>        <span class="n">password</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;password&#39;</span><span class="p">)</span>
<a id="__codelineno-101-15" name="__codelineno-101-15"></a>        <span class="k">if</span> <span class="s1">&#39;金瓶梅&#39;</span> <span class="ow">in</span> <span class="n">username</span><span class="p">:</span>
<a id="__codelineno-101-16" name="__codelineno-101-16"></a>            <span class="n">back_dic</span><span class="p">[</span><span class="s1">&#39;username&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;不符合社会主义核心价值观&#39;</span>
<a id="__codelineno-101-17" name="__codelineno-101-17"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">password</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">:</span>
<a id="__codelineno-101-18" name="__codelineno-101-18"></a>            <span class="n">back_dic</span><span class="p">[</span><span class="s1">&#39;password&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;不能太短 不好!&#39;</span>
<a id="__codelineno-101-19" name="__codelineno-101-19"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-101-20" name="__codelineno-101-20"></a><span class="sd">    无论是post请求还是get请求</span>
<a id="__codelineno-101-21" name="__codelineno-101-21"></a><span class="sd">    页面都能够获取到字典 只不过get请求来的时候 字典值都是空的</span>
<a id="__codelineno-101-22" name="__codelineno-101-22"></a><span class="sd">    而post请求来之后 字典可能有值</span>
<a id="__codelineno-101-23" name="__codelineno-101-23"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-101-24" name="__codelineno-101-24"></a>    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span><span class="s1">&#39;ab_form.html&#39;</span><span class="p">,</span><span class="nb">locals</span><span class="p">())</span>
<a id="__codelineno-101-25" name="__codelineno-101-25"></a>
<a id="__codelineno-101-26" name="__codelineno-101-26"></a><span class="o">&lt;</span><span class="n">form</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;&quot;</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;post&quot;</span><span class="o">&gt;</span>
<a id="__codelineno-101-27" name="__codelineno-101-27"></a>    <span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="n">username</span><span class="p">:</span>
<a id="__codelineno-101-28" name="__codelineno-101-28"></a>        <span class="o">&lt;</span><span class="nb">input</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;username&quot;</span><span class="o">&gt;</span>
<a id="__codelineno-101-29" name="__codelineno-101-29"></a>        <span class="o">&lt;</span><span class="n">span</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;color: red&quot;</span><span class="o">&gt;</span><span class="p">{{</span> <span class="n">back_dic</span><span class="o">.</span><span class="n">username</span> <span class="p">}}</span><span class="o">&lt;/</span><span class="n">span</span><span class="o">&gt;</span>
<a id="__codelineno-101-30" name="__codelineno-101-30"></a>
<a id="__codelineno-101-31" name="__codelineno-101-31"></a>    <span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
<a id="__codelineno-101-32" name="__codelineno-101-32"></a>
<a id="__codelineno-101-33" name="__codelineno-101-33"></a>    <span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="n">password</span><span class="p">:</span>
<a id="__codelineno-101-34" name="__codelineno-101-34"></a>        <span class="o">&lt;</span><span class="nb">input</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;password&quot;</span><span class="o">&gt;</span>
<a id="__codelineno-101-35" name="__codelineno-101-35"></a>        <span class="o">&lt;</span><span class="n">span</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;color: red&quot;</span><span class="o">&gt;</span><span class="p">{{</span> <span class="n">back_dic</span><span class="o">.</span><span class="n">password</span> <span class="p">}}</span><span class="o">&lt;/</span><span class="n">span</span><span class="o">&gt;</span>
<a id="__codelineno-101-36" name="__codelineno-101-36"></a>
<a id="__codelineno-101-37" name="__codelineno-101-37"></a>    <span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
<a id="__codelineno-101-38" name="__codelineno-101-38"></a>
<a id="__codelineno-101-39" name="__codelineno-101-39"></a>    <span class="o">&lt;</span><span class="nb">input</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;submit&quot;</span> <span class="n">class</span><span class="o">=</span><span class="s2">&quot;btn btn-info&quot;</span><span class="o">&gt;</span>
<a id="__codelineno-101-40" name="__codelineno-101-40"></a><span class="o">&lt;/</span><span class="n">form</span><span class="o">&gt;</span>
<a id="__codelineno-101-41" name="__codelineno-101-41"></a>
<a id="__codelineno-101-42" name="__codelineno-101-42"></a>
<a id="__codelineno-101-43" name="__codelineno-101-43"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-101-44" name="__codelineno-101-44"></a><span class="sd">1.手动书写前端获取用户数据的html代码                       渲染html代码</span>
<a id="__codelineno-101-45" name="__codelineno-101-45"></a><span class="sd">2.后端对用户数据进行校验                                            校验数据</span>
<a id="__codelineno-101-46" name="__codelineno-101-46"></a><span class="sd">3.对不符合要求的数据进行前端提示                               展示提示信息</span>
<a id="__codelineno-101-47" name="__codelineno-101-47"></a>
<a id="__codelineno-101-48" name="__codelineno-101-48"></a><span class="sd">forms组件</span>
<a id="__codelineno-101-49" name="__codelineno-101-49"></a><span class="sd">    能够完成的事情</span>
<a id="__codelineno-101-50" name="__codelineno-101-50"></a><span class="sd">            1.渲染html代码</span>
<a id="__codelineno-101-51" name="__codelineno-101-51"></a><span class="sd">            2.校验数据</span>
<a id="__codelineno-101-52" name="__codelineno-101-52"></a><span class="sd">            3.展示提示信息</span>
<a id="__codelineno-101-53" name="__codelineno-101-53"></a>
<a id="__codelineno-101-54" name="__codelineno-101-54"></a><span class="sd">为什么数据校验非要去后端 不能在前端利用js直接完成呢？</span>
<a id="__codelineno-101-55" name="__codelineno-101-55"></a><span class="sd">    数据校验前端可有可无</span>
<a id="__codelineno-101-56" name="__codelineno-101-56"></a><span class="sd">    但是后端必须要有!!!</span>
<a id="__codelineno-101-57" name="__codelineno-101-57"></a>
<a id="__codelineno-101-58" name="__codelineno-101-58"></a><span class="sd">    因为前端的校验是弱不禁风的 你可以直接修改</span>
<a id="__codelineno-101-59" name="__codelineno-101-59"></a><span class="sd">    或者利用爬虫程序绕过前端页面直接朝后端提交数据</span>
<a id="__codelineno-101-60" name="__codelineno-101-60"></a>
<a id="__codelineno-101-61" name="__codelineno-101-61"></a><span class="sd">    购物网站    </span>
<a id="__codelineno-101-62" name="__codelineno-101-62"></a><span class="sd">        选取了货物之后 会计算一个价格发送给后端 如果后端不做价格的校验</span>
<a id="__codelineno-101-63" name="__codelineno-101-63"></a>
<a id="__codelineno-101-64" name="__codelineno-101-64"></a><span class="sd">        实际是获取到用户选择的所有商品的主键值</span>
<a id="__codelineno-101-65" name="__codelineno-101-65"></a><span class="sd">        然后在后端查询出所有商品的价格 再次计算一遍</span>
<a id="__codelineno-101-66" name="__codelineno-101-66"></a><span class="sd">        如果跟前端一致 那么完成支付如果不一致直接拒绝</span>
<a id="__codelineno-101-67" name="__codelineno-101-67"></a><span class="sd">&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
<h3 id="18-2-基本使用">18-2  基本使用<a class="headerlink" href="#18-2-基本使用" title="Permanent link">&para;</a></h3>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-102-1">1</a></span>
<span class="normal"><a href="#__codelineno-102-2">2</a></span>
<span class="normal"><a href="#__codelineno-102-3">3</a></span>
<span class="normal"><a href="#__codelineno-102-4">4</a></span>
<span class="normal"><a href="#__codelineno-102-5">5</a></span>
<span class="normal"><a href="#__codelineno-102-6">6</a></span>
<span class="normal"><a href="#__codelineno-102-7">7</a></span>
<span class="normal"><a href="#__codelineno-102-8">8</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-102-1" name="__codelineno-102-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django</span><span class="w"> </span><span class="kn">import</span> <span class="n">forms</span>
<a id="__codelineno-102-2" name="__codelineno-102-2"></a><span class="k">class</span><span class="w"> </span><span class="nc">MyForm</span><span class="p">(</span><span class="n">forms</span><span class="o">.</span><span class="n">Form</span><span class="p">):</span>
<a id="__codelineno-102-3" name="__codelineno-102-3"></a>    <span class="c1"># username字符串类型最小3位最大8位</span>
<a id="__codelineno-102-4" name="__codelineno-102-4"></a>    <span class="n">username</span> <span class="o">=</span> <span class="n">forms</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">min_length</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">max_length</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<a id="__codelineno-102-5" name="__codelineno-102-5"></a>    <span class="c1"># password字符串类型最小3位最大8位</span>
<a id="__codelineno-102-6" name="__codelineno-102-6"></a>    <span class="n">password</span> <span class="o">=</span> <span class="n">forms</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">min_length</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">max_length</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<a id="__codelineno-102-7" name="__codelineno-102-7"></a>    <span class="c1"># email字段必须符合邮箱格式  xxx@xx.com</span>
<a id="__codelineno-102-8" name="__codelineno-102-8"></a>    <span class="n">email</span> <span class="o">=</span> <span class="n">forms</span><span class="o">.</span><span class="n">EmailField</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
<h3 id="18-3-校验数据">18-3 校验数据<a class="headerlink" href="#18-3-校验数据" title="Permanent link">&para;</a></h3>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-103-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-103-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-103-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-103-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-103-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-103-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-103-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-103-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-103-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-103-10">10</a></span>
<span class="normal"><a href="#__codelineno-103-11">11</a></span>
<span class="normal"><a href="#__codelineno-103-12">12</a></span>
<span class="normal"><a href="#__codelineno-103-13">13</a></span>
<span class="normal"><a href="#__codelineno-103-14">14</a></span>
<span class="normal"><a href="#__codelineno-103-15">15</a></span>
<span class="normal"><a href="#__codelineno-103-16">16</a></span>
<span class="normal"><a href="#__codelineno-103-17">17</a></span>
<span class="normal"><a href="#__codelineno-103-18">18</a></span>
<span class="normal"><a href="#__codelineno-103-19">19</a></span>
<span class="normal"><a href="#__codelineno-103-20">20</a></span>
<span class="normal"><a href="#__codelineno-103-21">21</a></span>
<span class="normal"><a href="#__codelineno-103-22">22</a></span>
<span class="normal"><a href="#__codelineno-103-23">23</a></span>
<span class="normal"><a href="#__codelineno-103-24">24</a></span>
<span class="normal"><a href="#__codelineno-103-25">25</a></span>
<span class="normal"><a href="#__codelineno-103-26">26</a></span>
<span class="normal"><a href="#__codelineno-103-27">27</a></span>
<span class="normal"><a href="#__codelineno-103-28">28</a></span>
<span class="normal"><a href="#__codelineno-103-29">29</a></span>
<span class="normal"><a href="#__codelineno-103-30">30</a></span>
<span class="normal"><a href="#__codelineno-103-31">31</a></span>
<span class="normal"><a href="#__codelineno-103-32">32</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-103-1" name="__codelineno-103-1"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-103-2" name="__codelineno-103-2"></a><span class="sd">1.测试环境的准备 可以自己拷贝代码准备</span>
<a id="__codelineno-103-3" name="__codelineno-103-3"></a><span class="sd">2.其实在pycharm里面已经帮你准备一个测试环境</span>
<a id="__codelineno-103-4" name="__codelineno-103-4"></a><span class="sd">    python console</span>
<a id="__codelineno-103-5" name="__codelineno-103-5"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-103-6" name="__codelineno-103-6"></a><span class="kn">from</span><span class="w"> </span><span class="nn">app01</span><span class="w"> </span><span class="kn">import</span> <span class="n">views</span>
<a id="__codelineno-103-7" name="__codelineno-103-7"></a><span class="c1"># 1 将带校验的数据组织成字典的形式传入即可</span>
<a id="__codelineno-103-8" name="__codelineno-103-8"></a>    <span class="n">form_obj</span> <span class="o">=</span> <span class="n">views</span><span class="o">.</span><span class="n">MyForm</span><span class="p">({</span><span class="s1">&#39;username&#39;</span><span class="p">:</span><span class="s1">&#39;jason&#39;</span><span class="p">,</span><span class="s1">&#39;password&#39;</span><span class="p">:</span><span class="s1">&#39;123&#39;</span><span class="p">,</span><span class="s1">&#39;email&#39;</span><span class="p">:</span><span class="s1">&#39;123&#39;</span><span class="p">})</span>
<a id="__codelineno-103-9" name="__codelineno-103-9"></a>
<a id="__codelineno-103-10" name="__codelineno-103-10"></a><span class="c1"># 2 判断数据是否合法，注意该方法只有在所有的数据全部合法的情况下才会返回True</span>
<a id="__codelineno-103-11" name="__codelineno-103-11"></a>    <span class="n">form_obj</span><span class="o">.</span><span class="n">is_valid</span><span class="p">()</span> <span class="c1"># False</span>
<a id="__codelineno-103-12" name="__codelineno-103-12"></a>
<a id="__codelineno-103-13" name="__codelineno-103-13"></a><span class="c1"># 3 查看所有校验通过的数据</span>
<a id="__codelineno-103-14" name="__codelineno-103-14"></a>    <span class="n">form_obj</span><span class="o">.</span><span class="n">cleaned_data</span> <span class="c1">## {&#39;username&#39;: &#39;jason&#39;, &#39;password&#39;: &#39;123&#39;}</span>
<a id="__codelineno-103-15" name="__codelineno-103-15"></a>
<a id="__codelineno-103-16" name="__codelineno-103-16"></a><span class="c1"># 4 查看所有不符合校验规则以及不符合的原因</span>
<a id="__codelineno-103-17" name="__codelineno-103-17"></a>    <span class="n">form_obj</span><span class="o">.</span><span class="n">errors</span>
<a id="__codelineno-103-18" name="__codelineno-103-18"></a>    <span class="p">{</span>
<a id="__codelineno-103-19" name="__codelineno-103-19"></a>      <span class="s1">&#39;email&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Enter a valid email address.&#39;</span><span class="p">]</span>
<a id="__codelineno-103-20" name="__codelineno-103-20"></a>    <span class="p">}</span>
<a id="__codelineno-103-21" name="__codelineno-103-21"></a>
<a id="__codelineno-103-22" name="__codelineno-103-22"></a><span class="c1"># 5 校验数据只校验类中出现的字段 多传不影响 多传的字段直接忽略</span>
<a id="__codelineno-103-23" name="__codelineno-103-23"></a><span class="n">form_obj</span> <span class="o">=</span> <span class="n">views</span><span class="o">.</span><span class="n">MyForm</span><span class="p">({</span><span class="s1">&#39;username&#39;</span><span class="p">:</span><span class="s1">&#39;jason&#39;</span><span class="p">,</span><span class="s1">&#39;password&#39;</span><span class="p">:</span><span class="s1">&#39;123&#39;</span><span class="p">,</span><span class="s1">&#39;email&#39;</span><span class="p">:</span><span class="s1">&#39;123@qq.com&#39;</span><span class="p">,</span><span class="s1">&#39;hobby&#39;</span><span class="p">:</span><span class="s1">&#39;study&#39;</span><span class="p">})</span>
<a id="__codelineno-103-24" name="__codelineno-103-24"></a><span class="n">form_obj</span><span class="o">.</span><span class="n">is_valid</span><span class="p">()</span>  <span class="c1">## True</span>
<a id="__codelineno-103-25" name="__codelineno-103-25"></a>
<a id="__codelineno-103-26" name="__codelineno-103-26"></a><span class="c1"># 6 校验数据 默认情况下 类里面所有的字段都必须传值</span>
<a id="__codelineno-103-27" name="__codelineno-103-27"></a><span class="n">form_obj</span> <span class="o">=</span> <span class="n">views</span><span class="o">.</span><span class="n">MyForm</span><span class="p">({</span><span class="s1">&#39;username&#39;</span><span class="p">:</span><span class="s1">&#39;jason&#39;</span><span class="p">,</span><span class="s1">&#39;password&#39;</span><span class="p">:</span><span class="s1">&#39;123&#39;</span><span class="p">})</span>
<a id="__codelineno-103-28" name="__codelineno-103-28"></a><span class="n">form_obj</span><span class="o">.</span><span class="n">is_valid</span><span class="p">()</span>  <span class="c1"># False</span>
<a id="__codelineno-103-29" name="__codelineno-103-29"></a>
<a id="__codelineno-103-30" name="__codelineno-103-30"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-103-31" name="__codelineno-103-31"></a><span class="sd">也就意味着校验数据的时候 默认情况下数据可以多传但是绝不可能少传</span>
<a id="__codelineno-103-32" name="__codelineno-103-32"></a><span class="sd">&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
<h3 id="18-4-渲染标签">18-4 渲染标签<a class="headerlink" href="#18-4-渲染标签" title="Permanent link">&para;</a></h3>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-104-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-104-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-104-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-104-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-104-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-104-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-104-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-104-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-104-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-104-10">10</a></span>
<span class="normal"><a href="#__codelineno-104-11">11</a></span>
<span class="normal"><a href="#__codelineno-104-12">12</a></span>
<span class="normal"><a href="#__codelineno-104-13">13</a></span>
<span class="normal"><a href="#__codelineno-104-14">14</a></span>
<span class="normal"><a href="#__codelineno-104-15">15</a></span>
<span class="normal"><a href="#__codelineno-104-16">16</a></span>
<span class="normal"><a href="#__codelineno-104-17">17</a></span>
<span class="normal"><a href="#__codelineno-104-18">18</a></span>
<span class="normal"><a href="#__codelineno-104-19">19</a></span>
<span class="normal"><a href="#__codelineno-104-20">20</a></span>
<span class="normal"><a href="#__codelineno-104-21">21</a></span>
<span class="normal"><a href="#__codelineno-104-22">22</a></span>
<span class="normal"><a href="#__codelineno-104-23">23</a></span>
<span class="normal"><a href="#__codelineno-104-24">24</a></span>
<span class="normal"><a href="#__codelineno-104-25">25</a></span>
<span class="normal"><a href="#__codelineno-104-26">26</a></span>
<span class="normal"><a href="#__codelineno-104-27">27</a></span>
<span class="normal"><a href="#__codelineno-104-28">28</a></span>
<span class="normal"><a href="#__codelineno-104-29">29</a></span>
<span class="normal"><a href="#__codelineno-104-30">30</a></span>
<span class="normal"><a href="#__codelineno-104-31">31</a></span>
<span class="normal"><a href="#__codelineno-104-32">32</a></span>
<span class="normal"><a href="#__codelineno-104-33">33</a></span>
<span class="normal"><a href="#__codelineno-104-34">34</a></span>
<span class="normal"><a href="#__codelineno-104-35">35</a></span>
<span class="normal"><a href="#__codelineno-104-36">36</a></span>
<span class="normal"><a href="#__codelineno-104-37">37</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-104-1" name="__codelineno-104-1"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-104-2" name="__codelineno-104-2"></a><span class="sd">forms组件只会自动帮你渲染获取用户输入的标签(input select radio checkbox)</span>
<a id="__codelineno-104-3" name="__codelineno-104-3"></a><span class="sd">不能帮你渲染提交按钮</span>
<a id="__codelineno-104-4" name="__codelineno-104-4"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-104-5" name="__codelineno-104-5"></a><span class="k">def</span><span class="w"> </span><span class="nf">index</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
<a id="__codelineno-104-6" name="__codelineno-104-6"></a>    <span class="c1"># 1 先产生一个空对象</span>
<a id="__codelineno-104-7" name="__codelineno-104-7"></a>    <span class="n">form_obj</span> <span class="o">=</span> <span class="n">MyForm</span><span class="p">()</span>
<a id="__codelineno-104-8" name="__codelineno-104-8"></a>    <span class="c1"># 2 直接将该空对象传递给html页面</span>
<a id="__codelineno-104-9" name="__codelineno-104-9"></a>    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span><span class="s1">&#39;index.html&#39;</span><span class="p">,</span><span class="nb">locals</span><span class="p">())</span>
<a id="__codelineno-104-10" name="__codelineno-104-10"></a>
<a id="__codelineno-104-11" name="__codelineno-104-11"></a><span class="c1"># 前端利用空对象做操作</span>
<a id="__codelineno-104-12" name="__codelineno-104-12"></a>    <span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span> <span class="n">第一种渲染方式</span><span class="p">:</span><span class="n">代码书写极少</span><span class="err">，</span><span class="n">封装程度太高</span> <span class="n">不便于后续的扩展</span> <span class="n">一般情况下只在本地测试使用</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
<a id="__codelineno-104-13" name="__codelineno-104-13"></a>
<a id="__codelineno-104-14" name="__codelineno-104-14"></a>    <span class="p">{{</span> <span class="n">form_obj</span><span class="o">.</span><span class="n">as_p</span> <span class="p">}}</span>
<a id="__codelineno-104-15" name="__codelineno-104-15"></a>    <span class="p">{{</span> <span class="n">form_obj</span><span class="o">.</span><span class="n">as_ul</span> <span class="p">}}</span>
<a id="__codelineno-104-16" name="__codelineno-104-16"></a>    <span class="p">{{</span> <span class="n">form_obj</span><span class="o">.</span><span class="n">as_table</span> <span class="p">}}</span>
<a id="__codelineno-104-17" name="__codelineno-104-17"></a>    <span class="c1">## 上面三种写法三选一即可，就是不同的渲染方式</span>
<a id="__codelineno-104-18" name="__codelineno-104-18"></a>    <span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="n">第二种渲染方式</span><span class="p">:</span><span class="n">可扩展性很强</span> <span class="n">但是需要书写的代码太多</span>  <span class="n">一般情况下不用</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
<a id="__codelineno-104-19" name="__codelineno-104-19"></a>
<a id="__codelineno-104-20" name="__codelineno-104-20"></a>    <span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="p">{{</span> <span class="n">form_obj</span><span class="o">.</span><span class="n">username</span><span class="o">.</span><span class="n">label</span> <span class="p">}}:{{</span> <span class="n">form_obj</span><span class="o">.</span><span class="n">username</span> <span class="p">}}</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
<a id="__codelineno-104-21" name="__codelineno-104-21"></a>
<a id="__codelineno-104-22" name="__codelineno-104-22"></a>    <span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="p">{{</span> <span class="n">form_obj</span><span class="o">.</span><span class="n">password</span><span class="o">.</span><span class="n">label</span> <span class="p">}}:{{</span> <span class="n">form_obj</span><span class="o">.</span><span class="n">password</span> <span class="p">}}</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
<a id="__codelineno-104-23" name="__codelineno-104-23"></a>
<a id="__codelineno-104-24" name="__codelineno-104-24"></a>    <span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="p">{{</span> <span class="n">form_obj</span><span class="o">.</span><span class="n">email</span><span class="o">.</span><span class="n">label</span> <span class="p">}}:{{</span> <span class="n">form_obj</span><span class="o">.</span><span class="n">email</span> <span class="p">}}</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
<a id="__codelineno-104-25" name="__codelineno-104-25"></a>
<a id="__codelineno-104-26" name="__codelineno-104-26"></a>    <span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="n">第三种渲染方式</span><span class="p">(</span><span class="n">推荐使用</span><span class="p">):</span><span class="n">代码书写简单</span> <span class="n">并且扩展性也高</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
<a id="__codelineno-104-27" name="__codelineno-104-27"></a>
<a id="__codelineno-104-28" name="__codelineno-104-28"></a>    <span class="p">{</span><span class="o">%</span> <span class="k">for</span> <span class="n">form</span> <span class="ow">in</span> <span class="n">form_obj</span> <span class="o">%</span><span class="p">}</span>
<a id="__codelineno-104-29" name="__codelineno-104-29"></a>        <span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="p">{{</span> <span class="n">form</span><span class="o">.</span><span class="n">label</span> <span class="p">}}:{{</span> <span class="n">form</span> <span class="p">}}</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
<a id="__codelineno-104-30" name="__codelineno-104-30"></a>
<a id="__codelineno-104-31" name="__codelineno-104-31"></a>    <span class="p">{</span><span class="o">%</span> <span class="n">endfor</span> <span class="o">%</span><span class="p">}</span>
<a id="__codelineno-104-32" name="__codelineno-104-32"></a>
<a id="__codelineno-104-33" name="__codelineno-104-33"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-104-34" name="__codelineno-104-34"></a><span class="sd">label属性默认展示的是类中定义的字段首字母大写的形式</span>
<a id="__codelineno-104-35" name="__codelineno-104-35"></a><span class="sd">也可以自己修改 直接给字段对象加label属性即可</span>
<a id="__codelineno-104-36" name="__codelineno-104-36"></a><span class="sd">     username = forms.CharField(min_length=3,max_length=8,label=&#39;用户名&#39;)</span>
<a id="__codelineno-104-37" name="__codelineno-104-37"></a><span class="sd">&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
<h3 id="18-5-展示提示信息">18-5 展示提示信息<a class="headerlink" href="#18-5-展示提示信息" title="Permanent link">&para;</a></h3>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-105-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-105-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-105-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-105-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-105-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-105-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-105-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-105-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-105-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-105-10">10</a></span>
<span class="normal"><a href="#__codelineno-105-11">11</a></span>
<span class="normal"><a href="#__codelineno-105-12">12</a></span>
<span class="normal"><a href="#__codelineno-105-13">13</a></span>
<span class="normal"><a href="#__codelineno-105-14">14</a></span>
<span class="normal"><a href="#__codelineno-105-15">15</a></span>
<span class="normal"><a href="#__codelineno-105-16">16</a></span>
<span class="normal"><a href="#__codelineno-105-17">17</a></span>
<span class="normal"><a href="#__codelineno-105-18">18</a></span>
<span class="normal"><a href="#__codelineno-105-19">19</a></span>
<span class="normal"><a href="#__codelineno-105-20">20</a></span>
<span class="normal"><a href="#__codelineno-105-21">21</a></span>
<span class="normal"><a href="#__codelineno-105-22">22</a></span>
<span class="normal"><a href="#__codelineno-105-23">23</a></span>
<span class="normal"><a href="#__codelineno-105-24">24</a></span>
<span class="normal"><a href="#__codelineno-105-25">25</a></span>
<span class="normal"><a href="#__codelineno-105-26">26</a></span>
<span class="normal"><a href="#__codelineno-105-27">27</a></span>
<span class="normal"><a href="#__codelineno-105-28">28</a></span>
<span class="normal"><a href="#__codelineno-105-29">29</a></span>
<span class="normal"><a href="#__codelineno-105-30">30</a></span>
<span class="normal"><a href="#__codelineno-105-31">31</a></span>
<span class="normal"><a href="#__codelineno-105-32">32</a></span>
<span class="normal"><a href="#__codelineno-105-33">33</a></span>
<span class="normal"><a href="#__codelineno-105-34">34</a></span>
<span class="normal"><a href="#__codelineno-105-35">35</a></span>
<span class="normal"><a href="#__codelineno-105-36">36</a></span>
<span class="normal"><a href="#__codelineno-105-37">37</a></span>
<span class="normal"><a href="#__codelineno-105-38">38</a></span>
<span class="normal"><a href="#__codelineno-105-39">39</a></span>
<span class="normal"><a href="#__codelineno-105-40">40</a></span>
<span class="normal"><a href="#__codelineno-105-41">41</a></span>
<span class="normal"><a href="#__codelineno-105-42">42</a></span>
<span class="normal"><a href="#__codelineno-105-43">43</a></span>
<span class="normal"><a href="#__codelineno-105-44">44</a></span>
<span class="normal"><a href="#__codelineno-105-45">45</a></span>
<span class="normal"><a href="#__codelineno-105-46">46</a></span>
<span class="normal"><a href="#__codelineno-105-47">47</a></span>
<span class="normal"><a href="#__codelineno-105-48">48</a></span>
<span class="normal"><a href="#__codelineno-105-49">49</a></span>
<span class="normal"><a href="#__codelineno-105-50">50</a></span>
<span class="normal"><a href="#__codelineno-105-51">51</a></span>
<span class="normal"><a href="#__codelineno-105-52">52</a></span>
<span class="normal"><a href="#__codelineno-105-53">53</a></span>
<span class="normal"><a href="#__codelineno-105-54">54</a></span>
<span class="normal"><a href="#__codelineno-105-55">55</a></span>
<span class="normal"><a href="#__codelineno-105-56">56</a></span>
<span class="normal"><a href="#__codelineno-105-57">57</a></span>
<span class="normal"><a href="#__codelineno-105-58">58</a></span>
<span class="normal"><a href="#__codelineno-105-59">59</a></span>
<span class="normal"><a href="#__codelineno-105-60">60</a></span>
<span class="normal"><a href="#__codelineno-105-61">61</a></span>
<span class="normal"><a href="#__codelineno-105-62">62</a></span>
<span class="normal"><a href="#__codelineno-105-63">63</a></span>
<span class="normal"><a href="#__codelineno-105-64">64</a></span>
<span class="normal"><a href="#__codelineno-105-65">65</a></span>
<span class="normal"><a href="#__codelineno-105-66">66</a></span>
<span class="normal"><a href="#__codelineno-105-67">67</a></span>
<span class="normal"><a href="#__codelineno-105-68">68</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-105-1" name="__codelineno-105-1"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-105-2" name="__codelineno-105-2"></a><span class="sd">浏览器会自动帮你校验数据 但是前端的校验弱不禁风</span>
<a id="__codelineno-105-3" name="__codelineno-105-3"></a><span class="sd">如何让浏览器不做校验</span>
<a id="__codelineno-105-4" name="__codelineno-105-4"></a><span class="sd">    &lt;form action=&quot;&quot; method=&quot;post&quot; novalidate&gt;</span>
<a id="__codelineno-105-5" name="__codelineno-105-5"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-105-6" name="__codelineno-105-6"></a>
<a id="__codelineno-105-7" name="__codelineno-105-7"></a><span class="k">def</span><span class="w"> </span><span class="nf">index</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
<a id="__codelineno-105-8" name="__codelineno-105-8"></a>    <span class="c1"># 1 先产生一个空对象</span>
<a id="__codelineno-105-9" name="__codelineno-105-9"></a>    <span class="n">form_obj</span> <span class="o">=</span> <span class="n">MyForm</span><span class="p">()</span>
<a id="__codelineno-105-10" name="__codelineno-105-10"></a>    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;POST&#39;</span><span class="p">:</span>
<a id="__codelineno-105-11" name="__codelineno-105-11"></a>        <span class="c1"># 获取用户数据并且校验</span>
<a id="__codelineno-105-12" name="__codelineno-105-12"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-105-13" name="__codelineno-105-13"></a><span class="sd">        1.数据获取繁琐</span>
<a id="__codelineno-105-14" name="__codelineno-105-14"></a><span class="sd">        2.校验数据需要构造成字典的格式传入才行</span>
<a id="__codelineno-105-15" name="__codelineno-105-15"></a><span class="sd">        ps:但是request.POST可以看成就是一个字典</span>
<a id="__codelineno-105-16" name="__codelineno-105-16"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-105-17" name="__codelineno-105-17"></a>        <span class="c1"># 3.校验数据</span>
<a id="__codelineno-105-18" name="__codelineno-105-18"></a>        <span class="n">form_obj</span> <span class="o">=</span> <span class="n">MyForm</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="p">)</span>
<a id="__codelineno-105-19" name="__codelineno-105-19"></a>        <span class="c1"># 4.判断数据是否合法</span>
<a id="__codelineno-105-20" name="__codelineno-105-20"></a>        <span class="k">if</span> <span class="n">form_obj</span><span class="o">.</span><span class="n">is_valid</span><span class="p">():</span>
<a id="__codelineno-105-21" name="__codelineno-105-21"></a>            <span class="c1"># 5.如果合法 操作数据库存储数据</span>
<a id="__codelineno-105-22" name="__codelineno-105-22"></a>            <span class="k">return</span> <span class="n">HttpResponse</span><span class="p">(</span><span class="s1">&#39;OK&#39;</span><span class="p">)</span>
<a id="__codelineno-105-23" name="__codelineno-105-23"></a>        <span class="c1"># 5.不合法 有错误</span>
<a id="__codelineno-105-24" name="__codelineno-105-24"></a>    <span class="c1"># 2 直接将该空对象传递给html页面</span>
<a id="__codelineno-105-25" name="__codelineno-105-25"></a>    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span><span class="s1">&#39;index.html&#39;</span><span class="p">,</span><span class="nb">locals</span><span class="p">())</span>
<a id="__codelineno-105-26" name="__codelineno-105-26"></a>
<a id="__codelineno-105-27" name="__codelineno-105-27"></a><span class="c1">## 前端页面渲染</span>
<a id="__codelineno-105-28" name="__codelineno-105-28"></a><span class="p">{</span><span class="o">%</span> <span class="k">for</span> <span class="n">form</span> <span class="ow">in</span> <span class="n">form_obj</span> <span class="o">%</span><span class="p">}</span>
<a id="__codelineno-105-29" name="__codelineno-105-29"></a>        <span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span>
<a id="__codelineno-105-30" name="__codelineno-105-30"></a>            <span class="p">{{</span> <span class="n">form</span><span class="o">.</span><span class="n">label</span> <span class="p">}}:{{</span> <span class="n">form</span> <span class="p">}}</span>
<a id="__codelineno-105-31" name="__codelineno-105-31"></a>            <span class="o">&lt;</span><span class="n">span</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;color: red&quot;</span><span class="o">&gt;</span><span class="p">{{</span> <span class="n">form</span><span class="o">.</span><span class="n">errors</span><span class="mf">.0</span> <span class="p">}}</span><span class="o">&lt;/</span><span class="n">span</span><span class="o">&gt;</span>
<a id="__codelineno-105-32" name="__codelineno-105-32"></a>
<a id="__codelineno-105-33" name="__codelineno-105-33"></a>        <span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
<a id="__codelineno-105-34" name="__codelineno-105-34"></a>
<a id="__codelineno-105-35" name="__codelineno-105-35"></a><span class="p">{</span><span class="o">%</span> <span class="n">endfor</span> <span class="o">%</span><span class="p">}</span>
<a id="__codelineno-105-36" name="__codelineno-105-36"></a>
<a id="__codelineno-105-37" name="__codelineno-105-37"></a><span class="c1">## 如果不想让前端也进行校验，那么在form标签加一个novalidate</span>
<a id="__codelineno-105-38" name="__codelineno-105-38"></a>
<a id="__codelineno-105-39" name="__codelineno-105-39"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-105-40" name="__codelineno-105-40"></a><span class="sd">1.必备的条件 get请求和post传给html页面对象变量名必须一样</span>
<a id="__codelineno-105-41" name="__codelineno-105-41"></a><span class="sd">2.forms组件当你的数据不合法的情况下 会保存你上次的数据 让你基于之前的结果进行修改</span>
<a id="__codelineno-105-42" name="__codelineno-105-42"></a><span class="sd">更加的人性化</span>
<a id="__codelineno-105-43" name="__codelineno-105-43"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-105-44" name="__codelineno-105-44"></a><span class="c1"># 针对错误的提示信息还可以自己自定制</span>
<a id="__codelineno-105-45" name="__codelineno-105-45"></a><span class="k">class</span><span class="w"> </span><span class="nc">MyForm</span><span class="p">(</span><span class="n">forms</span><span class="o">.</span><span class="n">Form</span><span class="p">):</span>
<a id="__codelineno-105-46" name="__codelineno-105-46"></a>    <span class="c1"># username字符串类型最小3位最大8位</span>
<a id="__codelineno-105-47" name="__codelineno-105-47"></a>    <span class="n">username</span> <span class="o">=</span> <span class="n">forms</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">min_length</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">max_length</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;用户名&#39;</span><span class="p">,</span>
<a id="__codelineno-105-48" name="__codelineno-105-48"></a>                               <span class="n">error_messages</span><span class="o">=</span><span class="p">{</span>
<a id="__codelineno-105-49" name="__codelineno-105-49"></a>                                   <span class="s1">&#39;min_length&#39;</span><span class="p">:</span><span class="s1">&#39;用户名最少3位&#39;</span><span class="p">,</span>
<a id="__codelineno-105-50" name="__codelineno-105-50"></a>                                   <span class="s1">&#39;max_length&#39;</span><span class="p">:</span><span class="s1">&#39;用户名最大8位&#39;</span><span class="p">,</span>
<a id="__codelineno-105-51" name="__codelineno-105-51"></a>                                   <span class="s1">&#39;required&#39;</span><span class="p">:</span><span class="s2">&quot;用户名不能为空&quot;</span>
<a id="__codelineno-105-52" name="__codelineno-105-52"></a>                               <span class="p">}</span>
<a id="__codelineno-105-53" name="__codelineno-105-53"></a>                               <span class="p">)</span>
<a id="__codelineno-105-54" name="__codelineno-105-54"></a>    <span class="c1"># password字符串类型最小3位最大8位</span>
<a id="__codelineno-105-55" name="__codelineno-105-55"></a>    <span class="n">password</span> <span class="o">=</span> <span class="n">forms</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">min_length</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">max_length</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;密码&#39;</span><span class="p">,</span>
<a id="__codelineno-105-56" name="__codelineno-105-56"></a>                               <span class="n">error_messages</span><span class="o">=</span><span class="p">{</span>
<a id="__codelineno-105-57" name="__codelineno-105-57"></a>                                   <span class="s1">&#39;min_length&#39;</span><span class="p">:</span> <span class="s1">&#39;密码最少3位&#39;</span><span class="p">,</span>
<a id="__codelineno-105-58" name="__codelineno-105-58"></a>                                   <span class="s1">&#39;max_length&#39;</span><span class="p">:</span> <span class="s1">&#39;密码最大8位&#39;</span><span class="p">,</span>
<a id="__codelineno-105-59" name="__codelineno-105-59"></a>                                   <span class="s1">&#39;required&#39;</span><span class="p">:</span> <span class="s2">&quot;密码不能为空&quot;</span>
<a id="__codelineno-105-60" name="__codelineno-105-60"></a>                               <span class="p">}</span>
<a id="__codelineno-105-61" name="__codelineno-105-61"></a>                               <span class="p">)</span>
<a id="__codelineno-105-62" name="__codelineno-105-62"></a>    <span class="c1"># email字段必须符合邮箱格式  xxx@xx.com</span>
<a id="__codelineno-105-63" name="__codelineno-105-63"></a>    <span class="n">email</span> <span class="o">=</span> <span class="n">forms</span><span class="o">.</span><span class="n">EmailField</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;邮箱&#39;</span><span class="p">,</span>
<a id="__codelineno-105-64" name="__codelineno-105-64"></a>                             <span class="n">error_messages</span><span class="o">=</span><span class="p">{</span>
<a id="__codelineno-105-65" name="__codelineno-105-65"></a>                                 <span class="s1">&#39;invalid&#39;</span><span class="p">:</span><span class="s1">&#39;邮箱格式不正确&#39;</span><span class="p">,</span>
<a id="__codelineno-105-66" name="__codelineno-105-66"></a>                                 <span class="s1">&#39;required&#39;</span><span class="p">:</span> <span class="s2">&quot;邮箱不能为空&quot;</span>
<a id="__codelineno-105-67" name="__codelineno-105-67"></a>                             <span class="p">}</span>
<a id="__codelineno-105-68" name="__codelineno-105-68"></a>                             <span class="p">)</span>
</code></pre></div></td></tr></table></div>
<h3 id="18-6-钩子函数hook">18-6 钩子函数(HOOK)<a class="headerlink" href="#18-6-钩子函数hook" title="Permanent link">&para;</a></h3>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-106-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-106-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-106-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-106-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-106-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-106-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-106-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-106-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-106-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-106-10">10</a></span>
<span class="normal"><a href="#__codelineno-106-11">11</a></span>
<span class="normal"><a href="#__codelineno-106-12">12</a></span>
<span class="normal"><a href="#__codelineno-106-13">13</a></span>
<span class="normal"><a href="#__codelineno-106-14">14</a></span>
<span class="normal"><a href="#__codelineno-106-15">15</a></span>
<span class="normal"><a href="#__codelineno-106-16">16</a></span>
<span class="normal"><a href="#__codelineno-106-17">17</a></span>
<span class="normal"><a href="#__codelineno-106-18">18</a></span>
<span class="normal"><a href="#__codelineno-106-19">19</a></span>
<span class="normal"><a href="#__codelineno-106-20">20</a></span>
<span class="normal"><a href="#__codelineno-106-21">21</a></span>
<span class="normal"><a href="#__codelineno-106-22">22</a></span>
<span class="normal"><a href="#__codelineno-106-23">23</a></span>
<span class="normal"><a href="#__codelineno-106-24">24</a></span>
<span class="normal"><a href="#__codelineno-106-25">25</a></span>
<span class="normal"><a href="#__codelineno-106-26">26</a></span>
<span class="normal"><a href="#__codelineno-106-27">27</a></span>
<span class="normal"><a href="#__codelineno-106-28">28</a></span>
<span class="normal"><a href="#__codelineno-106-29">29</a></span>
<span class="normal"><a href="#__codelineno-106-30">30</a></span>
<span class="normal"><a href="#__codelineno-106-31">31</a></span>
<span class="normal"><a href="#__codelineno-106-32">32</a></span>
<span class="normal"><a href="#__codelineno-106-33">33</a></span>
<span class="normal"><a href="#__codelineno-106-34">34</a></span>
<span class="normal"><a href="#__codelineno-106-35">35</a></span>
<span class="normal"><a href="#__codelineno-106-36">36</a></span>
<span class="normal"><a href="#__codelineno-106-37">37</a></span>
<span class="normal"><a href="#__codelineno-106-38">38</a></span>
<span class="normal"><a href="#__codelineno-106-39">39</a></span>
<span class="normal"><a href="#__codelineno-106-40">40</a></span>
<span class="normal"><a href="#__codelineno-106-41">41</a></span>
<span class="normal"><a href="#__codelineno-106-42">42</a></span>
<span class="normal"><a href="#__codelineno-106-43">43</a></span>
<span class="normal"><a href="#__codelineno-106-44">44</a></span>
<span class="normal"><a href="#__codelineno-106-45">45</a></span>
<span class="normal"><a href="#__codelineno-106-46">46</a></span>
<span class="normal"><a href="#__codelineno-106-47">47</a></span>
<span class="normal"><a href="#__codelineno-106-48">48</a></span>
<span class="normal"><a href="#__codelineno-106-49">49</a></span>
<span class="normal"><a href="#__codelineno-106-50">50</a></span>
<span class="normal"><a href="#__codelineno-106-51">51</a></span>
<span class="normal"><a href="#__codelineno-106-52">52</a></span>
<span class="normal"><a href="#__codelineno-106-53">53</a></span>
<span class="normal"><a href="#__codelineno-106-54">54</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-106-1" name="__codelineno-106-1"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-106-2" name="__codelineno-106-2"></a><span class="sd">在特定的节点自动触发完成响应操作</span>
<a id="__codelineno-106-3" name="__codelineno-106-3"></a>
<a id="__codelineno-106-4" name="__codelineno-106-4"></a><span class="sd">钩子函数在forms组件中就类似于第二道关卡，能够让我们自定义校验规则</span>
<a id="__codelineno-106-5" name="__codelineno-106-5"></a>
<a id="__codelineno-106-6" name="__codelineno-106-6"></a><span class="sd">在forms组件中有两类钩子</span>
<a id="__codelineno-106-7" name="__codelineno-106-7"></a><span class="sd">    1.局部钩子</span>
<a id="__codelineno-106-8" name="__codelineno-106-8"></a><span class="sd">        当你需要给单个字段增加校验规则的时候可以使用</span>
<a id="__codelineno-106-9" name="__codelineno-106-9"></a><span class="sd">    2.全局钩子</span>
<a id="__codelineno-106-10" name="__codelineno-106-10"></a><span class="sd">      当你需要给多个字段增加校验规则的时候可以使用</span>
<a id="__codelineno-106-11" name="__codelineno-106-11"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-106-12" name="__codelineno-106-12"></a><span class="c1"># 实际案例</span>
<a id="__codelineno-106-13" name="__codelineno-106-13"></a>
<a id="__codelineno-106-14" name="__codelineno-106-14"></a><span class="c1"># 1.校验用户名中不能含有666               只是校验username字段  局部钩子</span>
<a id="__codelineno-106-15" name="__codelineno-106-15"></a>
<a id="__codelineno-106-16" name="__codelineno-106-16"></a><span class="c1"># 2.校验密码和确认密码是否一致           password confirm两个字段    全局钩子</span>
<a id="__codelineno-106-17" name="__codelineno-106-17"></a>
<a id="__codelineno-106-18" name="__codelineno-106-18"></a><span class="c1"># 钩子函数  在类里面书写方法即可</span>
<a id="__codelineno-106-19" name="__codelineno-106-19"></a>    <span class="c1"># 局部钩子</span>
<a id="__codelineno-106-20" name="__codelineno-106-20"></a>    <span class="kn">from</span><span class="w"> </span><span class="nn">django</span><span class="w"> </span><span class="kn">import</span> <span class="n">forms</span>
<a id="__codelineno-106-21" name="__codelineno-106-21"></a>    <span class="k">class</span><span class="w"> </span><span class="nc">MyForm</span><span class="p">(</span><span class="n">forms</span><span class="o">.</span><span class="n">Form</span><span class="p">):</span>
<a id="__codelineno-106-22" name="__codelineno-106-22"></a>        <span class="c1"># username字符串类型最小3位最大8位</span>
<a id="__codelineno-106-23" name="__codelineno-106-23"></a>        <span class="n">username</span> <span class="o">=</span> <span class="n">forms</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">min_length</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">max_length</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<a id="__codelineno-106-24" name="__codelineno-106-24"></a>        <span class="c1"># password字符串类型最小3位最大8位</span>
<a id="__codelineno-106-25" name="__codelineno-106-25"></a>        <span class="n">password</span> <span class="o">=</span> <span class="n">forms</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">min_length</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">max_length</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<a id="__codelineno-106-26" name="__codelineno-106-26"></a>        <span class="c1"># email字段必须符合邮箱格式  xxx@xx.com</span>
<a id="__codelineno-106-27" name="__codelineno-106-27"></a>        <span class="n">email</span> <span class="o">=</span> <span class="n">forms</span><span class="o">.</span><span class="n">EmailField</span><span class="p">()</span>
<a id="__codelineno-106-28" name="__codelineno-106-28"></a>
<a id="__codelineno-106-29" name="__codelineno-106-29"></a>        <span class="k">def</span><span class="w"> </span><span class="nf">clean_username</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-106-30" name="__codelineno-106-30"></a>            <span class="c1"># 获取到用户名</span>
<a id="__codelineno-106-31" name="__codelineno-106-31"></a>            <span class="n">username</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cleaned_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;username&#39;</span><span class="p">)</span>
<a id="__codelineno-106-32" name="__codelineno-106-32"></a>            <span class="k">if</span> <span class="s1">&#39;666&#39;</span> <span class="ow">in</span> <span class="n">username</span><span class="p">:</span>
<a id="__codelineno-106-33" name="__codelineno-106-33"></a>                <span class="c1"># 提示前端展示错误信息</span>
<a id="__codelineno-106-34" name="__codelineno-106-34"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">add_error</span><span class="p">(</span><span class="s1">&#39;username&#39;</span><span class="p">,</span><span class="s1">&#39;光喊666是不行滴～&#39;</span><span class="p">)</span>
<a id="__codelineno-106-35" name="__codelineno-106-35"></a>            <span class="c1"># 将钩子函数钩去出来数据再放回去</span>
<a id="__codelineno-106-36" name="__codelineno-106-36"></a>            <span class="k">return</span> <span class="n">username</span>
<a id="__codelineno-106-37" name="__codelineno-106-37"></a>
<a id="__codelineno-106-38" name="__codelineno-106-38"></a>
<a id="__codelineno-106-39" name="__codelineno-106-39"></a>    <span class="k">class</span><span class="w"> </span><span class="nc">MyForm</span><span class="p">(</span><span class="n">forms</span><span class="o">.</span><span class="n">Form</span><span class="p">):</span>
<a id="__codelineno-106-40" name="__codelineno-106-40"></a>        <span class="c1"># username字符串类型最小3位最大8位</span>
<a id="__codelineno-106-41" name="__codelineno-106-41"></a>        <span class="n">username</span> <span class="o">=</span> <span class="n">forms</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">min_length</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">max_length</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<a id="__codelineno-106-42" name="__codelineno-106-42"></a>        <span class="c1"># password字符串类型最小3位最大8位</span>
<a id="__codelineno-106-43" name="__codelineno-106-43"></a>        <span class="n">password</span> <span class="o">=</span> <span class="n">forms</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">min_length</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">max_length</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<a id="__codelineno-106-44" name="__codelineno-106-44"></a>        <span class="c1"># email字段必须符合邮箱格式  xxx@xx.com</span>
<a id="__codelineno-106-45" name="__codelineno-106-45"></a>        <span class="n">email</span> <span class="o">=</span> <span class="n">forms</span><span class="o">.</span><span class="n">EmailField</span><span class="p">()</span>  
<a id="__codelineno-106-46" name="__codelineno-106-46"></a>
<a id="__codelineno-106-47" name="__codelineno-106-47"></a>        <span class="c1"># 全局钩子</span>
<a id="__codelineno-106-48" name="__codelineno-106-48"></a>        <span class="k">def</span><span class="w"> </span><span class="nf">clean</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-106-49" name="__codelineno-106-49"></a>            <span class="n">password</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cleaned_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;password&#39;</span><span class="p">)</span>
<a id="__codelineno-106-50" name="__codelineno-106-50"></a>            <span class="n">confirm_password</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cleaned_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;confirm_password&#39;</span><span class="p">)</span>
<a id="__codelineno-106-51" name="__codelineno-106-51"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">confirm_password</span> <span class="o">==</span> <span class="n">password</span><span class="p">:</span>
<a id="__codelineno-106-52" name="__codelineno-106-52"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">add_error</span><span class="p">(</span><span class="s1">&#39;confirm_password&#39;</span><span class="p">,</span><span class="s1">&#39;两次密码不一致&#39;</span><span class="p">)</span>
<a id="__codelineno-106-53" name="__codelineno-106-53"></a>            <span class="c1"># 将钩子函数钩出来数据再放回去</span>
<a id="__codelineno-106-54" name="__codelineno-106-54"></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cleaned_data</span>
</code></pre></div></td></tr></table></div>
<h3 id="18-7-forms组件其他参数及补充知识点">18-7 forms组件其他参数及补充知识点<a class="headerlink" href="#18-7-forms组件其他参数及补充知识点" title="Permanent link">&para;</a></h3>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-107-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-107-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-107-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-107-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-107-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-107-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-107-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-107-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-107-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-107-10">10</a></span>
<span class="normal"><a href="#__codelineno-107-11">11</a></span>
<span class="normal"><a href="#__codelineno-107-12">12</a></span>
<span class="normal"><a href="#__codelineno-107-13">13</a></span>
<span class="normal"><a href="#__codelineno-107-14">14</a></span>
<span class="normal"><a href="#__codelineno-107-15">15</a></span>
<span class="normal"><a href="#__codelineno-107-16">16</a></span>
<span class="normal"><a href="#__codelineno-107-17">17</a></span>
<span class="normal"><a href="#__codelineno-107-18">18</a></span>
<span class="normal"><a href="#__codelineno-107-19">19</a></span>
<span class="normal"><a href="#__codelineno-107-20">20</a></span>
<span class="normal"><a href="#__codelineno-107-21">21</a></span>
<span class="normal"><a href="#__codelineno-107-22">22</a></span>
<span class="normal"><a href="#__codelineno-107-23">23</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-107-1" name="__codelineno-107-1"></a><span class="n">label</span>       <span class="n">字段名</span>
<a id="__codelineno-107-2" name="__codelineno-107-2"></a><span class="n">error_messages</span>  <span class="n">自定义报错信息</span>
<a id="__codelineno-107-3" name="__codelineno-107-3"></a><span class="n">initial</span>  <span class="n">默认值</span>
<a id="__codelineno-107-4" name="__codelineno-107-4"></a><span class="n">required</span>  <span class="n">控制字段是否必填</span>
<a id="__codelineno-107-5" name="__codelineno-107-5"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-107-6" name="__codelineno-107-6"></a><span class="sd">1.字段没有样式</span>
<a id="__codelineno-107-7" name="__codelineno-107-7"></a><span class="sd">2.针对不同类型的input如何修改</span>
<a id="__codelineno-107-8" name="__codelineno-107-8"></a><span class="sd">    text</span>
<a id="__codelineno-107-9" name="__codelineno-107-9"></a><span class="sd">    password</span>
<a id="__codelineno-107-10" name="__codelineno-107-10"></a><span class="sd">    date</span>
<a id="__codelineno-107-11" name="__codelineno-107-11"></a><span class="sd">    radio</span>
<a id="__codelineno-107-12" name="__codelineno-107-12"></a><span class="sd">    checkbox</span>
<a id="__codelineno-107-13" name="__codelineno-107-13"></a><span class="sd">    ...</span>
<a id="__codelineno-107-14" name="__codelineno-107-14"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-107-15" name="__codelineno-107-15"></a><span class="n">widget</span><span class="o">=</span><span class="n">forms</span><span class="o">.</span><span class="n">widgets</span><span class="o">.</span><span class="n">PasswordInput</span><span class="p">(</span><span class="n">attrs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;class&#39;</span><span class="p">:</span><span class="s1">&#39;form-control c1 c2&#39;</span><span class="p">})</span>
<a id="__codelineno-107-16" name="__codelineno-107-16"></a><span class="c1"># 多个属性值的话 直接空格隔开即可</span>
<a id="__codelineno-107-17" name="__codelineno-107-17"></a>
<a id="__codelineno-107-18" name="__codelineno-107-18"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.core.validators</span><span class="w"> </span><span class="kn">import</span> <span class="n">RegexValidator</span>
<a id="__codelineno-107-19" name="__codelineno-107-19"></a><span class="c1"># 第一道关卡里面还支持正则校验</span>
<a id="__codelineno-107-20" name="__codelineno-107-20"></a><span class="n">validators</span><span class="o">=</span><span class="p">[</span>
<a id="__codelineno-107-21" name="__codelineno-107-21"></a>            <span class="n">RegexValidator</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^[0-9]+$&#39;</span><span class="p">,</span> <span class="s1">&#39;请输入数字&#39;</span><span class="p">),</span>
<a id="__codelineno-107-22" name="__codelineno-107-22"></a>            <span class="n">RegexValidator</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^159[0-9]+$&#39;</span><span class="p">,</span> <span class="s1">&#39;数字必须以159开头&#39;</span><span class="p">)</span>
<a id="__codelineno-107-23" name="__codelineno-107-23"></a>        <span class="p">]</span>
</code></pre></div></td></tr></table></div>
<h3 id="18-8-其他类型渲染">18-8 其他类型渲染<a class="headerlink" href="#18-8-其他类型渲染" title="Permanent link">&para;</a></h3>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-108-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-108-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-108-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-108-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-108-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-108-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-108-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-108-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-108-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-108-10">10</a></span>
<span class="normal"><a href="#__codelineno-108-11">11</a></span>
<span class="normal"><a href="#__codelineno-108-12">12</a></span>
<span class="normal"><a href="#__codelineno-108-13">13</a></span>
<span class="normal"><a href="#__codelineno-108-14">14</a></span>
<span class="normal"><a href="#__codelineno-108-15">15</a></span>
<span class="normal"><a href="#__codelineno-108-16">16</a></span>
<span class="normal"><a href="#__codelineno-108-17">17</a></span>
<span class="normal"><a href="#__codelineno-108-18">18</a></span>
<span class="normal"><a href="#__codelineno-108-19">19</a></span>
<span class="normal"><a href="#__codelineno-108-20">20</a></span>
<span class="normal"><a href="#__codelineno-108-21">21</a></span>
<span class="normal"><a href="#__codelineno-108-22">22</a></span>
<span class="normal"><a href="#__codelineno-108-23">23</a></span>
<span class="normal"><a href="#__codelineno-108-24">24</a></span>
<span class="normal"><a href="#__codelineno-108-25">25</a></span>
<span class="normal"><a href="#__codelineno-108-26">26</a></span>
<span class="normal"><a href="#__codelineno-108-27">27</a></span>
<span class="normal"><a href="#__codelineno-108-28">28</a></span>
<span class="normal"><a href="#__codelineno-108-29">29</a></span>
<span class="normal"><a href="#__codelineno-108-30">30</a></span>
<span class="normal"><a href="#__codelineno-108-31">31</a></span>
<span class="normal"><a href="#__codelineno-108-32">32</a></span>
<span class="normal"><a href="#__codelineno-108-33">33</a></span>
<span class="normal"><a href="#__codelineno-108-34">34</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-108-1" name="__codelineno-108-1"></a><span class="c1"># radio</span>
<a id="__codelineno-108-2" name="__codelineno-108-2"></a>    <span class="n">gender</span> <span class="o">=</span> <span class="n">forms</span><span class="o">.</span><span class="n">ChoiceField</span><span class="p">(</span>
<a id="__codelineno-108-3" name="__codelineno-108-3"></a>        <span class="n">choices</span><span class="o">=</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;男&quot;</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;女&quot;</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;保密&quot;</span><span class="p">)),</span>
<a id="__codelineno-108-4" name="__codelineno-108-4"></a>        <span class="n">label</span><span class="o">=</span><span class="s2">&quot;性别&quot;</span><span class="p">,</span>
<a id="__codelineno-108-5" name="__codelineno-108-5"></a>        <span class="n">initial</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
<a id="__codelineno-108-6" name="__codelineno-108-6"></a>        <span class="n">widget</span><span class="o">=</span><span class="n">forms</span><span class="o">.</span><span class="n">widgets</span><span class="o">.</span><span class="n">RadioSelect</span><span class="p">()</span>
<a id="__codelineno-108-7" name="__codelineno-108-7"></a>    <span class="p">)</span>
<a id="__codelineno-108-8" name="__codelineno-108-8"></a>    <span class="c1"># select</span>
<a id="__codelineno-108-9" name="__codelineno-108-9"></a>    <span class="n">hobby</span> <span class="o">=</span> <span class="n">forms</span><span class="o">.</span><span class="n">ChoiceField</span><span class="p">(</span>
<a id="__codelineno-108-10" name="__codelineno-108-10"></a>        <span class="n">choices</span><span class="o">=</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;篮球&quot;</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;足球&quot;</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;双色球&quot;</span><span class="p">),),</span>
<a id="__codelineno-108-11" name="__codelineno-108-11"></a>        <span class="n">label</span><span class="o">=</span><span class="s2">&quot;爱好&quot;</span><span class="p">,</span>
<a id="__codelineno-108-12" name="__codelineno-108-12"></a>        <span class="n">initial</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
<a id="__codelineno-108-13" name="__codelineno-108-13"></a>        <span class="n">widget</span><span class="o">=</span><span class="n">forms</span><span class="o">.</span><span class="n">widgets</span><span class="o">.</span><span class="n">Select</span><span class="p">()</span>
<a id="__codelineno-108-14" name="__codelineno-108-14"></a>    <span class="p">)</span>
<a id="__codelineno-108-15" name="__codelineno-108-15"></a>    <span class="c1"># 多选</span>
<a id="__codelineno-108-16" name="__codelineno-108-16"></a>    <span class="n">hobby1</span> <span class="o">=</span> <span class="n">forms</span><span class="o">.</span><span class="n">MultipleChoiceField</span><span class="p">(</span>
<a id="__codelineno-108-17" name="__codelineno-108-17"></a>        <span class="n">choices</span><span class="o">=</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;篮球&quot;</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;足球&quot;</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;双色球&quot;</span><span class="p">),),</span>
<a id="__codelineno-108-18" name="__codelineno-108-18"></a>        <span class="n">label</span><span class="o">=</span><span class="s2">&quot;爱好&quot;</span><span class="p">,</span>
<a id="__codelineno-108-19" name="__codelineno-108-19"></a>        <span class="n">initial</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
<a id="__codelineno-108-20" name="__codelineno-108-20"></a>        <span class="n">widget</span><span class="o">=</span><span class="n">forms</span><span class="o">.</span><span class="n">widgets</span><span class="o">.</span><span class="n">SelectMultiple</span><span class="p">()</span>
<a id="__codelineno-108-21" name="__codelineno-108-21"></a>    <span class="p">)</span>
<a id="__codelineno-108-22" name="__codelineno-108-22"></a>    <span class="c1"># 单选checkbox</span>
<a id="__codelineno-108-23" name="__codelineno-108-23"></a>    <span class="n">keep</span> <span class="o">=</span> <span class="n">forms</span><span class="o">.</span><span class="n">ChoiceField</span><span class="p">(</span>
<a id="__codelineno-108-24" name="__codelineno-108-24"></a>        <span class="n">label</span><span class="o">=</span><span class="s2">&quot;是否记住密码&quot;</span><span class="p">,</span>
<a id="__codelineno-108-25" name="__codelineno-108-25"></a>        <span class="n">initial</span><span class="o">=</span><span class="s2">&quot;checked&quot;</span><span class="p">,</span>
<a id="__codelineno-108-26" name="__codelineno-108-26"></a>        <span class="n">widget</span><span class="o">=</span><span class="n">forms</span><span class="o">.</span><span class="n">widgets</span><span class="o">.</span><span class="n">CheckboxInput</span><span class="p">()</span>
<a id="__codelineno-108-27" name="__codelineno-108-27"></a>    <span class="p">)</span>
<a id="__codelineno-108-28" name="__codelineno-108-28"></a>    <span class="c1"># 多选checkbox</span>
<a id="__codelineno-108-29" name="__codelineno-108-29"></a>    <span class="n">hobby2</span> <span class="o">=</span> <span class="n">forms</span><span class="o">.</span><span class="n">MultipleChoiceField</span><span class="p">(</span>
<a id="__codelineno-108-30" name="__codelineno-108-30"></a>        <span class="n">choices</span><span class="o">=</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;篮球&quot;</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;足球&quot;</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;双色球&quot;</span><span class="p">),),</span>
<a id="__codelineno-108-31" name="__codelineno-108-31"></a>        <span class="n">label</span><span class="o">=</span><span class="s2">&quot;爱好&quot;</span><span class="p">,</span>
<a id="__codelineno-108-32" name="__codelineno-108-32"></a>        <span class="n">initial</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
<a id="__codelineno-108-33" name="__codelineno-108-33"></a>        <span class="n">widget</span><span class="o">=</span><span class="n">forms</span><span class="o">.</span><span class="n">widgets</span><span class="o">.</span><span class="n">CheckboxSelectMultiple</span><span class="p">()</span>
<a id="__codelineno-108-34" name="__codelineno-108-34"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
<h3 id="18-9-forms组件源码">18-9 forms组件源码<a class="headerlink" href="#18-9-forms组件源码" title="Permanent link">&para;</a></h3>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Text Only</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-109-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-109-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-109-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-109-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-109-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-109-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-109-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-109-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-109-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-109-10">10</a></span>
<span class="normal"><a href="#__codelineno-109-11">11</a></span>
<span class="normal"><a href="#__codelineno-109-12">12</a></span>
<span class="normal"><a href="#__codelineno-109-13">13</a></span>
<span class="normal"><a href="#__codelineno-109-14">14</a></span>
<span class="normal"><a href="#__codelineno-109-15">15</a></span>
<span class="normal"><a href="#__codelineno-109-16">16</a></span>
<span class="normal"><a href="#__codelineno-109-17">17</a></span>
<span class="normal"><a href="#__codelineno-109-18">18</a></span>
<span class="normal"><a href="#__codelineno-109-19">19</a></span>
<span class="normal"><a href="#__codelineno-109-20">20</a></span>
<span class="normal"><a href="#__codelineno-109-21">21</a></span>
<span class="normal"><a href="#__codelineno-109-22">22</a></span>
<span class="normal"><a href="#__codelineno-109-23">23</a></span>
<span class="normal"><a href="#__codelineno-109-24">24</a></span>
<span class="normal"><a href="#__codelineno-109-25">25</a></span>
<span class="normal"><a href="#__codelineno-109-26">26</a></span>
<span class="normal"><a href="#__codelineno-109-27">27</a></span>
<span class="normal"><a href="#__codelineno-109-28">28</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-109-1" name="__codelineno-109-1"></a>&quot;&quot;&quot;
<a id="__codelineno-109-2" name="__codelineno-109-2"></a>切入点:
<a id="__codelineno-109-3" name="__codelineno-109-3"></a>    form_obj.is_valid()
<a id="__codelineno-109-4" name="__codelineno-109-4"></a>&quot;&quot;&quot;
<a id="__codelineno-109-5" name="__codelineno-109-5"></a>def is_valid(self):
<a id="__codelineno-109-6" name="__codelineno-109-6"></a>        &quot;&quot;&quot;
<a id="__codelineno-109-7" name="__codelineno-109-7"></a>        Returns True if the form has no errors. Otherwise, False. If errors are
<a id="__codelineno-109-8" name="__codelineno-109-8"></a>        being ignored, returns False.
<a id="__codelineno-109-9" name="__codelineno-109-9"></a>        &quot;&quot;&quot;
<a id="__codelineno-109-10" name="__codelineno-109-10"></a>   return self.is_bound and not self.errors
<a id="__codelineno-109-11" name="__codelineno-109-11"></a>   # 如果is_valid要返回True的话 那么self.is_bound要为True self.errors要为Flase
<a id="__codelineno-109-12" name="__codelineno-109-12"></a>
<a id="__codelineno-109-13" name="__codelineno-109-13"></a>
<a id="__codelineno-109-14" name="__codelineno-109-14"></a>self.is_bound = data is not None or files is not None  # 只要你传值了肯定为True
<a id="__codelineno-109-15" name="__codelineno-109-15"></a>
<a id="__codelineno-109-16" name="__codelineno-109-16"></a>
<a id="__codelineno-109-17" name="__codelineno-109-17"></a>@property
<a id="__codelineno-109-18" name="__codelineno-109-18"></a>def errors(self):
<a id="__codelineno-109-19" name="__codelineno-109-19"></a>        &quot;Returns an ErrorDict for the data provided for the form&quot;
<a id="__codelineno-109-20" name="__codelineno-109-20"></a>        if self._errors is None:
<a id="__codelineno-109-21" name="__codelineno-109-21"></a>            self.full_clean()
<a id="__codelineno-109-22" name="__codelineno-109-22"></a>        return self._errors
<a id="__codelineno-109-23" name="__codelineno-109-23"></a>
<a id="__codelineno-109-24" name="__codelineno-109-24"></a># forms组件所有的功能基本都出自于该方法
<a id="__codelineno-109-25" name="__codelineno-109-25"></a>def full_clean(self):
<a id="__codelineno-109-26" name="__codelineno-109-26"></a>      self._clean_fields()  # 校验字段 + 局部钩子
<a id="__codelineno-109-27" name="__codelineno-109-27"></a>    self._clean_form()  # 全局钩子
<a id="__codelineno-109-28" name="__codelineno-109-28"></a>    self._post_clean()  
</code></pre></div></td></tr></table></div>
<h2 id="19-cookie与session">19 cookie与session<a class="headerlink" href="#19-cookie与session" title="Permanent link">&para;</a></h2>
<h3 id="19-1-cookie与session">19-1 cookie与session<a class="headerlink" href="#19-1-cookie与session" title="Permanent link">&para;</a></h3>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-110-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-110-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-110-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-110-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-110-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-110-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-110-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-110-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-110-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-110-10">10</a></span>
<span class="normal"><a href="#__codelineno-110-11">11</a></span>
<span class="normal"><a href="#__codelineno-110-12">12</a></span>
<span class="normal"><a href="#__codelineno-110-13">13</a></span>
<span class="normal"><a href="#__codelineno-110-14">14</a></span>
<span class="normal"><a href="#__codelineno-110-15">15</a></span>
<span class="normal"><a href="#__codelineno-110-16">16</a></span>
<span class="normal"><a href="#__codelineno-110-17">17</a></span>
<span class="normal"><a href="#__codelineno-110-18">18</a></span>
<span class="normal"><a href="#__codelineno-110-19">19</a></span>
<span class="normal"><a href="#__codelineno-110-20">20</a></span>
<span class="normal"><a href="#__codelineno-110-21">21</a></span>
<span class="normal"><a href="#__codelineno-110-22">22</a></span>
<span class="normal"><a href="#__codelineno-110-23">23</a></span>
<span class="normal"><a href="#__codelineno-110-24">24</a></span>
<span class="normal"><a href="#__codelineno-110-25">25</a></span>
<span class="normal"><a href="#__codelineno-110-26">26</a></span>
<span class="normal"><a href="#__codelineno-110-27">27</a></span>
<span class="normal"><a href="#__codelineno-110-28">28</a></span>
<span class="normal"><a href="#__codelineno-110-29">29</a></span>
<span class="normal"><a href="#__codelineno-110-30">30</a></span>
<span class="normal"><a href="#__codelineno-110-31">31</a></span>
<span class="normal"><a href="#__codelineno-110-32">32</a></span>
<span class="normal"><a href="#__codelineno-110-33">33</a></span>
<span class="normal"><a href="#__codelineno-110-34">34</a></span>
<span class="normal"><a href="#__codelineno-110-35">35</a></span>
<span class="normal"><a href="#__codelineno-110-36">36</a></span>
<span class="normal"><a href="#__codelineno-110-37">37</a></span>
<span class="normal"><a href="#__codelineno-110-38">38</a></span>
<span class="normal"><a href="#__codelineno-110-39">39</a></span>
<span class="normal"><a href="#__codelineno-110-40">40</a></span>
<span class="normal"><a href="#__codelineno-110-41">41</a></span>
<span class="normal"><a href="#__codelineno-110-42">42</a></span>
<span class="normal"><a href="#__codelineno-110-43">43</a></span>
<span class="normal"><a href="#__codelineno-110-44">44</a></span>
<span class="normal"><a href="#__codelineno-110-45">45</a></span>
<span class="normal"><a href="#__codelineno-110-46">46</a></span>
<span class="normal"><a href="#__codelineno-110-47">47</a></span>
<span class="normal"><a href="#__codelineno-110-48">48</a></span>
<span class="normal"><a href="#__codelineno-110-49">49</a></span>
<span class="normal"><a href="#__codelineno-110-50">50</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-110-1" name="__codelineno-110-1"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-110-2" name="__codelineno-110-2"></a><span class="sd">发展史</span>
<a id="__codelineno-110-3" name="__codelineno-110-3"></a><span class="sd">    1.网站都没有保存用户功能的需求 所有用户访问返回的结果都是一样的</span>
<a id="__codelineno-110-4" name="__codelineno-110-4"></a><span class="sd">        eg:新闻、博客、文章...</span>
<a id="__codelineno-110-5" name="__codelineno-110-5"></a>
<a id="__codelineno-110-6" name="__codelineno-110-6"></a><span class="sd">    2.出现了一些需要保存用户信息的网站</span>
<a id="__codelineno-110-7" name="__codelineno-110-7"></a><span class="sd">        eg:淘宝、支付宝、京东...</span>
<a id="__codelineno-110-8" name="__codelineno-110-8"></a>
<a id="__codelineno-110-9" name="__codelineno-110-9"></a><span class="sd">        以登陆功能为例:如果不保存用户登陆状态 也就意味着用户每次访问网站都需要重复的输入用户名和密码(你觉得这样的网站你还想用吗？)</span>
<a id="__codelineno-110-10" name="__codelineno-110-10"></a><span class="sd">        当用户第一次登陆成功之后 将用户的用户名密码返回给用户浏览器 让用户浏览器保存在本地，之后访问网站的时候浏览器自动将保存在浏览器上的用户名和密码发送给服务端，服务端获取之后自动验证</span>
<a id="__codelineno-110-11" name="__codelineno-110-11"></a><span class="sd">        早起这种方式具有非常大的安全隐患</span>
<a id="__codelineno-110-12" name="__codelineno-110-12"></a>
<a id="__codelineno-110-13" name="__codelineno-110-13"></a>
<a id="__codelineno-110-14" name="__codelineno-110-14"></a><span class="sd">        优化:</span>
<a id="__codelineno-110-15" name="__codelineno-110-15"></a><span class="sd">            当用户登陆成功之后，服务端产生一个随机字符串(在服务端保存数据,用kv键值对的形式)，交由客户端浏览器保存</span>
<a id="__codelineno-110-16" name="__codelineno-110-16"></a><span class="sd">            随机字符串1:用户1相关信息</span>
<a id="__codelineno-110-17" name="__codelineno-110-17"></a><span class="sd">            随机字符串2:用户2相关信息</span>
<a id="__codelineno-110-18" name="__codelineno-110-18"></a><span class="sd">            随机字符串3:用户3相关信息</span>
<a id="__codelineno-110-19" name="__codelineno-110-19"></a><span class="sd">            之后访问服务端的时候，都带着该随机字符串，服务端去数据库中比对是否有对应的随机字符串从而获取到对应的用户信息</span>
<a id="__codelineno-110-20" name="__codelineno-110-20"></a>
<a id="__codelineno-110-21" name="__codelineno-110-21"></a>
<a id="__codelineno-110-22" name="__codelineno-110-22"></a>
<a id="__codelineno-110-23" name="__codelineno-110-23"></a><span class="sd">但是如果你拿到了截获到了该随机字符串，那么你就可以冒充当前用户 其实还是有安全隐患的</span>
<a id="__codelineno-110-24" name="__codelineno-110-24"></a>
<a id="__codelineno-110-25" name="__codelineno-110-25"></a>
<a id="__codelineno-110-26" name="__codelineno-110-26"></a><span class="sd">你要知道在web领域没有绝对的安全也没有绝对的不安全</span>
<a id="__codelineno-110-27" name="__codelineno-110-27"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-110-28" name="__codelineno-110-28"></a><span class="n">cookie</span>
<a id="__codelineno-110-29" name="__codelineno-110-29"></a>    <span class="n">服务端保存在客户端浏览器上的信息都可以称之为cookie</span>
<a id="__codelineno-110-30" name="__codelineno-110-30"></a>  <span class="n">它的表现形式一般都是k</span><span class="p">:</span><span class="n">v键值对</span><span class="p">(</span><span class="n">可以有多个</span><span class="p">)</span>
<a id="__codelineno-110-31" name="__codelineno-110-31"></a><span class="n">session</span>
<a id="__codelineno-110-32" name="__codelineno-110-32"></a>    <span class="n">数据是保存在服务端的并且它的表现形式一般也是k</span><span class="p">:</span><span class="n">v键值对</span><span class="p">(</span><span class="n">可以有多个</span><span class="p">)</span>
<a id="__codelineno-110-33" name="__codelineno-110-33"></a>
<a id="__codelineno-110-34" name="__codelineno-110-34"></a>
<a id="__codelineno-110-35" name="__codelineno-110-35"></a><span class="n">下述内容暂时了解即可</span> <span class="n">先给我搞明白最简单的cookie与session使用再说话</span><span class="err">！</span>
<a id="__codelineno-110-36" name="__codelineno-110-36"></a><span class="n">token</span>
<a id="__codelineno-110-37" name="__codelineno-110-37"></a>    <span class="n">session虽然数据是保存在服务端的</span> <span class="n">但是禁不住数据量大</span>
<a id="__codelineno-110-38" name="__codelineno-110-38"></a>  <span class="n">服务端不再保存数据</span>
<a id="__codelineno-110-39" name="__codelineno-110-39"></a>      <span class="n">登陆成功之后</span> <span class="n">将一段用户信息进行加密处理</span><span class="p">(</span><span class="n">加密算法之后你公司开发知道</span><span class="p">)</span>
<a id="__codelineno-110-40" name="__codelineno-110-40"></a>    <span class="n">将加密之后的结果拼接在信息后面</span> <span class="n">整体返回给浏览器保存</span> 
<a id="__codelineno-110-41" name="__codelineno-110-41"></a>    <span class="n">浏览器下次访问的时候带着该信息</span> <span class="n">服务端自动切去前面一段信息再次使用自己的加密算法</span>
<a id="__codelineno-110-42" name="__codelineno-110-42"></a>    <span class="n">跟浏览器尾部的密文进行比对</span>
<a id="__codelineno-110-43" name="__codelineno-110-43"></a><span class="n">jwt认证</span>
<a id="__codelineno-110-44" name="__codelineno-110-44"></a>    <span class="n">三段信息</span>
<a id="__codelineno-110-45" name="__codelineno-110-45"></a>  <span class="p">(</span><span class="n">后期会讲</span> <span class="n">结合django一起使用</span><span class="p">)</span> 
<a id="__codelineno-110-46" name="__codelineno-110-46"></a>
<a id="__codelineno-110-47" name="__codelineno-110-47"></a><span class="n">总结</span><span class="p">:</span>
<a id="__codelineno-110-48" name="__codelineno-110-48"></a>      <span class="mf">1.</span><span class="n">cookie就是保存在客户端浏览器上的信息</span>
<a id="__codelineno-110-49" name="__codelineno-110-49"></a>    <span class="mf">2.</span><span class="n">session就是保存在服务端上的信息</span>
<a id="__codelineno-110-50" name="__codelineno-110-50"></a>    <span class="mf">3.</span><span class="n">session是基于cookie工作的</span><span class="p">(</span><span class="n">其实大部分的保存用户状态的操作都需要使用到cookie</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<h3 id="19-2-django操作cookie">19-2 Django操作cookie<a class="headerlink" href="#19-2-django操作cookie" title="Permanent link">&para;</a></h3>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-111-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-111-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-111-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-111-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-111-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-111-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-111-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-111-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-111-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-111-10">10</a></span>
<span class="normal"><a href="#__codelineno-111-11">11</a></span>
<span class="normal"><a href="#__codelineno-111-12">12</a></span>
<span class="normal"><a href="#__codelineno-111-13">13</a></span>
<span class="normal"><a href="#__codelineno-111-14">14</a></span>
<span class="normal"><a href="#__codelineno-111-15">15</a></span>
<span class="normal"><a href="#__codelineno-111-16">16</a></span>
<span class="normal"><a href="#__codelineno-111-17">17</a></span>
<span class="normal"><a href="#__codelineno-111-18">18</a></span>
<span class="normal"><a href="#__codelineno-111-19">19</a></span>
<span class="normal"><a href="#__codelineno-111-20">20</a></span>
<span class="normal"><a href="#__codelineno-111-21">21</a></span>
<span class="normal"><a href="#__codelineno-111-22">22</a></span>
<span class="normal"><a href="#__codelineno-111-23">23</a></span>
<span class="normal"><a href="#__codelineno-111-24">24</a></span>
<span class="normal"><a href="#__codelineno-111-25">25</a></span>
<span class="normal"><a href="#__codelineno-111-26">26</a></span>
<span class="normal"><a href="#__codelineno-111-27">27</a></span>
<span class="normal"><a href="#__codelineno-111-28">28</a></span>
<span class="normal"><a href="#__codelineno-111-29">29</a></span>
<span class="normal"><a href="#__codelineno-111-30">30</a></span>
<span class="normal"><a href="#__codelineno-111-31">31</a></span>
<span class="normal"><a href="#__codelineno-111-32">32</a></span>
<span class="normal"><a href="#__codelineno-111-33">33</a></span>
<span class="normal"><a href="#__codelineno-111-34">34</a></span>
<span class="normal"><a href="#__codelineno-111-35">35</a></span>
<span class="normal"><a href="#__codelineno-111-36">36</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-111-1" name="__codelineno-111-1"></a><span class="c1"># 虽然cookie是服务端告诉客户端浏览器需要保存内容</span>
<a id="__codelineno-111-2" name="__codelineno-111-2"></a><span class="c1"># 但是客户端浏览器可以选择拒绝保存 如果禁止了 那么 只要是需要记录用户状态的网站登陆功能都无法使用了</span>
<a id="__codelineno-111-3" name="__codelineno-111-3"></a>
<a id="__codelineno-111-4" name="__codelineno-111-4"></a><span class="c1"># 视图函数的返回值</span>
<a id="__codelineno-111-5" name="__codelineno-111-5"></a><span class="k">return</span> <span class="n">HttpResponse</span><span class="p">()</span>
<a id="__codelineno-111-6" name="__codelineno-111-6"></a><span class="k">return</span> <span class="n">render</span><span class="p">()</span>
<a id="__codelineno-111-7" name="__codelineno-111-7"></a><span class="k">return</span> <span class="n">redirect</span><span class="p">()</span>
<a id="__codelineno-111-8" name="__codelineno-111-8"></a>
<a id="__codelineno-111-9" name="__codelineno-111-9"></a>
<a id="__codelineno-111-10" name="__codelineno-111-10"></a><span class="n">obj1</span> <span class="o">=</span> <span class="n">HttpResponse</span><span class="p">()</span>
<a id="__codelineno-111-11" name="__codelineno-111-11"></a><span class="c1"># 操作cookie</span>
<a id="__codelineno-111-12" name="__codelineno-111-12"></a><span class="k">return</span> <span class="n">obj1</span>
<a id="__codelineno-111-13" name="__codelineno-111-13"></a>
<a id="__codelineno-111-14" name="__codelineno-111-14"></a><span class="n">obj2</span> <span class="o">=</span> <span class="n">render</span><span class="p">()</span>
<a id="__codelineno-111-15" name="__codelineno-111-15"></a><span class="c1"># 操作cookie</span>
<a id="__codelineno-111-16" name="__codelineno-111-16"></a><span class="k">return</span> <span class="n">obj2</span>
<a id="__codelineno-111-17" name="__codelineno-111-17"></a>
<a id="__codelineno-111-18" name="__codelineno-111-18"></a><span class="n">obj3</span> <span class="o">=</span> <span class="n">redirect</span><span class="p">()</span>
<a id="__codelineno-111-19" name="__codelineno-111-19"></a><span class="c1"># 操作cookie</span>
<a id="__codelineno-111-20" name="__codelineno-111-20"></a><span class="k">return</span> <span class="n">obj3</span>
<a id="__codelineno-111-21" name="__codelineno-111-21"></a><span class="c1"># 如果你想要操作cookie，你就不得不利用obj对象</span>
<a id="__codelineno-111-22" name="__codelineno-111-22"></a>
<a id="__codelineno-111-23" name="__codelineno-111-23"></a>
<a id="__codelineno-111-24" name="__codelineno-111-24"></a>
<a id="__codelineno-111-25" name="__codelineno-111-25"></a><span class="c1">## 设置cookie</span>
<a id="__codelineno-111-26" name="__codelineno-111-26"></a>    <span class="n">obj</span><span class="o">.</span><span class="n">set_cookie</span><span class="p">(</span><span class="n">key</span><span class="p">,</span><span class="n">value</span><span class="p">)</span>
<a id="__codelineno-111-27" name="__codelineno-111-27"></a><span class="c1">## 获取cookie</span>
<a id="__codelineno-111-28" name="__codelineno-111-28"></a>    <span class="n">request</span><span class="o">.</span><span class="n">COOKIES</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
<a id="__codelineno-111-29" name="__codelineno-111-29"></a><span class="c1">## 在设置cookie的时候可以添加一个超时时间</span>
<a id="__codelineno-111-30" name="__codelineno-111-30"></a>    <span class="n">obj</span><span class="o">.</span><span class="n">set_cookie</span><span class="p">(</span><span class="s1">&#39;username&#39;</span><span class="p">,</span> <span class="s1">&#39;jason666&#39;</span><span class="p">,</span><span class="n">max_age</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">expires</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-111-31" name="__codelineno-111-31"></a>
<a id="__codelineno-111-32" name="__codelineno-111-32"></a>    <span class="n">max_age</span>  <span class="c1">## 5秒超时</span>
<a id="__codelineno-111-33" name="__codelineno-111-33"></a>    <span class="n">expires</span>
<a id="__codelineno-111-34" name="__codelineno-111-34"></a>        <span class="c1">## 两者都是设置超时时间的 并且都是以秒为单位</span>
<a id="__codelineno-111-35" name="__codelineno-111-35"></a>        <span class="c1">## 需要注意的是 针对IE浏览器需要使用expires</span>
<a id="__codelineno-111-36" name="__codelineno-111-36"></a><span class="c1">## 主动删除cookie(注销功能)</span>
</code></pre></div></td></tr></table></div>
<h3 id="19-3-登录装饰器">19-3 登录装饰器<a class="headerlink" href="#19-3-登录装饰器" title="Permanent link">&para;</a></h3>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-112-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-112-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-112-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-112-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-112-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-112-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-112-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-112-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-112-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-112-10">10</a></span>
<span class="normal"><a href="#__codelineno-112-11">11</a></span>
<span class="normal"><a href="#__codelineno-112-12">12</a></span>
<span class="normal"><a href="#__codelineno-112-13">13</a></span>
<span class="normal"><a href="#__codelineno-112-14">14</a></span>
<span class="normal"><a href="#__codelineno-112-15">15</a></span>
<span class="normal"><a href="#__codelineno-112-16">16</a></span>
<span class="normal"><a href="#__codelineno-112-17">17</a></span>
<span class="normal"><a href="#__codelineno-112-18">18</a></span>
<span class="normal"><a href="#__codelineno-112-19">19</a></span>
<span class="normal"><a href="#__codelineno-112-20">20</a></span>
<span class="normal"><a href="#__codelineno-112-21">21</a></span>
<span class="normal"><a href="#__codelineno-112-22">22</a></span>
<span class="normal"><a href="#__codelineno-112-23">23</a></span>
<span class="normal"><a href="#__codelineno-112-24">24</a></span>
<span class="normal"><a href="#__codelineno-112-25">25</a></span>
<span class="normal"><a href="#__codelineno-112-26">26</a></span>
<span class="normal"><a href="#__codelineno-112-27">27</a></span>
<span class="normal"><a href="#__codelineno-112-28">28</a></span>
<span class="normal"><a href="#__codelineno-112-29">29</a></span>
<span class="normal"><a href="#__codelineno-112-30">30</a></span>
<span class="normal"><a href="#__codelineno-112-31">31</a></span>
<span class="normal"><a href="#__codelineno-112-32">32</a></span>
<span class="normal"><a href="#__codelineno-112-33">33</a></span>
<span class="normal"><a href="#__codelineno-112-34">34</a></span>
<span class="normal"><a href="#__codelineno-112-35">35</a></span>
<span class="normal"><a href="#__codelineno-112-36">36</a></span>
<span class="normal"><a href="#__codelineno-112-37">37</a></span>
<span class="normal"><a href="#__codelineno-112-38">38</a></span>
<span class="normal"><a href="#__codelineno-112-39">39</a></span>
<span class="normal"><a href="#__codelineno-112-40">40</a></span>
<span class="normal"><a href="#__codelineno-112-41">41</a></span>
<span class="normal"><a href="#__codelineno-112-42">42</a></span>
<span class="normal"><a href="#__codelineno-112-43">43</a></span>
<span class="normal"><a href="#__codelineno-112-44">44</a></span>
<span class="normal"><a href="#__codelineno-112-45">45</a></span>
<span class="normal"><a href="#__codelineno-112-46">46</a></span>
<span class="normal"><a href="#__codelineno-112-47">47</a></span>
<span class="normal"><a href="#__codelineno-112-48">48</a></span>
<span class="normal"><a href="#__codelineno-112-49">49</a></span>
<span class="normal"><a href="#__codelineno-112-50">50</a></span>
<span class="normal"><a href="#__codelineno-112-51">51</a></span>
<span class="normal"><a href="#__codelineno-112-52">52</a></span>
<span class="normal"><a href="#__codelineno-112-53">53</a></span>
<span class="normal"><a href="#__codelineno-112-54">54</a></span>
<span class="normal"><a href="#__codelineno-112-55">55</a></span>
<span class="normal"><a href="#__codelineno-112-56">56</a></span>
<span class="normal"><a href="#__codelineno-112-57">57</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-112-1" name="__codelineno-112-1"></a><span class="c1"># 我们完成一个真正的登陆功能</span>
<a id="__codelineno-112-2" name="__codelineno-112-2"></a><span class="c1"># 校验用户是否登陆的装饰器</span>
<a id="__codelineno-112-3" name="__codelineno-112-3"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-112-4" name="__codelineno-112-4"></a><span class="sd">用户如果在没有登陆的情况下想访问一个需要登陆的页面</span>
<a id="__codelineno-112-5" name="__codelineno-112-5"></a><span class="sd">那么先跳转到登陆页面 当用户输入正确的用户名和密码之后</span>
<a id="__codelineno-112-6" name="__codelineno-112-6"></a><span class="sd">应该跳转到用户之前想要访问的页面去 而不是直接写死</span>
<a id="__codelineno-112-7" name="__codelineno-112-7"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-112-8" name="__codelineno-112-8"></a><span class="k">def</span><span class="w"> </span><span class="nf">login_auth</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
<a id="__codelineno-112-9" name="__codelineno-112-9"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">inner</span><span class="p">(</span><span class="n">request</span><span class="p">,</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<a id="__codelineno-112-10" name="__codelineno-112-10"></a>        <span class="c1"># print(request.path_info)</span>
<a id="__codelineno-112-11" name="__codelineno-112-11"></a>        <span class="c1"># print(request.get_full_path())  # 能够获取到用户上一次想要访问的url</span>
<a id="__codelineno-112-12" name="__codelineno-112-12"></a>        <span class="n">target_url</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">get_full_path</span><span class="p">()</span>
<a id="__codelineno-112-13" name="__codelineno-112-13"></a>        <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">COOKIES</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;username&#39;</span><span class="p">):</span>
<a id="__codelineno-112-14" name="__codelineno-112-14"></a>            <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="n">request</span><span class="p">,</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<a id="__codelineno-112-15" name="__codelineno-112-15"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-112-16" name="__codelineno-112-16"></a>            <span class="c1">## 以next查询字符串的方式，把用户想要访问的页面传到login页面</span>
<a id="__codelineno-112-17" name="__codelineno-112-17"></a>            <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;/login/?next=</span><span class="si">%s</span><span class="s1">&#39;</span><span class="o">%</span><span class="n">target_url</span><span class="p">)</span>
<a id="__codelineno-112-18" name="__codelineno-112-18"></a>    <span class="k">return</span> <span class="n">inner</span>
<a id="__codelineno-112-19" name="__codelineno-112-19"></a>
<a id="__codelineno-112-20" name="__codelineno-112-20"></a><span class="k">def</span><span class="w"> </span><span class="nf">login</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
<a id="__codelineno-112-21" name="__codelineno-112-21"></a>    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;POST&#39;</span><span class="p">:</span>
<a id="__codelineno-112-22" name="__codelineno-112-22"></a>        <span class="n">username</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;username&#39;</span><span class="p">)</span>
<a id="__codelineno-112-23" name="__codelineno-112-23"></a>        <span class="n">password</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;password&#39;</span><span class="p">)</span>
<a id="__codelineno-112-24" name="__codelineno-112-24"></a>        <span class="k">if</span> <span class="n">username</span> <span class="o">==</span> <span class="s1">&#39;jason&#39;</span> <span class="ow">and</span> <span class="n">password</span> <span class="o">==</span> <span class="s1">&#39;123&#39;</span><span class="p">:</span>
<a id="__codelineno-112-25" name="__codelineno-112-25"></a>
<a id="__codelineno-112-26" name="__codelineno-112-26"></a>            <span class="c1"># 获取用户上一次想要访问的url</span>
<a id="__codelineno-112-27" name="__codelineno-112-27"></a>            <span class="n">target_url</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;next&#39;</span><span class="p">)</span>  <span class="c1"># 这个结果可能是None</span>
<a id="__codelineno-112-28" name="__codelineno-112-28"></a>            <span class="k">if</span> <span class="n">target_url</span><span class="p">:</span>
<a id="__codelineno-112-29" name="__codelineno-112-29"></a>                <span class="n">obj</span> <span class="o">=</span> <span class="n">redirect</span><span class="p">(</span><span class="n">target_url</span><span class="p">)</span>
<a id="__codelineno-112-30" name="__codelineno-112-30"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-112-31" name="__codelineno-112-31"></a>                <span class="c1"># 保存用户登陆状态</span>
<a id="__codelineno-112-32" name="__codelineno-112-32"></a>                <span class="n">obj</span> <span class="o">=</span> <span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;/home/&#39;</span><span class="p">)</span>
<a id="__codelineno-112-33" name="__codelineno-112-33"></a>            <span class="c1"># 让浏览器记录cookie数据</span>
<a id="__codelineno-112-34" name="__codelineno-112-34"></a>            <span class="n">obj</span><span class="o">.</span><span class="n">set_cookie</span><span class="p">(</span><span class="s1">&#39;username&#39;</span><span class="p">,</span> <span class="s1">&#39;jason666&#39;</span><span class="p">)</span>
<a id="__codelineno-112-35" name="__codelineno-112-35"></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-112-36" name="__codelineno-112-36"></a><span class="sd">            浏览器不单单会帮你存</span>
<a id="__codelineno-112-37" name="__codelineno-112-37"></a><span class="sd">            而且后面每次访问你的时候还会带着它过来</span>
<a id="__codelineno-112-38" name="__codelineno-112-38"></a><span class="sd">            &quot;&quot;&quot;</span>
<a id="__codelineno-112-39" name="__codelineno-112-39"></a>            <span class="c1"># 跳转到一个需要用户登陆之后才能看的页面</span>
<a id="__codelineno-112-40" name="__codelineno-112-40"></a>            <span class="k">return</span> <span class="n">obj</span>
<a id="__codelineno-112-41" name="__codelineno-112-41"></a>    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span><span class="s1">&#39;login.html&#39;</span><span class="p">)</span>
<a id="__codelineno-112-42" name="__codelineno-112-42"></a>
<a id="__codelineno-112-43" name="__codelineno-112-43"></a>
<a id="__codelineno-112-44" name="__codelineno-112-44"></a><span class="nd">@login_auth</span>
<a id="__codelineno-112-45" name="__codelineno-112-45"></a><span class="k">def</span><span class="w"> </span><span class="nf">home</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
<a id="__codelineno-112-46" name="__codelineno-112-46"></a>    <span class="c1"># 获取cookie信息 判断你有没有</span>
<a id="__codelineno-112-47" name="__codelineno-112-47"></a>    <span class="c1"># if request.COOKIES.get(&#39;username&#39;) == &#39;jason666&#39;:</span>
<a id="__codelineno-112-48" name="__codelineno-112-48"></a>    <span class="c1">#     return HttpResponse(&quot;我是home页面，只有登陆的用户才能进来哟~&quot;)</span>
<a id="__codelineno-112-49" name="__codelineno-112-49"></a>    <span class="c1"># # 没有登陆应该跳转到登陆页面</span>
<a id="__codelineno-112-50" name="__codelineno-112-50"></a>    <span class="c1"># return redirect(&#39;/login/&#39;)</span>
<a id="__codelineno-112-51" name="__codelineno-112-51"></a>    <span class="k">return</span> <span class="n">HttpResponse</span><span class="p">(</span><span class="s2">&quot;我是home页面，只有登陆的用户才能进来哟~&quot;</span><span class="p">)</span>
<a id="__codelineno-112-52" name="__codelineno-112-52"></a>
<a id="__codelineno-112-53" name="__codelineno-112-53"></a><span class="nd">@login_auth</span>
<a id="__codelineno-112-54" name="__codelineno-112-54"></a><span class="k">def</span><span class="w"> </span><span class="nf">logout</span><span class="p">(</span><span class="n">requests</span><span class="p">):</span>
<a id="__codelineno-112-55" name="__codelineno-112-55"></a>    <span class="n">obj</span> <span class="o">=</span> <span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;/login/&#39;</span><span class="p">)</span>
<a id="__codelineno-112-56" name="__codelineno-112-56"></a>    <span class="n">obj</span><span class="o">.</span><span class="n">delete_cookie</span><span class="p">(</span><span class="s1">&#39;username&#39;</span><span class="p">)</span>
<a id="__codelineno-112-57" name="__codelineno-112-57"></a>    <span class="k">return</span> <span class="n">obj</span>
</code></pre></div></td></tr></table></div>
<h3 id="19-4-django操作session">19-4 django操作session<a class="headerlink" href="#19-4-django操作session" title="Permanent link">&para;</a></h3>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-113-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-113-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-113-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-113-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-113-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-113-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-113-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-113-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-113-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-113-10">10</a></span>
<span class="normal"><a href="#__codelineno-113-11">11</a></span>
<span class="normal"><a href="#__codelineno-113-12">12</a></span>
<span class="normal"><a href="#__codelineno-113-13">13</a></span>
<span class="normal"><a href="#__codelineno-113-14">14</a></span>
<span class="normal"><a href="#__codelineno-113-15">15</a></span>
<span class="normal"><a href="#__codelineno-113-16">16</a></span>
<span class="normal"><a href="#__codelineno-113-17">17</a></span>
<span class="normal"><a href="#__codelineno-113-18">18</a></span>
<span class="normal"><a href="#__codelineno-113-19">19</a></span>
<span class="normal"><a href="#__codelineno-113-20">20</a></span>
<span class="normal"><a href="#__codelineno-113-21">21</a></span>
<span class="normal"><a href="#__codelineno-113-22">22</a></span>
<span class="normal"><a href="#__codelineno-113-23">23</a></span>
<span class="normal"><a href="#__codelineno-113-24">24</a></span>
<span class="normal"><a href="#__codelineno-113-25">25</a></span>
<span class="normal"><a href="#__codelineno-113-26">26</a></span>
<span class="normal"><a href="#__codelineno-113-27">27</a></span>
<span class="normal"><a href="#__codelineno-113-28">28</a></span>
<span class="normal"><a href="#__codelineno-113-29">29</a></span>
<span class="normal"><a href="#__codelineno-113-30">30</a></span>
<span class="normal"><a href="#__codelineno-113-31">31</a></span>
<span class="normal"><a href="#__codelineno-113-32">32</a></span>
<span class="normal"><a href="#__codelineno-113-33">33</a></span>
<span class="normal"><a href="#__codelineno-113-34">34</a></span>
<span class="normal"><a href="#__codelineno-113-35">35</a></span>
<span class="normal"><a href="#__codelineno-113-36">36</a></span>
<span class="normal"><a href="#__codelineno-113-37">37</a></span>
<span class="normal"><a href="#__codelineno-113-38">38</a></span>
<span class="normal"><a href="#__codelineno-113-39">39</a></span>
<span class="normal"><a href="#__codelineno-113-40">40</a></span>
<span class="normal"><a href="#__codelineno-113-41">41</a></span>
<span class="normal"><a href="#__codelineno-113-42">42</a></span>
<span class="normal"><a href="#__codelineno-113-43">43</a></span>
<span class="normal"><a href="#__codelineno-113-44">44</a></span>
<span class="normal"><a href="#__codelineno-113-45">45</a></span>
<span class="normal"><a href="#__codelineno-113-46">46</a></span>
<span class="normal"><a href="#__codelineno-113-47">47</a></span>
<span class="normal"><a href="#__codelineno-113-48">48</a></span>
<span class="normal"><a href="#__codelineno-113-49">49</a></span>
<span class="normal"><a href="#__codelineno-113-50">50</a></span>
<span class="normal"><a href="#__codelineno-113-51">51</a></span>
<span class="normal"><a href="#__codelineno-113-52">52</a></span>
<span class="normal"><a href="#__codelineno-113-53">53</a></span>
<span class="normal"><a href="#__codelineno-113-54">54</a></span>
<span class="normal"><a href="#__codelineno-113-55">55</a></span>
<span class="normal"><a href="#__codelineno-113-56">56</a></span>
<span class="normal"><a href="#__codelineno-113-57">57</a></span>
<span class="normal"><a href="#__codelineno-113-58">58</a></span>
<span class="normal"><a href="#__codelineno-113-59">59</a></span>
<span class="normal"><a href="#__codelineno-113-60">60</a></span>
<span class="normal"><a href="#__codelineno-113-61">61</a></span>
<span class="normal"><a href="#__codelineno-113-62">62</a></span>
<span class="normal"><a href="#__codelineno-113-63">63</a></span>
<span class="normal"><a href="#__codelineno-113-64">64</a></span>
<span class="normal"><a href="#__codelineno-113-65">65</a></span>
<span class="normal"><a href="#__codelineno-113-66">66</a></span>
<span class="normal"><a href="#__codelineno-113-67">67</a></span>
<span class="normal"><a href="#__codelineno-113-68">68</a></span>
<span class="normal"><a href="#__codelineno-113-69">69</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-113-1" name="__codelineno-113-1"></a><span class="c1">## session数据是保存在服务端的(存？)，给客户端返回的是一个随机字符串</span>
<a id="__codelineno-113-2" name="__codelineno-113-2"></a>    <span class="n">sessionid</span><span class="p">:</span><span class="n">随机字符串</span>
<a id="__codelineno-113-3" name="__codelineno-113-3"></a>
<a id="__codelineno-113-4" name="__codelineno-113-4"></a><span class="c1">## 在默认情况下操作session的时候需要django默认的一张django_session表</span>
<a id="__codelineno-113-5" name="__codelineno-113-5"></a>    <span class="c1">## 数据库迁移命令</span>
<a id="__codelineno-113-6" name="__codelineno-113-6"></a>        <span class="c1">## django会自己创建很多表   django_session就是其中的一张</span>
<a id="__codelineno-113-7" name="__codelineno-113-7"></a>
<a id="__codelineno-113-8" name="__codelineno-113-8"></a>
<a id="__codelineno-113-9" name="__codelineno-113-9"></a><span class="c1">## django默认session的过期时间是14天</span>
<a id="__codelineno-113-10" name="__codelineno-113-10"></a>    <span class="c1">## 但是你也可以人为的修改它</span>
<a id="__codelineno-113-11" name="__codelineno-113-11"></a>
<a id="__codelineno-113-12" name="__codelineno-113-12"></a>
<a id="__codelineno-113-13" name="__codelineno-113-13"></a><span class="c1">## 设置session    </span>
<a id="__codelineno-113-14" name="__codelineno-113-14"></a>    <span class="n">request</span><span class="o">.</span><span class="n">session</span><span class="p">[</span><span class="s1">&#39;key&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
<a id="__codelineno-113-15" name="__codelineno-113-15"></a>
<a id="__codelineno-113-16" name="__codelineno-113-16"></a><span class="c1">## 获取session</span>
<a id="__codelineno-113-17" name="__codelineno-113-17"></a>    <span class="n">request</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;key&#39;</span><span class="p">)</span>
<a id="__codelineno-113-18" name="__codelineno-113-18"></a>
<a id="__codelineno-113-19" name="__codelineno-113-19"></a><span class="c1">## 设置过期时间</span>
<a id="__codelineno-113-20" name="__codelineno-113-20"></a>    <span class="n">request</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">set_expiry</span><span class="p">()</span>
<a id="__codelineno-113-21" name="__codelineno-113-21"></a>
<a id="__codelineno-113-22" name="__codelineno-113-22"></a>    <span class="c1">## 括号内可以放四种类型的参数</span>
<a id="__codelineno-113-23" name="__codelineno-113-23"></a>        <span class="mf">1.</span><span class="n">整数</span>                        <span class="n">多少秒</span>
<a id="__codelineno-113-24" name="__codelineno-113-24"></a>        <span class="mf">2.</span><span class="n">日期对象</span>                      <span class="n">到指定日期就失效</span>
<a id="__codelineno-113-25" name="__codelineno-113-25"></a>        <span class="mf">3.0</span>                           <span class="n">一旦当前浏览器窗口关闭立刻失效</span>
<a id="__codelineno-113-26" name="__codelineno-113-26"></a>        <span class="mf">4.</span><span class="n">不写</span>                        <span class="n">失效时间就取决于django内部全局session默认的失效时间</span>
<a id="__codelineno-113-27" name="__codelineno-113-27"></a>
<a id="__codelineno-113-28" name="__codelineno-113-28"></a><span class="c1">## 清除session    </span>
<a id="__codelineno-113-29" name="__codelineno-113-29"></a>    <span class="n">request</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>  <span class="c1"># 只删服务端的 客户端的不删</span>
<a id="__codelineno-113-30" name="__codelineno-113-30"></a>    <span class="n">request</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>  <span class="c1"># 浏览器和服务端都清空(推荐使用)</span>
<a id="__codelineno-113-31" name="__codelineno-113-31"></a>
<a id="__codelineno-113-32" name="__codelineno-113-32"></a>
<a id="__codelineno-113-33" name="__codelineno-113-33"></a><span class="c1">## session是保存在服务端的 但是session的保存位置可以有多种选择</span>
<a id="__codelineno-113-34" name="__codelineno-113-34"></a>    <span class="mf">1.</span><span class="n">MySQL</span>
<a id="__codelineno-113-35" name="__codelineno-113-35"></a>    <span class="mf">2.</span><span class="n">文件</span>
<a id="__codelineno-113-36" name="__codelineno-113-36"></a>    <span class="mf">3.</span><span class="n">redis</span>
<a id="__codelineno-113-37" name="__codelineno-113-37"></a>    <span class="mf">4.</span><span class="n">memcache</span>
<a id="__codelineno-113-38" name="__codelineno-113-38"></a>    <span class="o">...</span>
<a id="__codelineno-113-39" name="__codelineno-113-39"></a>
<a id="__codelineno-113-40" name="__codelineno-113-40"></a>
<a id="__codelineno-113-41" name="__codelineno-113-41"></a><span class="n">django_session表中的数据条数是取决于浏览器的</span>
<a id="__codelineno-113-42" name="__codelineno-113-42"></a>    <span class="c1">## 同一个计算机上(IP地址)同一个浏览器只会有一条数据生效</span>
<a id="__codelineno-113-43" name="__codelineno-113-43"></a>    <span class="c1">## (当session过期的时候可能会出现多条数据对应一个浏览器，但是该现象不会持续很久，内部会自动识别过期的数据清除 你也可以通过代码清除)</span>
<a id="__codelineno-113-44" name="__codelineno-113-44"></a>
<a id="__codelineno-113-45" name="__codelineno-113-45"></a>    <span class="c1">## 主要是为了节省服务端数据库资源</span>
<a id="__codelineno-113-46" name="__codelineno-113-46"></a>
<a id="__codelineno-113-47" name="__codelineno-113-47"></a><span class="k">def</span><span class="w"> </span><span class="nf">set_session</span><span class="p">(</span><span class="n">request</span><span class="p">)</span><span class="err">；</span>
<a id="__codelineno-113-48" name="__codelineno-113-48"></a>    <span class="n">request</span><span class="o">.</span><span class="n">session</span><span class="p">[</span><span class="s1">&#39;hobby&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;girl&#39;</span>
<a id="__codelineno-113-49" name="__codelineno-113-49"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-113-50" name="__codelineno-113-50"></a><span class="sd">    内部发送了那些事</span>
<a id="__codelineno-113-51" name="__codelineno-113-51"></a><span class="sd">        1.django内部会自动帮你生成一个随机字符串</span>
<a id="__codelineno-113-52" name="__codelineno-113-52"></a><span class="sd">        2.django内部自动将随机字符串和对应的数据存储到django_session表中</span>
<a id="__codelineno-113-53" name="__codelineno-113-53"></a><span class="sd">            2.1先在内存中产生操作数据的缓存</span>
<a id="__codelineno-113-54" name="__codelineno-113-54"></a><span class="sd">            2.2在响应结果django中间件的时候才真正的操作数据库</span>
<a id="__codelineno-113-55" name="__codelineno-113-55"></a><span class="sd">        3.将产生的随机字符串返回给客户端浏览器保存</span>
<a id="__codelineno-113-56" name="__codelineno-113-56"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-113-57" name="__codelineno-113-57"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_session</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
<a id="__codelineno-113-58" name="__codelineno-113-58"></a>    <span class="n">request</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;hobby&#39;</span><span class="p">)</span>
<a id="__codelineno-113-59" name="__codelineno-113-59"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-113-60" name="__codelineno-113-60"></a><span class="sd">    内部发送了那些事</span>
<a id="__codelineno-113-61" name="__codelineno-113-61"></a><span class="sd">        1.自动从浏览器请求中获取sessionid对应的随机字符串</span>
<a id="__codelineno-113-62" name="__codelineno-113-62"></a><span class="sd">        2.拿着该随机字符串去django_session表中查找对应的数据</span>
<a id="__codelineno-113-63" name="__codelineno-113-63"></a><span class="sd">        3.</span>
<a id="__codelineno-113-64" name="__codelineno-113-64"></a><span class="sd">            如果比对上了 则将对应的数据取出并以字典的形式封装到request.session中</span>
<a id="__codelineno-113-65" name="__codelineno-113-65"></a><span class="sd">            如果比对不上 则request.session.get()返回的是None</span>
<a id="__codelineno-113-66" name="__codelineno-113-66"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-113-67" name="__codelineno-113-67"></a>
<a id="__codelineno-113-68" name="__codelineno-113-68"></a>
<a id="__codelineno-113-69" name="__codelineno-113-69"></a><span class="c1"># 利用session实现登陆验证</span>
</code></pre></div></td></tr></table></div>
<h3 id="19-5-cbv如何添加装饰器">19-5 CBV如何添加装饰器<a class="headerlink" href="#19-5-cbv如何添加装饰器" title="Permanent link">&para;</a></h3>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-114-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-114-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-114-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-114-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-114-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-114-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-114-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-114-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-114-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-114-10">10</a></span>
<span class="normal"><a href="#__codelineno-114-11">11</a></span>
<span class="normal"><a href="#__codelineno-114-12">12</a></span>
<span class="normal"><a href="#__codelineno-114-13">13</a></span>
<span class="normal"><a href="#__codelineno-114-14">14</a></span>
<span class="normal"><a href="#__codelineno-114-15">15</a></span>
<span class="normal"><a href="#__codelineno-114-16">16</a></span>
<span class="normal"><a href="#__codelineno-114-17">17</a></span>
<span class="normal"><a href="#__codelineno-114-18">18</a></span>
<span class="normal"><a href="#__codelineno-114-19">19</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-114-1" name="__codelineno-114-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.views</span><span class="w"> </span><span class="kn">import</span> <span class="n">View</span>
<a id="__codelineno-114-2" name="__codelineno-114-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.utils.decorators</span><span class="w"> </span><span class="kn">import</span> <span class="n">method_decorator</span>
<a id="__codelineno-114-3" name="__codelineno-114-3"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-114-4" name="__codelineno-114-4"></a><span class="sd">CBV中django不建议你直接给类的方法加装饰器</span>
<a id="__codelineno-114-5" name="__codelineno-114-5"></a><span class="sd">无论该装饰器能都正常给你 都不建议直接加</span>
<a id="__codelineno-114-6" name="__codelineno-114-6"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-114-7" name="__codelineno-114-7"></a>
<a id="__codelineno-114-8" name="__codelineno-114-8"></a><span class="c1"># @method_decorator(login_auth,name=&#39;get&#39;)  # 方式2(可以添加多个针对不同的方法加不同的装饰器)</span>
<a id="__codelineno-114-9" name="__codelineno-114-9"></a><span class="c1"># @method_decorator(login_auth,name=&#39;post&#39;)</span>
<a id="__codelineno-114-10" name="__codelineno-114-10"></a><span class="k">class</span><span class="w"> </span><span class="nc">MyLogin</span><span class="p">(</span><span class="n">View</span><span class="p">):</span>
<a id="__codelineno-114-11" name="__codelineno-114-11"></a>    <span class="nd">@method_decorator</span><span class="p">(</span><span class="n">login_auth</span><span class="p">)</span>  <span class="c1"># 方式3:它会直接作用于当前类里面的所有的方法</span>
<a id="__codelineno-114-12" name="__codelineno-114-12"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">dispatch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<a id="__codelineno-114-13" name="__codelineno-114-13"></a>        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">dispatch</span><span class="p">(</span><span class="n">request</span><span class="p">,</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<a id="__codelineno-114-14" name="__codelineno-114-14"></a>    <span class="c1"># @method_decorator(login_auth)  # 方式1:指名道姓</span>
<a id="__codelineno-114-15" name="__codelineno-114-15"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">request</span><span class="p">):</span>
<a id="__codelineno-114-16" name="__codelineno-114-16"></a>        <span class="k">return</span> <span class="n">HttpResponse</span><span class="p">(</span><span class="s2">&quot;get请求&quot;</span><span class="p">)</span>
<a id="__codelineno-114-17" name="__codelineno-114-17"></a>
<a id="__codelineno-114-18" name="__codelineno-114-18"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">post</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">request</span><span class="p">):</span>
<a id="__codelineno-114-19" name="__codelineno-114-19"></a>        <span class="k">return</span> <span class="n">HttpResponse</span><span class="p">(</span><span class="s1">&#39;post请求&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<h2 id="20-django中间件">20 Django中间件<a class="headerlink" href="#20-django中间件" title="Permanent link">&para;</a></h2>
<h3 id="20-1-django中间件">20-1 django中间件<a class="headerlink" href="#20-1-django中间件" title="Permanent link">&para;</a></h3>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-115-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-115-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-115-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-115-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-115-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-115-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-115-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-115-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-115-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-115-10">10</a></span>
<span class="normal"><a href="#__codelineno-115-11">11</a></span>
<span class="normal"><a href="#__codelineno-115-12">12</a></span>
<span class="normal"><a href="#__codelineno-115-13">13</a></span>
<span class="normal"><a href="#__codelineno-115-14">14</a></span>
<span class="normal"><a href="#__codelineno-115-15">15</a></span>
<span class="normal"><a href="#__codelineno-115-16">16</a></span>
<span class="normal"><a href="#__codelineno-115-17">17</a></span>
<span class="normal"><a href="#__codelineno-115-18">18</a></span>
<span class="normal"><a href="#__codelineno-115-19">19</a></span>
<span class="normal"><a href="#__codelineno-115-20">20</a></span>
<span class="normal"><a href="#__codelineno-115-21">21</a></span>
<span class="normal"><a href="#__codelineno-115-22">22</a></span>
<span class="normal"><a href="#__codelineno-115-23">23</a></span>
<span class="normal"><a href="#__codelineno-115-24">24</a></span>
<span class="normal"><a href="#__codelineno-115-25">25</a></span>
<span class="normal"><a href="#__codelineno-115-26">26</a></span>
<span class="normal"><a href="#__codelineno-115-27">27</a></span>
<span class="normal"><a href="#__codelineno-115-28">28</a></span>
<span class="normal"><a href="#__codelineno-115-29">29</a></span>
<span class="normal"><a href="#__codelineno-115-30">30</a></span>
<span class="normal"><a href="#__codelineno-115-31">31</a></span>
<span class="normal"><a href="#__codelineno-115-32">32</a></span>
<span class="normal"><a href="#__codelineno-115-33">33</a></span>
<span class="normal"><a href="#__codelineno-115-34">34</a></span>
<span class="normal"><a href="#__codelineno-115-35">35</a></span>
<span class="normal"><a href="#__codelineno-115-36">36</a></span>
<span class="normal"><a href="#__codelineno-115-37">37</a></span>
<span class="normal"><a href="#__codelineno-115-38">38</a></span>
<span class="normal"><a href="#__codelineno-115-39">39</a></span>
<span class="normal"><a href="#__codelineno-115-40">40</a></span>
<span class="normal"><a href="#__codelineno-115-41">41</a></span>
<span class="normal"><a href="#__codelineno-115-42">42</a></span>
<span class="normal"><a href="#__codelineno-115-43">43</a></span>
<span class="normal"><a href="#__codelineno-115-44">44</a></span>
<span class="normal"><a href="#__codelineno-115-45">45</a></span>
<span class="normal"><a href="#__codelineno-115-46">46</a></span>
<span class="normal"><a href="#__codelineno-115-47">47</a></span>
<span class="normal"><a href="#__codelineno-115-48">48</a></span>
<span class="normal"><a href="#__codelineno-115-49">49</a></span>
<span class="normal"><a href="#__codelineno-115-50">50</a></span>
<span class="normal"><a href="#__codelineno-115-51">51</a></span>
<span class="normal"><a href="#__codelineno-115-52">52</a></span>
<span class="normal"><a href="#__codelineno-115-53">53</a></span>
<span class="normal"><a href="#__codelineno-115-54">54</a></span>
<span class="normal"><a href="#__codelineno-115-55">55</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-115-1" name="__codelineno-115-1"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-115-2" name="__codelineno-115-2"></a><span class="sd">django中间件是django的门户</span>
<a id="__codelineno-115-3" name="__codelineno-115-3"></a><span class="sd">1.请求来的时候需要先经过中间件才能到达真正的django后端</span>
<a id="__codelineno-115-4" name="__codelineno-115-4"></a><span class="sd">2.响应走的时候最后也需要经过中间件才能发送出去</span>
<a id="__codelineno-115-5" name="__codelineno-115-5"></a>
<a id="__codelineno-115-6" name="__codelineno-115-6"></a><span class="sd">django自带七个中间件</span>
<a id="__codelineno-115-7" name="__codelineno-115-7"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-115-8" name="__codelineno-115-8"></a><span class="c1">## django请求生命周期流程图</span>
<a id="__codelineno-115-9" name="__codelineno-115-9"></a>
<a id="__codelineno-115-10" name="__codelineno-115-10"></a><span class="c1">## 研究django中间件代码规律</span>
<a id="__codelineno-115-11" name="__codelineno-115-11"></a><span class="n">MIDDLEWARE</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-115-12" name="__codelineno-115-12"></a>    <span class="s1">&#39;django.middleware.security.SecurityMiddleware&#39;</span><span class="p">,</span>
<a id="__codelineno-115-13" name="__codelineno-115-13"></a>    <span class="s1">&#39;django.contrib.sessions.middleware.SessionMiddleware&#39;</span><span class="p">,</span>
<a id="__codelineno-115-14" name="__codelineno-115-14"></a>    <span class="s1">&#39;django.middleware.common.CommonMiddleware&#39;</span><span class="p">,</span>
<a id="__codelineno-115-15" name="__codelineno-115-15"></a>    <span class="s1">&#39;django.middleware.csrf.CsrfViewMiddleware&#39;</span><span class="p">,</span>
<a id="__codelineno-115-16" name="__codelineno-115-16"></a>    <span class="s1">&#39;django.contrib.auth.middleware.AuthenticationMiddleware&#39;</span><span class="p">,</span>
<a id="__codelineno-115-17" name="__codelineno-115-17"></a>    <span class="s1">&#39;django.contrib.messages.middleware.MessageMiddleware&#39;</span><span class="p">,</span>
<a id="__codelineno-115-18" name="__codelineno-115-18"></a>    <span class="s1">&#39;django.middleware.clickjacking.XFrameOptionsMiddleware&#39;</span><span class="p">,</span>
<a id="__codelineno-115-19" name="__codelineno-115-19"></a><span class="p">]</span>
<a id="__codelineno-115-20" name="__codelineno-115-20"></a>
<a id="__codelineno-115-21" name="__codelineno-115-21"></a><span class="k">class</span><span class="w"> </span><span class="nc">SessionMiddleware</span><span class="p">(</span><span class="n">MiddlewareMixin</span><span class="p">):</span>
<a id="__codelineno-115-22" name="__codelineno-115-22"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">process_request</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>
<a id="__codelineno-115-23" name="__codelineno-115-23"></a>        <span class="n">session_key</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">COOKIES</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">settings</span><span class="o">.</span><span class="n">SESSION_COOKIE_NAME</span><span class="p">)</span>
<a id="__codelineno-115-24" name="__codelineno-115-24"></a>        <span class="n">request</span><span class="o">.</span><span class="n">session</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SessionStore</span><span class="p">(</span><span class="n">session_key</span><span class="p">)</span>
<a id="__codelineno-115-25" name="__codelineno-115-25"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">process_response</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">response</span><span class="p">):</span>
<a id="__codelineno-115-26" name="__codelineno-115-26"></a>        <span class="k">return</span> <span class="n">response</span>
<a id="__codelineno-115-27" name="__codelineno-115-27"></a>
<a id="__codelineno-115-28" name="__codelineno-115-28"></a><span class="k">class</span><span class="w"> </span><span class="nc">CsrfViewMiddleware</span><span class="p">(</span><span class="n">MiddlewareMixin</span><span class="p">):</span>
<a id="__codelineno-115-29" name="__codelineno-115-29"></a>      <span class="k">def</span><span class="w"> </span><span class="nf">process_request</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>
<a id="__codelineno-115-30" name="__codelineno-115-30"></a>        <span class="n">csrf_token</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_token</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
<a id="__codelineno-115-31" name="__codelineno-115-31"></a>        <span class="k">if</span> <span class="n">csrf_token</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-115-32" name="__codelineno-115-32"></a>            <span class="c1"># Use same token next time.</span>
<a id="__codelineno-115-33" name="__codelineno-115-33"></a>            <span class="n">request</span><span class="o">.</span><span class="n">META</span><span class="p">[</span><span class="s1">&#39;CSRF_COOKIE&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">csrf_token</span>
<a id="__codelineno-115-34" name="__codelineno-115-34"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">process_view</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">callback</span><span class="p">,</span> <span class="n">callback_args</span><span class="p">,</span> <span class="n">callback_kwargs</span><span class="p">):</span>
<a id="__codelineno-115-35" name="__codelineno-115-35"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_accept</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
<a id="__codelineno-115-36" name="__codelineno-115-36"></a>
<a id="__codelineno-115-37" name="__codelineno-115-37"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">process_response</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">response</span><span class="p">):</span>
<a id="__codelineno-115-38" name="__codelineno-115-38"></a>        <span class="k">return</span> <span class="n">response</span>
<a id="__codelineno-115-39" name="__codelineno-115-39"></a>
<a id="__codelineno-115-40" name="__codelineno-115-40"></a><span class="k">class</span><span class="w"> </span><span class="nc">AuthenticationMiddleware</span><span class="p">(</span><span class="n">MiddlewareMixin</span><span class="p">):</span>
<a id="__codelineno-115-41" name="__codelineno-115-41"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">process_request</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>
<a id="__codelineno-115-42" name="__codelineno-115-42"></a>        <span class="n">request</span><span class="o">.</span><span class="n">user</span> <span class="o">=</span> <span class="n">SimpleLazyObject</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">get_user</span><span class="p">(</span><span class="n">request</span><span class="p">))</span>
<a id="__codelineno-115-43" name="__codelineno-115-43"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-115-44" name="__codelineno-115-44"></a><span class="sd">django支持程序员自定义中间件并且暴露给程序员五个可以自定义的方法</span>
<a id="__codelineno-115-45" name="__codelineno-115-45"></a><span class="sd">    1.必须掌握</span>
<a id="__codelineno-115-46" name="__codelineno-115-46"></a><span class="sd">        process_request</span>
<a id="__codelineno-115-47" name="__codelineno-115-47"></a>
<a id="__codelineno-115-48" name="__codelineno-115-48"></a><span class="sd">        process_response</span>
<a id="__codelineno-115-49" name="__codelineno-115-49"></a><span class="sd">    2.了解即可</span>
<a id="__codelineno-115-50" name="__codelineno-115-50"></a><span class="sd">        process_view</span>
<a id="__codelineno-115-51" name="__codelineno-115-51"></a>
<a id="__codelineno-115-52" name="__codelineno-115-52"></a><span class="sd">        process_template_response</span>
<a id="__codelineno-115-53" name="__codelineno-115-53"></a>
<a id="__codelineno-115-54" name="__codelineno-115-54"></a><span class="sd">        process_exception</span>
<a id="__codelineno-115-55" name="__codelineno-115-55"></a><span class="sd">&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
<h3 id="20-2-如何自定义中间件">20-2 如何自定义中间件<a class="headerlink" href="#20-2-如何自定义中间件" title="Permanent link">&para;</a></h3>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-116-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-116-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-116-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-116-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-116-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-116-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-116-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-116-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-116-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-116-10">10</a></span>
<span class="normal"><a href="#__codelineno-116-11">11</a></span>
<span class="normal"><a href="#__codelineno-116-12">12</a></span>
<span class="normal"><a href="#__codelineno-116-13">13</a></span>
<span class="normal"><a href="#__codelineno-116-14">14</a></span>
<span class="normal"><a href="#__codelineno-116-15">15</a></span>
<span class="normal"><a href="#__codelineno-116-16">16</a></span>
<span class="normal"><a href="#__codelineno-116-17">17</a></span>
<span class="normal"><a href="#__codelineno-116-18">18</a></span>
<span class="normal"><a href="#__codelineno-116-19">19</a></span>
<span class="normal"><a href="#__codelineno-116-20">20</a></span>
<span class="normal"><a href="#__codelineno-116-21">21</a></span>
<span class="normal"><a href="#__codelineno-116-22">22</a></span>
<span class="normal"><a href="#__codelineno-116-23">23</a></span>
<span class="normal"><a href="#__codelineno-116-24">24</a></span>
<span class="normal"><a href="#__codelineno-116-25">25</a></span>
<span class="normal"><a href="#__codelineno-116-26">26</a></span>
<span class="normal"><a href="#__codelineno-116-27">27</a></span>
<span class="normal"><a href="#__codelineno-116-28">28</a></span>
<span class="normal"><a href="#__codelineno-116-29">29</a></span>
<span class="normal"><a href="#__codelineno-116-30">30</a></span>
<span class="normal"><a href="#__codelineno-116-31">31</a></span>
<span class="normal"><a href="#__codelineno-116-32">32</a></span>
<span class="normal"><a href="#__codelineno-116-33">33</a></span>
<span class="normal"><a href="#__codelineno-116-34">34</a></span>
<span class="normal"><a href="#__codelineno-116-35">35</a></span>
<span class="normal"><a href="#__codelineno-116-36">36</a></span>
<span class="normal"><a href="#__codelineno-116-37">37</a></span>
<span class="normal"><a href="#__codelineno-116-38">38</a></span>
<span class="normal"><a href="#__codelineno-116-39">39</a></span>
<span class="normal"><a href="#__codelineno-116-40">40</a></span>
<span class="normal"><a href="#__codelineno-116-41">41</a></span>
<span class="normal"><a href="#__codelineno-116-42">42</a></span>
<span class="normal"><a href="#__codelineno-116-43">43</a></span>
<span class="normal"><a href="#__codelineno-116-44">44</a></span>
<span class="normal"><a href="#__codelineno-116-45">45</a></span>
<span class="normal"><a href="#__codelineno-116-46">46</a></span>
<span class="normal"><a href="#__codelineno-116-47">47</a></span>
<span class="normal"><a href="#__codelineno-116-48">48</a></span>
<span class="normal"><a href="#__codelineno-116-49">49</a></span>
<span class="normal"><a href="#__codelineno-116-50">50</a></span>
<span class="normal"><a href="#__codelineno-116-51">51</a></span>
<span class="normal"><a href="#__codelineno-116-52">52</a></span>
<span class="normal"><a href="#__codelineno-116-53">53</a></span>
<span class="normal"><a href="#__codelineno-116-54">54</a></span>
<span class="normal"><a href="#__codelineno-116-55">55</a></span>
<span class="normal"><a href="#__codelineno-116-56">56</a></span>
<span class="normal"><a href="#__codelineno-116-57">57</a></span>
<span class="normal"><a href="#__codelineno-116-58">58</a></span>
<span class="normal"><a href="#__codelineno-116-59">59</a></span>
<span class="normal"><a href="#__codelineno-116-60">60</a></span>
<span class="normal"><a href="#__codelineno-116-61">61</a></span>
<span class="normal"><a href="#__codelineno-116-62">62</a></span>
<span class="normal"><a href="#__codelineno-116-63">63</a></span>
<span class="normal"><a href="#__codelineno-116-64">64</a></span>
<span class="normal"><a href="#__codelineno-116-65">65</a></span>
<span class="normal"><a href="#__codelineno-116-66">66</a></span>
<span class="normal"><a href="#__codelineno-116-67">67</a></span>
<span class="normal"><a href="#__codelineno-116-68">68</a></span>
<span class="normal"><a href="#__codelineno-116-69">69</a></span>
<span class="normal"><a href="#__codelineno-116-70">70</a></span>
<span class="normal"><a href="#__codelineno-116-71">71</a></span>
<span class="normal"><a href="#__codelineno-116-72">72</a></span>
<span class="normal"><a href="#__codelineno-116-73">73</a></span>
<span class="normal"><a href="#__codelineno-116-74">74</a></span>
<span class="normal"><a href="#__codelineno-116-75">75</a></span>
<span class="normal"><a href="#__codelineno-116-76">76</a></span>
<span class="normal"><a href="#__codelineno-116-77">77</a></span>
<span class="normal"><a href="#__codelineno-116-78">78</a></span>
<span class="normal"><a href="#__codelineno-116-79">79</a></span>
<span class="normal"><a href="#__codelineno-116-80">80</a></span>
<span class="normal"><a href="#__codelineno-116-81">81</a></span>
<span class="normal"><a href="#__codelineno-116-82">82</a></span>
<span class="normal"><a href="#__codelineno-116-83">83</a></span>
<span class="normal"><a href="#__codelineno-116-84">84</a></span>
<span class="normal"><a href="#__codelineno-116-85">85</a></span>
<span class="normal"><a href="#__codelineno-116-86">86</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-116-1" name="__codelineno-116-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.utils.deprecation</span><span class="w"> </span><span class="kn">import</span> <span class="n">MiddlewareMixin</span>
<a id="__codelineno-116-2" name="__codelineno-116-2"></a>
<a id="__codelineno-116-3" name="__codelineno-116-3"></a><span class="k">class</span><span class="w"> </span><span class="nc">MyMiddleware</span><span class="p">(</span><span class="n">MiddlewareMixin</span><span class="p">):</span>
<a id="__codelineno-116-4" name="__codelineno-116-4"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">process_request</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">request</span><span class="p">):</span>
<a id="__codelineno-116-5" name="__codelineno-116-5"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;我是第一个自定义中间件里的process_request方法&#39;</span><span class="p">)</span>
<a id="__codelineno-116-6" name="__codelineno-116-6"></a>
<a id="__codelineno-116-7" name="__codelineno-116-7"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">process_response</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">request</span><span class="p">,</span><span class="n">response</span><span class="p">):</span>
<a id="__codelineno-116-8" name="__codelineno-116-8"></a>
<a id="__codelineno-116-9" name="__codelineno-116-9"></a>
<a id="__codelineno-116-10" name="__codelineno-116-10"></a>        <span class="c1">## 必须返回response 要不然就等于拦截了</span>
<a id="__codelineno-116-11" name="__codelineno-116-11"></a>        <span class="k">return</span> <span class="n">response</span>
<a id="__codelineno-116-12" name="__codelineno-116-12"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">process_view</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">request</span><span class="p">,</span><span class="n">view_name</span><span class="p">,</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<a id="__codelineno-116-13" name="__codelineno-116-13"></a>        <span class="c1">## 在路由匹配成功之后，在视图函数执行之前触发这个方法</span>
<a id="__codelineno-116-14" name="__codelineno-116-14"></a>        <span class="nb">print</span><span class="p">(</span><span class="n">view_name</span><span class="p">,</span><span class="n">args</span><span class="p">,</span><span class="n">kwargs</span><span class="p">)</span>
<a id="__codelineno-116-15" name="__codelineno-116-15"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;我是process_view方法&#39;</span><span class="p">)</span>
<a id="__codelineno-116-16" name="__codelineno-116-16"></a>
<a id="__codelineno-116-17" name="__codelineno-116-17"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">process_template_response</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">request</span><span class="p">,</span><span class="n">response</span><span class="p">):</span>
<a id="__codelineno-116-18" name="__codelineno-116-18"></a>        <span class="c1">## 执行条件很苛刻，了解一下即可，反正用的极少极少极少</span>
<a id="__codelineno-116-19" name="__codelineno-116-19"></a>
<a id="__codelineno-116-20" name="__codelineno-116-20"></a>        <span class="k">return</span> <span class="n">response</span>
<a id="__codelineno-116-21" name="__codelineno-116-21"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">process_exception</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">request</span><span class="p">,</span><span class="n">exception</span><span class="p">):</span>
<a id="__codelineno-116-22" name="__codelineno-116-22"></a>        <span class="c1">## 当视图函数中出现异常的情况下触发</span>
<a id="__codelineno-116-23" name="__codelineno-116-23"></a>        <span class="nb">print</span><span class="p">(</span><span class="n">exception</span><span class="p">)</span>
<a id="__codelineno-116-24" name="__codelineno-116-24"></a>
<a id="__codelineno-116-25" name="__codelineno-116-25"></a>
<a id="__codelineno-116-26" name="__codelineno-116-26"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-116-27" name="__codelineno-116-27"></a><span class="sd">1.在项目名或者应用名下创建一个任意名称的文件夹</span>
<a id="__codelineno-116-28" name="__codelineno-116-28"></a><span class="sd">2.在该文件夹内创建一个任意名称的py文件</span>
<a id="__codelineno-116-29" name="__codelineno-116-29"></a><span class="sd">3.在该py文件内需要书写类(这个类必须继承MiddlewareMixin)</span>
<a id="__codelineno-116-30" name="__codelineno-116-30"></a><span class="sd">    然后在这个类里面就可以自定义五个方法了</span>
<a id="__codelineno-116-31" name="__codelineno-116-31"></a><span class="sd">    (这五个方法并不是全部都需要书写，用几个写几个)</span>
<a id="__codelineno-116-32" name="__codelineno-116-32"></a><span class="sd">4.需要将类的路径以字符串的形式注册到配置文件中才能生效</span>
<a id="__codelineno-116-33" name="__codelineno-116-33"></a><span class="sd">MIDDLEWARE = [</span>
<a id="__codelineno-116-34" name="__codelineno-116-34"></a><span class="sd">    &#39;django.middleware.security.SecurityMiddleware&#39;,</span>
<a id="__codelineno-116-35" name="__codelineno-116-35"></a><span class="sd">    &#39;django.contrib.sessions.middleware.SessionMiddleware&#39;,</span>
<a id="__codelineno-116-36" name="__codelineno-116-36"></a><span class="sd">    &#39;django.middleware.common.CommonMiddleware&#39;,</span>
<a id="__codelineno-116-37" name="__codelineno-116-37"></a><span class="sd">    &#39;django.middleware.csrf.CsrfViewMiddleware&#39;,</span>
<a id="__codelineno-116-38" name="__codelineno-116-38"></a><span class="sd">    &#39;django.contrib.auth.middleware.AuthenticationMiddleware&#39;,</span>
<a id="__codelineno-116-39" name="__codelineno-116-39"></a><span class="sd">    &#39;django.contrib.messages.middleware.MessageMiddleware&#39;,</span>
<a id="__codelineno-116-40" name="__codelineno-116-40"></a><span class="sd">    &#39;django.middleware.clickjacking.XFrameOptionsMiddleware&#39;,</span>
<a id="__codelineno-116-41" name="__codelineno-116-41"></a><span class="sd">    &#39;你自己写的中间件的路径1&#39;,</span>
<a id="__codelineno-116-42" name="__codelineno-116-42"></a><span class="sd">    &#39;你自己写的中间件的路径2&#39;,</span>
<a id="__codelineno-116-43" name="__codelineno-116-43"></a><span class="sd">    &#39;你自己写的中间件的路径3&#39;,</span>
<a id="__codelineno-116-44" name="__codelineno-116-44"></a><span class="sd">]</span>
<a id="__codelineno-116-45" name="__codelineno-116-45"></a>
<a id="__codelineno-116-46" name="__codelineno-116-46"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-116-47" name="__codelineno-116-47"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-116-48" name="__codelineno-116-48"></a><span class="sd">1.必须掌握</span>
<a id="__codelineno-116-49" name="__codelineno-116-49"></a><span class="sd">        process_request </span>
<a id="__codelineno-116-50" name="__codelineno-116-50"></a><span class="sd">            1.请求来的时候需要经过每一个中间件里面的process_request方法</span>
<a id="__codelineno-116-51" name="__codelineno-116-51"></a><span class="sd">            结果的顺序是按照配置文件中注册的中间件从上往下的顺序依次执行</span>
<a id="__codelineno-116-52" name="__codelineno-116-52"></a><span class="sd">            2.如果中间件里面没有定义该方法，那么直接跳过执行下一个中间件</span>
<a id="__codelineno-116-53" name="__codelineno-116-53"></a><span class="sd">            3.如果该方法返回了HttpResponse对象，那么请求将不再继续往后执行</span>
<a id="__codelineno-116-54" name="__codelineno-116-54"></a><span class="sd">            而是直接原路返回(校验失败不允许访问...)</span>
<a id="__codelineno-116-55" name="__codelineno-116-55"></a><span class="sd">            process_request方法就是用来做全局相关的所有限制功能</span>
<a id="__codelineno-116-56" name="__codelineno-116-56"></a>
<a id="__codelineno-116-57" name="__codelineno-116-57"></a><span class="sd">        process_response</span>
<a id="__codelineno-116-58" name="__codelineno-116-58"></a><span class="sd">            1.响应走的时候需要结果每一个中间件里面的process_response方法</span>
<a id="__codelineno-116-59" name="__codelineno-116-59"></a><span class="sd">            该方法有两个额外的参数request,response</span>
<a id="__codelineno-116-60" name="__codelineno-116-60"></a><span class="sd">            2.该方法必须返回一个HttpResponse对象</span>
<a id="__codelineno-116-61" name="__codelineno-116-61"></a><span class="sd">                1.默认返回的就是形参response</span>
<a id="__codelineno-116-62" name="__codelineno-116-62"></a><span class="sd">                2.你也可以自己返回自己的</span>
<a id="__codelineno-116-63" name="__codelineno-116-63"></a><span class="sd">            3.顺序是按照配置文件中注册了的中间件从下往上依次经过</span>
<a id="__codelineno-116-64" name="__codelineno-116-64"></a><span class="sd">                如果你没有定义的话 直接跳过执行下一个</span>
<a id="__codelineno-116-65" name="__codelineno-116-65"></a>
<a id="__codelineno-116-66" name="__codelineno-116-66"></a><span class="sd">        研究如果在第一个process_request方法就已经返回了HttpResponse对象，那么响应走的时候是经过所有的中间件里面的process_response还是有其他情况</span>
<a id="__codelineno-116-67" name="__codelineno-116-67"></a><span class="sd">        是其他情况</span>
<a id="__codelineno-116-68" name="__codelineno-116-68"></a><span class="sd">            就是会直接走同级别的process_reponse返回</span>
<a id="__codelineno-116-69" name="__codelineno-116-69"></a>
<a id="__codelineno-116-70" name="__codelineno-116-70"></a><span class="sd">        flask框架也有一个中间件但是它的规律</span>
<a id="__codelineno-116-71" name="__codelineno-116-71"></a><span class="sd">            只要返回数据了就必须经过所有中间件里面的类似于process_reponse方法</span>
<a id="__codelineno-116-72" name="__codelineno-116-72"></a>
<a id="__codelineno-116-73" name="__codelineno-116-73"></a>
<a id="__codelineno-116-74" name="__codelineno-116-74"></a><span class="sd">2.了解即可</span>
<a id="__codelineno-116-75" name="__codelineno-116-75"></a><span class="sd">        process_view</span>
<a id="__codelineno-116-76" name="__codelineno-116-76"></a><span class="sd">            路由匹配成功之后执行视图函数之前，会自动执行中间件里面的该放法</span>
<a id="__codelineno-116-77" name="__codelineno-116-77"></a><span class="sd">            顺序是按照配置文件中注册的中间件从上往下的顺序依次执行</span>
<a id="__codelineno-116-78" name="__codelineno-116-78"></a>
<a id="__codelineno-116-79" name="__codelineno-116-79"></a><span class="sd">        process_template_response</span>
<a id="__codelineno-116-80" name="__codelineno-116-80"></a><span class="sd">            返回的HttpResponse对象有render属性的时候才会触发</span>
<a id="__codelineno-116-81" name="__codelineno-116-81"></a><span class="sd">            顺序是按照配置文件中注册了的中间件从下往上依次经过</span>
<a id="__codelineno-116-82" name="__codelineno-116-82"></a>
<a id="__codelineno-116-83" name="__codelineno-116-83"></a><span class="sd">        process_exception</span>
<a id="__codelineno-116-84" name="__codelineno-116-84"></a><span class="sd">            当视图函数中出现异常的情况下触发</span>
<a id="__codelineno-116-85" name="__codelineno-116-85"></a><span class="sd">            顺序是按照配置文件中注册了的中间件从下往上依次经过</span>
<a id="__codelineno-116-86" name="__codelineno-116-86"></a><span class="sd">&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
<h3 id="20-3-csrf跨站请求伪造">20-3 csrf跨站请求伪造<a class="headerlink" href="#20-3-csrf跨站请求伪造" title="Permanent link">&para;</a></h3>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-117-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-117-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-117-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-117-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-117-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-117-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-117-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-117-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-117-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-117-10">10</a></span>
<span class="normal"><a href="#__codelineno-117-11">11</a></span>
<span class="normal"><a href="#__codelineno-117-12">12</a></span>
<span class="normal"><a href="#__codelineno-117-13">13</a></span>
<span class="normal"><a href="#__codelineno-117-14">14</a></span>
<span class="normal"><a href="#__codelineno-117-15">15</a></span>
<span class="normal"><a href="#__codelineno-117-16">16</a></span>
<span class="normal"><a href="#__codelineno-117-17">17</a></span>
<span class="normal"><a href="#__codelineno-117-18">18</a></span>
<span class="normal"><a href="#__codelineno-117-19">19</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-117-1" name="__codelineno-117-1"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-117-2" name="__codelineno-117-2"></a><span class="sd">钓鱼网站</span>
<a id="__codelineno-117-3" name="__codelineno-117-3"></a><span class="sd">    我搭建一个跟正规网站一模一样的界面(中国银行)</span>
<a id="__codelineno-117-4" name="__codelineno-117-4"></a><span class="sd">    用户不小心进入到了我们的网站，用户给某个人打钱</span>
<a id="__codelineno-117-5" name="__codelineno-117-5"></a><span class="sd">    打钱的操作确确实实是提交给了中国银行的系统，用户的钱也确确实实减少了</span>
<a id="__codelineno-117-6" name="__codelineno-117-6"></a><span class="sd">    但是唯一不同的时候打钱的账户不适用户想要打的账户变成了一个莫名其妙的账户</span>
<a id="__codelineno-117-7" name="__codelineno-117-7"></a>
<a id="__codelineno-117-8" name="__codelineno-117-8"></a><span class="sd">大学英语四六级</span>
<a id="__codelineno-117-9" name="__codelineno-117-9"></a><span class="sd">    考之前需要学生自己网站登陆缴费</span>
<a id="__codelineno-117-10" name="__codelineno-117-10"></a>
<a id="__codelineno-117-11" name="__codelineno-117-11"></a><span class="sd">内部本质</span>
<a id="__codelineno-117-12" name="__codelineno-117-12"></a><span class="sd">    我们在钓鱼网站的页面 针对对方账户 只给用户提供一个没有name属性的普通input框</span>
<a id="__codelineno-117-13" name="__codelineno-117-13"></a><span class="sd">    然后我们在内部隐藏一个已经写好name和value的input框</span>
<a id="__codelineno-117-14" name="__codelineno-117-14"></a>
<a id="__codelineno-117-15" name="__codelineno-117-15"></a><span class="sd">如何规避上述问题</span>
<a id="__codelineno-117-16" name="__codelineno-117-16"></a><span class="sd">    csrf跨站请求伪造校验</span>
<a id="__codelineno-117-17" name="__codelineno-117-17"></a><span class="sd">        网站在给用户返回一个具有提交数据功能页面的时候会给这个页面加一个唯一标识</span>
<a id="__codelineno-117-18" name="__codelineno-117-18"></a><span class="sd">        当这个页面朝后端发送post请求的时候 我的后端会先校验唯一标识，如果唯一标识不对直接拒绝(403 forbbiden)如果成功则正常执行   </span>
<a id="__codelineno-117-19" name="__codelineno-117-19"></a><span class="sd">&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
<h3 id="20-4-如何符合校验">20-4 如何符合校验<a class="headerlink" href="#20-4-如何符合校验" title="Permanent link">&para;</a></h3>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-118-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-118-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-118-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-118-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-118-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-118-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-118-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-118-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-118-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-118-10">10</a></span>
<span class="normal"><a href="#__codelineno-118-11">11</a></span>
<span class="normal"><a href="#__codelineno-118-12">12</a></span>
<span class="normal"><a href="#__codelineno-118-13">13</a></span>
<span class="normal"><a href="#__codelineno-118-14">14</a></span>
<span class="normal"><a href="#__codelineno-118-15">15</a></span>
<span class="normal"><a href="#__codelineno-118-16">16</a></span>
<span class="normal"><a href="#__codelineno-118-17">17</a></span>
<span class="normal"><a href="#__codelineno-118-18">18</a></span>
<span class="normal"><a href="#__codelineno-118-19">19</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-118-1" name="__codelineno-118-1"></a><span class="c1"># form表单如何符合校验</span>
<a id="__codelineno-118-2" name="__codelineno-118-2"></a><span class="o">&lt;</span><span class="n">form</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;&quot;</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;post&quot;</span><span class="o">&gt;</span>
<a id="__codelineno-118-3" name="__codelineno-118-3"></a>    <span class="p">{</span><span class="o">%</span> <span class="n">csrf_token</span> <span class="o">%</span><span class="p">}</span>
<a id="__codelineno-118-4" name="__codelineno-118-4"></a>    <span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="n">username</span><span class="p">:</span><span class="o">&lt;</span><span class="nb">input</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;username&quot;</span><span class="o">&gt;&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
<a id="__codelineno-118-5" name="__codelineno-118-5"></a>
<a id="__codelineno-118-6" name="__codelineno-118-6"></a>    <span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="n">target_user</span><span class="p">:</span><span class="o">&lt;</span><span class="nb">input</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;target_user&quot;</span><span class="o">&gt;&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
<a id="__codelineno-118-7" name="__codelineno-118-7"></a>
<a id="__codelineno-118-8" name="__codelineno-118-8"></a>    <span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="n">money</span><span class="p">:</span><span class="o">&lt;</span><span class="nb">input</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;money&quot;</span><span class="o">&gt;&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
<a id="__codelineno-118-9" name="__codelineno-118-9"></a>
<a id="__codelineno-118-10" name="__codelineno-118-10"></a>    <span class="o">&lt;</span><span class="nb">input</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;submit&quot;</span><span class="o">&gt;</span>
<a id="__codelineno-118-11" name="__codelineno-118-11"></a><span class="o">&lt;/</span><span class="n">form</span><span class="o">&gt;</span>
<a id="__codelineno-118-12" name="__codelineno-118-12"></a>
<a id="__codelineno-118-13" name="__codelineno-118-13"></a><span class="c1"># ajax如何符合校验</span>
<a id="__codelineno-118-14" name="__codelineno-118-14"></a><span class="o">//</span> <span class="n">第一种</span> <span class="n">利用标签查找获取页面上的随机字符串</span>
<a id="__codelineno-118-15" name="__codelineno-118-15"></a><span class="p">{</span><span class="c1">#data:{&quot;username&quot;:&#39;jason&#39;,&#39;csrfmiddlewaretoken&#39;:$(&#39;[name=csrfmiddlewaretoken]&#39;).val()},#}</span>
<a id="__codelineno-118-16" name="__codelineno-118-16"></a><span class="o">//</span> <span class="n">第二种</span> <span class="n">利用模版语法提供的快捷书写</span>
<a id="__codelineno-118-17" name="__codelineno-118-17"></a><span class="p">{</span><span class="c1">#data:{&quot;username&quot;:&#39;jason&#39;,&#39;csrfmiddlewaretoken&#39;:&#39;{{ csrf_token }}&#39;},#}</span>
<a id="__codelineno-118-18" name="__codelineno-118-18"></a><span class="o">//</span> <span class="n">第三种</span> <span class="n">通用方式直接拷贝js代码并应用到自己的html页面上即可</span>
<a id="__codelineno-118-19" name="__codelineno-118-19"></a><span class="n">data</span><span class="p">:{</span><span class="s2">&quot;username&quot;</span><span class="p">:</span><span class="s1">&#39;jason&#39;</span><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-119-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-119-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-119-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-119-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-119-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-119-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-119-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-119-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-119-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-119-10">10</a></span>
<span class="normal"><a href="#__codelineno-119-11">11</a></span>
<span class="normal"><a href="#__codelineno-119-12">12</a></span>
<span class="normal"><a href="#__codelineno-119-13">13</a></span>
<span class="normal"><a href="#__codelineno-119-14">14</a></span>
<span class="normal"><a href="#__codelineno-119-15">15</a></span>
<span class="normal"><a href="#__codelineno-119-16">16</a></span>
<span class="normal"><a href="#__codelineno-119-17">17</a></span>
<span class="normal"><a href="#__codelineno-119-18">18</a></span>
<span class="normal"><a href="#__codelineno-119-19">19</a></span>
<span class="normal"><a href="#__codelineno-119-20">20</a></span>
<span class="normal"><a href="#__codelineno-119-21">21</a></span>
<span class="normal"><a href="#__codelineno-119-22">22</a></span>
<span class="normal"><a href="#__codelineno-119-23">23</a></span>
<span class="normal"><a href="#__codelineno-119-24">24</a></span>
<span class="normal"><a href="#__codelineno-119-25">25</a></span>
<span class="normal"><a href="#__codelineno-119-26">26</a></span>
<span class="normal"><a href="#__codelineno-119-27">27</a></span>
<span class="normal"><a href="#__codelineno-119-28">28</a></span>
<span class="normal"><a href="#__codelineno-119-29">29</a></span>
<span class="normal"><a href="#__codelineno-119-30">30</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-119-1" name="__codelineno-119-1"></a><span class="n">function</span> <span class="n">getCookie</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="p">{</span>
<a id="__codelineno-119-2" name="__codelineno-119-2"></a>    <span class="n">var</span> <span class="n">cookieValue</span> <span class="o">=</span> <span class="n">null</span><span class="p">;</span>
<a id="__codelineno-119-3" name="__codelineno-119-3"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">document</span><span class="o">.</span><span class="n">cookie</span> <span class="o">&amp;&amp;</span> <span class="n">document</span><span class="o">.</span><span class="n">cookie</span> <span class="o">!==</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="p">{</span>
<a id="__codelineno-119-4" name="__codelineno-119-4"></a>        <span class="n">var</span> <span class="n">cookies</span> <span class="o">=</span> <span class="n">document</span><span class="o">.</span><span class="n">cookie</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="p">);</span>
<a id="__codelineno-119-5" name="__codelineno-119-5"></a>        <span class="k">for</span> <span class="p">(</span><span class="n">var</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">cookies</span><span class="o">.</span><span class="n">length</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
<a id="__codelineno-119-6" name="__codelineno-119-6"></a>            <span class="n">var</span> <span class="n">cookie</span> <span class="o">=</span> <span class="n">jQuery</span><span class="o">.</span><span class="n">trim</span><span class="p">(</span><span class="n">cookies</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
<a id="__codelineno-119-7" name="__codelineno-119-7"></a>            <span class="o">//</span> <span class="n">Does</span> <span class="n">this</span> <span class="n">cookie</span> <span class="n">string</span> <span class="n">begin</span> <span class="k">with</span> <span class="n">the</span> <span class="n">name</span> <span class="n">we</span> <span class="n">want</span><span class="err">?</span>
<a id="__codelineno-119-8" name="__codelineno-119-8"></a>            <span class="k">if</span> <span class="p">(</span><span class="n">cookie</span><span class="o">.</span><span class="n">substring</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">name</span><span class="o">.</span><span class="n">length</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">===</span> <span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;=&#39;</span><span class="p">))</span> <span class="p">{</span>
<a id="__codelineno-119-9" name="__codelineno-119-9"></a>                <span class="n">cookieValue</span> <span class="o">=</span> <span class="n">decodeURIComponent</span><span class="p">(</span><span class="n">cookie</span><span class="o">.</span><span class="n">substring</span><span class="p">(</span><span class="n">name</span><span class="o">.</span><span class="n">length</span> <span class="o">+</span> <span class="mi">1</span><span class="p">));</span>
<a id="__codelineno-119-10" name="__codelineno-119-10"></a>                <span class="k">break</span><span class="p">;</span>
<a id="__codelineno-119-11" name="__codelineno-119-11"></a>            <span class="p">}</span>
<a id="__codelineno-119-12" name="__codelineno-119-12"></a>        <span class="p">}</span>
<a id="__codelineno-119-13" name="__codelineno-119-13"></a>    <span class="p">}</span>
<a id="__codelineno-119-14" name="__codelineno-119-14"></a>    <span class="k">return</span> <span class="n">cookieValue</span><span class="p">;</span>
<a id="__codelineno-119-15" name="__codelineno-119-15"></a><span class="p">}</span>
<a id="__codelineno-119-16" name="__codelineno-119-16"></a><span class="n">var</span> <span class="n">csrftoken</span> <span class="o">=</span> <span class="n">getCookie</span><span class="p">(</span><span class="s1">&#39;csrftoken&#39;</span><span class="p">);</span>
<a id="__codelineno-119-17" name="__codelineno-119-17"></a>
<a id="__codelineno-119-18" name="__codelineno-119-18"></a>
<a id="__codelineno-119-19" name="__codelineno-119-19"></a><span class="n">function</span> <span class="n">csrfSafeMethod</span><span class="p">(</span><span class="n">method</span><span class="p">)</span> <span class="p">{</span>
<a id="__codelineno-119-20" name="__codelineno-119-20"></a>  <span class="o">//</span> <span class="n">these</span> <span class="n">HTTP</span> <span class="n">methods</span> <span class="n">do</span> <span class="ow">not</span> <span class="n">require</span> <span class="n">CSRF</span> <span class="n">protection</span>
<a id="__codelineno-119-21" name="__codelineno-119-21"></a>  <span class="k">return</span> <span class="p">(</span><span class="o">/^</span><span class="p">(</span><span class="n">GET</span><span class="o">|</span><span class="n">HEAD</span><span class="o">|</span><span class="n">OPTIONS</span><span class="o">|</span><span class="n">TRACE</span><span class="p">)</span><span class="err">$</span><span class="o">/.</span><span class="n">test</span><span class="p">(</span><span class="n">method</span><span class="p">));</span>
<a id="__codelineno-119-22" name="__codelineno-119-22"></a><span class="p">}</span>
<a id="__codelineno-119-23" name="__codelineno-119-23"></a>
<a id="__codelineno-119-24" name="__codelineno-119-24"></a><span class="err">$</span><span class="o">.</span><span class="n">ajaxSetup</span><span class="p">({</span>
<a id="__codelineno-119-25" name="__codelineno-119-25"></a>  <span class="n">beforeSend</span><span class="p">:</span> <span class="n">function</span> <span class="p">(</span><span class="n">xhr</span><span class="p">,</span> <span class="n">settings</span><span class="p">)</span> <span class="p">{</span>
<a id="__codelineno-119-26" name="__codelineno-119-26"></a>    <span class="k">if</span> <span class="p">(</span><span class="err">!</span><span class="n">csrfSafeMethod</span><span class="p">(</span><span class="n">settings</span><span class="o">.</span><span class="n">type</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="err">!</span><span class="n">this</span><span class="o">.</span><span class="n">crossDomain</span><span class="p">)</span> <span class="p">{</span>
<a id="__codelineno-119-27" name="__codelineno-119-27"></a>      <span class="n">xhr</span><span class="o">.</span><span class="n">setRequestHeader</span><span class="p">(</span><span class="s2">&quot;X-CSRFToken&quot;</span><span class="p">,</span> <span class="n">csrftoken</span><span class="p">);</span>
<a id="__codelineno-119-28" name="__codelineno-119-28"></a>    <span class="p">}</span>
<a id="__codelineno-119-29" name="__codelineno-119-29"></a>  <span class="p">}</span>
<a id="__codelineno-119-30" name="__codelineno-119-30"></a><span class="p">});</span>
</code></pre></div></td></tr></table></div>
<h3 id="20-5-csrf相关装饰器">20-5 CSRF相关装饰器<a class="headerlink" href="#20-5-csrf相关装饰器" title="Permanent link">&para;</a></h3>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-120-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-120-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-120-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-120-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-120-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-120-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-120-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-120-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-120-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-120-10">10</a></span>
<span class="normal"><a href="#__codelineno-120-11">11</a></span>
<span class="normal"><a href="#__codelineno-120-12">12</a></span>
<span class="normal"><a href="#__codelineno-120-13">13</a></span>
<span class="normal"><a href="#__codelineno-120-14">14</a></span>
<span class="normal"><a href="#__codelineno-120-15">15</a></span>
<span class="normal"><a href="#__codelineno-120-16">16</a></span>
<span class="normal"><a href="#__codelineno-120-17">17</a></span>
<span class="normal"><a href="#__codelineno-120-18">18</a></span>
<span class="normal"><a href="#__codelineno-120-19">19</a></span>
<span class="normal"><a href="#__codelineno-120-20">20</a></span>
<span class="normal"><a href="#__codelineno-120-21">21</a></span>
<span class="normal"><a href="#__codelineno-120-22">22</a></span>
<span class="normal"><a href="#__codelineno-120-23">23</a></span>
<span class="normal"><a href="#__codelineno-120-24">24</a></span>
<span class="normal"><a href="#__codelineno-120-25">25</a></span>
<span class="normal"><a href="#__codelineno-120-26">26</a></span>
<span class="normal"><a href="#__codelineno-120-27">27</a></span>
<span class="normal"><a href="#__codelineno-120-28">28</a></span>
<span class="normal"><a href="#__codelineno-120-29">29</a></span>
<span class="normal"><a href="#__codelineno-120-30">30</a></span>
<span class="normal"><a href="#__codelineno-120-31">31</a></span>
<span class="normal"><a href="#__codelineno-120-32">32</a></span>
<span class="normal"><a href="#__codelineno-120-33">33</a></span>
<span class="normal"><a href="#__codelineno-120-34">34</a></span>
<span class="normal"><a href="#__codelineno-120-35">35</a></span>
<span class="normal"><a href="#__codelineno-120-36">36</a></span>
<span class="normal"><a href="#__codelineno-120-37">37</a></span>
<span class="normal"><a href="#__codelineno-120-38">38</a></span>
<span class="normal"><a href="#__codelineno-120-39">39</a></span>
<span class="normal"><a href="#__codelineno-120-40">40</a></span>
<span class="normal"><a href="#__codelineno-120-41">41</a></span>
<span class="normal"><a href="#__codelineno-120-42">42</a></span>
<span class="normal"><a href="#__codelineno-120-43">43</a></span>
<span class="normal"><a href="#__codelineno-120-44">44</a></span>
<span class="normal"><a href="#__codelineno-120-45">45</a></span>
<span class="normal"><a href="#__codelineno-120-46">46</a></span>
<span class="normal"><a href="#__codelineno-120-47">47</a></span>
<span class="normal"><a href="#__codelineno-120-48">48</a></span>
<span class="normal"><a href="#__codelineno-120-49">49</a></span>
<span class="normal"><a href="#__codelineno-120-50">50</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-120-1" name="__codelineno-120-1"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-120-2" name="__codelineno-120-2"></a><span class="sd">1.网站整体都不校验csrf，就单单几个视图函数需要校验</span>
<a id="__codelineno-120-3" name="__codelineno-120-3"></a><span class="sd">2.网站整体都校验csrf，就单单几个视图函数不校验</span>
<a id="__codelineno-120-4" name="__codelineno-120-4"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-120-5" name="__codelineno-120-5"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.views.decorators.csrf</span><span class="w"> </span><span class="kn">import</span> <span class="n">csrf_protect</span><span class="p">,</span><span class="n">csrf_exempt</span>
<a id="__codelineno-120-6" name="__codelineno-120-6"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.utils.decorators</span><span class="w"> </span><span class="kn">import</span> <span class="n">method_decorator</span>
<a id="__codelineno-120-7" name="__codelineno-120-7"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-120-8" name="__codelineno-120-8"></a><span class="sd">csrf_protect  需要校验</span>
<a id="__codelineno-120-9" name="__codelineno-120-9"></a><span class="sd">    针对csrf_protect符合我们之前所学的装饰器的三种玩法</span>
<a id="__codelineno-120-10" name="__codelineno-120-10"></a><span class="sd">csrf_exempt   忽视校验</span>
<a id="__codelineno-120-11" name="__codelineno-120-11"></a><span class="sd">    针对csrf_exempt只能给dispatch方法加才有效</span>
<a id="__codelineno-120-12" name="__codelineno-120-12"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-120-13" name="__codelineno-120-13"></a>
<a id="__codelineno-120-14" name="__codelineno-120-14"></a>
<a id="__codelineno-120-15" name="__codelineno-120-15"></a> <span class="s1">&#39;django.middleware.csrf.CsrfViewMiddleware&#39;</span> 
<a id="__codelineno-120-16" name="__codelineno-120-16"></a><span class="c1">## 打开以后网站对csrf进行校验，这个时候可以用@csrf_exempt装饰器忽略某些函数的校验</span>
<a id="__codelineno-120-17" name="__codelineno-120-17"></a>
<a id="__codelineno-120-18" name="__codelineno-120-18"></a>  <span class="s1">&#39;django.middleware.csrf.CsrfViewMiddleware&#39;</span>
<a id="__codelineno-120-19" name="__codelineno-120-19"></a><span class="c1">## 注释掉以后，整个网站就不会进行校验，这时候我们用@csrf_protect 对个别视图函数进行校验</span>
<a id="__codelineno-120-20" name="__codelineno-120-20"></a>
<a id="__codelineno-120-21" name="__codelineno-120-21"></a><span class="c1"># @csrf_exempt</span>
<a id="__codelineno-120-22" name="__codelineno-120-22"></a><span class="c1"># @csrf_protect</span>
<a id="__codelineno-120-23" name="__codelineno-120-23"></a><span class="k">def</span><span class="w"> </span><span class="nf">transfer</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
<a id="__codelineno-120-24" name="__codelineno-120-24"></a>    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;POST&#39;</span><span class="p">:</span>
<a id="__codelineno-120-25" name="__codelineno-120-25"></a>        <span class="n">username</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;username&#39;</span><span class="p">)</span>
<a id="__codelineno-120-26" name="__codelineno-120-26"></a>        <span class="n">target_user</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;target_user&#39;</span><span class="p">)</span>
<a id="__codelineno-120-27" name="__codelineno-120-27"></a>        <span class="n">money</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;money&#39;</span><span class="p">)</span>
<a id="__codelineno-120-28" name="__codelineno-120-28"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">给</span><span class="si">%s</span><span class="s1">转了</span><span class="si">%s</span><span class="s1">元&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">username</span><span class="p">,</span><span class="n">target_user</span><span class="p">,</span><span class="n">money</span><span class="p">))</span>
<a id="__codelineno-120-29" name="__codelineno-120-29"></a>    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span><span class="s1">&#39;transfer.html&#39;</span><span class="p">)</span>
<a id="__codelineno-120-30" name="__codelineno-120-30"></a>
<a id="__codelineno-120-31" name="__codelineno-120-31"></a>
<a id="__codelineno-120-32" name="__codelineno-120-32"></a>
<a id="__codelineno-120-33" name="__codelineno-120-33"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.views</span><span class="w"> </span><span class="kn">import</span> <span class="n">View</span>
<a id="__codelineno-120-34" name="__codelineno-120-34"></a>
<a id="__codelineno-120-35" name="__codelineno-120-35"></a><span class="c1"># @method_decorator(csrf_protect,name=&#39;post&#39;)  # 针对csrf_protect 第二种方式可以</span>
<a id="__codelineno-120-36" name="__codelineno-120-36"></a><span class="c1"># @method_decorator(csrf_exempt,name=&#39;post&#39;)  # 针对csrf_exempt 第二种方式不可以</span>
<a id="__codelineno-120-37" name="__codelineno-120-37"></a><span class="nd">@method_decorator</span><span class="p">(</span><span class="n">csrf_exempt</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;dispatch&#39;</span><span class="p">)</span>
<a id="__codelineno-120-38" name="__codelineno-120-38"></a><span class="k">class</span><span class="w"> </span><span class="nc">MyCsrfToken</span><span class="p">(</span><span class="n">View</span><span class="p">):</span>
<a id="__codelineno-120-39" name="__codelineno-120-39"></a>    <span class="c1"># @method_decorator(csrf_protect)  # 针对csrf_protect 第三种方式可以</span>
<a id="__codelineno-120-40" name="__codelineno-120-40"></a>    <span class="c1"># @method_decorator(csrf_exempt)  # 针对csrf_exempt 第三种方式可以</span>
<a id="__codelineno-120-41" name="__codelineno-120-41"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">dispatch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<a id="__codelineno-120-42" name="__codelineno-120-42"></a>        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">MyCsrfToken</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">dispatch</span><span class="p">(</span><span class="n">request</span><span class="p">,</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<a id="__codelineno-120-43" name="__codelineno-120-43"></a>
<a id="__codelineno-120-44" name="__codelineno-120-44"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">request</span><span class="p">):</span>
<a id="__codelineno-120-45" name="__codelineno-120-45"></a>        <span class="k">return</span> <span class="n">HttpResponse</span><span class="p">(</span><span class="s1">&#39;get&#39;</span><span class="p">)</span>
<a id="__codelineno-120-46" name="__codelineno-120-46"></a>
<a id="__codelineno-120-47" name="__codelineno-120-47"></a>    <span class="c1"># @method_decorator(csrf_protect)  # 针对csrf_protect 第一种方式可以</span>
<a id="__codelineno-120-48" name="__codelineno-120-48"></a>    <span class="c1"># @method_decorator(csrf_exempt)  # 针对csrf_exempt 第一种方式不可以</span>
<a id="__codelineno-120-49" name="__codelineno-120-49"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">post</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">request</span><span class="p">):</span>
<a id="__codelineno-120-50" name="__codelineno-120-50"></a>        <span class="k">return</span> <span class="n">HttpResponse</span><span class="p">(</span><span class="s1">&#39;post&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<h3 id="20-6-补充知识点">20-6 补充知识点<a class="headerlink" href="#20-6-补充知识点" title="Permanent link">&para;</a></h3>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-121-1">1</a></span>
<span class="normal"><a href="#__codelineno-121-2">2</a></span>
<span class="normal"><a href="#__codelineno-121-3">3</a></span>
<span class="normal"><a href="#__codelineno-121-4">4</a></span>
<span class="normal"><a href="#__codelineno-121-5">5</a></span>
<span class="normal"><a href="#__codelineno-121-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-121-1" name="__codelineno-121-1"></a><span class="c1"># 模块:importlib</span>
<a id="__codelineno-121-2" name="__codelineno-121-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">importlib</span>
<a id="__codelineno-121-3" name="__codelineno-121-3"></a><span class="n">res</span> <span class="o">=</span> <span class="s1">&#39;myfile.b&#39;</span>
<a id="__codelineno-121-4" name="__codelineno-121-4"></a><span class="n">ret</span> <span class="o">=</span> <span class="n">importlib</span><span class="o">.</span><span class="n">import_module</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>  <span class="c1"># from myfile import b</span>
<a id="__codelineno-121-5" name="__codelineno-121-5"></a><span class="c1"># 该方法最小只能到py文件名</span>
<a id="__codelineno-121-6" name="__codelineno-121-6"></a><span class="nb">print</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<h3 id="20-7-重要思想">20-7 重要思想<a class="headerlink" href="#20-7-重要思想" title="Permanent link">&para;</a></h3>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-122-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-122-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-122-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-122-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-122-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-122-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-122-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-122-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-122-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-122-10">10</a></span>
<span class="normal"><a href="#__codelineno-122-11">11</a></span>
<span class="normal"><a href="#__codelineno-122-12">12</a></span>
<span class="normal"><a href="#__codelineno-122-13">13</a></span>
<span class="normal"><a href="#__codelineno-122-14">14</a></span>
<span class="normal"><a href="#__codelineno-122-15">15</a></span>
<span class="normal"><a href="#__codelineno-122-16">16</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-122-1" name="__codelineno-122-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">settings</span>
<a id="__codelineno-122-2" name="__codelineno-122-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">importlib</span>
<a id="__codelineno-122-3" name="__codelineno-122-3"></a>
<a id="__codelineno-122-4" name="__codelineno-122-4"></a>
<a id="__codelineno-122-5" name="__codelineno-122-5"></a><span class="k">def</span><span class="w"> </span><span class="nf">send_all</span><span class="p">(</span><span class="n">content</span><span class="p">):</span>
<a id="__codelineno-122-6" name="__codelineno-122-6"></a>    <span class="k">for</span> <span class="n">path_str</span> <span class="ow">in</span> <span class="n">settings</span><span class="o">.</span><span class="n">NOTIFY_LIST</span><span class="p">:</span>  <span class="c1">#&#39;notify.email.Email&#39;</span>
<a id="__codelineno-122-7" name="__codelineno-122-7"></a>        <span class="n">module_path</span><span class="p">,</span><span class="n">class_name</span> <span class="o">=</span> <span class="n">path_str</span><span class="o">.</span><span class="n">rsplit</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="n">maxsplit</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-122-8" name="__codelineno-122-8"></a>        <span class="c1"># module_path = &#39;notify.email&#39;  class_name = &#39;Email&#39;</span>
<a id="__codelineno-122-9" name="__codelineno-122-9"></a>        <span class="c1"># 1 利用字符串导入模块</span>
<a id="__codelineno-122-10" name="__codelineno-122-10"></a>        <span class="n">module</span> <span class="o">=</span> <span class="n">importlib</span><span class="o">.</span><span class="n">import_module</span><span class="p">(</span><span class="n">module_path</span><span class="p">)</span>  <span class="c1"># from notify import email</span>
<a id="__codelineno-122-11" name="__codelineno-122-11"></a>        <span class="c1"># 2 利用反射获取类名</span>
<a id="__codelineno-122-12" name="__codelineno-122-12"></a>        <span class="bp">cls</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">module</span><span class="p">,</span><span class="n">class_name</span><span class="p">)</span>  <span class="c1"># Email、QQ、Wechat</span>
<a id="__codelineno-122-13" name="__codelineno-122-13"></a>        <span class="c1"># 3 生成类的对象</span>
<a id="__codelineno-122-14" name="__codelineno-122-14"></a>        <span class="n">obj</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">()</span>
<a id="__codelineno-122-15" name="__codelineno-122-15"></a>        <span class="c1"># 4 利用鸭子类型直接调用send方法</span>
<a id="__codelineno-122-16" name="__codelineno-122-16"></a>        <span class="n">obj</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">content</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<h2 id="21-auth模块">21 auth模块<a class="headerlink" href="#21-auth模块" title="Permanent link">&para;</a></h2>
<h3 id="21-1-auth模块">21-1 Auth模块<a class="headerlink" href="#21-1-auth模块" title="Permanent link">&para;</a></h3>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Text Only</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-123-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-123-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-123-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-123-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-123-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-123-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-123-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-123-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-123-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-123-10">10</a></span>
<span class="normal"><a href="#__codelineno-123-11">11</a></span>
<span class="normal"><a href="#__codelineno-123-12">12</a></span>
<span class="normal"><a href="#__codelineno-123-13">13</a></span>
<span class="normal"><a href="#__codelineno-123-14">14</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-123-1" name="__codelineno-123-1"></a>&quot;&quot;&quot;
<a id="__codelineno-123-2" name="__codelineno-123-2"></a>其实我们在创建好一个django项目之后直接执行数据库迁移命令会自动生成很多表
<a id="__codelineno-123-3" name="__codelineno-123-3"></a>    django_session
<a id="__codelineno-123-4" name="__codelineno-123-4"></a>    auth_user
<a id="__codelineno-123-5" name="__codelineno-123-5"></a>django在启动之后就可以直接访问admin路由，需要输入用户名和密码，数据参考的就是auth_user表,并且还必须是管理员用户才能进入
<a id="__codelineno-123-6" name="__codelineno-123-6"></a>
<a id="__codelineno-123-7" name="__codelineno-123-7"></a>创建超级用户(管理员)
<a id="__codelineno-123-8" name="__codelineno-123-8"></a>    python3 manage.py createsuperuser
<a id="__codelineno-123-9" name="__codelineno-123-9"></a>
<a id="__codelineno-123-10" name="__codelineno-123-10"></a>    或者在工具里面run manager.py
<a id="__codelineno-123-11" name="__codelineno-123-11"></a>    然后在下面输入createsuperuser
<a id="__codelineno-123-12" name="__codelineno-123-12"></a>
<a id="__codelineno-123-13" name="__codelineno-123-13"></a>依赖于auth_user表完成用户相关的所有功能
<a id="__codelineno-123-14" name="__codelineno-123-14"></a>&quot;&quot;&quot;
</code></pre></div></td></tr></table></div>
<h3 id="21-2-方法总结">21-2 方法总结<a class="headerlink" href="#21-2-方法总结" title="Permanent link">&para;</a></h3>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-124-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-124-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-124-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-124-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-124-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-124-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-124-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-124-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-124-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-124-10">10</a></span>
<span class="normal"><a href="#__codelineno-124-11">11</a></span>
<span class="normal"><a href="#__codelineno-124-12">12</a></span>
<span class="normal"><a href="#__codelineno-124-13">13</a></span>
<span class="normal"><a href="#__codelineno-124-14">14</a></span>
<span class="normal"><a href="#__codelineno-124-15">15</a></span>
<span class="normal"><a href="#__codelineno-124-16">16</a></span>
<span class="normal"><a href="#__codelineno-124-17">17</a></span>
<span class="normal"><a href="#__codelineno-124-18">18</a></span>
<span class="normal"><a href="#__codelineno-124-19">19</a></span>
<span class="normal"><a href="#__codelineno-124-20">20</a></span>
<span class="normal"><a href="#__codelineno-124-21">21</a></span>
<span class="normal"><a href="#__codelineno-124-22">22</a></span>
<span class="normal"><a href="#__codelineno-124-23">23</a></span>
<span class="normal"><a href="#__codelineno-124-24">24</a></span>
<span class="normal"><a href="#__codelineno-124-25">25</a></span>
<span class="normal"><a href="#__codelineno-124-26">26</a></span>
<span class="normal"><a href="#__codelineno-124-27">27</a></span>
<span class="normal"><a href="#__codelineno-124-28">28</a></span>
<span class="normal"><a href="#__codelineno-124-29">29</a></span>
<span class="normal"><a href="#__codelineno-124-30">30</a></span>
<span class="normal"><a href="#__codelineno-124-31">31</a></span>
<span class="normal"><a href="#__codelineno-124-32">32</a></span>
<span class="normal"><a href="#__codelineno-124-33">33</a></span>
<span class="normal"><a href="#__codelineno-124-34">34</a></span>
<span class="normal"><a href="#__codelineno-124-35">35</a></span>
<span class="normal"><a href="#__codelineno-124-36">36</a></span>
<span class="normal"><a href="#__codelineno-124-37">37</a></span>
<span class="normal"><a href="#__codelineno-124-38">38</a></span>
<span class="normal"><a href="#__codelineno-124-39">39</a></span>
<span class="normal"><a href="#__codelineno-124-40">40</a></span>
<span class="normal"><a href="#__codelineno-124-41">41</a></span>
<span class="normal"><a href="#__codelineno-124-42">42</a></span>
<span class="normal"><a href="#__codelineno-124-43">43</a></span>
<span class="normal"><a href="#__codelineno-124-44">44</a></span>
<span class="normal"><a href="#__codelineno-124-45">45</a></span>
<span class="normal"><a href="#__codelineno-124-46">46</a></span>
<span class="normal"><a href="#__codelineno-124-47">47</a></span>
<span class="normal"><a href="#__codelineno-124-48">48</a></span>
<span class="normal"><a href="#__codelineno-124-49">49</a></span>
<span class="normal"><a href="#__codelineno-124-50">50</a></span>
<span class="normal"><a href="#__codelineno-124-51">51</a></span>
<span class="normal"><a href="#__codelineno-124-52">52</a></span>
<span class="normal"><a href="#__codelineno-124-53">53</a></span>
<span class="normal"><a href="#__codelineno-124-54">54</a></span>
<span class="normal"><a href="#__codelineno-124-55">55</a></span>
<span class="normal"><a href="#__codelineno-124-56">56</a></span>
<span class="normal"><a href="#__codelineno-124-57">57</a></span>
<span class="normal"><a href="#__codelineno-124-58">58</a></span>
<span class="normal"><a href="#__codelineno-124-59">59</a></span>
<span class="normal"><a href="#__codelineno-124-60">60</a></span>
<span class="normal"><a href="#__codelineno-124-61">61</a></span>
<span class="normal"><a href="#__codelineno-124-62">62</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-124-1" name="__codelineno-124-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.contrib</span><span class="w"> </span><span class="kn">import</span> <span class="n">auth</span>
<a id="__codelineno-124-2" name="__codelineno-124-2"></a>
<a id="__codelineno-124-3" name="__codelineno-124-3"></a><span class="c1"># 1.比对用户名和密码是否正确</span>
<a id="__codelineno-124-4" name="__codelineno-124-4"></a><span class="n">user_obj</span> <span class="o">=</span> <span class="n">auth</span><span class="o">.</span><span class="n">authenticate</span><span class="p">(</span><span class="n">request</span><span class="p">,</span><span class="n">username</span><span class="o">=</span><span class="n">username</span><span class="p">,</span><span class="n">password</span><span class="o">=</span><span class="n">password</span><span class="p">)</span>
<a id="__codelineno-124-5" name="__codelineno-124-5"></a><span class="c1">## 自动查找auth_user标签</span>
<a id="__codelineno-124-6" name="__codelineno-124-6"></a><span class="c1">## 自动给密码加密再比对</span>
<a id="__codelineno-124-7" name="__codelineno-124-7"></a><span class="c1"># 括号内必须同时传入用户名和密码</span>
<a id="__codelineno-124-8" name="__codelineno-124-8"></a><span class="nb">print</span><span class="p">(</span><span class="n">user_obj</span><span class="p">)</span>  <span class="c1"># 用户对象  jason   数据不符合则返回None</span>
<a id="__codelineno-124-9" name="__codelineno-124-9"></a><span class="nb">print</span><span class="p">(</span><span class="n">user_obj</span><span class="o">.</span><span class="n">username</span><span class="p">)</span>  <span class="c1"># jason</span>
<a id="__codelineno-124-10" name="__codelineno-124-10"></a><span class="nb">print</span><span class="p">(</span><span class="n">user_obj</span><span class="o">.</span><span class="n">password</span><span class="p">)</span>  <span class="c1"># 密文</span>
<a id="__codelineno-124-11" name="__codelineno-124-11"></a>
<a id="__codelineno-124-12" name="__codelineno-124-12"></a><span class="c1"># 2.保存用户状态</span>
<a id="__codelineno-124-13" name="__codelineno-124-13"></a><span class="k">if</span> <span class="n">user_obj</span><span class="p">:</span>
<a id="__codelineno-124-14" name="__codelineno-124-14"></a>    <span class="n">auth</span><span class="o">.</span><span class="n">login</span><span class="p">(</span><span class="n">request</span><span class="p">,</span><span class="n">user_obj</span><span class="p">)</span>  <span class="c1"># 类似于request.session[key] = user_obj</span>
<a id="__codelineno-124-15" name="__codelineno-124-15"></a><span class="c1"># 只要执行了该方法 你就可以在任何地方通过request.user获取到当前登陆的用户对象</span>
<a id="__codelineno-124-16" name="__codelineno-124-16"></a><span class="c1">## 如果没有登录则拿到的是AnonymousUser</span>
<a id="__codelineno-124-17" name="__codelineno-124-17"></a>
<a id="__codelineno-124-18" name="__codelineno-124-18"></a><span class="c1"># 3.判断当前用户是否登陆</span>
<a id="__codelineno-124-19" name="__codelineno-124-19"></a><span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">is_authenticated</span><span class="p">()</span>
<a id="__codelineno-124-20" name="__codelineno-124-20"></a>
<a id="__codelineno-124-21" name="__codelineno-124-21"></a><span class="c1"># 4.获取当前登陆用户</span>
<a id="__codelineno-124-22" name="__codelineno-124-22"></a><span class="n">request</span><span class="o">.</span><span class="n">user</span>
<a id="__codelineno-124-23" name="__codelineno-124-23"></a>
<a id="__codelineno-124-24" name="__codelineno-124-24"></a><span class="c1"># 5.校验用户是否登陆装饰器</span>
<a id="__codelineno-124-25" name="__codelineno-124-25"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.contrib.auth.decorators</span><span class="w"> </span><span class="kn">import</span> <span class="n">login_required</span>
<a id="__codelineno-124-26" name="__codelineno-124-26"></a><span class="c1"># 局部配置</span>
<a id="__codelineno-124-27" name="__codelineno-124-27"></a><span class="nd">@login_required</span><span class="p">(</span><span class="n">login_url</span><span class="o">=</span><span class="s1">&#39;/login/&#39;</span><span class="p">)</span> 
<a id="__codelineno-124-28" name="__codelineno-124-28"></a><span class="c1"># 全局配置,在settings.py里配置即可</span>
<a id="__codelineno-124-29" name="__codelineno-124-29"></a><span class="n">LOGIN_URL</span> <span class="o">=</span> <span class="s1">&#39;/login/&#39;</span>
<a id="__codelineno-124-30" name="__codelineno-124-30"></a>    <span class="mf">1.</span><span class="n">如果局部和全局都有</span> <span class="n">该听谁的</span><span class="err">?</span>
<a id="__codelineno-124-31" name="__codelineno-124-31"></a>    <span class="c1">##  局部 &gt; 全局</span>
<a id="__codelineno-124-32" name="__codelineno-124-32"></a>    <span class="mf">2.</span><span class="n">局部和全局哪个好呢</span><span class="err">?</span>
<a id="__codelineno-124-33" name="__codelineno-124-33"></a>    <span class="c1">## 全局的好处在于无需重复写代码 但是跳转的页面却很单一</span>
<a id="__codelineno-124-34" name="__codelineno-124-34"></a>    <span class="c1">## 局部的好处在于不同的视图函数在用户没有登陆的情况下可以跳转到不同的页面</span>
<a id="__codelineno-124-35" name="__codelineno-124-35"></a>
<a id="__codelineno-124-36" name="__codelineno-124-36"></a><span class="c1"># 6.比对原密码</span>
<a id="__codelineno-124-37" name="__codelineno-124-37"></a><span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">check_password</span><span class="p">(</span><span class="n">old_password</span><span class="p">)</span>
<a id="__codelineno-124-38" name="__codelineno-124-38"></a>
<a id="__codelineno-124-39" name="__codelineno-124-39"></a><span class="k">if</span> <span class="n">new_password</span> <span class="o">==</span> <span class="n">confirm_password</span><span class="p">:</span>
<a id="__codelineno-124-40" name="__codelineno-124-40"></a>    <span class="n">res</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">check_password</span><span class="p">(</span><span class="n">old_password</span><span class="p">)</span> <span class="c1">## 自动加密比对密码</span>
<a id="__codelineno-124-41" name="__codelineno-124-41"></a>    <span class="c1">## 返回值为true 或者 false</span>
<a id="__codelineno-124-42" name="__codelineno-124-42"></a>    <span class="k">if</span> <span class="n">res</span><span class="p">:</span>
<a id="__codelineno-124-43" name="__codelineno-124-43"></a>        <span class="c1">## 修改密码</span>
<a id="__codelineno-124-44" name="__codelineno-124-44"></a>        <span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">set_password</span><span class="p">(</span><span class="n">new_password</span><span class="p">)</span>
<a id="__codelineno-124-45" name="__codelineno-124-45"></a>        <span class="c1">## 一定要保存，要不然不会去操作数据库的</span>
<a id="__codelineno-124-46" name="__codelineno-124-46"></a>        <span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">save</span><span class="p">()</span> 
<a id="__codelineno-124-47" name="__codelineno-124-47"></a>
<a id="__codelineno-124-48" name="__codelineno-124-48"></a><span class="c1"># 7.修改密码</span>
<a id="__codelineno-124-49" name="__codelineno-124-49"></a><span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">set_password</span><span class="p">(</span><span class="n">new_password</span><span class="p">)</span>  <span class="c1"># 仅仅是在修改对象的属性</span>
<a id="__codelineno-124-50" name="__codelineno-124-50"></a><span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>  <span class="c1"># 这一步才是真正的操作数据库</span>
<a id="__codelineno-124-51" name="__codelineno-124-51"></a>
<a id="__codelineno-124-52" name="__codelineno-124-52"></a><span class="c1"># 8.注销</span>
<a id="__codelineno-124-53" name="__codelineno-124-53"></a><span class="n">auth</span><span class="o">.</span><span class="n">logout</span><span class="p">(</span><span class="n">request</span><span class="p">)</span> 
<a id="__codelineno-124-54" name="__codelineno-124-54"></a>
<a id="__codelineno-124-55" name="__codelineno-124-55"></a><span class="c1"># 9.注册</span>
<a id="__codelineno-124-56" name="__codelineno-124-56"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.contrib.auth.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">User</span>
<a id="__codelineno-124-57" name="__codelineno-124-57"></a><span class="c1"># 操作auth_user表写入数据</span>
<a id="__codelineno-124-58" name="__codelineno-124-58"></a><span class="n">User</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="n">username</span><span class="p">,</span><span class="n">password</span><span class="o">=</span><span class="n">password</span><span class="p">)</span>  <span class="c1"># 写入数据  但是密码是明文的，所以写入数据不能用create</span>
<a id="__codelineno-124-59" name="__codelineno-124-59"></a><span class="c1"># 创建普通用户</span>
<a id="__codelineno-124-60" name="__codelineno-124-60"></a><span class="n">User</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create_user</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="n">username</span><span class="p">,</span><span class="n">password</span><span class="o">=</span><span class="n">password</span><span class="p">)</span>
<a id="__codelineno-124-61" name="__codelineno-124-61"></a><span class="c1"># 创建超级用户(了解):使用代码创建超级用户 邮箱是必填的 而用命令创建则可以不填</span>
<a id="__codelineno-124-62" name="__codelineno-124-62"></a><span class="n">User</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create_superuser</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="n">username</span><span class="p">,</span><span class="n">email</span><span class="o">=</span><span class="s1">&#39;123@qq.com&#39;</span><span class="p">,</span><span class="n">password</span><span class="o">=</span><span class="n">password</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<h3 id="21-3-如何扩展auth_user表">21-3 如何扩展auth_user表<a class="headerlink" href="#21-3-如何扩展auth_user表" title="Permanent link">&para;</a></h3>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-125-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-125-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-125-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-125-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-125-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-125-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-125-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-125-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-125-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-125-10">10</a></span>
<span class="normal"><a href="#__codelineno-125-11">11</a></span>
<span class="normal"><a href="#__codelineno-125-12">12</a></span>
<span class="normal"><a href="#__codelineno-125-13">13</a></span>
<span class="normal"><a href="#__codelineno-125-14">14</a></span>
<span class="normal"><a href="#__codelineno-125-15">15</a></span>
<span class="normal"><a href="#__codelineno-125-16">16</a></span>
<span class="normal"><a href="#__codelineno-125-17">17</a></span>
<span class="normal"><a href="#__codelineno-125-18">18</a></span>
<span class="normal"><a href="#__codelineno-125-19">19</a></span>
<span class="normal"><a href="#__codelineno-125-20">20</a></span>
<span class="normal"><a href="#__codelineno-125-21">21</a></span>
<span class="normal"><a href="#__codelineno-125-22">22</a></span>
<span class="normal"><a href="#__codelineno-125-23">23</a></span>
<span class="normal"><a href="#__codelineno-125-24">24</a></span>
<span class="normal"><a href="#__codelineno-125-25">25</a></span>
<span class="normal"><a href="#__codelineno-125-26">26</a></span>
<span class="normal"><a href="#__codelineno-125-27">27</a></span>
<span class="normal"><a href="#__codelineno-125-28">28</a></span>
<span class="normal"><a href="#__codelineno-125-29">29</a></span>
<span class="normal"><a href="#__codelineno-125-30">30</a></span>
<span class="normal"><a href="#__codelineno-125-31">31</a></span>
<span class="normal"><a href="#__codelineno-125-32">32</a></span>
<span class="normal"><a href="#__codelineno-125-33">33</a></span>
<span class="normal"><a href="#__codelineno-125-34">34</a></span>
<span class="normal"><a href="#__codelineno-125-35">35</a></span>
<span class="normal"><a href="#__codelineno-125-36">36</a></span>
<span class="normal"><a href="#__codelineno-125-37">37</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-125-1" name="__codelineno-125-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.db</span><span class="w"> </span><span class="kn">import</span> <span class="n">models</span>
<a id="__codelineno-125-2" name="__codelineno-125-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.contrib.auth.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">User</span><span class="p">,</span><span class="n">AbstractUser</span>
<a id="__codelineno-125-3" name="__codelineno-125-3"></a><span class="c1"># Create your models here.</span>
<a id="__codelineno-125-4" name="__codelineno-125-4"></a>
<a id="__codelineno-125-5" name="__codelineno-125-5"></a><span class="c1"># 第一种:一对一关系  不推荐</span>
<a id="__codelineno-125-6" name="__codelineno-125-6"></a><span class="c1"># class UserDetail(models.Model):</span>
<a id="__codelineno-125-7" name="__codelineno-125-7"></a><span class="c1">#     phone = models.BigIntegerField()</span>
<a id="__codelineno-125-8" name="__codelineno-125-8"></a><span class="c1">#     user = models.OneToOneField(to=&#39;User&#39;)</span>
<a id="__codelineno-125-9" name="__codelineno-125-9"></a>
<a id="__codelineno-125-10" name="__codelineno-125-10"></a>
<a id="__codelineno-125-11" name="__codelineno-125-11"></a><span class="c1"># 第二种:面向对象的继承</span>
<a id="__codelineno-125-12" name="__codelineno-125-12"></a><span class="k">class</span><span class="w"> </span><span class="nc">UserInfo</span><span class="p">(</span><span class="n">AbstractUser</span><span class="p">):</span>
<a id="__codelineno-125-13" name="__codelineno-125-13"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-125-14" name="__codelineno-125-14"></a><span class="sd">    如果继承了AbstractUser</span>
<a id="__codelineno-125-15" name="__codelineno-125-15"></a><span class="sd">    那么在执行数据库迁移命令的时候auth_user表就不会再创建出来了</span>
<a id="__codelineno-125-16" name="__codelineno-125-16"></a><span class="sd">    而UserInfo表中会出现auth_user所有的字段外加自己扩展的字段</span>
<a id="__codelineno-125-17" name="__codelineno-125-17"></a><span class="sd">    这么做的好处在于你能够直接点击你自己的表更加快速的完成操作及扩展</span>
<a id="__codelineno-125-18" name="__codelineno-125-18"></a>
<a id="__codelineno-125-19" name="__codelineno-125-19"></a><span class="sd">    前提:</span>
<a id="__codelineno-125-20" name="__codelineno-125-20"></a><span class="sd">        1.在继承之前没有执行过数据库迁移命令</span>
<a id="__codelineno-125-21" name="__codelineno-125-21"></a><span class="sd">            auth_user没有被创建，如果当前库已经创建了那么你就重新换一个库</span>
<a id="__codelineno-125-22" name="__codelineno-125-22"></a><span class="sd">        2.继承的类里面不要覆盖AbstractUser里面的字段名</span>
<a id="__codelineno-125-23" name="__codelineno-125-23"></a><span class="sd">            表里面有的字段都不要动，只扩展额外字段即可</span>
<a id="__codelineno-125-24" name="__codelineno-125-24"></a><span class="sd">        3.需要在配置文件中告诉django你要用UserInfo替代auth_user(******)</span>
<a id="__codelineno-125-25" name="__codelineno-125-25"></a><span class="sd">            AUTH_USER_MODEL = &#39;app01.UserInfo&#39;</span>
<a id="__codelineno-125-26" name="__codelineno-125-26"></a><span class="sd">                                &#39;应用名.表名&#39;</span>
<a id="__codelineno-125-27" name="__codelineno-125-27"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-125-28" name="__codelineno-125-28"></a>    <span class="n">phone</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">BigIntegerField</span><span class="p">()</span>
<a id="__codelineno-125-29" name="__codelineno-125-29"></a>
<a id="__codelineno-125-30" name="__codelineno-125-30"></a>
<a id="__codelineno-125-31" name="__codelineno-125-31"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-125-32" name="__codelineno-125-32"></a><span class="sd">你如果自己写表替代了auth_user那么</span>
<a id="__codelineno-125-33" name="__codelineno-125-33"></a><span class="sd">auth模块的功能还是照常使用，参考的表页由原来的auth_user变成了UserInfo</span>
<a id="__codelineno-125-34" name="__codelineno-125-34"></a>
<a id="__codelineno-125-35" name="__codelineno-125-35"></a>
<a id="__codelineno-125-36" name="__codelineno-125-36"></a><span class="sd">我们bbs作业用户表就是用的上述方式</span>
<a id="__codelineno-125-37" name="__codelineno-125-37"></a><span class="sd">&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
<h2 id="22-bbs项目">22 bbs项目<a class="headerlink" href="#22-bbs项目" title="Permanent link">&para;</a></h2>
<h3 id="22-1-表设计">22-1 表设计<a class="headerlink" href="#22-1-表设计" title="Permanent link">&para;</a></h3>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Text Only</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-126-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-126-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-126-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-126-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-126-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-126-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-126-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-126-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-126-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-126-10">10</a></span>
<span class="normal"><a href="#__codelineno-126-11">11</a></span>
<span class="normal"><a href="#__codelineno-126-12">12</a></span>
<span class="normal"><a href="#__codelineno-126-13">13</a></span>
<span class="normal"><a href="#__codelineno-126-14">14</a></span>
<span class="normal"><a href="#__codelineno-126-15">15</a></span>
<span class="normal"><a href="#__codelineno-126-16">16</a></span>
<span class="normal"><a href="#__codelineno-126-17">17</a></span>
<span class="normal"><a href="#__codelineno-126-18">18</a></span>
<span class="normal"><a href="#__codelineno-126-19">19</a></span>
<span class="normal"><a href="#__codelineno-126-20">20</a></span>
<span class="normal"><a href="#__codelineno-126-21">21</a></span>
<span class="normal"><a href="#__codelineno-126-22">22</a></span>
<span class="normal"><a href="#__codelineno-126-23">23</a></span>
<span class="normal"><a href="#__codelineno-126-24">24</a></span>
<span class="normal"><a href="#__codelineno-126-25">25</a></span>
<span class="normal"><a href="#__codelineno-126-26">26</a></span>
<span class="normal"><a href="#__codelineno-126-27">27</a></span>
<span class="normal"><a href="#__codelineno-126-28">28</a></span>
<span class="normal"><a href="#__codelineno-126-29">29</a></span>
<span class="normal"><a href="#__codelineno-126-30">30</a></span>
<span class="normal"><a href="#__codelineno-126-31">31</a></span>
<span class="normal"><a href="#__codelineno-126-32">32</a></span>
<span class="normal"><a href="#__codelineno-126-33">33</a></span>
<span class="normal"><a href="#__codelineno-126-34">34</a></span>
<span class="normal"><a href="#__codelineno-126-35">35</a></span>
<span class="normal"><a href="#__codelineno-126-36">36</a></span>
<span class="normal"><a href="#__codelineno-126-37">37</a></span>
<span class="normal"><a href="#__codelineno-126-38">38</a></span>
<span class="normal"><a href="#__codelineno-126-39">39</a></span>
<span class="normal"><a href="#__codelineno-126-40">40</a></span>
<span class="normal"><a href="#__codelineno-126-41">41</a></span>
<span class="normal"><a href="#__codelineno-126-42">42</a></span>
<span class="normal"><a href="#__codelineno-126-43">43</a></span>
<span class="normal"><a href="#__codelineno-126-44">44</a></span>
<span class="normal"><a href="#__codelineno-126-45">45</a></span>
<span class="normal"><a href="#__codelineno-126-46">46</a></span>
<span class="normal"><a href="#__codelineno-126-47">47</a></span>
<span class="normal"><a href="#__codelineno-126-48">48</a></span>
<span class="normal"><a href="#__codelineno-126-49">49</a></span>
<span class="normal"><a href="#__codelineno-126-50">50</a></span>
<span class="normal"><a href="#__codelineno-126-51">51</a></span>
<span class="normal"><a href="#__codelineno-126-52">52</a></span>
<span class="normal"><a href="#__codelineno-126-53">53</a></span>
<span class="normal"><a href="#__codelineno-126-54">54</a></span>
<span class="normal"><a href="#__codelineno-126-55">55</a></span>
<span class="normal"><a href="#__codelineno-126-56">56</a></span>
<span class="normal"><a href="#__codelineno-126-57">57</a></span>
<span class="normal"><a href="#__codelineno-126-58">58</a></span>
<span class="normal"><a href="#__codelineno-126-59">59</a></span>
<span class="normal"><a href="#__codelineno-126-60">60</a></span>
<span class="normal"><a href="#__codelineno-126-61">61</a></span>
<span class="normal"><a href="#__codelineno-126-62">62</a></span>
<span class="normal"><a href="#__codelineno-126-63">63</a></span>
<span class="normal"><a href="#__codelineno-126-64">64</a></span>
<span class="normal"><a href="#__codelineno-126-65">65</a></span>
<span class="normal"><a href="#__codelineno-126-66">66</a></span>
<span class="normal"><a href="#__codelineno-126-67">67</a></span>
<span class="normal"><a href="#__codelineno-126-68">68</a></span>
<span class="normal"><a href="#__codelineno-126-69">69</a></span>
<span class="normal"><a href="#__codelineno-126-70">70</a></span>
<span class="normal"><a href="#__codelineno-126-71">71</a></span>
<span class="normal"><a href="#__codelineno-126-72">72</a></span>
<span class="normal"><a href="#__codelineno-126-73">73</a></span>
<span class="normal"><a href="#__codelineno-126-74">74</a></span>
<span class="normal"><a href="#__codelineno-126-75">75</a></span>
<span class="normal"><a href="#__codelineno-126-76">76</a></span>
<span class="normal"><a href="#__codelineno-126-77">77</a></span>
<span class="normal"><a href="#__codelineno-126-78">78</a></span>
<span class="normal"><a href="#__codelineno-126-79">79</a></span>
<span class="normal"><a href="#__codelineno-126-80">80</a></span>
<span class="normal"><a href="#__codelineno-126-81">81</a></span>
<span class="normal"><a href="#__codelineno-126-82">82</a></span>
<span class="normal"><a href="#__codelineno-126-83">83</a></span>
<span class="normal"><a href="#__codelineno-126-84">84</a></span>
<span class="normal"><a href="#__codelineno-126-85">85</a></span>
<span class="normal"><a href="#__codelineno-126-86">86</a></span>
<span class="normal"><a href="#__codelineno-126-87">87</a></span>
<span class="normal"><a href="#__codelineno-126-88">88</a></span>
<span class="normal"><a href="#__codelineno-126-89">89</a></span>
<span class="normal"><a href="#__codelineno-126-90">90</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-126-1" name="__codelineno-126-1"></a>&quot;&quot;&quot;
<a id="__codelineno-126-2" name="__codelineno-126-2"></a>一个项目中最最最重要的不是业务逻辑的书写
<a id="__codelineno-126-3" name="__codelineno-126-3"></a>而是前期的表设计，只要将表设计好了，后续的功能书写才会一帆风顺
<a id="__codelineno-126-4" name="__codelineno-126-4"></a>
<a id="__codelineno-126-5" name="__codelineno-126-5"></a>bbs表设计
<a id="__codelineno-126-6" name="__codelineno-126-6"></a>    1.用户表
<a id="__codelineno-126-7" name="__codelineno-126-7"></a>        继承AbstractUser
<a id="__codelineno-126-8" name="__codelineno-126-8"></a>        扩展
<a id="__codelineno-126-9" name="__codelineno-126-9"></a>            phone 电话号码
<a id="__codelineno-126-10" name="__codelineno-126-10"></a>            avatar  用户头像
<a id="__codelineno-126-11" name="__codelineno-126-11"></a>            create_time  创建时间
<a id="__codelineno-126-12" name="__codelineno-126-12"></a>
<a id="__codelineno-126-13" name="__codelineno-126-13"></a>        外键字段
<a id="__codelineno-126-14" name="__codelineno-126-14"></a>            一对一个人站点表
<a id="__codelineno-126-15" name="__codelineno-126-15"></a>
<a id="__codelineno-126-16" name="__codelineno-126-16"></a>    2.个人站点表
<a id="__codelineno-126-17" name="__codelineno-126-17"></a>        site_name 站点名称
<a id="__codelineno-126-18" name="__codelineno-126-18"></a>        site_title   站点标题
<a id="__codelineno-126-19" name="__codelineno-126-19"></a>        site_theme  站点样式
<a id="__codelineno-126-20" name="__codelineno-126-20"></a>
<a id="__codelineno-126-21" name="__codelineno-126-21"></a>    3.文章标签表
<a id="__codelineno-126-22" name="__codelineno-126-22"></a>        name        标签名
<a id="__codelineno-126-23" name="__codelineno-126-23"></a>
<a id="__codelineno-126-24" name="__codelineno-126-24"></a>        外键字段
<a id="__codelineno-126-25" name="__codelineno-126-25"></a>            一对多个人站点
<a id="__codelineno-126-26" name="__codelineno-126-26"></a>
<a id="__codelineno-126-27" name="__codelineno-126-27"></a>    4.文章分类表
<a id="__codelineno-126-28" name="__codelineno-126-28"></a>        name        分类名
<a id="__codelineno-126-29" name="__codelineno-126-29"></a>
<a id="__codelineno-126-30" name="__codelineno-126-30"></a>        外键字段
<a id="__codelineno-126-31" name="__codelineno-126-31"></a>            一对多个人站点
<a id="__codelineno-126-32" name="__codelineno-126-32"></a>
<a id="__codelineno-126-33" name="__codelineno-126-33"></a>    5.文章表
<a id="__codelineno-126-34" name="__codelineno-126-34"></a>        title   文章标题
<a id="__codelineno-126-35" name="__codelineno-126-35"></a>        desc    文章简介
<a id="__codelineno-126-36" name="__codelineno-126-36"></a>        content 文章内容
<a id="__codelineno-126-37" name="__codelineno-126-37"></a>        create_time 发布时间
<a id="__codelineno-126-38" name="__codelineno-126-38"></a>
<a id="__codelineno-126-39" name="__codelineno-126-39"></a>        数据库字段设计优化(******)
<a id="__codelineno-126-40" name="__codelineno-126-40"></a>            (虽然下述的三个字段可以从其他表里面跨表查询计算得出，但是频繁跨表效率)
<a id="__codelineno-126-41" name="__codelineno-126-41"></a>        up_num                  点赞数
<a id="__codelineno-126-42" name="__codelineno-126-42"></a>        down_num                点踩数
<a id="__codelineno-126-43" name="__codelineno-126-43"></a>        comment_num         评论数
<a id="__codelineno-126-44" name="__codelineno-126-44"></a>
<a id="__codelineno-126-45" name="__codelineno-126-45"></a>        外键字段
<a id="__codelineno-126-46" name="__codelineno-126-46"></a>            一对多个人站点
<a id="__codelineno-126-47" name="__codelineno-126-47"></a>            多对多文章标签
<a id="__codelineno-126-48" name="__codelineno-126-48"></a>            一对多文章分类
<a id="__codelineno-126-49" name="__codelineno-126-49"></a>
<a id="__codelineno-126-50" name="__codelineno-126-50"></a>
<a id="__codelineno-126-51" name="__codelineno-126-51"></a>
<a id="__codelineno-126-52" name="__codelineno-126-52"></a>    6.点赞点踩表
<a id="__codelineno-126-53" name="__codelineno-126-53"></a>        记录哪个用户给哪篇文章点了赞还是点了踩
<a id="__codelineno-126-54" name="__codelineno-126-54"></a>        user                        ForeignKey(to=&quot;User&quot;)               
<a id="__codelineno-126-55" name="__codelineno-126-55"></a>        article                 ForeignKey(to=&quot;Article&quot;)    
<a id="__codelineno-126-56" name="__codelineno-126-56"></a>        is_up                       BooleanField()
<a id="__codelineno-126-57" name="__codelineno-126-57"></a>
<a id="__codelineno-126-58" name="__codelineno-126-58"></a>        1               1               1
<a id="__codelineno-126-59" name="__codelineno-126-59"></a>        1               2               1
<a id="__codelineno-126-60" name="__codelineno-126-60"></a>        1               3               0
<a id="__codelineno-126-61" name="__codelineno-126-61"></a>        2               1               1
<a id="__codelineno-126-62" name="__codelineno-126-62"></a>
<a id="__codelineno-126-63" name="__codelineno-126-63"></a>
<a id="__codelineno-126-64" name="__codelineno-126-64"></a>    7.文章评论表
<a id="__codelineno-126-65" name="__codelineno-126-65"></a>        记录哪个用户给哪篇文章写了哪些评论内容
<a id="__codelineno-126-66" name="__codelineno-126-66"></a>        user                        ForeignKey(to=&quot;User&quot;)               
<a id="__codelineno-126-67" name="__codelineno-126-67"></a>        article                 ForeignKey(to=&quot;Article&quot;)
<a id="__codelineno-126-68" name="__codelineno-126-68"></a>        content                 CharField()
<a id="__codelineno-126-69" name="__codelineno-126-69"></a>        comment_time        DateField()
<a id="__codelineno-126-70" name="__codelineno-126-70"></a>        # 自关联
<a id="__codelineno-126-71" name="__codelineno-126-71"></a>        parent                  ForeignKey(to=&quot;Comment&quot;,null=True)      
<a id="__codelineno-126-72" name="__codelineno-126-72"></a>        # ORM专门提供的自关联写法 
<a id="__codelineno-126-73" name="__codelineno-126-73"></a>        parent                  ForeignKey(to=&quot;self&quot;,null=True)
<a id="__codelineno-126-74" name="__codelineno-126-74"></a>
<a id="__codelineno-126-75" name="__codelineno-126-75"></a>    id  user_id         article_id              parent_id
<a id="__codelineno-126-76" name="__codelineno-126-76"></a>    1        1                      1                                       
<a id="__codelineno-126-77" name="__codelineno-126-77"></a>    2        2                      1                                       1                   
<a id="__codelineno-126-78" name="__codelineno-126-78"></a>
<a id="__codelineno-126-79" name="__codelineno-126-79"></a>根评论子评论的概念
<a id="__codelineno-126-80" name="__codelineno-126-80"></a>    根评论就是直接评论当前发布的内容的
<a id="__codelineno-126-81" name="__codelineno-126-81"></a>
<a id="__codelineno-126-82" name="__codelineno-126-82"></a>    子评论是评论别人的评论
<a id="__codelineno-126-83" name="__codelineno-126-83"></a>        1.PHP是世界上最牛逼的语言
<a id="__codelineno-126-84" name="__codelineno-126-84"></a>            1.1 python才是最牛逼的
<a id="__codelineno-126-85" name="__codelineno-126-85"></a>                1.2 java才是
<a id="__codelineno-126-86" name="__codelineno-126-86"></a>
<a id="__codelineno-126-87" name="__codelineno-126-87"></a>    根评论与子评论是一对多的关系
<a id="__codelineno-126-88" name="__codelineno-126-88"></a>
<a id="__codelineno-126-89" name="__codelineno-126-89"></a>
<a id="__codelineno-126-90" name="__codelineno-126-90"></a>&quot;&quot;&quot;
</code></pre></div></td></tr></table></div>
<h3 id="22-2-表设计代码">22-2 表设计代码<a class="headerlink" href="#22-2-表设计代码" title="Permanent link">&para;</a></h3>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Text Only</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-127-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-127-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-127-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-127-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-127-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-127-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-127-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-127-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-127-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-127-10">10</a></span>
<span class="normal"><a href="#__codelineno-127-11">11</a></span>
<span class="normal"><a href="#__codelineno-127-12">12</a></span>
<span class="normal"><a href="#__codelineno-127-13">13</a></span>
<span class="normal"><a href="#__codelineno-127-14">14</a></span>
<span class="normal"><a href="#__codelineno-127-15">15</a></span>
<span class="normal"><a href="#__codelineno-127-16">16</a></span>
<span class="normal"><a href="#__codelineno-127-17">17</a></span>
<span class="normal"><a href="#__codelineno-127-18">18</a></span>
<span class="normal"><a href="#__codelineno-127-19">19</a></span>
<span class="normal"><a href="#__codelineno-127-20">20</a></span>
<span class="normal"><a href="#__codelineno-127-21">21</a></span>
<span class="normal"><a href="#__codelineno-127-22">22</a></span>
<span class="normal"><a href="#__codelineno-127-23">23</a></span>
<span class="normal"><a href="#__codelineno-127-24">24</a></span>
<span class="normal"><a href="#__codelineno-127-25">25</a></span>
<span class="normal"><a href="#__codelineno-127-26">26</a></span>
<span class="normal"><a href="#__codelineno-127-27">27</a></span>
<span class="normal"><a href="#__codelineno-127-28">28</a></span>
<span class="normal"><a href="#__codelineno-127-29">29</a></span>
<span class="normal"><a href="#__codelineno-127-30">30</a></span>
<span class="normal"><a href="#__codelineno-127-31">31</a></span>
<span class="normal"><a href="#__codelineno-127-32">32</a></span>
<span class="normal"><a href="#__codelineno-127-33">33</a></span>
<span class="normal"><a href="#__codelineno-127-34">34</a></span>
<span class="normal"><a href="#__codelineno-127-35">35</a></span>
<span class="normal"><a href="#__codelineno-127-36">36</a></span>
<span class="normal"><a href="#__codelineno-127-37">37</a></span>
<span class="normal"><a href="#__codelineno-127-38">38</a></span>
<span class="normal"><a href="#__codelineno-127-39">39</a></span>
<span class="normal"><a href="#__codelineno-127-40">40</a></span>
<span class="normal"><a href="#__codelineno-127-41">41</a></span>
<span class="normal"><a href="#__codelineno-127-42">42</a></span>
<span class="normal"><a href="#__codelineno-127-43">43</a></span>
<span class="normal"><a href="#__codelineno-127-44">44</a></span>
<span class="normal"><a href="#__codelineno-127-45">45</a></span>
<span class="normal"><a href="#__codelineno-127-46">46</a></span>
<span class="normal"><a href="#__codelineno-127-47">47</a></span>
<span class="normal"><a href="#__codelineno-127-48">48</a></span>
<span class="normal"><a href="#__codelineno-127-49">49</a></span>
<span class="normal"><a href="#__codelineno-127-50">50</a></span>
<span class="normal"><a href="#__codelineno-127-51">51</a></span>
<span class="normal"><a href="#__codelineno-127-52">52</a></span>
<span class="normal"><a href="#__codelineno-127-53">53</a></span>
<span class="normal"><a href="#__codelineno-127-54">54</a></span>
<span class="normal"><a href="#__codelineno-127-55">55</a></span>
<span class="normal"><a href="#__codelineno-127-56">56</a></span>
<span class="normal"><a href="#__codelineno-127-57">57</a></span>
<span class="normal"><a href="#__codelineno-127-58">58</a></span>
<span class="normal"><a href="#__codelineno-127-59">59</a></span>
<span class="normal"><a href="#__codelineno-127-60">60</a></span>
<span class="normal"><a href="#__codelineno-127-61">61</a></span>
<span class="normal"><a href="#__codelineno-127-62">62</a></span>
<span class="normal"><a href="#__codelineno-127-63">63</a></span>
<span class="normal"><a href="#__codelineno-127-64">64</a></span>
<span class="normal"><a href="#__codelineno-127-65">65</a></span>
<span class="normal"><a href="#__codelineno-127-66">66</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-127-1" name="__codelineno-127-1"></a>from django.db import models
<a id="__codelineno-127-2" name="__codelineno-127-2"></a>
<a id="__codelineno-127-3" name="__codelineno-127-3"></a># Create your models here.
<a id="__codelineno-127-4" name="__codelineno-127-4"></a>
<a id="__codelineno-127-5" name="__codelineno-127-5"></a>from django.contrib.auth.models import AbstractUser
<a id="__codelineno-127-6" name="__codelineno-127-6"></a>
<a id="__codelineno-127-7" name="__codelineno-127-7"></a>class UserInfo(AbstractUser):
<a id="__codelineno-127-8" name="__codelineno-127-8"></a>    phone = models.BigIntegerField(verbose_name=&#39;手机号&#39;,null=True)
<a id="__codelineno-127-9" name="__codelineno-127-9"></a>    # 头像
<a id="__codelineno-127-10" name="__codelineno-127-10"></a>    avatar = models.FileField(upload_to=&#39;avatar/&#39;,default=&#39;avatar/default.jpg&#39;,verbose_name=&#39;用户头像&#39;)
<a id="__codelineno-127-11" name="__codelineno-127-11"></a>    &#39;&#39;&#39;
<a id="__codelineno-127-12" name="__codelineno-127-12"></a>    给avatar字段传文件对象，该文件会自动存储到avatar文件下，然后avatar字段只保存文件路径avatar/default
<a id="__codelineno-127-13" name="__codelineno-127-13"></a>    &#39;&#39;&#39;
<a id="__codelineno-127-14" name="__codelineno-127-14"></a>    create_time = models.DateField(auto_now_add=True)
<a id="__codelineno-127-15" name="__codelineno-127-15"></a>
<a id="__codelineno-127-16" name="__codelineno-127-16"></a>    blog = models.OneToOneField(to=&#39;Blog&#39;,null=True)
<a id="__codelineno-127-17" name="__codelineno-127-17"></a>
<a id="__codelineno-127-18" name="__codelineno-127-18"></a>
<a id="__codelineno-127-19" name="__codelineno-127-19"></a>class Blog(models.Model):
<a id="__codelineno-127-20" name="__codelineno-127-20"></a>    site_name = models.CharField(max_length=32,verbose_name=&#39;站点名称&#39;)
<a id="__codelineno-127-21" name="__codelineno-127-21"></a>    site_title = models.CharField(verbose_name=&#39;站点标题&#39;,max_length=32)
<a id="__codelineno-127-22" name="__codelineno-127-22"></a>    site_theme = models.CharField(verbose_name=&#39;站点样式&#39;,max_length=64) # 存储css或js的文件路径
<a id="__codelineno-127-23" name="__codelineno-127-23"></a>
<a id="__codelineno-127-24" name="__codelineno-127-24"></a>
<a id="__codelineno-127-25" name="__codelineno-127-25"></a>class Category(models.Model):
<a id="__codelineno-127-26" name="__codelineno-127-26"></a>    name = models.CharField(verbose_name=&#39;文章分类&#39;,max_length=32)
<a id="__codelineno-127-27" name="__codelineno-127-27"></a>
<a id="__codelineno-127-28" name="__codelineno-127-28"></a>    blog = models.ForeignKey(to=&#39;Blog&#39;,null=True)
<a id="__codelineno-127-29" name="__codelineno-127-29"></a>
<a id="__codelineno-127-30" name="__codelineno-127-30"></a>
<a id="__codelineno-127-31" name="__codelineno-127-31"></a>class Tag(models.Model):
<a id="__codelineno-127-32" name="__codelineno-127-32"></a>    name = models.CharField(verbose_name=&#39;文章标签&#39;,max_length=32)
<a id="__codelineno-127-33" name="__codelineno-127-33"></a>    blog = models.ForeignKey(to=&#39;Blog&#39;, null=True)
<a id="__codelineno-127-34" name="__codelineno-127-34"></a>
<a id="__codelineno-127-35" name="__codelineno-127-35"></a>class Article(models.Model):
<a id="__codelineno-127-36" name="__codelineno-127-36"></a>    title = models.CharField(max_length=64,verbose_name=&#39;文章标题&#39;)
<a id="__codelineno-127-37" name="__codelineno-127-37"></a>    desc = models.CharField(max_length=255,verbose_name=&#39;文章简介&#39;)
<a id="__codelineno-127-38" name="__codelineno-127-38"></a>    content = models.TextField(verbose_name=&#39;文章内容&#39;)
<a id="__codelineno-127-39" name="__codelineno-127-39"></a>    create_time = models.DateField(auto_now_add=True)
<a id="__codelineno-127-40" name="__codelineno-127-40"></a>
<a id="__codelineno-127-41" name="__codelineno-127-41"></a>    up_num = models.BigIntegerField(default=0,verbose_name=&#39;点赞数&#39;)
<a id="__codelineno-127-42" name="__codelineno-127-42"></a>    down_num = models.BigIntegerField(default=0,verbose_name=&#39;点踩数&#39;)
<a id="__codelineno-127-43" name="__codelineno-127-43"></a>    comment_num = models.BigIntegerField(default=0,verbose_name=&#39;评论数&#39;)
<a id="__codelineno-127-44" name="__codelineno-127-44"></a>
<a id="__codelineno-127-45" name="__codelineno-127-45"></a>    ## 外键字段
<a id="__codelineno-127-46" name="__codelineno-127-46"></a>    blog = models.ForeignKey(to=&#39;Blog&#39;, null=True)
<a id="__codelineno-127-47" name="__codelineno-127-47"></a>    category = models.ForeignKey(to=&#39;Category&#39;)
<a id="__codelineno-127-48" name="__codelineno-127-48"></a>    tags = models.ManyToManyField(to=&#39;Tag&#39;,through=&#39;Article2Tag&#39;,through_fields=(&#39;article&#39;,&#39;tag&#39;))
<a id="__codelineno-127-49" name="__codelineno-127-49"></a>
<a id="__codelineno-127-50" name="__codelineno-127-50"></a>class Article2Tag(models.Model):
<a id="__codelineno-127-51" name="__codelineno-127-51"></a>    article = models.ForeignKey(to=&#39;Article&#39;)
<a id="__codelineno-127-52" name="__codelineno-127-52"></a>    tag = models.ForeignKey(to=&#39;Tag&#39;)
<a id="__codelineno-127-53" name="__codelineno-127-53"></a>
<a id="__codelineno-127-54" name="__codelineno-127-54"></a>class UpAndDown(models.Model):
<a id="__codelineno-127-55" name="__codelineno-127-55"></a>    user = models.ForeignKey(to=&#39;UserInfo&#39;)
<a id="__codelineno-127-56" name="__codelineno-127-56"></a>    article = models.ForeignKey(to=&quot;Article&quot;)
<a id="__codelineno-127-57" name="__codelineno-127-57"></a>    is_up = models.BooleanField()
<a id="__codelineno-127-58" name="__codelineno-127-58"></a>
<a id="__codelineno-127-59" name="__codelineno-127-59"></a>class Comment(models.Model):
<a id="__codelineno-127-60" name="__codelineno-127-60"></a>    user = models.ForeignKey(to=&#39;UserInfo&#39;)
<a id="__codelineno-127-61" name="__codelineno-127-61"></a>    article = models.ForeignKey(to=&quot;Article&quot;)
<a id="__codelineno-127-62" name="__codelineno-127-62"></a>    content = models.CharField(verbose_name=&#39;评论内容&#39;,max_length=255)
<a id="__codelineno-127-63" name="__codelineno-127-63"></a>    comment_time = models.DateTimeField(verbose_name=&#39;评论时间&#39;,auto_now_add=True)
<a id="__codelineno-127-64" name="__codelineno-127-64"></a>
<a id="__codelineno-127-65" name="__codelineno-127-65"></a>    ## 自关联
<a id="__codelineno-127-66" name="__codelineno-127-66"></a>    parent = models.ForeignKey(to=&#39;self&#39;,null=True)
</code></pre></div></td></tr></table></div>
<h3 id="22-3-注册功能">22-3 注册功能<a class="headerlink" href="#22-3-注册功能" title="Permanent link">&para;</a></h3>
<h4 id="3-1-后端代码">3-1 后端代码<a class="headerlink" href="#3-1-后端代码" title="Permanent link">&para;</a></h4>
<p><strong>注册页面的逻辑处理函数</strong></p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-128-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-128-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-128-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-128-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-128-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-128-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-128-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-128-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-128-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-128-10">10</a></span>
<span class="normal"><a href="#__codelineno-128-11">11</a></span>
<span class="normal"><a href="#__codelineno-128-12">12</a></span>
<span class="normal"><a href="#__codelineno-128-13">13</a></span>
<span class="normal"><a href="#__codelineno-128-14">14</a></span>
<span class="normal"><a href="#__codelineno-128-15">15</a></span>
<span class="normal"><a href="#__codelineno-128-16">16</a></span>
<span class="normal"><a href="#__codelineno-128-17">17</a></span>
<span class="normal"><a href="#__codelineno-128-18">18</a></span>
<span class="normal"><a href="#__codelineno-128-19">19</a></span>
<span class="normal"><a href="#__codelineno-128-20">20</a></span>
<span class="normal"><a href="#__codelineno-128-21">21</a></span>
<span class="normal"><a href="#__codelineno-128-22">22</a></span>
<span class="normal"><a href="#__codelineno-128-23">23</a></span>
<span class="normal"><a href="#__codelineno-128-24">24</a></span>
<span class="normal"><a href="#__codelineno-128-25">25</a></span>
<span class="normal"><a href="#__codelineno-128-26">26</a></span>
<span class="normal"><a href="#__codelineno-128-27">27</a></span>
<span class="normal"><a href="#__codelineno-128-28">28</a></span>
<span class="normal"><a href="#__codelineno-128-29">29</a></span>
<span class="normal"><a href="#__codelineno-128-30">30</a></span>
<span class="normal"><a href="#__codelineno-128-31">31</a></span>
<span class="normal"><a href="#__codelineno-128-32">32</a></span>
<span class="normal"><a href="#__codelineno-128-33">33</a></span>
<span class="normal"><a href="#__codelineno-128-34">34</a></span>
<span class="normal"><a href="#__codelineno-128-35">35</a></span>
<span class="normal"><a href="#__codelineno-128-36">36</a></span>
<span class="normal"><a href="#__codelineno-128-37">37</a></span>
<span class="normal"><a href="#__codelineno-128-38">38</a></span>
<span class="normal"><a href="#__codelineno-128-39">39</a></span>
<span class="normal"><a href="#__codelineno-128-40">40</a></span>
<span class="normal"><a href="#__codelineno-128-41">41</a></span>
<span class="normal"><a href="#__codelineno-128-42">42</a></span>
<span class="normal"><a href="#__codelineno-128-43">43</a></span>
<span class="normal"><a href="#__codelineno-128-44">44</a></span>
<span class="normal"><a href="#__codelineno-128-45">45</a></span>
<span class="normal"><a href="#__codelineno-128-46">46</a></span>
<span class="normal"><a href="#__codelineno-128-47">47</a></span>
<span class="normal"><a href="#__codelineno-128-48">48</a></span>
<span class="normal"><a href="#__codelineno-128-49">49</a></span>
<span class="normal"><a href="#__codelineno-128-50">50</a></span>
<span class="normal"><a href="#__codelineno-128-51">51</a></span>
<span class="normal"><a href="#__codelineno-128-52">52</a></span>
<span class="normal"><a href="#__codelineno-128-53">53</a></span>
<span class="normal"><a href="#__codelineno-128-54">54</a></span>
<span class="normal"><a href="#__codelineno-128-55">55</a></span>
<span class="normal"><a href="#__codelineno-128-56">56</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-128-1" name="__codelineno-128-1"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-128-2" name="__codelineno-128-2"></a><span class="sd">我们之前是直接在views.py中书写的forms组件代码</span>
<a id="__codelineno-128-3" name="__codelineno-128-3"></a><span class="sd">但是为了接耦合 应该将所有的forms组件代码单独写到一个地方</span>
<a id="__codelineno-128-4" name="__codelineno-128-4"></a>
<a id="__codelineno-128-5" name="__codelineno-128-5"></a><span class="sd">如果你的项目至始至终只用到一个forms组件那么你可以直接建一个py文件书写即可</span>
<a id="__codelineno-128-6" name="__codelineno-128-6"></a><span class="sd">    myforms.py</span>
<a id="__codelineno-128-7" name="__codelineno-128-7"></a><span class="sd">但是如果你的项目需要使用多个forms组件，那么你可以创建一个文件夹在文件夹内根据</span>
<a id="__codelineno-128-8" name="__codelineno-128-8"></a><span class="sd">forms组件功能的不同创建不同的py文件</span>
<a id="__codelineno-128-9" name="__codelineno-128-9"></a><span class="sd">    myforms文件夹</span>
<a id="__codelineno-128-10" name="__codelineno-128-10"></a><span class="sd">        regform.py</span>
<a id="__codelineno-128-11" name="__codelineno-128-11"></a><span class="sd">        loginform.py</span>
<a id="__codelineno-128-12" name="__codelineno-128-12"></a><span class="sd">        userform.py</span>
<a id="__codelineno-128-13" name="__codelineno-128-13"></a><span class="sd">        orderform.py</span>
<a id="__codelineno-128-14" name="__codelineno-128-14"></a><span class="sd">        ...</span>
<a id="__codelineno-128-15" name="__codelineno-128-15"></a><span class="sd">&quot;&quot;&quot;</span> 
<a id="__codelineno-128-16" name="__codelineno-128-16"></a><span class="c1">## views.py </span>
<a id="__codelineno-128-17" name="__codelineno-128-17"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.shortcuts</span><span class="w"> </span><span class="kn">import</span> <span class="n">render</span>
<a id="__codelineno-128-18" name="__codelineno-128-18"></a><span class="kn">from</span><span class="w"> </span><span class="nn">django.http</span><span class="w"> </span><span class="kn">import</span> <span class="n">JsonResponse</span>
<a id="__codelineno-128-19" name="__codelineno-128-19"></a><span class="kn">from</span><span class="w"> </span><span class="nn">app01</span><span class="w"> </span><span class="kn">import</span> <span class="n">models</span>
<a id="__codelineno-128-20" name="__codelineno-128-20"></a><span class="c1"># Create your views here.</span>
<a id="__codelineno-128-21" name="__codelineno-128-21"></a><span class="kn">from</span><span class="w"> </span><span class="nn">app01.myforms</span><span class="w"> </span><span class="kn">import</span>  <span class="n">MyRegForm</span>
<a id="__codelineno-128-22" name="__codelineno-128-22"></a>
<a id="__codelineno-128-23" name="__codelineno-128-23"></a><span class="c1">## 登录功能逻辑处理函数</span>
<a id="__codelineno-128-24" name="__codelineno-128-24"></a><span class="k">def</span><span class="w"> </span><span class="nf">register</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
<a id="__codelineno-128-25" name="__codelineno-128-25"></a>    <span class="n">form_obj</span> <span class="o">=</span> <span class="n">MyRegForm</span><span class="p">()</span>
<a id="__codelineno-128-26" name="__codelineno-128-26"></a>    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span>  <span class="s2">&quot;POST&quot;</span><span class="p">:</span>
<a id="__codelineno-128-27" name="__codelineno-128-27"></a>        <span class="c1"># 校验数据是否合法</span>
<a id="__codelineno-128-28" name="__codelineno-128-28"></a>        <span class="n">form_obj</span> <span class="o">=</span> <span class="n">MyRegForm</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="p">)</span>
<a id="__codelineno-128-29" name="__codelineno-128-29"></a>
<a id="__codelineno-128-30" name="__codelineno-128-30"></a>        <span class="c1">## 往前端放回的字典</span>
<a id="__codelineno-128-31" name="__codelineno-128-31"></a>        <span class="n">back_dic</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;code&quot;</span><span class="p">:</span> <span class="s2">&quot;200&quot;</span><span class="p">,</span> <span class="s2">&quot;msg&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">}</span>
<a id="__codelineno-128-32" name="__codelineno-128-32"></a>        <span class="c1"># 判断数据是否合法</span>
<a id="__codelineno-128-33" name="__codelineno-128-33"></a>        <span class="k">if</span> <span class="n">form_obj</span><span class="o">.</span><span class="n">is_valid</span><span class="p">():</span>
<a id="__codelineno-128-34" name="__codelineno-128-34"></a>
<a id="__codelineno-128-35" name="__codelineno-128-35"></a>            <span class="n">clean_data</span> <span class="o">=</span> <span class="n">form_obj</span><span class="o">.</span><span class="n">cleaned_data</span> <span class="c1">## 将校验通过的数据字典赋值给一个变量</span>
<a id="__codelineno-128-36" name="__codelineno-128-36"></a>            <span class="c1"># 将字典里面的confirm_password字段删除 为后续保存数据提供方便</span>
<a id="__codelineno-128-37" name="__codelineno-128-37"></a>            <span class="n">clean_data</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;confirm_password&#39;</span><span class="p">)</span>
<a id="__codelineno-128-38" name="__codelineno-128-38"></a>
<a id="__codelineno-128-39" name="__codelineno-128-39"></a>            <span class="c1">## 用户头像</span>
<a id="__codelineno-128-40" name="__codelineno-128-40"></a>            <span class="n">file_obj</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">FILES</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;avatar&#39;</span><span class="p">)</span>
<a id="__codelineno-128-41" name="__codelineno-128-41"></a>            <span class="c1">## 针对用户头像一定要判断是否传值，不能直接添加到用户字典里去</span>
<a id="__codelineno-128-42" name="__codelineno-128-42"></a>            <span class="k">if</span> <span class="n">file_obj</span><span class="p">:</span>
<a id="__codelineno-128-43" name="__codelineno-128-43"></a>                <span class="n">clean_data</span><span class="p">[</span><span class="s1">&#39;avatar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">file_obj</span>
<a id="__codelineno-128-44" name="__codelineno-128-44"></a>
<a id="__codelineno-128-45" name="__codelineno-128-45"></a>            <span class="c1">## 操作数据库保存数据</span>
<a id="__codelineno-128-46" name="__codelineno-128-46"></a>            <span class="n">models</span><span class="o">.</span><span class="n">UserInfo</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create_user</span><span class="p">(</span><span class="o">**</span><span class="n">clean_data</span><span class="p">)</span>
<a id="__codelineno-128-47" name="__codelineno-128-47"></a>            <span class="n">back_dic</span><span class="p">[</span><span class="s1">&#39;url&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;/login/&#39;</span>
<a id="__codelineno-128-48" name="__codelineno-128-48"></a>            <span class="n">back_dic</span><span class="p">[</span><span class="s1">&#39;msg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;注册用户成功！&#39;</span>
<a id="__codelineno-128-49" name="__codelineno-128-49"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-128-50" name="__codelineno-128-50"></a>            <span class="n">back_dic</span><span class="p">[</span><span class="s1">&#39;code&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">600</span>
<a id="__codelineno-128-51" name="__codelineno-128-51"></a>            <span class="n">back_dic</span><span class="p">[</span><span class="s1">&#39;msg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">form_obj</span><span class="o">.</span><span class="n">errors</span>
<a id="__codelineno-128-52" name="__codelineno-128-52"></a>
<a id="__codelineno-128-53" name="__codelineno-128-53"></a>        <span class="k">return</span> <span class="n">JsonResponse</span><span class="p">(</span><span class="n">back_dic</span><span class="p">)</span>
<a id="__codelineno-128-54" name="__codelineno-128-54"></a>
<a id="__codelineno-128-55" name="__codelineno-128-55"></a>
<a id="__codelineno-128-56" name="__codelineno-128-56"></a>    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span><span class="s1">&#39;register.html&#39;</span><span class="p">,</span><span class="nb">locals</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
<h4 id="3-2-前端页面registerhtml代码">3-2 前端页面register.html代码<a class="headerlink" href="#3-2-前端页面registerhtml代码" title="Permanent link">&para;</a></h4>
<p><strong>register.html 页面</strong>  </p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Text Only</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-129-1">  1</a></span>
<span class="normal"><a href="#__codelineno-129-2">  2</a></span>
<span class="normal"><a href="#__codelineno-129-3">  3</a></span>
<span class="normal"><a href="#__codelineno-129-4">  4</a></span>
<span class="normal"><a href="#__codelineno-129-5">  5</a></span>
<span class="normal"><a href="#__codelineno-129-6">  6</a></span>
<span class="normal"><a href="#__codelineno-129-7">  7</a></span>
<span class="normal"><a href="#__codelineno-129-8">  8</a></span>
<span class="normal"><a href="#__codelineno-129-9">  9</a></span>
<span class="normal"><a href="#__codelineno-129-10"> 10</a></span>
<span class="normal"><a href="#__codelineno-129-11"> 11</a></span>
<span class="normal"><a href="#__codelineno-129-12"> 12</a></span>
<span class="normal"><a href="#__codelineno-129-13"> 13</a></span>
<span class="normal"><a href="#__codelineno-129-14"> 14</a></span>
<span class="normal"><a href="#__codelineno-129-15"> 15</a></span>
<span class="normal"><a href="#__codelineno-129-16"> 16</a></span>
<span class="normal"><a href="#__codelineno-129-17"> 17</a></span>
<span class="normal"><a href="#__codelineno-129-18"> 18</a></span>
<span class="normal"><a href="#__codelineno-129-19"> 19</a></span>
<span class="normal"><a href="#__codelineno-129-20"> 20</a></span>
<span class="normal"><a href="#__codelineno-129-21"> 21</a></span>
<span class="normal"><a href="#__codelineno-129-22"> 22</a></span>
<span class="normal"><a href="#__codelineno-129-23"> 23</a></span>
<span class="normal"><a href="#__codelineno-129-24"> 24</a></span>
<span class="normal"><a href="#__codelineno-129-25"> 25</a></span>
<span class="normal"><a href="#__codelineno-129-26"> 26</a></span>
<span class="normal"><a href="#__codelineno-129-27"> 27</a></span>
<span class="normal"><a href="#__codelineno-129-28"> 28</a></span>
<span class="normal"><a href="#__codelineno-129-29"> 29</a></span>
<span class="normal"><a href="#__codelineno-129-30"> 30</a></span>
<span class="normal"><a href="#__codelineno-129-31"> 31</a></span>
<span class="normal"><a href="#__codelineno-129-32"> 32</a></span>
<span class="normal"><a href="#__codelineno-129-33"> 33</a></span>
<span class="normal"><a href="#__codelineno-129-34"> 34</a></span>
<span class="normal"><a href="#__codelineno-129-35"> 35</a></span>
<span class="normal"><a href="#__codelineno-129-36"> 36</a></span>
<span class="normal"><a href="#__codelineno-129-37"> 37</a></span>
<span class="normal"><a href="#__codelineno-129-38"> 38</a></span>
<span class="normal"><a href="#__codelineno-129-39"> 39</a></span>
<span class="normal"><a href="#__codelineno-129-40"> 40</a></span>
<span class="normal"><a href="#__codelineno-129-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-129-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-129-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-129-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-129-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-129-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-129-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-129-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-129-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-129-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-129-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-129-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-129-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-129-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-129-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-129-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-129-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-129-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-129-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-129-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-129-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-129-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-129-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-129-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-129-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-129-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-129-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-129-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-129-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-129-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-129-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-129-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-129-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-129-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-129-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-129-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-129-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-129-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-129-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-129-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-129-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-129-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-129-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-129-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-129-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-129-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-129-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-129-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-129-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-129-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-129-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-129-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-129-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-129-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-129-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-129-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-129-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-129-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-129-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-129-100">100</a></span>
<span class="normal"><a href="#__codelineno-129-101">101</a></span>
<span class="normal"><a href="#__codelineno-129-102">102</a></span>
<span class="normal"><a href="#__codelineno-129-103">103</a></span>
<span class="normal"><a href="#__codelineno-129-104">104</a></span>
<span class="normal"><a href="#__codelineno-129-105">105</a></span>
<span class="normal"><a href="#__codelineno-129-106">106</a></span>
<span class="normal"><a href="#__codelineno-129-107">107</a></span>
<span class="normal"><a href="#__codelineno-129-108">108</a></span>
<span class="normal"><a href="#__codelineno-129-109">109</a></span>
<span class="normal"><a href="#__codelineno-129-110">110</a></span>
<span class="normal"><a href="#__codelineno-129-111">111</a></span>
<span class="normal"><a href="#__codelineno-129-112">112</a></span>
<span class="normal"><a href="#__codelineno-129-113">113</a></span>
<span class="normal"><a href="#__codelineno-129-114">114</a></span>
<span class="normal"><a href="#__codelineno-129-115">115</a></span>
<span class="normal"><a href="#__codelineno-129-116">116</a></span>
<span class="normal"><a href="#__codelineno-129-117">117</a></span>
<span class="normal"><a href="#__codelineno-129-118">118</a></span>
<span class="normal"><a href="#__codelineno-129-119">119</a></span>
<span class="normal"><a href="#__codelineno-129-120">120</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-129-1" name="__codelineno-129-1"></a>&lt;!DOCTYPE html&gt;
<a id="__codelineno-129-2" name="__codelineno-129-2"></a>&lt;html lang=&quot;en&quot;&gt;
<a id="__codelineno-129-3" name="__codelineno-129-3"></a>&lt;head&gt;
<a id="__codelineno-129-4" name="__codelineno-129-4"></a>    &lt;meta charset=&quot;UTF-8&quot;&gt;
<a id="__codelineno-129-5" name="__codelineno-129-5"></a>    &lt;title&gt;Title&lt;/title&gt;
<a id="__codelineno-129-6" name="__codelineno-129-6"></a>
<a id="__codelineno-129-7" name="__codelineno-129-7"></a>    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1&quot;&gt;
<a id="__codelineno-129-8" name="__codelineno-129-8"></a>    &lt;link href=&quot;https://cdn.bootcss.com/twitter-bootstrap/3.4.1/css/bootstrap.min.css&quot; rel=&quot;stylesheet&quot;&gt;
<a id="__codelineno-129-9" name="__codelineno-129-9"></a>    &lt;script src=&quot;https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js&quot;&gt;&lt;/script&gt;
<a id="__codelineno-129-10" name="__codelineno-129-10"></a>
<a id="__codelineno-129-11" name="__codelineno-129-11"></a>    &lt;script src=&quot;https://cdn.bootcss.com/twitter-bootstrap/3.4.1/js/bootstrap.min.js&quot;&gt;&lt;/script&gt;
<a id="__codelineno-129-12" name="__codelineno-129-12"></a>
<a id="__codelineno-129-13" name="__codelineno-129-13"></a>&lt;/head&gt;
<a id="__codelineno-129-14" name="__codelineno-129-14"></a>
<a id="__codelineno-129-15" name="__codelineno-129-15"></a>&lt;body&gt;
<a id="__codelineno-129-16" name="__codelineno-129-16"></a>&lt;div class=&quot;container-fluid&quot;&gt;
<a id="__codelineno-129-17" name="__codelineno-129-17"></a>    &lt;div class=&quot;row&quot;&gt;
<a id="__codelineno-129-18" name="__codelineno-129-18"></a>        &lt;div class=&quot;col-md-8 col-md-offset-2&quot;&gt;
<a id="__codelineno-129-19" name="__codelineno-129-19"></a>            &lt;h1 class=&quot;text-center&quot;&gt;注册&lt;/h1&gt;
<a id="__codelineno-129-20" name="__codelineno-129-20"></a>
<a id="__codelineno-129-21" name="__codelineno-129-21"></a>            &lt;form id=&quot;myform&quot;&gt;
<a id="__codelineno-129-22" name="__codelineno-129-22"></a>                {% csrf_token %}
<a id="__codelineno-129-23" name="__codelineno-129-23"></a>                {% for form in form_obj %}
<a id="__codelineno-129-24" name="__codelineno-129-24"></a>                    &lt;div class=&quot;form-group&quot; id=&quot;form-group&quot;&gt;
<a id="__codelineno-129-25" name="__codelineno-129-25"></a>                        &lt;label for=&quot;{{ form.auto_id }}&quot;&gt;{{ form.label }}&lt;/label&gt;
<a id="__codelineno-129-26" name="__codelineno-129-26"></a>
<a id="__codelineno-129-27" name="__codelineno-129-27"></a>                        {{ form }}
<a id="__codelineno-129-28" name="__codelineno-129-28"></a>                        &lt;span style=&quot;color:red&quot; class=&quot;pull-right&quot;&gt;{{ form.errors.0 }}&lt;/span&gt;
<a id="__codelineno-129-29" name="__codelineno-129-29"></a>
<a id="__codelineno-129-30" name="__codelineno-129-30"></a>                    &lt;/div&gt;
<a id="__codelineno-129-31" name="__codelineno-129-31"></a>
<a id="__codelineno-129-32" name="__codelineno-129-32"></a>                {% endfor %}
<a id="__codelineno-129-33" name="__codelineno-129-33"></a>                {% load static %}
<a id="__codelineno-129-34" name="__codelineno-129-34"></a>                &lt;div class=&quot;form-group&quot;&gt;
<a id="__codelineno-129-35" name="__codelineno-129-35"></a>                    &lt;label for=&quot;myfile&quot;&gt;头像
<a id="__codelineno-129-36" name="__codelineno-129-36"></a>                        &lt;img src=&quot;{% static &#39;image/default.jpg&#39; %}&quot;  id=&quot;myimg&quot; alt=&quot;&quot; width=&quot;100&quot; height=&quot;100&quot; style=&quot;margin-left: 10px&quot;&gt;
<a id="__codelineno-129-37" name="__codelineno-129-37"></a>                    &lt;/label&gt;
<a id="__codelineno-129-38" name="__codelineno-129-38"></a>
<a id="__codelineno-129-39" name="__codelineno-129-39"></a>                    &lt;input type=&quot;file&quot; id=&quot;myfile&quot; name=&quot;avatar&quot; style=&quot;display: none&quot;&gt;
<a id="__codelineno-129-40" name="__codelineno-129-40"></a>                &lt;/div&gt;
<a id="__codelineno-129-41" name="__codelineno-129-41"></a>
<a id="__codelineno-129-42" name="__codelineno-129-42"></a>
<a id="__codelineno-129-43" name="__codelineno-129-43"></a>                &lt;input type=&quot;button&quot; class=&quot;btn btn-primary pull-right&quot; value=&quot;注册&quot; id=&quot;id_commit&quot;&gt;
<a id="__codelineno-129-44" name="__codelineno-129-44"></a>            &lt;/form&gt;
<a id="__codelineno-129-45" name="__codelineno-129-45"></a>
<a id="__codelineno-129-46" name="__codelineno-129-46"></a>        &lt;/div&gt;
<a id="__codelineno-129-47" name="__codelineno-129-47"></a>
<a id="__codelineno-129-48" name="__codelineno-129-48"></a>    &lt;/div&gt;
<a id="__codelineno-129-49" name="__codelineno-129-49"></a>
<a id="__codelineno-129-50" name="__codelineno-129-50"></a>&lt;/body&gt;
<a id="__codelineno-129-51" name="__codelineno-129-51"></a>
<a id="__codelineno-129-52" name="__codelineno-129-52"></a>&lt;script&gt;
<a id="__codelineno-129-53" name="__codelineno-129-53"></a>    $(&quot;#myfile&quot;).change(function(){
<a id="__codelineno-129-54" name="__codelineno-129-54"></a>        // 文件阅读器对象
<a id="__codelineno-129-55" name="__codelineno-129-55"></a>        // 第一步 生成一个文件阅读器对象
<a id="__codelineno-129-56" name="__codelineno-129-56"></a>        let myFileReaderObj = new FileReader();
<a id="__codelineno-129-57" name="__codelineno-129-57"></a>
<a id="__codelineno-129-58" name="__codelineno-129-58"></a>        // 获取用户上传的头像文件
<a id="__codelineno-129-59" name="__codelineno-129-59"></a>        let fileObj = $(this)[0].files[0]
<a id="__codelineno-129-60" name="__codelineno-129-60"></a>
<a id="__codelineno-129-61" name="__codelineno-129-61"></a>        // 将文件对象交给阅读器对象读取
<a id="__codelineno-129-62" name="__codelineno-129-62"></a>        myFileReaderObj.readAsDataURL(fileObj)  // 异步操作  且IO操作
<a id="__codelineno-129-63" name="__codelineno-129-63"></a>
<a id="__codelineno-129-64" name="__codelineno-129-64"></a>        // 所以等待文件阅读器异步加载完毕再进行下一步
<a id="__codelineno-129-65" name="__codelineno-129-65"></a>        myFileReaderObj.onload = function(){
<a id="__codelineno-129-66" name="__codelineno-129-66"></a>           // 利用文件阅读器将文件展示到前端页面，修改src属性
<a id="__codelineno-129-67" name="__codelineno-129-67"></a>        $(&#39;#myimg&#39;).attr(&#39;src&#39;,myFileReaderObj.result)
<a id="__codelineno-129-68" name="__codelineno-129-68"></a>        }
<a id="__codelineno-129-69" name="__codelineno-129-69"></a>    })
<a id="__codelineno-129-70" name="__codelineno-129-70"></a>
<a id="__codelineno-129-71" name="__codelineno-129-71"></a>    $(&quot;#id_commit&quot;).click(function(){
<a id="__codelineno-129-72" name="__codelineno-129-72"></a>        // 发送Ajax请求
<a id="__codelineno-129-73" name="__codelineno-129-73"></a>        // 我们发送的数据包含普通的键值对也包含文件
<a id="__codelineno-129-74" name="__codelineno-129-74"></a>        let formDataObj = new FormData()
<a id="__codelineno-129-75" name="__codelineno-129-75"></a>        // 添加普通的键值对
<a id="__codelineno-129-76" name="__codelineno-129-76"></a>        form_arr = $(&#39;#myform&#39;).serializeArray() // [{},{},{},{},{},{}]
<a id="__codelineno-129-77" name="__codelineno-129-77"></a>
<a id="__codelineno-129-78" name="__codelineno-129-78"></a>        // 遍历
<a id="__codelineno-129-79" name="__codelineno-129-79"></a>        $.each(form_arr,function(index,obj){
<a id="__codelineno-129-80" name="__codelineno-129-80"></a>            // 往文件对象里添加普通键值对
<a id="__codelineno-129-81" name="__codelineno-129-81"></a>          formDataObj.append(obj.name,obj.value)
<a id="__codelineno-129-82" name="__codelineno-129-82"></a>        })
<a id="__codelineno-129-83" name="__codelineno-129-83"></a>        // 添加文件数据
<a id="__codelineno-129-84" name="__codelineno-129-84"></a>        formDataObj.append(&#39;avatar&#39;,$(&#39;#myfile&#39;)[0].files[0])
<a id="__codelineno-129-85" name="__codelineno-129-85"></a>
<a id="__codelineno-129-86" name="__codelineno-129-86"></a>        // 发送Ajax请求
<a id="__codelineno-129-87" name="__codelineno-129-87"></a>        $.ajax({
<a id="__codelineno-129-88" name="__codelineno-129-88"></a>            url:&quot;&quot;,
<a id="__codelineno-129-89" name="__codelineno-129-89"></a>            type:&quot;post&quot;,
<a id="__codelineno-129-90" name="__codelineno-129-90"></a>            data:formDataObj,
<a id="__codelineno-129-91" name="__codelineno-129-91"></a>
<a id="__codelineno-129-92" name="__codelineno-129-92"></a>            // 需要指定两个关键性参数
<a id="__codelineno-129-93" name="__codelineno-129-93"></a>            contentType:false,
<a id="__codelineno-129-94" name="__codelineno-129-94"></a>            processData:false,
<a id="__codelineno-129-95" name="__codelineno-129-95"></a>
<a id="__codelineno-129-96" name="__codelineno-129-96"></a>            success: function(res){
<a id="__codelineno-129-97" name="__codelineno-129-97"></a>                if(res.code == 200){
<a id="__codelineno-129-98" name="__codelineno-129-98"></a>                    // 跳转到登录页面
<a id="__codelineno-129-99" name="__codelineno-129-99"></a>                    window.location.href = res.url
<a id="__codelineno-129-100" name="__codelineno-129-100"></a>                }else{
<a id="__codelineno-129-101" name="__codelineno-129-101"></a>                    // 如何将对应的错误信息展示到对应的input框
<a id="__codelineno-129-102" name="__codelineno-129-102"></a>                    // forms组件渲染的标签ID值都是id_字段名
<a id="__codelineno-129-103" name="__codelineno-129-103"></a>
<a id="__codelineno-129-104" name="__codelineno-129-104"></a>                    $.each(res.msg,function(index,obj){
<a id="__codelineno-129-105" name="__codelineno-129-105"></a>                        let target_id = &#39;#id_&#39; + index
<a id="__codelineno-129-106" name="__codelineno-129-106"></a>                        $(target_id).next().text(obj[0]).parent().addClass(&#39;has-error&#39;)
<a id="__codelineno-129-107" name="__codelineno-129-107"></a>
<a id="__codelineno-129-108" name="__codelineno-129-108"></a>                    })
<a id="__codelineno-129-109" name="__codelineno-129-109"></a>                }
<a id="__codelineno-129-110" name="__codelineno-129-110"></a>            }
<a id="__codelineno-129-111" name="__codelineno-129-111"></a>        })
<a id="__codelineno-129-112" name="__codelineno-129-112"></a>    })
<a id="__codelineno-129-113" name="__codelineno-129-113"></a>
<a id="__codelineno-129-114" name="__codelineno-129-114"></a>    // 直接给所有的input框绑定获取焦点事件
<a id="__codelineno-129-115" name="__codelineno-129-115"></a>    $(&#39;input&#39;).focus(function(){
<a id="__codelineno-129-116" name="__codelineno-129-116"></a>        $(this).next().text(&#39;&#39;).parent().removeClass(&#39;has-error&#39;)
<a id="__codelineno-129-117" name="__codelineno-129-117"></a>    })
<a id="__codelineno-129-118" name="__codelineno-129-118"></a>&lt;/script&gt;
<a id="__codelineno-129-119" name="__codelineno-129-119"></a>
<a id="__codelineno-129-120" name="__codelineno-129-120"></a>&lt;/html&gt;
</code></pre></div></td></tr></table></div>
<h3 id="22-4-登录功能">22-4 登录功能<a class="headerlink" href="#22-4-登录功能" title="Permanent link">&para;</a></h3>
<h4 id="4-1-后端代码">4-1 后端代码<a class="headerlink" href="#4-1-后端代码" title="Permanent link">&para;</a></h4>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-130-1">  1</a></span>
<span class="normal"><a href="#__codelineno-130-2">  2</a></span>
<span class="normal"><a href="#__codelineno-130-3">  3</a></span>
<span class="normal"><a href="#__codelineno-130-4">  4</a></span>
<span class="normal"><a href="#__codelineno-130-5">  5</a></span>
<span class="normal"><a href="#__codelineno-130-6">  6</a></span>
<span class="normal"><a href="#__codelineno-130-7">  7</a></span>
<span class="normal"><a href="#__codelineno-130-8">  8</a></span>
<span class="normal"><a href="#__codelineno-130-9">  9</a></span>
<span class="normal"><a href="#__codelineno-130-10"> 10</a></span>
<span class="normal"><a href="#__codelineno-130-11"> 11</a></span>
<span class="normal"><a href="#__codelineno-130-12"> 12</a></span>
<span class="normal"><a href="#__codelineno-130-13"> 13</a></span>
<span class="normal"><a href="#__codelineno-130-14"> 14</a></span>
<span class="normal"><a href="#__codelineno-130-15"> 15</a></span>
<span class="normal"><a href="#__codelineno-130-16"> 16</a></span>
<span class="normal"><a href="#__codelineno-130-17"> 17</a></span>
<span class="normal"><a href="#__codelineno-130-18"> 18</a></span>
<span class="normal"><a href="#__codelineno-130-19"> 19</a></span>
<span class="normal"><a href="#__codelineno-130-20"> 20</a></span>
<span class="normal"><a href="#__codelineno-130-21"> 21</a></span>
<span class="normal"><a href="#__codelineno-130-22"> 22</a></span>
<span class="normal"><a href="#__codelineno-130-23"> 23</a></span>
<span class="normal"><a href="#__codelineno-130-24"> 24</a></span>
<span class="normal"><a href="#__codelineno-130-25"> 25</a></span>
<span class="normal"><a href="#__codelineno-130-26"> 26</a></span>
<span class="normal"><a href="#__codelineno-130-27"> 27</a></span>
<span class="normal"><a href="#__codelineno-130-28"> 28</a></span>
<span class="normal"><a href="#__codelineno-130-29"> 29</a></span>
<span class="normal"><a href="#__codelineno-130-30"> 30</a></span>
<span class="normal"><a href="#__codelineno-130-31"> 31</a></span>
<span class="normal"><a href="#__codelineno-130-32"> 32</a></span>
<span class="normal"><a href="#__codelineno-130-33"> 33</a></span>
<span class="normal"><a href="#__codelineno-130-34"> 34</a></span>
<span class="normal"><a href="#__codelineno-130-35"> 35</a></span>
<span class="normal"><a href="#__codelineno-130-36"> 36</a></span>
<span class="normal"><a href="#__codelineno-130-37"> 37</a></span>
<span class="normal"><a href="#__codelineno-130-38"> 38</a></span>
<span class="normal"><a href="#__codelineno-130-39"> 39</a></span>
<span class="normal"><a href="#__codelineno-130-40"> 40</a></span>
<span class="normal"><a href="#__codelineno-130-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-130-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-130-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-130-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-130-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-130-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-130-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-130-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-130-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-130-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-130-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-130-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-130-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-130-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-130-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-130-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-130-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-130-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-130-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-130-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-130-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-130-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-130-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-130-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-130-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-130-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-130-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-130-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-130-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-130-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-130-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-130-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-130-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-130-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-130-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-130-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-130-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-130-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-130-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-130-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-130-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-130-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-130-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-130-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-130-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-130-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-130-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-130-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-130-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-130-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-130-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-130-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-130-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-130-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-130-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-130-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-130-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-130-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-130-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-130-100">100</a></span>
<span class="normal"><a href="#__codelineno-130-101">101</a></span>
<span class="normal"><a href="#__codelineno-130-102">102</a></span>
<span class="normal"><a href="#__codelineno-130-103">103</a></span>
<span class="normal"><a href="#__codelineno-130-104">104</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-130-1" name="__codelineno-130-1"></a><span class="c1">## 登录页面的逻辑处理函数</span>
<a id="__codelineno-130-2" name="__codelineno-130-2"></a><span class="k">def</span><span class="w"> </span><span class="nf">login</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
<a id="__codelineno-130-3" name="__codelineno-130-3"></a>    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;POST&#39;</span><span class="p">:</span>
<a id="__codelineno-130-4" name="__codelineno-130-4"></a>        <span class="n">back_dic</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;code&#39;</span><span class="p">:</span><span class="mi">200</span><span class="p">,</span><span class="s1">&#39;msg&#39;</span><span class="p">:</span><span class="s1">&#39;&#39;</span><span class="p">}</span>
<a id="__codelineno-130-5" name="__codelineno-130-5"></a>        <span class="n">username</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;username&#39;</span><span class="p">)</span>
<a id="__codelineno-130-6" name="__codelineno-130-6"></a>        <span class="n">password</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;password&#39;</span><span class="p">)</span>
<a id="__codelineno-130-7" name="__codelineno-130-7"></a>        <span class="n">code</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;code&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
<a id="__codelineno-130-8" name="__codelineno-130-8"></a>
<a id="__codelineno-130-9" name="__codelineno-130-9"></a>        <span class="c1">## 校验验证码是否正确（忽略大小写）</span>
<a id="__codelineno-130-10" name="__codelineno-130-10"></a>        <span class="n">local_code</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;code&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
<a id="__codelineno-130-11" name="__codelineno-130-11"></a>        <span class="k">if</span> <span class="n">local_code</span> <span class="o">==</span> <span class="n">code</span><span class="p">:</span>
<a id="__codelineno-130-12" name="__codelineno-130-12"></a>            <span class="c1">## 校验用户名和密码是否正确</span>
<a id="__codelineno-130-13" name="__codelineno-130-13"></a>            <span class="n">user_obj</span> <span class="o">=</span> <span class="n">auth</span><span class="o">.</span><span class="n">authenticate</span><span class="p">(</span><span class="n">request</span><span class="p">,</span><span class="n">username</span><span class="o">=</span><span class="n">username</span><span class="p">,</span><span class="n">password</span><span class="o">=</span><span class="n">password</span><span class="p">)</span>
<a id="__codelineno-130-14" name="__codelineno-130-14"></a>
<a id="__codelineno-130-15" name="__codelineno-130-15"></a>            <span class="k">if</span> <span class="n">user_obj</span><span class="p">:</span>
<a id="__codelineno-130-16" name="__codelineno-130-16"></a>                <span class="c1">## 保存用户状态</span>
<a id="__codelineno-130-17" name="__codelineno-130-17"></a>                <span class="n">auth</span><span class="o">.</span><span class="n">login</span><span class="p">(</span><span class="n">request</span><span class="p">,</span><span class="n">user_obj</span><span class="p">)</span>
<a id="__codelineno-130-18" name="__codelineno-130-18"></a>                <span class="n">back_dic</span><span class="p">[</span><span class="s1">&#39;url&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;/home/&#39;</span>
<a id="__codelineno-130-19" name="__codelineno-130-19"></a>                <span class="n">back_dic</span><span class="p">[</span><span class="s1">&#39;msg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;登录成功！&#39;</span>
<a id="__codelineno-130-20" name="__codelineno-130-20"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-130-21" name="__codelineno-130-21"></a>                <span class="n">back_dic</span><span class="p">[</span><span class="s1">&#39;code&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">600</span>
<a id="__codelineno-130-22" name="__codelineno-130-22"></a>                <span class="n">back_dic</span><span class="p">[</span><span class="s1">&#39;msg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;用户名或密码错误&#39;</span>
<a id="__codelineno-130-23" name="__codelineno-130-23"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-130-24" name="__codelineno-130-24"></a>            <span class="n">back_dic</span><span class="p">[</span><span class="s1">&#39;code&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">700</span>
<a id="__codelineno-130-25" name="__codelineno-130-25"></a>            <span class="n">back_dic</span><span class="p">[</span><span class="s1">&#39;msg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;验证码错误&#39;</span>
<a id="__codelineno-130-26" name="__codelineno-130-26"></a>        <span class="k">return</span> <span class="n">JsonResponse</span><span class="p">(</span><span class="n">back_dic</span><span class="p">)</span>
<a id="__codelineno-130-27" name="__codelineno-130-27"></a>
<a id="__codelineno-130-28" name="__codelineno-130-28"></a>    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span><span class="s1">&#39;login.html&#39;</span><span class="p">)</span>
<a id="__codelineno-130-29" name="__codelineno-130-29"></a>
<a id="__codelineno-130-30" name="__codelineno-130-30"></a>
<a id="__codelineno-130-31" name="__codelineno-130-31"></a><span class="c1">## 图片相关的模块</span>
<a id="__codelineno-130-32" name="__codelineno-130-32"></a><span class="sd">&#39;&#39;&#39;</span>
<a id="__codelineno-130-33" name="__codelineno-130-33"></a><span class="sd">pip install pillow</span>
<a id="__codelineno-130-34" name="__codelineno-130-34"></a>
<a id="__codelineno-130-35" name="__codelineno-130-35"></a><span class="sd">Image:生成图片</span>
<a id="__codelineno-130-36" name="__codelineno-130-36"></a><span class="sd">ImageDraw:能够在图片上乱涂乱画</span>
<a id="__codelineno-130-37" name="__codelineno-130-37"></a><span class="sd">ImageFont:控制字体样式</span>
<a id="__codelineno-130-38" name="__codelineno-130-38"></a><span class="sd">&#39;&#39;&#39;</span>
<a id="__codelineno-130-39" name="__codelineno-130-39"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_random</span><span class="p">():</span>
<a id="__codelineno-130-40" name="__codelineno-130-40"></a>    <span class="k">return</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">255</span><span class="p">),</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">255</span><span class="p">),</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">255</span><span class="p">)</span>
<a id="__codelineno-130-41" name="__codelineno-130-41"></a>
<a id="__codelineno-130-42" name="__codelineno-130-42"></a><span class="kn">from</span><span class="w"> </span><span class="nn">PIL</span><span class="w"> </span><span class="kn">import</span> <span class="n">Image</span><span class="p">,</span><span class="n">ImageDraw</span><span class="p">,</span><span class="n">ImageFont</span>
<a id="__codelineno-130-43" name="__codelineno-130-43"></a><span class="kn">from</span><span class="w"> </span><span class="nn">io</span><span class="w"> </span><span class="kn">import</span> <span class="n">BytesIO</span><span class="p">,</span><span class="n">StringIO</span>
<a id="__codelineno-130-44" name="__codelineno-130-44"></a><span class="sd">&#39;&#39;&#39;</span>
<a id="__codelineno-130-45" name="__codelineno-130-45"></a><span class="sd">内存管理器模块</span>
<a id="__codelineno-130-46" name="__codelineno-130-46"></a><span class="sd">BytesIO:临时帮你存储数据 返回的时候数据是二进制</span>
<a id="__codelineno-130-47" name="__codelineno-130-47"></a><span class="sd">StringIO:临时帮你存储数据 返回的时候数据是字符串</span>
<a id="__codelineno-130-48" name="__codelineno-130-48"></a><span class="sd">&#39;&#39;&#39;</span>
<a id="__codelineno-130-49" name="__codelineno-130-49"></a><span class="c1">## 图片验证码</span>
<a id="__codelineno-130-50" name="__codelineno-130-50"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_code</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
<a id="__codelineno-130-51" name="__codelineno-130-51"></a>    <span class="c1">## 推导步骤一：直接获取后端图片的二进制数据返回给前端</span>
<a id="__codelineno-130-52" name="__codelineno-130-52"></a>    <span class="c1"># with open(r&#39;static/image/default.jpg&#39;,&#39;rb&#39;) as f:</span>
<a id="__codelineno-130-53" name="__codelineno-130-53"></a>    <span class="c1">#   data = f.read()</span>
<a id="__codelineno-130-54" name="__codelineno-130-54"></a>    <span class="c1"># return HttpResponse(data)</span>
<a id="__codelineno-130-55" name="__codelineno-130-55"></a>
<a id="__codelineno-130-56" name="__codelineno-130-56"></a>    <span class="c1">## 推导步骤二：用pillow模块动态生成图片 缺点是IO操作频繁</span>
<a id="__codelineno-130-57" name="__codelineno-130-57"></a>    <span class="c1"># img_obj = Image.new(&#39;RGB&#39;,(340,35),get_random())</span>
<a id="__codelineno-130-58" name="__codelineno-130-58"></a>    <span class="c1">#</span>
<a id="__codelineno-130-59" name="__codelineno-130-59"></a>    <span class="c1"># ## 先将图片对象保存起来</span>
<a id="__codelineno-130-60" name="__codelineno-130-60"></a>    <span class="c1"># with open(&#39;xxx.png&#39;,&#39;wb&#39;) as f:</span>
<a id="__codelineno-130-61" name="__codelineno-130-61"></a>    <span class="c1">#   img_obj.save(f,&#39;png&#39;)</span>
<a id="__codelineno-130-62" name="__codelineno-130-62"></a>    <span class="c1">#</span>
<a id="__codelineno-130-63" name="__codelineno-130-63"></a>    <span class="c1"># ## 再将图片对象读取出来</span>
<a id="__codelineno-130-64" name="__codelineno-130-64"></a>    <span class="c1"># with open(&#39;xxx.png&#39;,&#39;rb&#39;) as f:</span>
<a id="__codelineno-130-65" name="__codelineno-130-65"></a>    <span class="c1">#   data = f.read()</span>
<a id="__codelineno-130-66" name="__codelineno-130-66"></a>    <span class="c1">#</span>
<a id="__codelineno-130-67" name="__codelineno-130-67"></a>    <span class="c1"># return HttpResponse(data)</span>
<a id="__codelineno-130-68" name="__codelineno-130-68"></a>
<a id="__codelineno-130-69" name="__codelineno-130-69"></a>    <span class="c1">## 推导步骤三：借助于内存管理器模块</span>
<a id="__codelineno-130-70" name="__codelineno-130-70"></a>    <span class="c1"># img_obj = Image.new(&#39;RGB&#39;, (340, 35), get_random())</span>
<a id="__codelineno-130-71" name="__codelineno-130-71"></a>    <span class="c1"># io_obj = BytesIO() ## 生成一个内存管理器对象 你可以看成是文件句柄</span>
<a id="__codelineno-130-72" name="__codelineno-130-72"></a>    <span class="c1">#</span>
<a id="__codelineno-130-73" name="__codelineno-130-73"></a>    <span class="c1"># img_obj.save(io_obj,&#39;png&#39;)</span>
<a id="__codelineno-130-74" name="__codelineno-130-74"></a>    <span class="c1"># return HttpResponse(io_obj.getvalue())  ## 从内存管理器中读取二进制数据返回给前端</span>
<a id="__codelineno-130-75" name="__codelineno-130-75"></a>
<a id="__codelineno-130-76" name="__codelineno-130-76"></a>    <span class="c1">## 最终步骤：写图片验证码</span>
<a id="__codelineno-130-77" name="__codelineno-130-77"></a>    <span class="n">img_obj</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s1">&#39;RGB&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">340</span><span class="p">,</span> <span class="mi">35</span><span class="p">),</span> <span class="n">get_random</span><span class="p">())</span>
<a id="__codelineno-130-78" name="__codelineno-130-78"></a>    <span class="n">img_draw</span> <span class="o">=</span> <span class="n">ImageDraw</span><span class="o">.</span><span class="n">Draw</span><span class="p">((</span><span class="n">img_obj</span><span class="p">))</span>  <span class="c1">## 产生画笔对象</span>
<a id="__codelineno-130-79" name="__codelineno-130-79"></a>    <span class="n">img_font</span> <span class="o">=</span> <span class="n">ImageFont</span><span class="o">.</span><span class="n">truetype</span><span class="p">(</span><span class="s1">&#39;static/font/222.ttf&#39;</span><span class="p">,</span><span class="mi">30</span><span class="p">)</span> <span class="c1">## 字体样式和大小</span>
<a id="__codelineno-130-80" name="__codelineno-130-80"></a>
<a id="__codelineno-130-81" name="__codelineno-130-81"></a>    <span class="c1">## 五位数的随机验证码，包含数字，小写字母，大写字母</span>
<a id="__codelineno-130-82" name="__codelineno-130-82"></a>    <span class="n">code</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<a id="__codelineno-130-83" name="__codelineno-130-83"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
<a id="__codelineno-130-84" name="__codelineno-130-84"></a>        <span class="n">random_uppper</span> <span class="o">=</span> <span class="nb">chr</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">65</span><span class="p">,</span><span class="mi">90</span><span class="p">))</span>  <span class="c1">## 大写字母</span>
<a id="__codelineno-130-85" name="__codelineno-130-85"></a>        <span class="n">random_lower</span> <span class="o">=</span> <span class="nb">chr</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">97</span><span class="p">,</span> <span class="mi">122</span><span class="p">))</span>  <span class="c1">## 大写字母</span>
<a id="__codelineno-130-86" name="__codelineno-130-86"></a>        <span class="n">random_int</span>  <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">9</span><span class="p">))</span>  <span class="c1">## 数字</span>
<a id="__codelineno-130-87" name="__codelineno-130-87"></a>
<a id="__codelineno-130-88" name="__codelineno-130-88"></a>        <span class="c1">## 从上面三个里面随机选择一个</span>
<a id="__codelineno-130-89" name="__codelineno-130-89"></a>        <span class="n">tmp</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="n">random_uppper</span><span class="p">,</span><span class="n">random_lower</span><span class="p">,</span><span class="n">random_int</span><span class="p">])</span>
<a id="__codelineno-130-90" name="__codelineno-130-90"></a>
<a id="__codelineno-130-91" name="__codelineno-130-91"></a>        <span class="c1">## 将产生的随机字符串写入到图片上</span>
<a id="__codelineno-130-92" name="__codelineno-130-92"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-130-93" name="__codelineno-130-93"></a><span class="sd">           为什么一个个写而不是生成好了之后再写</span>
<a id="__codelineno-130-94" name="__codelineno-130-94"></a><span class="sd">           因为一个个写能够控制每个字体的间隙 而生成好之后再写的话</span>
<a id="__codelineno-130-95" name="__codelineno-130-95"></a><span class="sd">           间隙就没法控制了</span>
<a id="__codelineno-130-96" name="__codelineno-130-96"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-130-97" name="__codelineno-130-97"></a>        <span class="n">img_draw</span><span class="o">.</span><span class="n">text</span><span class="p">((</span><span class="n">i</span><span class="o">*</span><span class="mi">45</span><span class="o">+</span><span class="mi">70</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">),</span><span class="n">tmp</span><span class="p">,</span><span class="n">get_random</span><span class="p">(),</span><span class="n">img_font</span><span class="p">)</span>
<a id="__codelineno-130-98" name="__codelineno-130-98"></a>        <span class="c1">## 拼接随机字符串</span>
<a id="__codelineno-130-99" name="__codelineno-130-99"></a>        <span class="n">code</span> <span class="o">+=</span> <span class="n">tmp</span>
<a id="__codelineno-130-100" name="__codelineno-130-100"></a>    <span class="c1">## 随机验证码在登录的视图函数中需要用到 要比对 而且其他视图函数也能够拿到</span>
<a id="__codelineno-130-101" name="__codelineno-130-101"></a>    <span class="n">request</span><span class="o">.</span><span class="n">session</span><span class="p">[</span><span class="s1">&#39;code&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">code</span>
<a id="__codelineno-130-102" name="__codelineno-130-102"></a>    <span class="n">io_obj</span> <span class="o">=</span> <span class="n">BytesIO</span><span class="p">()</span>
<a id="__codelineno-130-103" name="__codelineno-130-103"></a>    <span class="n">img_obj</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">io_obj</span><span class="p">,</span><span class="s1">&#39;png&#39;</span><span class="p">)</span>
<a id="__codelineno-130-104" name="__codelineno-130-104"></a>    <span class="k">return</span> <span class="n">HttpResponse</span><span class="p">(</span><span class="n">io_obj</span><span class="o">.</span><span class="n">getvalue</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
<h4 id="4-2-前端login页面代码">4-2 前端login页面代码<a class="headerlink" href="#4-2-前端login页面代码" title="Permanent link">&para;</a></h4>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">HTML</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-131-1">  1</a></span>
<span class="normal"><a href="#__codelineno-131-2">  2</a></span>
<span class="normal"><a href="#__codelineno-131-3">  3</a></span>
<span class="normal"><a href="#__codelineno-131-4">  4</a></span>
<span class="normal"><a href="#__codelineno-131-5">  5</a></span>
<span class="normal"><a href="#__codelineno-131-6">  6</a></span>
<span class="normal"><a href="#__codelineno-131-7">  7</a></span>
<span class="normal"><a href="#__codelineno-131-8">  8</a></span>
<span class="normal"><a href="#__codelineno-131-9">  9</a></span>
<span class="normal"><a href="#__codelineno-131-10"> 10</a></span>
<span class="normal"><a href="#__codelineno-131-11"> 11</a></span>
<span class="normal"><a href="#__codelineno-131-12"> 12</a></span>
<span class="normal"><a href="#__codelineno-131-13"> 13</a></span>
<span class="normal"><a href="#__codelineno-131-14"> 14</a></span>
<span class="normal"><a href="#__codelineno-131-15"> 15</a></span>
<span class="normal"><a href="#__codelineno-131-16"> 16</a></span>
<span class="normal"><a href="#__codelineno-131-17"> 17</a></span>
<span class="normal"><a href="#__codelineno-131-18"> 18</a></span>
<span class="normal"><a href="#__codelineno-131-19"> 19</a></span>
<span class="normal"><a href="#__codelineno-131-20"> 20</a></span>
<span class="normal"><a href="#__codelineno-131-21"> 21</a></span>
<span class="normal"><a href="#__codelineno-131-22"> 22</a></span>
<span class="normal"><a href="#__codelineno-131-23"> 23</a></span>
<span class="normal"><a href="#__codelineno-131-24"> 24</a></span>
<span class="normal"><a href="#__codelineno-131-25"> 25</a></span>
<span class="normal"><a href="#__codelineno-131-26"> 26</a></span>
<span class="normal"><a href="#__codelineno-131-27"> 27</a></span>
<span class="normal"><a href="#__codelineno-131-28"> 28</a></span>
<span class="normal"><a href="#__codelineno-131-29"> 29</a></span>
<span class="normal"><a href="#__codelineno-131-30"> 30</a></span>
<span class="normal"><a href="#__codelineno-131-31"> 31</a></span>
<span class="normal"><a href="#__codelineno-131-32"> 32</a></span>
<span class="normal"><a href="#__codelineno-131-33"> 33</a></span>
<span class="normal"><a href="#__codelineno-131-34"> 34</a></span>
<span class="normal"><a href="#__codelineno-131-35"> 35</a></span>
<span class="normal"><a href="#__codelineno-131-36"> 36</a></span>
<span class="normal"><a href="#__codelineno-131-37"> 37</a></span>
<span class="normal"><a href="#__codelineno-131-38"> 38</a></span>
<span class="normal"><a href="#__codelineno-131-39"> 39</a></span>
<span class="normal"><a href="#__codelineno-131-40"> 40</a></span>
<span class="normal"><a href="#__codelineno-131-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-131-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-131-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-131-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-131-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-131-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-131-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-131-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-131-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-131-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-131-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-131-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-131-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-131-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-131-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-131-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-131-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-131-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-131-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-131-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-131-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-131-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-131-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-131-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-131-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-131-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-131-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-131-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-131-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-131-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-131-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-131-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-131-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-131-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-131-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-131-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-131-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-131-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-131-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-131-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-131-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-131-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-131-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-131-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-131-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-131-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-131-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-131-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-131-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-131-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-131-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-131-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-131-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-131-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-131-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-131-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-131-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-131-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-131-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-131-100">100</a></span>
<span class="normal"><a href="#__codelineno-131-101">101</a></span>
<span class="normal"><a href="#__codelineno-131-102">102</a></span>
<span class="normal"><a href="#__codelineno-131-103">103</a></span>
<span class="normal"><a href="#__codelineno-131-104">104</a></span>
<span class="normal"><a href="#__codelineno-131-105">105</a></span>
<span class="normal"><a href="#__codelineno-131-106">106</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-131-1" name="__codelineno-131-1"></a><span class="cp">&lt;!DOCTYPE html&gt;</span>
<a id="__codelineno-131-2" name="__codelineno-131-2"></a><span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&quot;en&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-131-3" name="__codelineno-131-3"></a><span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
<a id="__codelineno-131-4" name="__codelineno-131-4"></a>    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&quot;UTF-8&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-131-5" name="__codelineno-131-5"></a>    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>Title<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
<a id="__codelineno-131-6" name="__codelineno-131-6"></a>
<a id="__codelineno-131-7" name="__codelineno-131-7"></a>     <span class="p">&lt;</span><span class="nt">link</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;https://cdn.bootcss.com/twitter-bootstrap/3.4.1/css/bootstrap.min.css&quot;</span> <span class="na">rel</span><span class="o">=</span><span class="s">&quot;stylesheet&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-131-8" name="__codelineno-131-8"></a>    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<a id="__codelineno-131-9" name="__codelineno-131-9"></a>
<a id="__codelineno-131-10" name="__codelineno-131-10"></a>    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;https://cdn.bootcss.com/twitter-bootstrap/3.4.1/js/bootstrap.min.js&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<a id="__codelineno-131-11" name="__codelineno-131-11"></a>
<a id="__codelineno-131-12" name="__codelineno-131-12"></a><span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<a id="__codelineno-131-13" name="__codelineno-131-13"></a>
<a id="__codelineno-131-14" name="__codelineno-131-14"></a><span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
<a id="__codelineno-131-15" name="__codelineno-131-15"></a>{% load static %}
<a id="__codelineno-131-16" name="__codelineno-131-16"></a><span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;container-fluid&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-131-17" name="__codelineno-131-17"></a>    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;row&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-131-18" name="__codelineno-131-18"></a>        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;col-md-8 col-md-offset-2&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-131-19" name="__codelineno-131-19"></a>            <span class="p">&lt;</span><span class="nt">h1</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;text-center&quot;</span><span class="p">&gt;</span>登录<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
<a id="__codelineno-131-20" name="__codelineno-131-20"></a>
<a id="__codelineno-131-21" name="__codelineno-131-21"></a>            <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;form-group&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-131-22" name="__codelineno-131-22"></a>                <span class="p">&lt;</span><span class="nt">label</span> <span class="na">for</span><span class="o">=</span><span class="s">&quot;username&quot;</span><span class="p">&gt;</span>用户名<span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;&lt;</span><span class="nt">span</span> <span class="na">style</span><span class="o">=</span><span class="s">&quot;color:red&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;input_error pull-right&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>
<a id="__codelineno-131-23" name="__codelineno-131-23"></a>
<a id="__codelineno-131-24" name="__codelineno-131-24"></a>                <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;text&quot;</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;username&quot;</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;username&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;form-control&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-131-25" name="__codelineno-131-25"></a>            <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a id="__codelineno-131-26" name="__codelineno-131-26"></a>
<a id="__codelineno-131-27" name="__codelineno-131-27"></a>            <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;form-group&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-131-28" name="__codelineno-131-28"></a>                 <span class="p">&lt;</span><span class="nt">label</span> <span class="na">for</span><span class="o">=</span><span class="s">&quot;password&quot;</span><span class="p">&gt;</span>密码<span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;&lt;</span><span class="nt">span</span> <span class="na">style</span><span class="o">=</span><span class="s">&quot;color:red&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;input_error pull-right&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>
<a id="__codelineno-131-29" name="__codelineno-131-29"></a>
<a id="__codelineno-131-30" name="__codelineno-131-30"></a>                <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;password&quot;</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;password&quot;</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;password&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;form-control&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-131-31" name="__codelineno-131-31"></a>            <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a id="__codelineno-131-32" name="__codelineno-131-32"></a>
<a id="__codelineno-131-33" name="__codelineno-131-33"></a>            <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;form-group&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-131-34" name="__codelineno-131-34"></a>                <span class="p">&lt;</span><span class="nt">label</span> <span class="na">for</span><span class="o">=</span><span class="s">&quot;code&quot;</span><span class="p">&gt;</span>验证码<span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;&lt;</span><span class="nt">span</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;error&quot;</span> <span class="na">style</span><span class="o">=</span><span class="s">&quot;color:red&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;pull-right&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>
<a id="__codelineno-131-35" name="__codelineno-131-35"></a>
<a id="__codelineno-131-36" name="__codelineno-131-36"></a>                <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;row&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-131-37" name="__codelineno-131-37"></a>                    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;col-md-8&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-131-38" name="__codelineno-131-38"></a>                       <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;text&quot;</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;code&quot;</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;id_code&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;form-control&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-131-39" name="__codelineno-131-39"></a>                    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a id="__codelineno-131-40" name="__codelineno-131-40"></a>
<a id="__codelineno-131-41" name="__codelineno-131-41"></a>                    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;col-md-4&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-131-42" name="__codelineno-131-42"></a>                        <span class="p">&lt;</span><span class="nt">img</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;/get_code/&quot;</span> <span class="na">alt</span><span class="o">=</span><span class="s">&quot;&quot;</span> <span class="na">width</span><span class="o">=</span><span class="s">&quot;340&quot;</span> <span class="na">height</span><span class="o">=</span><span class="s">&quot;35&quot;</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;code_img&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-131-43" name="__codelineno-131-43"></a>                    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a id="__codelineno-131-44" name="__codelineno-131-44"></a>
<a id="__codelineno-131-45" name="__codelineno-131-45"></a>                <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a id="__codelineno-131-46" name="__codelineno-131-46"></a>
<a id="__codelineno-131-47" name="__codelineno-131-47"></a>            <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a id="__codelineno-131-48" name="__codelineno-131-48"></a>
<a id="__codelineno-131-49" name="__codelineno-131-49"></a>            <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;a-box&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-131-50" name="__codelineno-131-50"></a>                <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;javascript:avoid;&quot;</span> <span class="na">id</span><span class="o">=</span> <span class="s">&quot;a-box&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;pull-right&quot;</span><span class="p">&gt;</span>看不清？换一张？<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
<a id="__codelineno-131-51" name="__codelineno-131-51"></a>
<a id="__codelineno-131-52" name="__codelineno-131-52"></a>            <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a id="__codelineno-131-53" name="__codelineno-131-53"></a>
<a id="__codelineno-131-54" name="__codelineno-131-54"></a>            <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;button&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;btn btn-success&quot;</span> <span class="na">value</span><span class="o">=</span><span class="s">&quot;登录&quot;</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;id_commit&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-131-55" name="__codelineno-131-55"></a>        <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a id="__codelineno-131-56" name="__codelineno-131-56"></a>
<a id="__codelineno-131-57" name="__codelineno-131-57"></a>    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a id="__codelineno-131-58" name="__codelineno-131-58"></a>
<a id="__codelineno-131-59" name="__codelineno-131-59"></a><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a id="__codelineno-131-60" name="__codelineno-131-60"></a>
<a id="__codelineno-131-61" name="__codelineno-131-61"></a><span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<a id="__codelineno-131-62" name="__codelineno-131-62"></a>
<a id="__codelineno-131-63" name="__codelineno-131-63"></a><span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span>
<a id="__codelineno-131-64" name="__codelineno-131-64"></a><span class="w">    </span><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#code_img&#39;</span><span class="p">).</span><span class="nx">click</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
<a id="__codelineno-131-65" name="__codelineno-131-65"></a><span class="w">        </span><span class="c1">// 获取标签之前的src</span>
<a id="__codelineno-131-66" name="__codelineno-131-66"></a><span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="nx">oldval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;src&#39;</span><span class="p">)</span>
<a id="__codelineno-131-67" name="__codelineno-131-67"></a><span class="w">        </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">oldval</span><span class="p">)</span>
<a id="__codelineno-131-68" name="__codelineno-131-68"></a><span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="nx">newSrc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">oldval</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s2">&quot;?&quot;</span>
<a id="__codelineno-131-69" name="__codelineno-131-69"></a><span class="w">        </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">newSrc</span><span class="p">)</span>
<a id="__codelineno-131-70" name="__codelineno-131-70"></a><span class="w">        </span><span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;src&#39;</span><span class="p">,</span><span class="nx">newSrc</span><span class="p">)</span>
<a id="__codelineno-131-71" name="__codelineno-131-71"></a><span class="w">    </span><span class="p">})</span>
<a id="__codelineno-131-72" name="__codelineno-131-72"></a>
<a id="__codelineno-131-73" name="__codelineno-131-73"></a><span class="w">    </span><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#a-box&#39;</span><span class="p">).</span><span class="nx">click</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
<a id="__codelineno-131-74" name="__codelineno-131-74"></a><span class="w">        </span><span class="c1">// 获取标签之前的src</span>
<a id="__codelineno-131-75" name="__codelineno-131-75"></a><span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="nx">oldval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#code_img&#39;</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;src&#39;</span><span class="p">)</span>
<a id="__codelineno-131-76" name="__codelineno-131-76"></a><span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="nx">newSrc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">oldval</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s2">&quot;?&quot;</span>
<a id="__codelineno-131-77" name="__codelineno-131-77"></a><span class="w">        </span><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#code_img&#39;</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;src&#39;</span><span class="p">,</span><span class="nx">newSrc</span><span class="p">)</span>
<a id="__codelineno-131-78" name="__codelineno-131-78"></a><span class="w">    </span><span class="p">})</span>
<a id="__codelineno-131-79" name="__codelineno-131-79"></a>
<a id="__codelineno-131-80" name="__codelineno-131-80"></a><span class="w">    </span><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#id_commit&#39;</span><span class="p">).</span><span class="nx">click</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
<a id="__codelineno-131-81" name="__codelineno-131-81"></a><span class="w">        </span><span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
<a id="__codelineno-131-82" name="__codelineno-131-82"></a><span class="w">            </span><span class="nx">url</span><span class="o">:</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
<a id="__codelineno-131-83" name="__codelineno-131-83"></a><span class="w">            </span><span class="nx">type</span><span class="o">:</span><span class="s1">&#39;post&#39;</span><span class="p">,</span>
<a id="__codelineno-131-84" name="__codelineno-131-84"></a><span class="w">            </span><span class="nx">data</span><span class="o">:</span><span class="p">{</span>
<a id="__codelineno-131-85" name="__codelineno-131-85"></a><span class="w">                </span><span class="s1">&#39;username&#39;</span><span class="o">:</span><span class="nx">$</span><span class="p">(</span><span class="s2">&quot;#username&quot;</span><span class="p">).</span><span class="nx">val</span><span class="p">(),</span>
<a id="__codelineno-131-86" name="__codelineno-131-86"></a><span class="w">                </span><span class="s1">&#39;password&#39;</span><span class="o">:</span><span class="nx">$</span><span class="p">(</span><span class="s2">&quot;#password&quot;</span><span class="p">).</span><span class="nx">val</span><span class="p">(),</span>
<a id="__codelineno-131-87" name="__codelineno-131-87"></a><span class="w">                </span><span class="s1">&#39;code&#39;</span><span class="o">:</span><span class="nx">$</span><span class="p">(</span><span class="s2">&quot;#id_code&quot;</span><span class="p">).</span><span class="nx">val</span><span class="p">(),</span>
<a id="__codelineno-131-88" name="__codelineno-131-88"></a><span class="w">                </span><span class="s1">&#39;csrfmiddlewaretoken&#39;</span><span class="o">:</span><span class="s1">&#39;{{ csrf_token }}&#39;</span>
<a id="__codelineno-131-89" name="__codelineno-131-89"></a><span class="w">            </span><span class="p">},</span>
<a id="__codelineno-131-90" name="__codelineno-131-90"></a><span class="w">            </span><span class="nx">success</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">res</span><span class="p">){</span>
<a id="__codelineno-131-91" name="__codelineno-131-91"></a><span class="w">                </span><span class="k">if</span><span class="p">(</span><span class="nx">res</span><span class="p">.</span><span class="nx">code</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mf">200</span><span class="p">){</span>
<a id="__codelineno-131-92" name="__codelineno-131-92"></a><span class="w">                    </span><span class="nb">window</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">href</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">res</span><span class="p">.</span><span class="nx">url</span>
<a id="__codelineno-131-93" name="__codelineno-131-93"></a><span class="w">                </span><span class="p">}</span><span class="k">else</span><span class="p">{</span>
<a id="__codelineno-131-94" name="__codelineno-131-94"></a><span class="w">                    </span><span class="c1">// 渲染错误信息</span>
<a id="__codelineno-131-95" name="__codelineno-131-95"></a><span class="w">                    </span><span class="k">if</span><span class="p">(</span><span class="nx">res</span><span class="p">.</span><span class="nx">msg</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;验证码错误&#39;</span><span class="p">){</span>
<a id="__codelineno-131-96" name="__codelineno-131-96"></a><span class="w">                        </span><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#error&#39;</span><span class="p">).</span><span class="nx">text</span><span class="p">(</span><span class="nx">res</span><span class="p">.</span><span class="nx">msg</span><span class="p">)</span>
<a id="__codelineno-131-97" name="__codelineno-131-97"></a><span class="w">                    </span><span class="p">}</span><span class="k">else</span><span class="p">{</span>
<a id="__codelineno-131-98" name="__codelineno-131-98"></a><span class="w">                        </span><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;.input_error&#39;</span><span class="p">).</span><span class="nx">text</span><span class="p">(</span><span class="nx">res</span><span class="p">.</span><span class="nx">msg</span><span class="p">)</span>
<a id="__codelineno-131-99" name="__codelineno-131-99"></a><span class="w">                    </span><span class="p">}</span>
<a id="__codelineno-131-100" name="__codelineno-131-100"></a><span class="w">                </span><span class="p">}</span>
<a id="__codelineno-131-101" name="__codelineno-131-101"></a><span class="w">            </span><span class="p">}</span>
<a id="__codelineno-131-102" name="__codelineno-131-102"></a><span class="w">        </span><span class="p">})</span>
<a id="__codelineno-131-103" name="__codelineno-131-103"></a><span class="w">    </span><span class="p">})</span>
<a id="__codelineno-131-104" name="__codelineno-131-104"></a><span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<a id="__codelineno-131-105" name="__codelineno-131-105"></a>
<a id="__codelineno-131-106" name="__codelineno-131-106"></a><span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></div></td></tr></table></div>
<h2 id="django-报错解决">Django 报错解决<a class="headerlink" href="#django-报错解决" title="Permanent link">&para;</a></h2>
<h2 id="1-1-错误一">1-1   错误一<a class="headerlink" href="#1-1-错误一" title="Permanent link">&para;</a></h2>
<p>module ‘collections‘ has no attribute ‘Iterable‘报错 </p>
<p>在python3.9之后collections.<a href="https://so.csdn.net/so/search?q=Iterable&amp;spm=1001.2101.3001.7020">Iterable</a>被废弃，在更高版本的环境中使用时会出现module 'collections' has no attribute 'Iterable’报错。</p>
<p>可以直接添加语句collections.Iterable = collections.abc.Iterable完成修改</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-132-1">1</a></span>
<span class="normal"><a href="#__codelineno-132-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-132-1" name="__codelineno-132-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">collections</span>
<a id="__codelineno-132-2" name="__codelineno-132-2"></a><span class="n">collections</span><span class="o">.</span><span class="n">Iterable</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">abc</span><span class="o">.</span><span class="n">Iterable</span>
</code></pre></div></td></tr></table></div>
<h2 id="1-2-错误二">1-2 错误二<a class="headerlink" href="#1-2-错误二" title="Permanent link">&para;</a></h2>
<p>'DIRS': [BASE_DIR / 'templates']</p>
<p>TypeError: unsupported operand type(s) for /: 'str' and 'str'</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-133-1">1</a></span>
<span class="normal"><a href="#__codelineno-133-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-133-1" name="__codelineno-133-1"></a><span class="n">setting</span> <span class="n">设置改为如下</span>
<a id="__codelineno-133-2" name="__codelineno-133-2"></a><span class="s1">&#39;DIRS&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">BASE_DIR</span><span class="p">,</span><span class="s1">&#39;templates&#39;</span><span class="p">)],</span>
</code></pre></div></td></tr></table></div>
<h1 id="_1"><a class="headerlink" href="#_1" title="Permanent link">&para;</a></h1>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  回到页面顶部
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="页脚" >
        
          
          <a href="../Bootstrap/" class="md-footer__link md-footer__link--prev" aria-label="上一页: Bootstrap">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                上一页
              </span>
              <div class="md-ellipsis">
                Bootstrap
              </div>
            </div>
          </a>
        
        
          
          <a href="../Tailwind%20CSS/" class="md-footer__link md-footer__link--next" aria-label="下一页: Tailwind CSS">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                下一页
              </span>
              <div class="md-ellipsis">
                Tailwind CSS
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2025 李烨栋
    </div>
  
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["header.autohide", "announce.dismiss", "navigation.instant", "navigation.tracking", "content.code.annotate", "toc.integrate", "toc.follow", "navigation.path", "navigation.top", "navigation.tabs", "navigation.prune", "navigation.footer", "navigation.tabs.sticky", "navigation.sections", "navigation.expand", "content.code.copy", "navigation.indexes", "search.share", "search.suggest", "search.highlight"], "search": "../../../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.c8b220af.min.js"></script>
      
    
  </body>
</html>