下面是适用于典型**前端项目（如 Vue / React / Vite 等）**的 Dockerfile 模板，采用 **多阶段构建**，将构建产物打包进轻量级 Nginx 镜像，适合用于部署生产环境。

---

## ✅ 通用前端项目 Dockerfile（支持 Vue / React / Vite）
```dockerfile
# ===== 第一步：构建阶段 =====
FROM node:20-alpine AS builder

# 设置中国 npm 镜像源（加速依赖安装）
RUN npm config set registry https://registry.npmmirror.com

WORKDIR /app

# 复制 package 相关文件并安装依赖（分步缓存）
COPY package*.json ./
RUN npm install

# 复制项目源码并构建
COPY . .
RUN npm run build

# ===== 第二步：生产环境镜像，用 Nginx 托管 =====
FROM nginx:1.25-alpine

# 可选：使用自定义 Nginx 配置（替换默认配置）
# COPY nginx.conf /etc/nginx/nginx.conf

# 删除默认页面
RUN rm -rf /usr/share/nginx/html/*

# 复制构建产物到 Nginx 的 html 目录  react是build目录，将dist修改成build
COPY --from=builder /app/dist /usr/share/nginx/html

# 开放端口
EXPOSE 80

# 启动 Nginx（可选优化：加上 daemon off）
CMD ["nginx", "-g", "daemon off;"]
```

---

## ☑️ nginx.conf（可选：自定义 Nginx 配置）
如果你想让前端路由全部由 `index.html` 处理（用于 history 模式），可添加如下 `nginx.conf` 并挂载：

```nginx
server {
    listen 80;
    server_name ${NGINX_SERVER_NAME:-localhost};  # 默认值为 localhost

    location / {
        root /opt/vue-fastapi-admin/web/dist;
        index index.html index.htm;
        try_files $uri /index.html;
    }

    location /api/ {
        proxy_pass http://localhost:9999/api/;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    }

    location /docs {
        proxy_pass http://localhost:9999/docs;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    }

    location /openapi.json {
        proxy_pass http://localhost:9999/openapi.json;
    }
}

```

使用时：

```dockerfile
COPY nginx.conf /etc/nginx/conf.d/default.conf
```

---

## 📌 常见适配说明
| 框架 | 构建命令 | 构建产物目录 |
| --- | --- | --- |
| Vue 2/3 | `npm run build` | `/dist` |
| React | `npm run build` | `/build` |
| Vite | `npm run build` | `/dist` |


如果是 React 项目，请把 `COPY --from=builder /app/build /usr/share/nginx/html` 写成对应的路径。

---

## 🧪 构建与运行示例
```bash
docker build -t my-frontend-app .
docker run -d -p 80:80 my-frontend-app
```

---

## 🚀 若部署到 Harbor 私有仓库
你可以在 Dockerfile 中替换基础镜像，例如：

```dockerfile
FROM harbor.liyedong.com/base/node:20-alpine AS builder
FROM harbor.liyedong.com/base/nginx:1.25-alpine
```

