

## æ‹‰å–é•œåƒ
```bash
docker pull swr.cn-north-4.myhuaweicloud.com/ddn-k8s/docker.io/redis:8.2.0
docker tag  swr.cn-north-4.myhuaweicloud.com/ddn-k8s/docker.io/redis:8.2.0  docker.io/redis:8.2.0
docker pull swr.cn-north-4.myhuaweicloud.com/ddn-k8s/docker.io/mysql:9.3.0
docker tag  swr.cn-north-4.myhuaweicloud.com/ddn-k8s/docker.io/mysql:9.3.0  docker.io/mysql:9.3.0
docker pull swr.cn-north-4.myhuaweicloud.com/ddn-k8s/docker.io/library/elasticsearch:8.17.6
docker tag  swr.cn-north-4.myhuaweicloud.com/ddn-k8s/docker.io/library/elasticsearch:8.17.6  docker.io/library/elasticsearch:8.17.6
```



## åˆ›å»ºæ•°æ®ç›®å½•
```bash
mkdir -p /u01/docker/mysql/data
mkdir -p /u01/docker/mysql/conf
mkdir -p /u01/docker/mysql/logs

mkdir -p /u01/docker/elasticsearch/data
mkdir -p /u01/docker/elasticsearch/logs
mkdir -p /u01/docker/elasticsearch/plugins

mkdir -p /u01/docker/redis/data

```

##  docker-compose.yml  
```yaml
tee /u01/docker/docker-compose.yml <<EOF
version: '3.9'

services:
  mysql:
    image: mysql:9.3.0
    container_name: mysql
    restart: always
    ports:
      - "3306:3306"
    environment:
      MYSQL_ROOT_PASSWORD: root
      MYSQL_DATABASE: blog_db
    volumes:
      - /u01/docker/mysql/data:/var/lib/mysql
      - /u01/docker/mysql/conf:/etc/mysql/conf.d
      - /u01/docker/mysql/logs:/var/log/mysql

  elasticsearch:
    image: elasticsearch:8.17.6
    container_name: es
    restart: always
    ports:
      - "9200:9200"
    environment:
      discovery.type: single-node
      xpack.security.http.ssl.enabled: "false"
      xpack.license.self_generated.type: trial
      xpack.security.enabled: "true"   #falseæ²¡æœ‰å¯†ç 
      ELASTIC_PASSWORD: "elastic"   # âœ… æŒ‡å®š elastic ç”¨æˆ·çš„åˆå§‹å¯†ç 
      ES_JAVA_OPTS: "-Xms512m -Xmx512m"
    volumes:
      - /u01/docker/elasticsearch/data:/usr/share/elasticsearch/data
      - /u01/docker/elasticsearch/logs:/usr/share/elasticsearch/logs
      - /u01/docker/elasticsearch/plugins:/usr/share/elasticsearch/plugins

  redis:
    image: redis:8.2.0
    container_name: redis
    restart: always
    ports:
      - "6379:6379"
    volumes:
      - /u01/docker/redis/data:/data
      - /u01/docker/redis/redis.conf:/usr/local/etc/redis/redis.conf
    command: ["redis-server", "/usr/local/etc/redis/redis.conf"]

EOF
```

## åˆ›å»ºé…ç½®æ–‡ä»¶å’Œæˆæƒ
```bash
chown -R 1000:1000 /u01/docker/elasticsearch
tee /u01/docker/mysql/conf/my.cnf <<EOF
[mysqld]
character-set-server = utf8mb4
collation-server = utf8mb4_general_ci
EOF
tee /u01/docker/redis/redis.conf <<EOF
appendonly yes
save 60 1000
requirepass redis
EOF
```

## å¯åŠ¨
```bash
cd /u01/docker
docker compose up -d
```

## æ£€æŸ¥
```bash
docker ps
docker exec -it mysql mysql -uroot -proot -e "SHOW DATABASES;"
curl 127.0.0.1:9200
docker exec -it redis redis-cli ping
```

## 4ï¸âƒ£ éªŒè¯æ•°æ®æŒä¹…åŒ–ï¼ˆé‡ç‚¹ï¼‰
1. å‘ MySQL æ’å…¥ä¸€æ¡æ•°æ® / å‘ Redis set ä¸€ä¸ª key / å‘ ES å»ºä¸€ä¸ªç´¢å¼•ã€‚
2. åœæ‰å®¹å™¨ï¼š

```plain
docker compose down
```

3. å†æ¬¡å¯åŠ¨ï¼š

```plain
docker compose up -d
```

4. é‡æ–°æŸ¥è¯¢ï¼Œçœ‹æ•°æ®æ˜¯å¦è¿˜åœ¨ã€‚  
ğŸ‘‰ å¦‚æœè¿˜åœ¨ï¼Œè¯´æ˜ `/u01/docker/...` çš„æŒ‚è½½ç”Ÿæ•ˆï¼Œæ•°æ®å­˜åˆ°äº†ä½ çš„æ•°æ®ç›˜ã€‚

